{"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nvar _dotenv = _interopRequireDefault(require(\"dotenv\"));\n\nvar _express = _interopRequireDefault(require(\"express\"));\n\nvar _apolloServerExpress = require(\"apollo-server-express\");\n\nvar _graphql = _interopRequireDefault(require(\"./graphql\"));\n\nvar _validateToken = _interopRequireDefault(require(\"./middlewares/auth/validate-token\"));\n\nrequire(\"./config/mongodb-config\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst client = require(\"./config/redis-config\");\n\n_dotenv.default.config();\n\nconst app = (0, _express.default)();\n\nasync function startApolloServer() {\n  const server = new _apolloServerExpress.ApolloServer({\n    schema: _graphql.default,\n    playground: true,\n    introspection: true,\n    tracing: true,\n    path: \"/\",\n    context: ({\n      req\n    }) => {\n      return {\n        user: req.headers.user,\n        headers: req.headers,\n        phoneVerification: req.headers.phoneverification || \"\",\n        context: {\n          client\n        }\n      };\n    }\n  });\n  app.use(_validateToken.default);\n  await server.start();\n  server.applyMiddleware({\n    app,\n    path: \"/\",\n    cors: \"no-cors\"\n  });\n  app.listen({\n    port: process.env.PORT\n  }, () => {\n    console.log(`ðŸš€ Server listening on port ${process.env.PORT}`);\n  });\n}\n\nstartApolloServer().then(() => {\n  console.log(\"Apollo server started\");\n}).catch(err => {\n  console.log(`ðŸš€ Server Error: ${err.message}`);\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbImNsaWVudCIsInJlcXVpcmUiLCJkb3RlbnYiLCJjb25maWciLCJhcHAiLCJzdGFydEFwb2xsb1NlcnZlciIsInNlcnZlciIsIkFwb2xsb1NlcnZlciIsInNjaGVtYSIsInBsYXlncm91bmQiLCJpbnRyb3NwZWN0aW9uIiwidHJhY2luZyIsInBhdGgiLCJjb250ZXh0IiwicmVxIiwidXNlciIsImhlYWRlcnMiLCJwaG9uZVZlcmlmaWNhdGlvbiIsInBob25ldmVyaWZpY2F0aW9uIiwidXNlIiwidmFsaWRhdGVUb2tlbiIsInN0YXJ0IiwiYXBwbHlNaWRkbGV3YXJlIiwiY29ycyIsImxpc3RlbiIsInBvcnQiLCJwcm9jZXNzIiwiZW52IiwiUE9SVCIsImNvbnNvbGUiLCJsb2ciLCJ0aGVuIiwiY2F0Y2giLCJlcnIiLCJtZXNzYWdlIl0sIm1hcHBpbmdzIjoiOztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOzs7O0FBRUEsTUFBTUEsTUFBTSxHQUFHQyxPQUFPLENBQUMsdUJBQUQsQ0FBdEI7O0FBRUFDLGdCQUFPQyxNQUFQOztBQUNBLE1BQU1DLEdBQUcsR0FBRyx1QkFBWjs7QUFFQSxlQUFlQyxpQkFBZixHQUFtQztBQUMvQixRQUFNQyxNQUFNLEdBQUcsSUFBSUMsaUNBQUosQ0FBaUI7QUFDNUJDLElBQUFBLE1BQU0sRUFBTkEsZ0JBRDRCO0FBRTVCQyxJQUFBQSxVQUFVLEVBQUUsSUFGZ0I7QUFHNUJDLElBQUFBLGFBQWEsRUFBRSxJQUhhO0FBSTVCQyxJQUFBQSxPQUFPLEVBQUUsSUFKbUI7QUFLNUJDLElBQUFBLElBQUksRUFBRSxHQUxzQjtBQU01QkMsSUFBQUEsT0FBTyxFQUFFLENBQUM7QUFBQ0MsTUFBQUE7QUFBRCxLQUFELEtBQVc7QUFDaEIsYUFBTztBQUNIQyxRQUFBQSxJQUFJLEVBQUVELEdBQUcsQ0FBQ0UsT0FBSixDQUFZRCxJQURmO0FBRUhDLFFBQUFBLE9BQU8sRUFBRUYsR0FBRyxDQUFDRSxPQUZWO0FBR0hDLFFBQUFBLGlCQUFpQixFQUFFSCxHQUFHLENBQUNFLE9BQUosQ0FBWUUsaUJBQVosSUFBaUMsRUFIakQ7QUFJSEwsUUFBQUEsT0FBTyxFQUFFO0FBQUViLFVBQUFBO0FBQUY7QUFKTixPQUFQO0FBTUg7QUFiMkIsR0FBakIsQ0FBZjtBQWdCQUksRUFBQUEsR0FBRyxDQUFDZSxHQUFKLENBQVFDLHNCQUFSO0FBRUEsUUFBTWQsTUFBTSxDQUFDZSxLQUFQLEVBQU47QUFFQWYsRUFBQUEsTUFBTSxDQUFDZ0IsZUFBUCxDQUF1QjtBQUNuQmxCLElBQUFBLEdBRG1CO0FBRW5CUSxJQUFBQSxJQUFJLEVBQUUsR0FGYTtBQUduQlcsSUFBQUEsSUFBSSxFQUFFO0FBSGEsR0FBdkI7QUFNQW5CLEVBQUFBLEdBQUcsQ0FBQ29CLE1BQUosQ0FBVztBQUFDQyxJQUFBQSxJQUFJLEVBQUVDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQztBQUFuQixHQUFYLEVBQXFDLE1BQU07QUFDdkNDLElBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFhLCtCQUE4QkosT0FBTyxDQUFDQyxHQUFSLENBQVlDLElBQUssRUFBNUQ7QUFDSCxHQUZEO0FBR0g7O0FBRUR2QixpQkFBaUIsR0FBRzBCLElBQXBCLENBQXlCLE1BQU07QUFDM0JGLEVBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLHVCQUFaO0FBQ0gsQ0FGRCxFQUVHRSxLQUZILENBRVVDLEdBQUQsSUFBUztBQUNkSixFQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBYSxvQkFBbUJHLEdBQUcsQ0FBQ0MsT0FBUSxFQUE1QztBQUNILENBSkQiLCJzb3VyY2VSb290IjoiQzpcXFVzZXJzXFxSZWJiZVxcRGVza3RvcFxcaGFsZXRhLW5ldy1hcGlcXHNyY1xcIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGRvdGVudiBmcm9tIFwiZG90ZW52XCI7XHJcbmltcG9ydCBleHByZXNzIGZyb20gXCJleHByZXNzXCI7XHJcbmltcG9ydCB7QXBvbGxvU2VydmVyfSBmcm9tIFwiYXBvbGxvLXNlcnZlci1leHByZXNzXCI7XHJcbmltcG9ydCBzY2hlbWEgZnJvbSBcIi4vZ3JhcGhxbFwiO1xyXG5pbXBvcnQgdmFsaWRhdGVUb2tlbiBmcm9tIFwiLi9taWRkbGV3YXJlcy9hdXRoL3ZhbGlkYXRlLXRva2VuXCI7XHJcbmltcG9ydCBcIi4vY29uZmlnL21vbmdvZGItY29uZmlnXCI7XHJcblxyXG5jb25zdCBjbGllbnQgPSByZXF1aXJlKFwiLi9jb25maWcvcmVkaXMtY29uZmlnXCIpO1xyXG5cclxuZG90ZW52LmNvbmZpZygpO1xyXG5jb25zdCBhcHAgPSBleHByZXNzKCk7XHJcblxyXG5hc3luYyBmdW5jdGlvbiBzdGFydEFwb2xsb1NlcnZlcigpIHtcclxuICAgIGNvbnN0IHNlcnZlciA9IG5ldyBBcG9sbG9TZXJ2ZXIoe1xyXG4gICAgICAgIHNjaGVtYSxcclxuICAgICAgICBwbGF5Z3JvdW5kOiB0cnVlLFxyXG4gICAgICAgIGludHJvc3BlY3Rpb246IHRydWUsXHJcbiAgICAgICAgdHJhY2luZzogdHJ1ZSxcclxuICAgICAgICBwYXRoOiBcIi9cIixcclxuICAgICAgICBjb250ZXh0OiAoe3JlcX0pID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgIHVzZXI6IHJlcS5oZWFkZXJzLnVzZXIsXHJcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiByZXEuaGVhZGVycyxcclxuICAgICAgICAgICAgICAgIHBob25lVmVyaWZpY2F0aW9uOiByZXEuaGVhZGVycy5waG9uZXZlcmlmaWNhdGlvbiB8fCBcIlwiLFxyXG4gICAgICAgICAgICAgICAgY29udGV4dDogeyBjbGllbnQgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH0sXHJcbiAgICB9KTtcclxuXHJcbiAgICBhcHAudXNlKHZhbGlkYXRlVG9rZW4pXHJcblxyXG4gICAgYXdhaXQgc2VydmVyLnN0YXJ0KCk7XHJcblxyXG4gICAgc2VydmVyLmFwcGx5TWlkZGxld2FyZSh7XHJcbiAgICAgICAgYXBwLFxyXG4gICAgICAgIHBhdGg6IFwiL1wiLFxyXG4gICAgICAgIGNvcnM6IFwibm8tY29yc1wiLFxyXG4gICAgfSk7XHJcblxyXG4gICAgYXBwLmxpc3Rlbih7cG9ydDogcHJvY2Vzcy5lbnYuUE9SVH0sICgpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhg8J+agCBTZXJ2ZXIgbGlzdGVuaW5nIG9uIHBvcnQgJHtwcm9jZXNzLmVudi5QT1JUfWApO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbnN0YXJ0QXBvbGxvU2VydmVyKCkudGhlbigoKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhcIkFwb2xsbyBzZXJ2ZXIgc3RhcnRlZFwiKTtcclxufSkuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgY29uc29sZS5sb2coYPCfmoAgU2VydmVyIEVycm9yOiAke2Vyci5tZXNzYWdlfWApO1xyXG59KSJdfQ==","map":{"version":3,"sources":["index.js"],"names":["client","require","dotenv","config","app","startApolloServer","server","ApolloServer","schema","playground","introspection","tracing","path","context","req","user","headers","phoneVerification","phoneverification","use","validateToken","start","applyMiddleware","cors","listen","port","process","env","PORT","console","log","then","catch","err","message"],"mappings":";;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AAEA,MAAMA,MAAM,GAAGC,OAAO,CAAC,uBAAD,CAAtB;;AAEAC,gBAAOC,MAAP;;AACA,MAAMC,GAAG,GAAG,uBAAZ;;AAEA,eAAeC,iBAAf,GAAmC;AAC/B,QAAMC,MAAM,GAAG,IAAIC,iCAAJ,CAAiB;AAC5BC,IAAAA,MAAM,EAANA,gBAD4B;AAE5BC,IAAAA,UAAU,EAAE,IAFgB;AAG5BC,IAAAA,aAAa,EAAE,IAHa;AAI5BC,IAAAA,OAAO,EAAE,IAJmB;AAK5BC,IAAAA,IAAI,EAAE,GALsB;AAM5BC,IAAAA,OAAO,EAAE,CAAC;AAACC,MAAAA;AAAD,KAAD,KAAW;AAChB,aAAO;AACHC,QAAAA,IAAI,EAAED,GAAG,CAACE,OAAJ,CAAYD,IADf;AAEHC,QAAAA,OAAO,EAAEF,GAAG,CAACE,OAFV;AAGHC,QAAAA,iBAAiB,EAAEH,GAAG,CAACE,OAAJ,CAAYE,iBAAZ,IAAiC,EAHjD;AAIHL,QAAAA,OAAO,EAAE;AAAEb,UAAAA;AAAF;AAJN,OAAP;AAMH;AAb2B,GAAjB,CAAf;AAgBAI,EAAAA,GAAG,CAACe,GAAJ,CAAQC,sBAAR;AAEA,QAAMd,MAAM,CAACe,KAAP,EAAN;AAEAf,EAAAA,MAAM,CAACgB,eAAP,CAAuB;AACnBlB,IAAAA,GADmB;AAEnBQ,IAAAA,IAAI,EAAE,GAFa;AAGnBW,IAAAA,IAAI,EAAE;AAHa,GAAvB;AAMAnB,EAAAA,GAAG,CAACoB,MAAJ,CAAW;AAACC,IAAAA,IAAI,EAAEC,OAAO,CAACC,GAAR,CAAYC;AAAnB,GAAX,EAAqC,MAAM;AACvCC,IAAAA,OAAO,CAACC,GAAR,CAAa,+BAA8BJ,OAAO,CAACC,GAAR,CAAYC,IAAK,EAA5D;AACH,GAFD;AAGH;;AAEDvB,iBAAiB,GAAG0B,IAApB,CAAyB,MAAM;AAC3BF,EAAAA,OAAO,CAACC,GAAR,CAAY,uBAAZ;AACH,CAFD,EAEGE,KAFH,CAEUC,GAAD,IAAS;AACdJ,EAAAA,OAAO,CAACC,GAAR,CAAa,oBAAmBG,GAAG,CAACC,OAAQ,EAA5C;AACH,CAJD","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\","sourcesContent":["import dotenv from \"dotenv\";\r\nimport express from \"express\";\r\nimport {ApolloServer} from \"apollo-server-express\";\r\nimport schema from \"./graphql\";\r\nimport validateToken from \"./middlewares/auth/validate-token\";\r\nimport \"./config/mongodb-config\";\r\n\r\nconst client = require(\"./config/redis-config\");\r\n\r\ndotenv.config();\r\nconst app = express();\r\n\r\nasync function startApolloServer() {\r\n    const server = new ApolloServer({\r\n        schema,\r\n        playground: true,\r\n        introspection: true,\r\n        tracing: true,\r\n        path: \"/\",\r\n        context: ({req}) => {\r\n            return {\r\n                user: req.headers.user,\r\n                headers: req.headers,\r\n                phoneVerification: req.headers.phoneverification || \"\",\r\n                context: { client }\r\n            };\r\n        },\r\n    });\r\n\r\n    app.use(validateToken)\r\n\r\n    await server.start();\r\n\r\n    server.applyMiddleware({\r\n        app,\r\n        path: \"/\",\r\n        cors: \"no-cors\",\r\n    });\r\n\r\n    app.listen({port: process.env.PORT}, () => {\r\n        console.log(`ðŸš€ Server listening on port ${process.env.PORT}`);\r\n    });\r\n}\r\n\r\nstartApolloServer().then(() => {\r\n    console.log(\"Apollo server started\");\r\n}).catch((err) => {\r\n    console.log(`ðŸš€ Server Error: ${err.message}`);\r\n})"]}},"mtime":1648588416342},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\graphql\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\graphql\\\\index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _graphqlCompose = require(\"graphql-compose\");\n\nvar _auth = require(\"./auth\");\n\nvar _user = require(\"./user\");\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nconst schemaComposer = new _graphqlCompose.SchemaComposer();\nschemaComposer.Query.addFields(_objectSpread({}, _user.UserQuery));\nschemaComposer.Mutation.addFields(_objectSpread(_objectSpread({}, _auth.AuthMutation), _user.UserMutation));\nconst schema = schemaComposer.buildSchema();\nvar _default = schema;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbInNjaGVtYUNvbXBvc2VyIiwiU2NoZW1hQ29tcG9zZXIiLCJRdWVyeSIsImFkZEZpZWxkcyIsIlVzZXJRdWVyeSIsIk11dGF0aW9uIiwiQXV0aE11dGF0aW9uIiwiVXNlck11dGF0aW9uIiwic2NoZW1hIiwiYnVpbGRTY2hlbWEiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7Ozs7Ozs7QUFFQSxNQUFNQSxjQUFjLEdBQUcsSUFBSUMsOEJBQUosRUFBdkI7QUFFQUQsY0FBYyxDQUFDRSxLQUFmLENBQXFCQyxTQUFyQixtQkFDT0MsZUFEUDtBQUlBSixjQUFjLENBQUNLLFFBQWYsQ0FBd0JGLFNBQXhCLGlDQUNPRyxrQkFEUCxHQUVPQyxrQkFGUDtBQUtBLE1BQU1DLE1BQU0sR0FBR1IsY0FBYyxDQUFDUyxXQUFmLEVBQWY7ZUFDZUQsTSIsInNvdXJjZVJvb3QiOiJDOlxcVXNlcnNcXFJlYmJlXFxEZXNrdG9wXFxoYWxldGEtbmV3LWFwaVxcc3JjXFxncmFwaHFsXFwiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1NjaGVtYUNvbXBvc2VyfSBmcm9tIFwiZ3JhcGhxbC1jb21wb3NlXCI7XHJcbmltcG9ydCB7QXV0aE11dGF0aW9ufSBmcm9tIFwiLi9hdXRoXCI7XHJcbmltcG9ydCB7VXNlck11dGF0aW9uLCBVc2VyUXVlcnl9IGZyb20gXCIuL3VzZXJcIjtcclxuXHJcbmNvbnN0IHNjaGVtYUNvbXBvc2VyID0gbmV3IFNjaGVtYUNvbXBvc2VyKCk7XHJcblxyXG5zY2hlbWFDb21wb3Nlci5RdWVyeS5hZGRGaWVsZHMoe1xyXG4gICAgLi4uVXNlclF1ZXJ5LFxyXG59KTtcclxuXHJcbnNjaGVtYUNvbXBvc2VyLk11dGF0aW9uLmFkZEZpZWxkcyh7XHJcbiAgICAuLi5BdXRoTXV0YXRpb24sXHJcbiAgICAuLi5Vc2VyTXV0YXRpb24sXHJcbn0pO1xyXG5cclxuY29uc3Qgc2NoZW1hID0gc2NoZW1hQ29tcG9zZXIuYnVpbGRTY2hlbWEoKTtcclxuZXhwb3J0IGRlZmF1bHQgc2NoZW1hO1xyXG4iXX0=","map":{"version":3,"sources":["index.js"],"names":["schemaComposer","SchemaComposer","Query","addFields","UserQuery","Mutation","AuthMutation","UserMutation","schema","buildSchema"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;;;;;AAEA,MAAMA,cAAc,GAAG,IAAIC,8BAAJ,EAAvB;AAEAD,cAAc,CAACE,KAAf,CAAqBC,SAArB,mBACOC,eADP;AAIAJ,cAAc,CAACK,QAAf,CAAwBF,SAAxB,iCACOG,kBADP,GAEOC,kBAFP;AAKA,MAAMC,MAAM,GAAGR,cAAc,CAACS,WAAf,EAAf;eACeD,M","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\graphql\\","sourcesContent":["import {SchemaComposer} from \"graphql-compose\";\r\nimport {AuthMutation} from \"./auth\";\r\nimport {UserMutation, UserQuery} from \"./user\";\r\n\r\nconst schemaComposer = new SchemaComposer();\r\n\r\nschemaComposer.Query.addFields({\r\n    ...UserQuery,\r\n});\r\n\r\nschemaComposer.Mutation.addFields({\r\n    ...AuthMutation,\r\n    ...UserMutation,\r\n});\r\n\r\nconst schema = schemaComposer.buildSchema();\r\nexport default schema;\r\n"]}},"mtime":1648583275527},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\graphql\\\\auth\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\graphql\\\\auth\\\\index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.AuthMutation = void 0;\n\nvar _user = require(\"../../models/user\");\n\nvar _middlewares = require(\"../../middlewares\");\n\nvar _authResolvers = _interopRequireDefault(require(\"./resolvers/auth-resolvers\"));\n\nrequire(\"./typedefs/types\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfor (const resolver in _authResolvers.default) {\n  _user.UserTC.addResolver(_authResolvers.default[resolver]);\n}\n\nconst AuthMutation = {\n  signIn: _user.UserTC.getResolver(\"signIn\", [_middlewares.authentication.isGuest, _middlewares.userValidator.signIn]),\n  signUp: _user.UserTC.getResolver(\"signUp\", [_middlewares.authentication.isGuest, _middlewares.userValidator.signUp]) // logout: UserTC.getResolver('logout', [middleware.isAuth]),\n  // resetPassword: UserTC.getResolver(\"resetPassword\", [middleware.isGuest, validators.resetPassword]),\n  // newPassword: UserTC.getResolver(\"newPassword\", [middleware.isGuest, validators.newPassword]),\n  // changePassword: UserTC.getResolver(\"changePassword\", [middleware.isAuth, validators.changePassword]),\n\n};\nexports.AuthMutation = AuthMutation;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbInJlc29sdmVyIiwiUmVzb2x2ZXJzIiwiVXNlclRDIiwiYWRkUmVzb2x2ZXIiLCJBdXRoTXV0YXRpb24iLCJzaWduSW4iLCJnZXRSZXNvbHZlciIsImF1dGhlbnRpY2F0aW9uIiwiaXNHdWVzdCIsInVzZXJWYWxpZGF0b3IiLCJzaWduVXAiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFFQTs7QUFFQTs7QUFFQTs7OztBQUVBLEtBQUssTUFBTUEsUUFBWCxJQUF1QkMsc0JBQXZCLEVBQWtDO0FBQzlCQyxlQUFPQyxXQUFQLENBQW1CRix1QkFBVUQsUUFBVixDQUFuQjtBQUNIOztBQUVELE1BQU1JLFlBQVksR0FBRztBQUNqQkMsRUFBQUEsTUFBTSxFQUFFSCxhQUFPSSxXQUFQLENBQW1CLFFBQW5CLEVBQTZCLENBQUNDLDRCQUFlQyxPQUFoQixFQUF5QkMsMkJBQWNKLE1BQXZDLENBQTdCLENBRFM7QUFFakJLLEVBQUFBLE1BQU0sRUFBRVIsYUFBT0ksV0FBUCxDQUFtQixRQUFuQixFQUE2QixDQUFDQyw0QkFBZUMsT0FBaEIsRUFBeUJDLDJCQUFjQyxNQUF2QyxDQUE3QixDQUZTLENBR2pCO0FBQ0E7QUFDQTtBQUNBOztBQU5pQixDQUFyQiIsInNvdXJjZVJvb3QiOiJDOlxcVXNlcnNcXFJlYmJlXFxEZXNrdG9wXFxoYWxldGEtbmV3LWFwaVxcc3JjXFxncmFwaHFsXFxhdXRoXFwiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1VzZXJUQ30gZnJvbSBcIi4uLy4uL21vZGVscy91c2VyXCI7XHJcblxyXG5pbXBvcnQgeyBhdXRoZW50aWNhdGlvbiwgdXNlclZhbGlkYXRvciB9IGZyb20gXCIuLi8uLi9taWRkbGV3YXJlc1wiO1xyXG5cclxuaW1wb3J0IFJlc29sdmVycyBmcm9tIFwiLi9yZXNvbHZlcnMvYXV0aC1yZXNvbHZlcnNcIjtcclxuXHJcbmltcG9ydCBcIi4vdHlwZWRlZnMvdHlwZXNcIlxyXG5cclxuZm9yIChjb25zdCByZXNvbHZlciBpbiBSZXNvbHZlcnMpIHtcclxuICAgIFVzZXJUQy5hZGRSZXNvbHZlcihSZXNvbHZlcnNbcmVzb2x2ZXJdKTtcclxufVxyXG5cclxuY29uc3QgQXV0aE11dGF0aW9uID0ge1xyXG4gICAgc2lnbkluOiBVc2VyVEMuZ2V0UmVzb2x2ZXIoXCJzaWduSW5cIiwgW2F1dGhlbnRpY2F0aW9uLmlzR3Vlc3QsIHVzZXJWYWxpZGF0b3Iuc2lnbkluXSksXHJcbiAgICBzaWduVXA6IFVzZXJUQy5nZXRSZXNvbHZlcihcInNpZ25VcFwiLCBbYXV0aGVudGljYXRpb24uaXNHdWVzdCwgdXNlclZhbGlkYXRvci5zaWduVXBdKSxcclxuICAgIC8vIGxvZ291dDogVXNlclRDLmdldFJlc29sdmVyKCdsb2dvdXQnLCBbbWlkZGxld2FyZS5pc0F1dGhdKSxcclxuICAgIC8vIHJlc2V0UGFzc3dvcmQ6IFVzZXJUQy5nZXRSZXNvbHZlcihcInJlc2V0UGFzc3dvcmRcIiwgW21pZGRsZXdhcmUuaXNHdWVzdCwgdmFsaWRhdG9ycy5yZXNldFBhc3N3b3JkXSksXHJcbiAgICAvLyBuZXdQYXNzd29yZDogVXNlclRDLmdldFJlc29sdmVyKFwibmV3UGFzc3dvcmRcIiwgW21pZGRsZXdhcmUuaXNHdWVzdCwgdmFsaWRhdG9ycy5uZXdQYXNzd29yZF0pLFxyXG4gICAgLy8gY2hhbmdlUGFzc3dvcmQ6IFVzZXJUQy5nZXRSZXNvbHZlcihcImNoYW5nZVBhc3N3b3JkXCIsIFttaWRkbGV3YXJlLmlzQXV0aCwgdmFsaWRhdG9ycy5jaGFuZ2VQYXNzd29yZF0pLFxyXG59O1xyXG5cclxuZXhwb3J0IHtBdXRoTXV0YXRpb259O1xyXG4iXX0=","map":{"version":3,"sources":["index.js"],"names":["resolver","Resolvers","UserTC","addResolver","AuthMutation","signIn","getResolver","authentication","isGuest","userValidator","signUp"],"mappings":";;;;;;;AAAA;;AAEA;;AAEA;;AAEA;;;;AAEA,KAAK,MAAMA,QAAX,IAAuBC,sBAAvB,EAAkC;AAC9BC,eAAOC,WAAP,CAAmBF,uBAAUD,QAAV,CAAnB;AACH;;AAED,MAAMI,YAAY,GAAG;AACjBC,EAAAA,MAAM,EAAEH,aAAOI,WAAP,CAAmB,QAAnB,EAA6B,CAACC,4BAAeC,OAAhB,EAAyBC,2BAAcJ,MAAvC,CAA7B,CADS;AAEjBK,EAAAA,MAAM,EAAER,aAAOI,WAAP,CAAmB,QAAnB,EAA6B,CAACC,4BAAeC,OAAhB,EAAyBC,2BAAcC,MAAvC,CAA7B,CAFS,CAGjB;AACA;AACA;AACA;;AANiB,CAArB","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\graphql\\auth\\","sourcesContent":["import {UserTC} from \"../../models/user\";\r\n\r\nimport { authentication, userValidator } from \"../../middlewares\";\r\n\r\nimport Resolvers from \"./resolvers/auth-resolvers\";\r\n\r\nimport \"./typedefs/types\"\r\n\r\nfor (const resolver in Resolvers) {\r\n    UserTC.addResolver(Resolvers[resolver]);\r\n}\r\n\r\nconst AuthMutation = {\r\n    signIn: UserTC.getResolver(\"signIn\", [authentication.isGuest, userValidator.signIn]),\r\n    signUp: UserTC.getResolver(\"signUp\", [authentication.isGuest, userValidator.signUp]),\r\n    // logout: UserTC.getResolver('logout', [middleware.isAuth]),\r\n    // resetPassword: UserTC.getResolver(\"resetPassword\", [middleware.isGuest, validators.resetPassword]),\r\n    // newPassword: UserTC.getResolver(\"newPassword\", [middleware.isGuest, validators.newPassword]),\r\n    // changePassword: UserTC.getResolver(\"changePassword\", [middleware.isAuth, validators.changePassword]),\r\n};\r\n\r\nexport {AuthMutation};\r\n"]}},"mtime":1648583440807},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\models\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\models\\\\user.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.UserTC = exports.UserSchema = exports.UserModel = void 0;\n\nvar _mongoose = _interopRequireWildcard(require(\"mongoose\"));\n\nvar _mongooseTimestamp = _interopRequireDefault(require(\"mongoose-timestamp\"));\n\nvar _graphqlComposeMongoose = require(\"graphql-compose-mongoose\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nconst UserSchema = new _mongoose.Schema({\n  firstName: String,\n  middleName: String,\n  lastName: String,\n  email: String,\n  phoneNumber: String,\n  image: String,\n  firebaseId: String,\n  password: String,\n  status: {\n    type: String,\n    default: \"ACTIVE\",\n    enum: [\"ACTIVE\", \"BLOCKED\"]\n  },\n  roles: {\n    type: String,\n    default: \"NORMAL\",\n    enum: [\"NORMAL\", \"OWNER\", \"ADMIN\", \"SALES\"]\n  },\n  account: {\n    verification: {\n      verified: {\n        type: Boolean,\n        default: false\n      },\n      token: String,\n      expiresIn: Date\n    },\n    emailVerification: {\n      verified: {\n        type: Boolean,\n        default: false\n      },\n      token: String,\n      expiresIn: Date\n    },\n    phoneVerification: {\n      verified: {\n        type: Boolean,\n        default: false\n      },\n      token: String,\n      expiresIn: Date\n    },\n    resetPassword: {\n      token: String,\n      expiresIn: Date\n    }\n  }\n}, {\n  collection: \"users\"\n});\nexports.UserSchema = UserSchema;\nUserSchema.plugin(_mongooseTimestamp.default);\nUserSchema.index({\n  createdAt: 1,\n  updatedAt: 1\n});\n\nUserSchema.statics.emailExist = function (email) {\n  return this.findOne({\n    email\n  });\n};\n\nUserSchema.statics.phoneNumberExist = function (phoneNumber) {\n  return this.findOne({\n    phoneNumber\n  });\n};\n\nUserSchema.methods.comparePassword = function (password) {\n  return bcrypt.compareSync(password, this.password);\n};\n\nconst UserModel = _mongoose.default.model(\"User\", UserSchema);\n\nexports.UserModel = UserModel;\nconst UserTC = (0, _graphqlComposeMongoose.composeWithMongoose)(UserModel); // const UserTC = composeWithMongoose(UserModel).removeField('password');\n\nexports.UserTC = UserTC;\nconst UserAccountTC = UserTC.getFieldTC(\"account\");\nUserAccountTC.getFieldTC(\"verification\").removeField([\"token\", \"expiresIn\"]); // UserAccountTC.removeField('resetPassword');\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXIuanMiXSwibmFtZXMiOlsiVXNlclNjaGVtYSIsIlNjaGVtYSIsImZpcnN0TmFtZSIsIlN0cmluZyIsIm1pZGRsZU5hbWUiLCJsYXN0TmFtZSIsImVtYWlsIiwicGhvbmVOdW1iZXIiLCJpbWFnZSIsImZpcmViYXNlSWQiLCJwYXNzd29yZCIsInN0YXR1cyIsInR5cGUiLCJkZWZhdWx0IiwiZW51bSIsInJvbGVzIiwiYWNjb3VudCIsInZlcmlmaWNhdGlvbiIsInZlcmlmaWVkIiwiQm9vbGVhbiIsInRva2VuIiwiZXhwaXJlc0luIiwiRGF0ZSIsImVtYWlsVmVyaWZpY2F0aW9uIiwicGhvbmVWZXJpZmljYXRpb24iLCJyZXNldFBhc3N3b3JkIiwiY29sbGVjdGlvbiIsInBsdWdpbiIsInRpbWVzdGFtcHMiLCJpbmRleCIsImNyZWF0ZWRBdCIsInVwZGF0ZWRBdCIsInN0YXRpY3MiLCJlbWFpbEV4aXN0IiwiZmluZE9uZSIsInBob25lTnVtYmVyRXhpc3QiLCJtZXRob2RzIiwiY29tcGFyZVBhc3N3b3JkIiwiYmNyeXB0IiwiY29tcGFyZVN5bmMiLCJVc2VyTW9kZWwiLCJtb25nb29zZSIsIm1vZGVsIiwiVXNlclRDIiwiVXNlckFjY291bnRUQyIsImdldEZpZWxkVEMiLCJyZW1vdmVGaWVsZCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOztBQUNBOzs7Ozs7OztBQUVBLE1BQU1BLFVBQVUsR0FBRyxJQUFJQyxnQkFBSixDQUFXO0FBQzFCQyxFQUFBQSxTQUFTLEVBQUVDLE1BRGU7QUFFMUJDLEVBQUFBLFVBQVUsRUFBRUQsTUFGYztBQUcxQkUsRUFBQUEsUUFBUSxFQUFFRixNQUhnQjtBQUkxQkcsRUFBQUEsS0FBSyxFQUFFSCxNQUptQjtBQUsxQkksRUFBQUEsV0FBVyxFQUFFSixNQUxhO0FBTTFCSyxFQUFBQSxLQUFLLEVBQUVMLE1BTm1CO0FBTzFCTSxFQUFBQSxVQUFVLEVBQUVOLE1BUGM7QUFRMUJPLEVBQUFBLFFBQVEsRUFBRVAsTUFSZ0I7QUFTMUJRLEVBQUFBLE1BQU0sRUFBRTtBQUNKQyxJQUFBQSxJQUFJLEVBQUVULE1BREY7QUFFSlUsSUFBQUEsT0FBTyxFQUFFLFFBRkw7QUFHSkMsSUFBQUEsSUFBSSxFQUFFLENBQUMsUUFBRCxFQUFXLFNBQVg7QUFIRixHQVRrQjtBQWMxQkMsRUFBQUEsS0FBSyxFQUFFO0FBQ0hILElBQUFBLElBQUksRUFBRVQsTUFESDtBQUVIVSxJQUFBQSxPQUFPLEVBQUUsUUFGTjtBQUdIQyxJQUFBQSxJQUFJLEVBQUUsQ0FBQyxRQUFELEVBQVcsT0FBWCxFQUFvQixPQUFwQixFQUE2QixPQUE3QjtBQUhILEdBZG1CO0FBbUIxQkUsRUFBQUEsT0FBTyxFQUFFO0FBQ0xDLElBQUFBLFlBQVksRUFBRTtBQUNWQyxNQUFBQSxRQUFRLEVBQUU7QUFDTk4sUUFBQUEsSUFBSSxFQUFFTyxPQURBO0FBRU5OLFFBQUFBLE9BQU8sRUFBRTtBQUZILE9BREE7QUFLVk8sTUFBQUEsS0FBSyxFQUFFakIsTUFMRztBQU1Wa0IsTUFBQUEsU0FBUyxFQUFFQztBQU5ELEtBRFQ7QUFTTEMsSUFBQUEsaUJBQWlCLEVBQUU7QUFDZkwsTUFBQUEsUUFBUSxFQUFFO0FBQ05OLFFBQUFBLElBQUksRUFBRU8sT0FEQTtBQUVOTixRQUFBQSxPQUFPLEVBQUU7QUFGSCxPQURLO0FBS2ZPLE1BQUFBLEtBQUssRUFBRWpCLE1BTFE7QUFNZmtCLE1BQUFBLFNBQVMsRUFBRUM7QUFOSSxLQVRkO0FBaUJMRSxJQUFBQSxpQkFBaUIsRUFBRTtBQUNmTixNQUFBQSxRQUFRLEVBQUU7QUFDTk4sUUFBQUEsSUFBSSxFQUFFTyxPQURBO0FBRU5OLFFBQUFBLE9BQU8sRUFBRTtBQUZILE9BREs7QUFLZk8sTUFBQUEsS0FBSyxFQUFFakIsTUFMUTtBQU1ma0IsTUFBQUEsU0FBUyxFQUFFQztBQU5JLEtBakJkO0FBeUJMRyxJQUFBQSxhQUFhLEVBQUU7QUFDWEwsTUFBQUEsS0FBSyxFQUFFakIsTUFESTtBQUVYa0IsTUFBQUEsU0FBUyxFQUFFQztBQUZBO0FBekJWO0FBbkJpQixDQUFYLEVBaURoQjtBQUNDSSxFQUFBQSxVQUFVLEVBQUU7QUFEYixDQWpEZ0IsQ0FBbkI7O0FBcURBMUIsVUFBVSxDQUFDMkIsTUFBWCxDQUFrQkMsMEJBQWxCO0FBQ0E1QixVQUFVLENBQUM2QixLQUFYLENBQWlCO0FBQ2JDLEVBQUFBLFNBQVMsRUFBRSxDQURFO0FBRWJDLEVBQUFBLFNBQVMsRUFBRTtBQUZFLENBQWpCOztBQUtBL0IsVUFBVSxDQUFDZ0MsT0FBWCxDQUFtQkMsVUFBbkIsR0FBZ0MsVUFBVTNCLEtBQVYsRUFBaUI7QUFDN0MsU0FBTyxLQUFLNEIsT0FBTCxDQUFhO0FBQUM1QixJQUFBQTtBQUFELEdBQWIsQ0FBUDtBQUNILENBRkQ7O0FBSUFOLFVBQVUsQ0FBQ2dDLE9BQVgsQ0FBbUJHLGdCQUFuQixHQUFzQyxVQUFVNUIsV0FBVixFQUF1QjtBQUN6RCxTQUFPLEtBQUsyQixPQUFMLENBQWE7QUFBQzNCLElBQUFBO0FBQUQsR0FBYixDQUFQO0FBQ0gsQ0FGRDs7QUFJQVAsVUFBVSxDQUFDb0MsT0FBWCxDQUFtQkMsZUFBbkIsR0FBcUMsVUFBVTNCLFFBQVYsRUFBb0I7QUFDckQsU0FBTzRCLE1BQU0sQ0FBQ0MsV0FBUCxDQUFtQjdCLFFBQW5CLEVBQTZCLEtBQUtBLFFBQWxDLENBQVA7QUFDSCxDQUZEOztBQUlBLE1BQU04QixTQUFTLEdBQUdDLGtCQUFTQyxLQUFULENBQWUsTUFBZixFQUF1QjFDLFVBQXZCLENBQWxCOzs7QUFDQSxNQUFNMkMsTUFBTSxHQUFHLGlEQUFvQkgsU0FBcEIsQ0FBZixDLENBQ0E7OztBQUVBLE1BQU1JLGFBQWEsR0FBR0QsTUFBTSxDQUFDRSxVQUFQLENBQWtCLFNBQWxCLENBQXRCO0FBRUFELGFBQWEsQ0FBQ0MsVUFBZCxDQUF5QixjQUF6QixFQUF5Q0MsV0FBekMsQ0FBcUQsQ0FBQyxPQUFELEVBQVUsV0FBVixDQUFyRCxFLENBRUEiLCJzb3VyY2VSb290IjoiQzpcXFVzZXJzXFxSZWJiZVxcRGVza3RvcFxcaGFsZXRhLW5ldy1hcGlcXHNyY1xcbW9kZWxzXFwiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9uZ29vc2UsIHtTY2hlbWF9IGZyb20gXCJtb25nb29zZVwiO1xyXG5pbXBvcnQgdGltZXN0YW1wcyBmcm9tIFwibW9uZ29vc2UtdGltZXN0YW1wXCI7XHJcbmltcG9ydCB7Y29tcG9zZVdpdGhNb25nb29zZX0gZnJvbSBcImdyYXBocWwtY29tcG9zZS1tb25nb29zZVwiO1xyXG5cclxuY29uc3QgVXNlclNjaGVtYSA9IG5ldyBTY2hlbWEoe1xyXG4gICAgZmlyc3ROYW1lOiBTdHJpbmcsXHJcbiAgICBtaWRkbGVOYW1lOiBTdHJpbmcsXHJcbiAgICBsYXN0TmFtZTogU3RyaW5nLFxyXG4gICAgZW1haWw6IFN0cmluZyxcclxuICAgIHBob25lTnVtYmVyOiBTdHJpbmcsXHJcbiAgICBpbWFnZTogU3RyaW5nLFxyXG4gICAgZmlyZWJhc2VJZDogU3RyaW5nLFxyXG4gICAgcGFzc3dvcmQ6IFN0cmluZyxcclxuICAgIHN0YXR1czoge1xyXG4gICAgICAgIHR5cGU6IFN0cmluZyxcclxuICAgICAgICBkZWZhdWx0OiBcIkFDVElWRVwiLFxyXG4gICAgICAgIGVudW06IFtcIkFDVElWRVwiLCBcIkJMT0NLRURcIl0sXHJcbiAgICB9LFxyXG4gICAgcm9sZXM6IHtcclxuICAgICAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICAgICAgZGVmYXVsdDogXCJOT1JNQUxcIixcclxuICAgICAgICBlbnVtOiBbXCJOT1JNQUxcIiwgXCJPV05FUlwiLCBcIkFETUlOXCIsIFwiU0FMRVNcIl0sXHJcbiAgICB9LFxyXG4gICAgYWNjb3VudDoge1xyXG4gICAgICAgIHZlcmlmaWNhdGlvbjoge1xyXG4gICAgICAgICAgICB2ZXJpZmllZDoge1xyXG4gICAgICAgICAgICAgICAgdHlwZTogQm9vbGVhbixcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0b2tlbjogU3RyaW5nLFxyXG4gICAgICAgICAgICBleHBpcmVzSW46IERhdGUsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbWFpbFZlcmlmaWNhdGlvbjoge1xyXG4gICAgICAgICAgICB2ZXJpZmllZDoge1xyXG4gICAgICAgICAgICAgICAgdHlwZTogQm9vbGVhbixcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0b2tlbjogU3RyaW5nLFxyXG4gICAgICAgICAgICBleHBpcmVzSW46IERhdGUsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBwaG9uZVZlcmlmaWNhdGlvbjoge1xyXG4gICAgICAgICAgICB2ZXJpZmllZDoge1xyXG4gICAgICAgICAgICAgICAgdHlwZTogQm9vbGVhbixcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0b2tlbjogU3RyaW5nLFxyXG4gICAgICAgICAgICBleHBpcmVzSW46IERhdGUsXHJcbiAgICAgICAgfSxcclxuICAgICAgICByZXNldFBhc3N3b3JkOiB7XHJcbiAgICAgICAgICAgIHRva2VuOiBTdHJpbmcsXHJcbiAgICAgICAgICAgIGV4cGlyZXNJbjogRGF0ZSxcclxuICAgICAgICB9LFxyXG4gICAgfSxcclxufSwge1xyXG4gICAgY29sbGVjdGlvbjogXCJ1c2Vyc1wiLFxyXG59KTtcclxuXHJcblVzZXJTY2hlbWEucGx1Z2luKHRpbWVzdGFtcHMpO1xyXG5Vc2VyU2NoZW1hLmluZGV4KHtcclxuICAgIGNyZWF0ZWRBdDogMSxcclxuICAgIHVwZGF0ZWRBdDogMSxcclxufSk7XHJcblxyXG5Vc2VyU2NoZW1hLnN0YXRpY3MuZW1haWxFeGlzdCA9IGZ1bmN0aW9uIChlbWFpbCkge1xyXG4gICAgcmV0dXJuIHRoaXMuZmluZE9uZSh7ZW1haWx9KTtcclxufTtcclxuXHJcblVzZXJTY2hlbWEuc3RhdGljcy5waG9uZU51bWJlckV4aXN0ID0gZnVuY3Rpb24gKHBob25lTnVtYmVyKSB7XHJcbiAgICByZXR1cm4gdGhpcy5maW5kT25lKHtwaG9uZU51bWJlcn0pO1xyXG59O1xyXG5cclxuVXNlclNjaGVtYS5tZXRob2RzLmNvbXBhcmVQYXNzd29yZCA9IGZ1bmN0aW9uIChwYXNzd29yZCkge1xyXG4gICAgcmV0dXJuIGJjcnlwdC5jb21wYXJlU3luYyhwYXNzd29yZCwgdGhpcy5wYXNzd29yZCk7XHJcbn07XHJcblxyXG5jb25zdCBVc2VyTW9kZWwgPSBtb25nb29zZS5tb2RlbChcIlVzZXJcIiwgVXNlclNjaGVtYSk7XHJcbmNvbnN0IFVzZXJUQyA9IGNvbXBvc2VXaXRoTW9uZ29vc2UoVXNlck1vZGVsKTtcclxuLy8gY29uc3QgVXNlclRDID0gY29tcG9zZVdpdGhNb25nb29zZShVc2VyTW9kZWwpLnJlbW92ZUZpZWxkKCdwYXNzd29yZCcpO1xyXG5cclxuY29uc3QgVXNlckFjY291bnRUQyA9IFVzZXJUQy5nZXRGaWVsZFRDKFwiYWNjb3VudFwiKTtcclxuXHJcblVzZXJBY2NvdW50VEMuZ2V0RmllbGRUQyhcInZlcmlmaWNhdGlvblwiKS5yZW1vdmVGaWVsZChbXCJ0b2tlblwiLCBcImV4cGlyZXNJblwiXSk7XHJcblxyXG4vLyBVc2VyQWNjb3VudFRDLnJlbW92ZUZpZWxkKCdyZXNldFBhc3N3b3JkJyk7XHJcblxyXG5leHBvcnQge1VzZXJNb2RlbCwgVXNlclRDLCBVc2VyU2NoZW1hfTtcclxuIl19","map":{"version":3,"sources":["user.js"],"names":["UserSchema","Schema","firstName","String","middleName","lastName","email","phoneNumber","image","firebaseId","password","status","type","default","enum","roles","account","verification","verified","Boolean","token","expiresIn","Date","emailVerification","phoneVerification","resetPassword","collection","plugin","timestamps","index","createdAt","updatedAt","statics","emailExist","findOne","phoneNumberExist","methods","comparePassword","bcrypt","compareSync","UserModel","mongoose","model","UserTC","UserAccountTC","getFieldTC","removeField"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;;;;;AAEA,MAAMA,UAAU,GAAG,IAAIC,gBAAJ,CAAW;AAC1BC,EAAAA,SAAS,EAAEC,MADe;AAE1BC,EAAAA,UAAU,EAAED,MAFc;AAG1BE,EAAAA,QAAQ,EAAEF,MAHgB;AAI1BG,EAAAA,KAAK,EAAEH,MAJmB;AAK1BI,EAAAA,WAAW,EAAEJ,MALa;AAM1BK,EAAAA,KAAK,EAAEL,MANmB;AAO1BM,EAAAA,UAAU,EAAEN,MAPc;AAQ1BO,EAAAA,QAAQ,EAAEP,MARgB;AAS1BQ,EAAAA,MAAM,EAAE;AACJC,IAAAA,IAAI,EAAET,MADF;AAEJU,IAAAA,OAAO,EAAE,QAFL;AAGJC,IAAAA,IAAI,EAAE,CAAC,QAAD,EAAW,SAAX;AAHF,GATkB;AAc1BC,EAAAA,KAAK,EAAE;AACHH,IAAAA,IAAI,EAAET,MADH;AAEHU,IAAAA,OAAO,EAAE,QAFN;AAGHC,IAAAA,IAAI,EAAE,CAAC,QAAD,EAAW,OAAX,EAAoB,OAApB,EAA6B,OAA7B;AAHH,GAdmB;AAmB1BE,EAAAA,OAAO,EAAE;AACLC,IAAAA,YAAY,EAAE;AACVC,MAAAA,QAAQ,EAAE;AACNN,QAAAA,IAAI,EAAEO,OADA;AAENN,QAAAA,OAAO,EAAE;AAFH,OADA;AAKVO,MAAAA,KAAK,EAAEjB,MALG;AAMVkB,MAAAA,SAAS,EAAEC;AAND,KADT;AASLC,IAAAA,iBAAiB,EAAE;AACfL,MAAAA,QAAQ,EAAE;AACNN,QAAAA,IAAI,EAAEO,OADA;AAENN,QAAAA,OAAO,EAAE;AAFH,OADK;AAKfO,MAAAA,KAAK,EAAEjB,MALQ;AAMfkB,MAAAA,SAAS,EAAEC;AANI,KATd;AAiBLE,IAAAA,iBAAiB,EAAE;AACfN,MAAAA,QAAQ,EAAE;AACNN,QAAAA,IAAI,EAAEO,OADA;AAENN,QAAAA,OAAO,EAAE;AAFH,OADK;AAKfO,MAAAA,KAAK,EAAEjB,MALQ;AAMfkB,MAAAA,SAAS,EAAEC;AANI,KAjBd;AAyBLG,IAAAA,aAAa,EAAE;AACXL,MAAAA,KAAK,EAAEjB,MADI;AAEXkB,MAAAA,SAAS,EAAEC;AAFA;AAzBV;AAnBiB,CAAX,EAiDhB;AACCI,EAAAA,UAAU,EAAE;AADb,CAjDgB,CAAnB;;AAqDA1B,UAAU,CAAC2B,MAAX,CAAkBC,0BAAlB;AACA5B,UAAU,CAAC6B,KAAX,CAAiB;AACbC,EAAAA,SAAS,EAAE,CADE;AAEbC,EAAAA,SAAS,EAAE;AAFE,CAAjB;;AAKA/B,UAAU,CAACgC,OAAX,CAAmBC,UAAnB,GAAgC,UAAU3B,KAAV,EAAiB;AAC7C,SAAO,KAAK4B,OAAL,CAAa;AAAC5B,IAAAA;AAAD,GAAb,CAAP;AACH,CAFD;;AAIAN,UAAU,CAACgC,OAAX,CAAmBG,gBAAnB,GAAsC,UAAU5B,WAAV,EAAuB;AACzD,SAAO,KAAK2B,OAAL,CAAa;AAAC3B,IAAAA;AAAD,GAAb,CAAP;AACH,CAFD;;AAIAP,UAAU,CAACoC,OAAX,CAAmBC,eAAnB,GAAqC,UAAU3B,QAAV,EAAoB;AACrD,SAAO4B,MAAM,CAACC,WAAP,CAAmB7B,QAAnB,EAA6B,KAAKA,QAAlC,CAAP;AACH,CAFD;;AAIA,MAAM8B,SAAS,GAAGC,kBAASC,KAAT,CAAe,MAAf,EAAuB1C,UAAvB,CAAlB;;;AACA,MAAM2C,MAAM,GAAG,iDAAoBH,SAApB,CAAf,C,CACA;;;AAEA,MAAMI,aAAa,GAAGD,MAAM,CAACE,UAAP,CAAkB,SAAlB,CAAtB;AAEAD,aAAa,CAACC,UAAd,CAAyB,cAAzB,EAAyCC,WAAzC,CAAqD,CAAC,OAAD,EAAU,WAAV,CAArD,E,CAEA","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\models\\","sourcesContent":["import mongoose, {Schema} from \"mongoose\";\r\nimport timestamps from \"mongoose-timestamp\";\r\nimport {composeWithMongoose} from \"graphql-compose-mongoose\";\r\n\r\nconst UserSchema = new Schema({\r\n    firstName: String,\r\n    middleName: String,\r\n    lastName: String,\r\n    email: String,\r\n    phoneNumber: String,\r\n    image: String,\r\n    firebaseId: String,\r\n    password: String,\r\n    status: {\r\n        type: String,\r\n        default: \"ACTIVE\",\r\n        enum: [\"ACTIVE\", \"BLOCKED\"],\r\n    },\r\n    roles: {\r\n        type: String,\r\n        default: \"NORMAL\",\r\n        enum: [\"NORMAL\", \"OWNER\", \"ADMIN\", \"SALES\"],\r\n    },\r\n    account: {\r\n        verification: {\r\n            verified: {\r\n                type: Boolean,\r\n                default: false,\r\n            },\r\n            token: String,\r\n            expiresIn: Date,\r\n        },\r\n        emailVerification: {\r\n            verified: {\r\n                type: Boolean,\r\n                default: false,\r\n            },\r\n            token: String,\r\n            expiresIn: Date,\r\n        },\r\n        phoneVerification: {\r\n            verified: {\r\n                type: Boolean,\r\n                default: false,\r\n            },\r\n            token: String,\r\n            expiresIn: Date,\r\n        },\r\n        resetPassword: {\r\n            token: String,\r\n            expiresIn: Date,\r\n        },\r\n    },\r\n}, {\r\n    collection: \"users\",\r\n});\r\n\r\nUserSchema.plugin(timestamps);\r\nUserSchema.index({\r\n    createdAt: 1,\r\n    updatedAt: 1,\r\n});\r\n\r\nUserSchema.statics.emailExist = function (email) {\r\n    return this.findOne({email});\r\n};\r\n\r\nUserSchema.statics.phoneNumberExist = function (phoneNumber) {\r\n    return this.findOne({phoneNumber});\r\n};\r\n\r\nUserSchema.methods.comparePassword = function (password) {\r\n    return bcrypt.compareSync(password, this.password);\r\n};\r\n\r\nconst UserModel = mongoose.model(\"User\", UserSchema);\r\nconst UserTC = composeWithMongoose(UserModel);\r\n// const UserTC = composeWithMongoose(UserModel).removeField('password');\r\n\r\nconst UserAccountTC = UserTC.getFieldTC(\"account\");\r\n\r\nUserAccountTC.getFieldTC(\"verification\").removeField([\"token\", \"expiresIn\"]);\r\n\r\n// UserAccountTC.removeField('resetPassword');\r\n\r\nexport {UserModel, UserTC, UserSchema};\r\n"]}},"mtime":1648583275536},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\middlewares\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\middlewares\\\\index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"authentication\", {\n  enumerable: true,\n  get: function () {\n    return _authentication.default;\n  }\n});\nObject.defineProperty(exports, \"authorization\", {\n  enumerable: true,\n  get: function () {\n    return _authorization.default;\n  }\n});\nObject.defineProperty(exports, \"phoneVerification\", {\n  enumerable: true,\n  get: function () {\n    return _phoneVerification.default;\n  }\n});\nObject.defineProperty(exports, \"userValidator\", {\n  enumerable: true,\n  get: function () {\n    return _userValidator.default;\n  }\n});\nObject.defineProperty(exports, \"validateToken\", {\n  enumerable: true,\n  get: function () {\n    return _validateToken.default;\n  }\n});\n\nvar _authentication = _interopRequireDefault(require(\"./auth/authentication\"));\n\nvar _authorization = _interopRequireDefault(require(\"./auth/authorization\"));\n\nvar _validateToken = _interopRequireDefault(require(\"./auth/validate-token\"));\n\nvar _phoneVerification = _interopRequireDefault(require(\"./auth/phone-verification\"));\n\nvar _userValidator = _interopRequireDefault(require(\"./validators/user-validator\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUNBIiwic291cmNlUm9vdCI6IkM6XFxVc2Vyc1xcUmViYmVcXERlc2t0b3BcXGhhbGV0YS1uZXctYXBpXFxzcmNcXG1pZGRsZXdhcmVzXFwiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgYXV0aGVudGljYXRpb24gZnJvbSBcIi4vYXV0aC9hdXRoZW50aWNhdGlvblwiXHJcbmltcG9ydCBhdXRob3JpemF0aW9uIGZyb20gXCIuL2F1dGgvYXV0aG9yaXphdGlvblwiXHJcbmltcG9ydCB2YWxpZGF0ZVRva2VuIGZyb20gXCIuL2F1dGgvdmFsaWRhdGUtdG9rZW5cIlxyXG5pbXBvcnQgcGhvbmVWZXJpZmljYXRpb24gZnJvbSBcIi4vYXV0aC9waG9uZS12ZXJpZmljYXRpb25cIlxyXG5pbXBvcnQgdXNlclZhbGlkYXRvciBmcm9tIFwiLi92YWxpZGF0b3JzL3VzZXItdmFsaWRhdG9yXCI7XHJcblxyXG5leHBvcnQge1xyXG4gICAgYXV0aGVudGljYXRpb24sXHJcbiAgICBhdXRob3JpemF0aW9uLFxyXG4gICAgdmFsaWRhdGVUb2tlbixcclxuICAgIHBob25lVmVyaWZpY2F0aW9uLFxyXG4gICAgdXNlclZhbGlkYXRvcixcclxufSJdfQ==","map":{"version":3,"sources":["index.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\middlewares\\","sourcesContent":["import authentication from \"./auth/authentication\"\r\nimport authorization from \"./auth/authorization\"\r\nimport validateToken from \"./auth/validate-token\"\r\nimport phoneVerification from \"./auth/phone-verification\"\r\nimport userValidator from \"./validators/user-validator\";\r\n\r\nexport {\r\n    authentication,\r\n    authorization,\r\n    validateToken,\r\n    phoneVerification,\r\n    userValidator,\r\n}"]}},"mtime":1648583275535},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\middlewares\\\\auth\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\middlewares\\\\auth\\\\authentication.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nconst isAuth = async (resolve, source, args, context, info) => {\n  const {\n    user\n  } = context;\n\n  if (!user) {\n    return Promise.reject(new Error(\"You must be authorized.\"));\n  }\n\n  return resolve(source, args, context, info);\n};\n\nconst isGuest = async (resolve, source, args, context, info) => {\n  const {\n    user\n  } = context;\n\n  if (user) {\n    return Promise.reject(new Error(\"You have already authorized.\"));\n  }\n\n  return resolve(source, args, context, info);\n};\n\nvar _default = {\n  isAuth,\n  isGuest\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGhlbnRpY2F0aW9uLmpzIl0sIm5hbWVzIjpbImlzQXV0aCIsInJlc29sdmUiLCJzb3VyY2UiLCJhcmdzIiwiY29udGV4dCIsImluZm8iLCJ1c2VyIiwiUHJvbWlzZSIsInJlamVjdCIsIkVycm9yIiwiaXNHdWVzdCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBLE1BQU1BLE1BQU0sR0FBRyxPQUFPQyxPQUFQLEVBQWdCQyxNQUFoQixFQUF3QkMsSUFBeEIsRUFBOEJDLE9BQTlCLEVBQXVDQyxJQUF2QyxLQUFnRDtBQUMzRCxRQUFNO0FBQUNDLElBQUFBO0FBQUQsTUFBU0YsT0FBZjs7QUFDQSxNQUFJLENBQUNFLElBQUwsRUFBVztBQUNQLFdBQU9DLE9BQU8sQ0FBQ0MsTUFBUixDQUFlLElBQUlDLEtBQUosQ0FBVSx5QkFBVixDQUFmLENBQVA7QUFDSDs7QUFDRCxTQUFPUixPQUFPLENBQUNDLE1BQUQsRUFBU0MsSUFBVCxFQUFlQyxPQUFmLEVBQXdCQyxJQUF4QixDQUFkO0FBQ0gsQ0FORDs7QUFRQSxNQUFNSyxPQUFPLEdBQUcsT0FBT1QsT0FBUCxFQUFnQkMsTUFBaEIsRUFBd0JDLElBQXhCLEVBQThCQyxPQUE5QixFQUF1Q0MsSUFBdkMsS0FBZ0Q7QUFDNUQsUUFBTTtBQUFDQyxJQUFBQTtBQUFELE1BQVNGLE9BQWY7O0FBQ0EsTUFBSUUsSUFBSixFQUFVO0FBQ04sV0FBT0MsT0FBTyxDQUFDQyxNQUFSLENBQWUsSUFBSUMsS0FBSixDQUFVLDhCQUFWLENBQWYsQ0FBUDtBQUNIOztBQUNELFNBQU9SLE9BQU8sQ0FBQ0MsTUFBRCxFQUFTQyxJQUFULEVBQWVDLE9BQWYsRUFBd0JDLElBQXhCLENBQWQ7QUFDSCxDQU5EOztlQVFlO0FBQUNMLEVBQUFBLE1BQUQ7QUFBU1UsRUFBQUE7QUFBVCxDIiwic291cmNlUm9vdCI6IkM6XFxVc2Vyc1xcUmViYmVcXERlc2t0b3BcXGhhbGV0YS1uZXctYXBpXFxzcmNcXG1pZGRsZXdhcmVzXFxhdXRoXFwiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBpc0F1dGggPSBhc3luYyAocmVzb2x2ZSwgc291cmNlLCBhcmdzLCBjb250ZXh0LCBpbmZvKSA9PiB7XHJcbiAgICBjb25zdCB7dXNlcn0gPSBjb250ZXh0O1xyXG4gICAgaWYgKCF1c2VyKSB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcIllvdSBtdXN0IGJlIGF1dGhvcml6ZWQuXCIpKTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXNvbHZlKHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbyk7XHJcbn07XHJcblxyXG5jb25zdCBpc0d1ZXN0ID0gYXN5bmMgKHJlc29sdmUsIHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbykgPT4ge1xyXG4gICAgY29uc3Qge3VzZXJ9ID0gY29udGV4dDtcclxuICAgIGlmICh1c2VyKSB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcIllvdSBoYXZlIGFscmVhZHkgYXV0aG9yaXplZC5cIikpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc29sdmUoc291cmNlLCBhcmdzLCBjb250ZXh0LCBpbmZvKTtcclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IHtpc0F1dGgsIGlzR3Vlc3R9O1xyXG4iXX0=","map":{"version":3,"sources":["authentication.js"],"names":["isAuth","resolve","source","args","context","info","user","Promise","reject","Error","isGuest"],"mappings":";;;;;;;AAAA,MAAMA,MAAM,GAAG,OAAOC,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AAC3D,QAAM;AAACC,IAAAA;AAAD,MAASF,OAAf;;AACA,MAAI,CAACE,IAAL,EAAW;AACP,WAAOC,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAU,yBAAV,CAAf,CAAP;AACH;;AACD,SAAOR,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,CAND;;AAQA,MAAMK,OAAO,GAAG,OAAOT,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AAC5D,QAAM;AAACC,IAAAA;AAAD,MAASF,OAAf;;AACA,MAAIE,IAAJ,EAAU;AACN,WAAOC,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAU,8BAAV,CAAf,CAAP;AACH;;AACD,SAAOR,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,CAND;;eAQe;AAACL,EAAAA,MAAD;AAASU,EAAAA;AAAT,C","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\middlewares\\auth\\","sourcesContent":["const isAuth = async (resolve, source, args, context, info) => {\r\n    const {user} = context;\r\n    if (!user) {\r\n        return Promise.reject(new Error(\"You must be authorized.\"));\r\n    }\r\n    return resolve(source, args, context, info);\r\n};\r\n\r\nconst isGuest = async (resolve, source, args, context, info) => {\r\n    const {user} = context;\r\n    if (user) {\r\n        return Promise.reject(new Error(\"You have already authorized.\"));\r\n    }\r\n    return resolve(source, args, context, info);\r\n};\r\n\r\nexport default {isAuth, isGuest};\r\n"]}},"mtime":1648583275533},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\middlewares\\\\auth\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\middlewares\\\\auth\\\\authorization.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n//list from redis, list of functions for each role\nconst accessList = {\n  ADMIN: [\"findMany\", \"createOne\"],\n  SUPER_ADMIN: [\"findMany\", \"createOne\"],\n  NORMAL: [],\n  TUTOR: [],\n  CUSTOMER_SERVICE: []\n};\n\nconst authorization = async (resolve, source, args, context, info) => {\n  const {\n    user\n  } = context;\n  const fieldName = info.fieldName;\n  let hasAccess = false; //list from redis, list of functions for each role\n\n  user.roles.forEach(role => {\n    if (accessList[role].includes(fieldName)) {\n      hasAccess = true;\n    }\n  });\n\n  if (!hasAccess) {\n    return Promise.reject(new Error(\"Access denied.\"));\n  }\n\n  return resolve(source, args, context, info);\n};\n\nvar _default = authorization;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGhvcml6YXRpb24uanMiXSwibmFtZXMiOlsiYWNjZXNzTGlzdCIsIkFETUlOIiwiU1VQRVJfQURNSU4iLCJOT1JNQUwiLCJUVVRPUiIsIkNVU1RPTUVSX1NFUlZJQ0UiLCJhdXRob3JpemF0aW9uIiwicmVzb2x2ZSIsInNvdXJjZSIsImFyZ3MiLCJjb250ZXh0IiwiaW5mbyIsInVzZXIiLCJmaWVsZE5hbWUiLCJoYXNBY2Nlc3MiLCJyb2xlcyIsImZvckVhY2giLCJyb2xlIiwiaW5jbHVkZXMiLCJQcm9taXNlIiwicmVqZWN0IiwiRXJyb3IiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0EsTUFBTUEsVUFBVSxHQUFHO0FBQ2ZDLEVBQUFBLEtBQUssRUFBRSxDQUFDLFVBQUQsRUFBYSxXQUFiLENBRFE7QUFFZkMsRUFBQUEsV0FBVyxFQUFFLENBQUMsVUFBRCxFQUFhLFdBQWIsQ0FGRTtBQUdmQyxFQUFBQSxNQUFNLEVBQUUsRUFITztBQUlmQyxFQUFBQSxLQUFLLEVBQUUsRUFKUTtBQUtmQyxFQUFBQSxnQkFBZ0IsRUFBRTtBQUxILENBQW5COztBQVFBLE1BQU1DLGFBQWEsR0FBRyxPQUFPQyxPQUFQLEVBQWdCQyxNQUFoQixFQUF3QkMsSUFBeEIsRUFBOEJDLE9BQTlCLEVBQXVDQyxJQUF2QyxLQUFnRDtBQUNsRSxRQUFNO0FBQUNDLElBQUFBO0FBQUQsTUFBU0YsT0FBZjtBQUNBLFFBQU1HLFNBQVMsR0FBR0YsSUFBSSxDQUFDRSxTQUF2QjtBQUNBLE1BQUlDLFNBQVMsR0FBRyxLQUFoQixDQUhrRSxDQUlsRTs7QUFDQUYsRUFBQUEsSUFBSSxDQUFDRyxLQUFMLENBQVdDLE9BQVgsQ0FBbUJDLElBQUksSUFBSTtBQUN2QixRQUFHakIsVUFBVSxDQUFDaUIsSUFBRCxDQUFWLENBQWlCQyxRQUFqQixDQUEwQkwsU0FBMUIsQ0FBSCxFQUF3QztBQUNwQ0MsTUFBQUEsU0FBUyxHQUFHLElBQVo7QUFDSDtBQUNKLEdBSkQ7O0FBS0EsTUFBSSxDQUFDQSxTQUFMLEVBQWdCO0FBQ1osV0FBT0ssT0FBTyxDQUFDQyxNQUFSLENBQWUsSUFBSUMsS0FBSixDQUFVLGdCQUFWLENBQWYsQ0FBUDtBQUNIOztBQUNELFNBQU9kLE9BQU8sQ0FBQ0MsTUFBRCxFQUFTQyxJQUFULEVBQWVDLE9BQWYsRUFBd0JDLElBQXhCLENBQWQ7QUFDSCxDQWREOztlQWdCZUwsYSIsInNvdXJjZVJvb3QiOiJDOlxcVXNlcnNcXFJlYmJlXFxEZXNrdG9wXFxoYWxldGEtbmV3LWFwaVxcc3JjXFxtaWRkbGV3YXJlc1xcYXV0aFxcIiwic291cmNlc0NvbnRlbnQiOlsiLy9saXN0IGZyb20gcmVkaXMsIGxpc3Qgb2YgZnVuY3Rpb25zIGZvciBlYWNoIHJvbGVcclxuY29uc3QgYWNjZXNzTGlzdCA9IHtcclxuICAgIEFETUlOOiBbXCJmaW5kTWFueVwiLCBcImNyZWF0ZU9uZVwiXSxcclxuICAgIFNVUEVSX0FETUlOOiBbXCJmaW5kTWFueVwiLCBcImNyZWF0ZU9uZVwiXSxcclxuICAgIE5PUk1BTDogW10sXHJcbiAgICBUVVRPUjogW10sXHJcbiAgICBDVVNUT01FUl9TRVJWSUNFOiBbXSxcclxufTtcclxuXHJcbmNvbnN0IGF1dGhvcml6YXRpb24gPSBhc3luYyAocmVzb2x2ZSwgc291cmNlLCBhcmdzLCBjb250ZXh0LCBpbmZvKSA9PiB7XHJcbiAgICBjb25zdCB7dXNlcn0gPSBjb250ZXh0O1xyXG4gICAgY29uc3QgZmllbGROYW1lID0gaW5mby5maWVsZE5hbWVcclxuICAgIGxldCBoYXNBY2Nlc3MgPSBmYWxzZVxyXG4gICAgLy9saXN0IGZyb20gcmVkaXMsIGxpc3Qgb2YgZnVuY3Rpb25zIGZvciBlYWNoIHJvbGVcclxuICAgIHVzZXIucm9sZXMuZm9yRWFjaChyb2xlID0+IHtcclxuICAgICAgICBpZihhY2Nlc3NMaXN0W3JvbGVdLmluY2x1ZGVzKGZpZWxkTmFtZSkpe1xyXG4gICAgICAgICAgICBoYXNBY2Nlc3MgPSB0cnVlXHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxuICAgIGlmICghaGFzQWNjZXNzKSB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcIkFjY2VzcyBkZW5pZWQuXCIpKTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXNvbHZlKHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbyk7XHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBhdXRob3JpemF0aW9uO1xyXG4iXX0=","map":{"version":3,"sources":["authorization.js"],"names":["accessList","ADMIN","SUPER_ADMIN","NORMAL","TUTOR","CUSTOMER_SERVICE","authorization","resolve","source","args","context","info","user","fieldName","hasAccess","roles","forEach","role","includes","Promise","reject","Error"],"mappings":";;;;;;AAAA;AACA,MAAMA,UAAU,GAAG;AACfC,EAAAA,KAAK,EAAE,CAAC,UAAD,EAAa,WAAb,CADQ;AAEfC,EAAAA,WAAW,EAAE,CAAC,UAAD,EAAa,WAAb,CAFE;AAGfC,EAAAA,MAAM,EAAE,EAHO;AAIfC,EAAAA,KAAK,EAAE,EAJQ;AAKfC,EAAAA,gBAAgB,EAAE;AALH,CAAnB;;AAQA,MAAMC,aAAa,GAAG,OAAOC,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AAClE,QAAM;AAACC,IAAAA;AAAD,MAASF,OAAf;AACA,QAAMG,SAAS,GAAGF,IAAI,CAACE,SAAvB;AACA,MAAIC,SAAS,GAAG,KAAhB,CAHkE,CAIlE;;AACAF,EAAAA,IAAI,CAACG,KAAL,CAAWC,OAAX,CAAmBC,IAAI,IAAI;AACvB,QAAGjB,UAAU,CAACiB,IAAD,CAAV,CAAiBC,QAAjB,CAA0BL,SAA1B,CAAH,EAAwC;AACpCC,MAAAA,SAAS,GAAG,IAAZ;AACH;AACJ,GAJD;;AAKA,MAAI,CAACA,SAAL,EAAgB;AACZ,WAAOK,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAU,gBAAV,CAAf,CAAP;AACH;;AACD,SAAOd,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,CAdD;;eAgBeL,a","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\middlewares\\auth\\","sourcesContent":["//list from redis, list of functions for each role\r\nconst accessList = {\r\n    ADMIN: [\"findMany\", \"createOne\"],\r\n    SUPER_ADMIN: [\"findMany\", \"createOne\"],\r\n    NORMAL: [],\r\n    TUTOR: [],\r\n    CUSTOMER_SERVICE: [],\r\n};\r\n\r\nconst authorization = async (resolve, source, args, context, info) => {\r\n    const {user} = context;\r\n    const fieldName = info.fieldName\r\n    let hasAccess = false\r\n    //list from redis, list of functions for each role\r\n    user.roles.forEach(role => {\r\n        if(accessList[role].includes(fieldName)){\r\n            hasAccess = true\r\n        }\r\n    })\r\n    if (!hasAccess) {\r\n        return Promise.reject(new Error(\"Access denied.\"));\r\n    }\r\n    return resolve(source, args, context, info);\r\n};\r\n\r\nexport default authorization;\r\n"]}},"mtime":1648583275533},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\middlewares\\\\auth\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\middlewares\\\\auth\\\\validate-token.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\n\nvar _user = require(\"../../models/user\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// import redis from \"../config/redis-config\";\nconst validateToken = async (req, res, next) => {\n  try {\n    const authorization = req.headers.authorization;\n    Object.assign(req.headers, {\n      user: null,\n      authorization: null\n    });\n\n    if (!authorization) {\n      return next();\n    }\n\n    const accessToken = authorization.split(\" \")[1];\n    let decoded;\n\n    if (accessToken) {\n      decoded = _jsonwebtoken.default.verify(accessToken, process.env.JWT_SECRET);\n    }\n\n    if (!decoded) {\n      // invalid token, remove the token from everywhere\n      //remove from database\n      //remove from redis\n      return next();\n    }\n\n    if (decoded.exp * 1000 < Date.now()) {\n      //remove from database\n      //remove from redis\n      return next();\n    } //check if token is in redis\n    //if NOT in redis call next()\n    //else check last update time if greater than or equals to 1hour update the token\n    // if less skip else update token\n    // authorization = new token\n\n\n    const user = await _user.UserModel.findById(decoded.userId);\n\n    if (!user) {\n      //remove from database\n      //remove from redis\n      return next();\n    } // if the token has come all this way everything is good just attach it to the request header\n\n\n    Object.assign(req.headers, {\n      user,\n      authorization\n    });\n    return next();\n  } catch (error) {\n    console.log(error);\n    return Promise.reject(new Error(\"Error Happened!\"));\n  }\n};\n\nvar _default = validateToken; // ------------- authorization ------------------\n// let check_user_action = async (req,action,resource) =>{\n//   if(!['updateOwn','deleteOwn'].includes(action)){\n//     return true\n//   }\n//\n//   const userResource = new Set()\n//\n//   if(resource == 'tender'){\n//     let userTender = await Tender.find({ creator_user: req.user._id })\n//     userTender.forEach(tender => userResource.add(`${tender._id}`))\n//\n//   }else if(resource == 'company'){\n//     let userCompany = await Company.find({ creator_user: req.user._id })\n//     userCompany.forEach(company => userResource.add( `${company._id}`))\n//\n//   }else if(resource == 'award'){\n//     let userAward = await Award.find({ creator_user: req.user._id })\n//     userAward.forEach(award => userResource.add(`${award._id}`))\n//   }\n//\n//   if(!userResource.has(req.params.id)){\n//     return false\n//   }\n//\n//   return true\n// }\n//\n//\n//\n// exports.authorize = function (action, resource) {\n//   return async (req, res, next) => {\n//     try {\n//       const permission = roles.can(req.user.role)[action](resource);\n//\n//       if (!permission.granted) {\n//         return res.status(401).send(\"You don't have enough permission to perform this action\");\n//       }\n//\n//       let result = await check_user_action(req,action,resource)\n//       if(!result){\n//         return res.status(401).send({ param: resource , msg: `You are not authorized to edit this ${resource}.` })\n//       }\n//\n//       next()\n//     } catch (error) {\n//       return res.status(401).send(\"You don't have enough permission to perform this action\")\n//     }\n//   }\n// }\n\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInZhbGlkYXRlLXRva2VuLmpzIl0sIm5hbWVzIjpbInZhbGlkYXRlVG9rZW4iLCJyZXEiLCJyZXMiLCJuZXh0IiwiYXV0aG9yaXphdGlvbiIsImhlYWRlcnMiLCJPYmplY3QiLCJhc3NpZ24iLCJ1c2VyIiwiYWNjZXNzVG9rZW4iLCJzcGxpdCIsImRlY29kZWQiLCJqd3QiLCJ2ZXJpZnkiLCJwcm9jZXNzIiwiZW52IiwiSldUX1NFQ1JFVCIsImV4cCIsIkRhdGUiLCJub3ciLCJVc2VyTW9kZWwiLCJmaW5kQnlJZCIsInVzZXJJZCIsImVycm9yIiwiY29uc29sZSIsImxvZyIsIlByb21pc2UiLCJyZWplY3QiLCJFcnJvciJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUdBOzs7O0FBREE7QUFHQSxNQUFNQSxhQUFhLEdBQUcsT0FBT0MsR0FBUCxFQUFZQyxHQUFaLEVBQWlCQyxJQUFqQixLQUEwQjtBQUM1QyxNQUFJO0FBQ0EsVUFBTUMsYUFBYSxHQUFHSCxHQUFHLENBQUNJLE9BQUosQ0FBWUQsYUFBbEM7QUFFQUUsSUFBQUEsTUFBTSxDQUFDQyxNQUFQLENBQWNOLEdBQUcsQ0FBQ0ksT0FBbEIsRUFBMkI7QUFDdkJHLE1BQUFBLElBQUksRUFBRSxJQURpQjtBQUV2QkosTUFBQUEsYUFBYSxFQUFFO0FBRlEsS0FBM0I7O0FBS0EsUUFBSSxDQUFDQSxhQUFMLEVBQW9CO0FBQ2hCLGFBQU9ELElBQUksRUFBWDtBQUNIOztBQUVELFVBQU1NLFdBQVcsR0FBR0wsYUFBYSxDQUFDTSxLQUFkLENBQW9CLEdBQXBCLEVBQXlCLENBQXpCLENBQXBCO0FBRUEsUUFBSUMsT0FBSjs7QUFDQSxRQUFJRixXQUFKLEVBQWlCO0FBQ2JFLE1BQUFBLE9BQU8sR0FBR0Msc0JBQUlDLE1BQUosQ0FBV0osV0FBWCxFQUF3QkssT0FBTyxDQUFDQyxHQUFSLENBQVlDLFVBQXBDLENBQVY7QUFDSDs7QUFDRCxRQUFJLENBQUNMLE9BQUwsRUFBYztBQUNWO0FBQ0E7QUFDQTtBQUNBLGFBQU9SLElBQUksRUFBWDtBQUNIOztBQUVELFFBQUlRLE9BQU8sQ0FBQ00sR0FBUixHQUFjLElBQWQsR0FBcUJDLElBQUksQ0FBQ0MsR0FBTCxFQUF6QixFQUFxQztBQUNqQztBQUNBO0FBQ0EsYUFBT2hCLElBQUksRUFBWDtBQUNILEtBN0JELENBK0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBLFVBQU1LLElBQUksR0FBRyxNQUFNWSxnQkFBVUMsUUFBVixDQUFtQlYsT0FBTyxDQUFDVyxNQUEzQixDQUFuQjs7QUFDQSxRQUFJLENBQUNkLElBQUwsRUFBVztBQUNQO0FBQ0E7QUFDQSxhQUFPTCxJQUFJLEVBQVg7QUFDSCxLQTFDRCxDQTRDQTs7O0FBQ0FHLElBQUFBLE1BQU0sQ0FBQ0MsTUFBUCxDQUFjTixHQUFHLENBQUNJLE9BQWxCLEVBQTJCO0FBQ3ZCRyxNQUFBQSxJQUR1QjtBQUV2QkosTUFBQUE7QUFGdUIsS0FBM0I7QUFLQSxXQUFPRCxJQUFJLEVBQVg7QUFDSCxHQW5ERCxDQW1ERSxPQUFPb0IsS0FBUCxFQUFjO0FBQ1pDLElBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZRixLQUFaO0FBQ0EsV0FBT0csT0FBTyxDQUFDQyxNQUFSLENBQWUsSUFBSUMsS0FBSixDQUFVLGlCQUFWLENBQWYsQ0FBUDtBQUNIO0FBQ0osQ0F4REQ7O2VBMERlNUIsYSxFQUdmO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiQzpcXFVzZXJzXFxSZWJiZVxcRGVza3RvcFxcaGFsZXRhLW5ldy1hcGlcXHNyY1xcbWlkZGxld2FyZXNcXGF1dGhcXCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBqd3QgZnJvbSBcImpzb253ZWJ0b2tlblwiO1xyXG5cclxuLy8gaW1wb3J0IHJlZGlzIGZyb20gXCIuLi9jb25maWcvcmVkaXMtY29uZmlnXCI7XHJcbmltcG9ydCB7VXNlck1vZGVsfSBmcm9tIFwiLi4vLi4vbW9kZWxzL3VzZXJcIjtcclxuXHJcbmNvbnN0IHZhbGlkYXRlVG9rZW4gPSBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgYXV0aG9yaXphdGlvbiA9IHJlcS5oZWFkZXJzLmF1dGhvcml6YXRpb25cclxuXHJcbiAgICAgICAgT2JqZWN0LmFzc2lnbihyZXEuaGVhZGVycywge1xyXG4gICAgICAgICAgICB1c2VyOiBudWxsLFxyXG4gICAgICAgICAgICBhdXRob3JpemF0aW9uOiBudWxsLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIWF1dGhvcml6YXRpb24pIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5leHQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gYXV0aG9yaXphdGlvbi5zcGxpdChcIiBcIilbMV07XHJcblxyXG4gICAgICAgIGxldCBkZWNvZGVkO1xyXG4gICAgICAgIGlmIChhY2Nlc3NUb2tlbikge1xyXG4gICAgICAgICAgICBkZWNvZGVkID0gand0LnZlcmlmeShhY2Nlc3NUb2tlbiwgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghZGVjb2RlZCkge1xyXG4gICAgICAgICAgICAvLyBpbnZhbGlkIHRva2VuLCByZW1vdmUgdGhlIHRva2VuIGZyb20gZXZlcnl3aGVyZVxyXG4gICAgICAgICAgICAvL3JlbW92ZSBmcm9tIGRhdGFiYXNlXHJcbiAgICAgICAgICAgIC8vcmVtb3ZlIGZyb20gcmVkaXNcclxuICAgICAgICAgICAgcmV0dXJuIG5leHQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChkZWNvZGVkLmV4cCAqIDEwMDAgPCBEYXRlLm5vdygpKSB7XHJcbiAgICAgICAgICAgIC8vcmVtb3ZlIGZyb20gZGF0YWJhc2VcclxuICAgICAgICAgICAgLy9yZW1vdmUgZnJvbSByZWRpc1xyXG4gICAgICAgICAgICByZXR1cm4gbmV4dCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy9jaGVjayBpZiB0b2tlbiBpcyBpbiByZWRpc1xyXG4gICAgICAgIC8vaWYgTk9UIGluIHJlZGlzIGNhbGwgbmV4dCgpXHJcbiAgICAgICAgLy9lbHNlIGNoZWNrIGxhc3QgdXBkYXRlIHRpbWUgaWYgZ3JlYXRlciB0aGFuIG9yIGVxdWFscyB0byAxaG91ciB1cGRhdGUgdGhlIHRva2VuXHJcbiAgICAgICAgLy8gaWYgbGVzcyBza2lwIGVsc2UgdXBkYXRlIHRva2VuXHJcbiAgICAgICAgLy8gYXV0aG9yaXphdGlvbiA9IG5ldyB0b2tlblxyXG5cclxuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlck1vZGVsLmZpbmRCeUlkKGRlY29kZWQudXNlcklkKTtcclxuICAgICAgICBpZiAoIXVzZXIpIHtcclxuICAgICAgICAgICAgLy9yZW1vdmUgZnJvbSBkYXRhYmFzZVxyXG4gICAgICAgICAgICAvL3JlbW92ZSBmcm9tIHJlZGlzXHJcbiAgICAgICAgICAgIHJldHVybiBuZXh0KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBpZiB0aGUgdG9rZW4gaGFzIGNvbWUgYWxsIHRoaXMgd2F5IGV2ZXJ5dGhpbmcgaXMgZ29vZCBqdXN0IGF0dGFjaCBpdCB0byB0aGUgcmVxdWVzdCBoZWFkZXJcclxuICAgICAgICBPYmplY3QuYXNzaWduKHJlcS5oZWFkZXJzLCB7XHJcbiAgICAgICAgICAgIHVzZXIsXHJcbiAgICAgICAgICAgIGF1dGhvcml6YXRpb24sXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiBuZXh0KCk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGVycm9yKVxyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoXCJFcnJvciBIYXBwZW5lZCFcIikpO1xyXG4gICAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgdmFsaWRhdGVUb2tlbjtcclxuXHJcblxyXG4vLyAtLS0tLS0tLS0tLS0tIGF1dGhvcml6YXRpb24gLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vLyBsZXQgY2hlY2tfdXNlcl9hY3Rpb24gPSBhc3luYyAocmVxLGFjdGlvbixyZXNvdXJjZSkgPT57XHJcbi8vICAgaWYoIVsndXBkYXRlT3duJywnZGVsZXRlT3duJ10uaW5jbHVkZXMoYWN0aW9uKSl7XHJcbi8vICAgICByZXR1cm4gdHJ1ZVxyXG4vLyAgIH1cclxuLy9cclxuLy8gICBjb25zdCB1c2VyUmVzb3VyY2UgPSBuZXcgU2V0KClcclxuLy9cclxuLy8gICBpZihyZXNvdXJjZSA9PSAndGVuZGVyJyl7XHJcbi8vICAgICBsZXQgdXNlclRlbmRlciA9IGF3YWl0IFRlbmRlci5maW5kKHsgY3JlYXRvcl91c2VyOiByZXEudXNlci5faWQgfSlcclxuLy8gICAgIHVzZXJUZW5kZXIuZm9yRWFjaCh0ZW5kZXIgPT4gdXNlclJlc291cmNlLmFkZChgJHt0ZW5kZXIuX2lkfWApKVxyXG4vL1xyXG4vLyAgIH1lbHNlIGlmKHJlc291cmNlID09ICdjb21wYW55Jyl7XHJcbi8vICAgICBsZXQgdXNlckNvbXBhbnkgPSBhd2FpdCBDb21wYW55LmZpbmQoeyBjcmVhdG9yX3VzZXI6IHJlcS51c2VyLl9pZCB9KVxyXG4vLyAgICAgdXNlckNvbXBhbnkuZm9yRWFjaChjb21wYW55ID0+IHVzZXJSZXNvdXJjZS5hZGQoIGAke2NvbXBhbnkuX2lkfWApKVxyXG4vL1xyXG4vLyAgIH1lbHNlIGlmKHJlc291cmNlID09ICdhd2FyZCcpe1xyXG4vLyAgICAgbGV0IHVzZXJBd2FyZCA9IGF3YWl0IEF3YXJkLmZpbmQoeyBjcmVhdG9yX3VzZXI6IHJlcS51c2VyLl9pZCB9KVxyXG4vLyAgICAgdXNlckF3YXJkLmZvckVhY2goYXdhcmQgPT4gdXNlclJlc291cmNlLmFkZChgJHthd2FyZC5faWR9YCkpXHJcbi8vICAgfVxyXG4vL1xyXG4vLyAgIGlmKCF1c2VyUmVzb3VyY2UuaGFzKHJlcS5wYXJhbXMuaWQpKXtcclxuLy8gICAgIHJldHVybiBmYWxzZVxyXG4vLyAgIH1cclxuLy9cclxuLy8gICByZXR1cm4gdHJ1ZVxyXG4vLyB9XHJcbi8vXHJcbi8vXHJcbi8vXHJcbi8vIGV4cG9ydHMuYXV0aG9yaXplID0gZnVuY3Rpb24gKGFjdGlvbiwgcmVzb3VyY2UpIHtcclxuLy8gICByZXR1cm4gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XHJcbi8vICAgICB0cnkge1xyXG4vLyAgICAgICBjb25zdCBwZXJtaXNzaW9uID0gcm9sZXMuY2FuKHJlcS51c2VyLnJvbGUpW2FjdGlvbl0ocmVzb3VyY2UpO1xyXG4vL1xyXG4vLyAgICAgICBpZiAoIXBlcm1pc3Npb24uZ3JhbnRlZCkge1xyXG4vLyAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuc2VuZChcIllvdSBkb24ndCBoYXZlIGVub3VnaCBwZXJtaXNzaW9uIHRvIHBlcmZvcm0gdGhpcyBhY3Rpb25cIik7XHJcbi8vICAgICAgIH1cclxuLy9cclxuLy8gICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IGNoZWNrX3VzZXJfYWN0aW9uKHJlcSxhY3Rpb24scmVzb3VyY2UpXHJcbi8vICAgICAgIGlmKCFyZXN1bHQpe1xyXG4vLyAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuc2VuZCh7IHBhcmFtOiByZXNvdXJjZSAsIG1zZzogYFlvdSBhcmUgbm90IGF1dGhvcml6ZWQgdG8gZWRpdCB0aGlzICR7cmVzb3VyY2V9LmAgfSlcclxuLy8gICAgICAgfVxyXG4vL1xyXG4vLyAgICAgICBuZXh0KClcclxuLy8gICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbi8vICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuc2VuZChcIllvdSBkb24ndCBoYXZlIGVub3VnaCBwZXJtaXNzaW9uIHRvIHBlcmZvcm0gdGhpcyBhY3Rpb25cIilcclxuLy8gICAgIH1cclxuLy8gICB9XHJcbi8vIH1cclxuIl19","map":{"version":3,"sources":["validate-token.js"],"names":["validateToken","req","res","next","authorization","headers","Object","assign","user","accessToken","split","decoded","jwt","verify","process","env","JWT_SECRET","exp","Date","now","UserModel","findById","userId","error","console","log","Promise","reject","Error"],"mappings":";;;;;;;AAAA;;AAGA;;;;AADA;AAGA,MAAMA,aAAa,GAAG,OAAOC,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB,KAA0B;AAC5C,MAAI;AACA,UAAMC,aAAa,GAAGH,GAAG,CAACI,OAAJ,CAAYD,aAAlC;AAEAE,IAAAA,MAAM,CAACC,MAAP,CAAcN,GAAG,CAACI,OAAlB,EAA2B;AACvBG,MAAAA,IAAI,EAAE,IADiB;AAEvBJ,MAAAA,aAAa,EAAE;AAFQ,KAA3B;;AAKA,QAAI,CAACA,aAAL,EAAoB;AAChB,aAAOD,IAAI,EAAX;AACH;;AAED,UAAMM,WAAW,GAAGL,aAAa,CAACM,KAAd,CAAoB,GAApB,EAAyB,CAAzB,CAApB;AAEA,QAAIC,OAAJ;;AACA,QAAIF,WAAJ,EAAiB;AACbE,MAAAA,OAAO,GAAGC,sBAAIC,MAAJ,CAAWJ,WAAX,EAAwBK,OAAO,CAACC,GAAR,CAAYC,UAApC,CAAV;AACH;;AACD,QAAI,CAACL,OAAL,EAAc;AACV;AACA;AACA;AACA,aAAOR,IAAI,EAAX;AACH;;AAED,QAAIQ,OAAO,CAACM,GAAR,GAAc,IAAd,GAAqBC,IAAI,CAACC,GAAL,EAAzB,EAAqC;AACjC;AACA;AACA,aAAOhB,IAAI,EAAX;AACH,KA7BD,CA+BA;AACA;AACA;AACA;AACA;;;AAEA,UAAMK,IAAI,GAAG,MAAMY,gBAAUC,QAAV,CAAmBV,OAAO,CAACW,MAA3B,CAAnB;;AACA,QAAI,CAACd,IAAL,EAAW;AACP;AACA;AACA,aAAOL,IAAI,EAAX;AACH,KA1CD,CA4CA;;;AACAG,IAAAA,MAAM,CAACC,MAAP,CAAcN,GAAG,CAACI,OAAlB,EAA2B;AACvBG,MAAAA,IADuB;AAEvBJ,MAAAA;AAFuB,KAA3B;AAKA,WAAOD,IAAI,EAAX;AACH,GAnDD,CAmDE,OAAOoB,KAAP,EAAc;AACZC,IAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACA,WAAOG,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAU,iBAAV,CAAf,CAAP;AACH;AACJ,CAxDD;;eA0De5B,a,EAGf;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\middlewares\\auth\\","sourcesContent":["import jwt from \"jsonwebtoken\";\r\n\r\n// import redis from \"../config/redis-config\";\r\nimport {UserModel} from \"../../models/user\";\r\n\r\nconst validateToken = async (req, res, next) => {\r\n    try {\r\n        const authorization = req.headers.authorization\r\n\r\n        Object.assign(req.headers, {\r\n            user: null,\r\n            authorization: null,\r\n        });\r\n\r\n        if (!authorization) {\r\n            return next();\r\n        }\r\n\r\n        const accessToken = authorization.split(\" \")[1];\r\n\r\n        let decoded;\r\n        if (accessToken) {\r\n            decoded = jwt.verify(accessToken, process.env.JWT_SECRET);\r\n        }\r\n        if (!decoded) {\r\n            // invalid token, remove the token from everywhere\r\n            //remove from database\r\n            //remove from redis\r\n            return next();\r\n        }\r\n\r\n        if (decoded.exp * 1000 < Date.now()) {\r\n            //remove from database\r\n            //remove from redis\r\n            return next();\r\n        }\r\n\r\n        //check if token is in redis\r\n        //if NOT in redis call next()\r\n        //else check last update time if greater than or equals to 1hour update the token\r\n        // if less skip else update token\r\n        // authorization = new token\r\n\r\n        const user = await UserModel.findById(decoded.userId);\r\n        if (!user) {\r\n            //remove from database\r\n            //remove from redis\r\n            return next();\r\n        }\r\n\r\n        // if the token has come all this way everything is good just attach it to the request header\r\n        Object.assign(req.headers, {\r\n            user,\r\n            authorization,\r\n        });\r\n\r\n        return next();\r\n    } catch (error) {\r\n        console.log(error)\r\n        return Promise.reject(new Error(\"Error Happened!\"));\r\n    }\r\n};\r\n\r\nexport default validateToken;\r\n\r\n\r\n// ------------- authorization ------------------\r\n\r\n// let check_user_action = async (req,action,resource) =>{\r\n//   if(!['updateOwn','deleteOwn'].includes(action)){\r\n//     return true\r\n//   }\r\n//\r\n//   const userResource = new Set()\r\n//\r\n//   if(resource == 'tender'){\r\n//     let userTender = await Tender.find({ creator_user: req.user._id })\r\n//     userTender.forEach(tender => userResource.add(`${tender._id}`))\r\n//\r\n//   }else if(resource == 'company'){\r\n//     let userCompany = await Company.find({ creator_user: req.user._id })\r\n//     userCompany.forEach(company => userResource.add( `${company._id}`))\r\n//\r\n//   }else if(resource == 'award'){\r\n//     let userAward = await Award.find({ creator_user: req.user._id })\r\n//     userAward.forEach(award => userResource.add(`${award._id}`))\r\n//   }\r\n//\r\n//   if(!userResource.has(req.params.id)){\r\n//     return false\r\n//   }\r\n//\r\n//   return true\r\n// }\r\n//\r\n//\r\n//\r\n// exports.authorize = function (action, resource) {\r\n//   return async (req, res, next) => {\r\n//     try {\r\n//       const permission = roles.can(req.user.role)[action](resource);\r\n//\r\n//       if (!permission.granted) {\r\n//         return res.status(401).send(\"You don't have enough permission to perform this action\");\r\n//       }\r\n//\r\n//       let result = await check_user_action(req,action,resource)\r\n//       if(!result){\r\n//         return res.status(401).send({ param: resource , msg: `You are not authorized to edit this ${resource}.` })\r\n//       }\r\n//\r\n//       next()\r\n//     } catch (error) {\r\n//       return res.status(401).send(\"You don't have enough permission to perform this action\")\r\n//     }\r\n//   }\r\n// }\r\n"]}},"mtime":1648583440810},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\middlewares\\\\auth\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\middlewares\\\\auth\\\\phone-verification.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\n// import admin from \"../../config/firebase-config\";\nconst phoneVerification = async (resolve, source, args, context, info) => {\n  // const {phoneVerification} = context;\n  // let phoneNumber = \"\";\n  //\n  // await admin\n  //     .auth()\n  //     .verifyIdToken(phoneVerification)\n  //     .then((decodedToken) => {\n  //         phoneNumber = decodedToken.phone_number;\n  //     })\n  //     .catch(() => Promise.reject(new Error(\"Error happened!\")));\n  // if (phoneNumber === \"\") {\n  //     return Promise.reject(new Error(\"Phone number not detected!\"));\n  // }\n  // context.phoneNumber = phoneNumber;\n  return resolve(source, args, context, info);\n};\n\nvar _default = phoneVerification;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBob25lLXZlcmlmaWNhdGlvbi5qcyJdLCJuYW1lcyI6WyJwaG9uZVZlcmlmaWNhdGlvbiIsInJlc29sdmUiLCJzb3VyY2UiLCJhcmdzIiwiY29udGV4dCIsImluZm8iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTtBQUVBLE1BQU1BLGlCQUFpQixHQUFHLE9BQU9DLE9BQVAsRUFBZ0JDLE1BQWhCLEVBQXdCQyxJQUF4QixFQUE4QkMsT0FBOUIsRUFBdUNDLElBQXZDLEtBQWdEO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFPSixPQUFPLENBQUNDLE1BQUQsRUFBU0MsSUFBVCxFQUFlQyxPQUFmLEVBQXdCQyxJQUF4QixDQUFkO0FBQ0gsQ0FoQkQ7O2VBa0JlTCxpQiIsInNvdXJjZVJvb3QiOiJDOlxcVXNlcnNcXFJlYmJlXFxEZXNrdG9wXFxoYWxldGEtbmV3LWFwaVxcc3JjXFxtaWRkbGV3YXJlc1xcYXV0aFxcIiwic291cmNlc0NvbnRlbnQiOlsiLy8gaW1wb3J0IGFkbWluIGZyb20gXCIuLi8uLi9jb25maWcvZmlyZWJhc2UtY29uZmlnXCI7XHJcblxyXG5jb25zdCBwaG9uZVZlcmlmaWNhdGlvbiA9IGFzeW5jIChyZXNvbHZlLCBzb3VyY2UsIGFyZ3MsIGNvbnRleHQsIGluZm8pID0+IHtcclxuICAgIC8vIGNvbnN0IHtwaG9uZVZlcmlmaWNhdGlvbn0gPSBjb250ZXh0O1xyXG4gICAgLy8gbGV0IHBob25lTnVtYmVyID0gXCJcIjtcclxuICAgIC8vXHJcbiAgICAvLyBhd2FpdCBhZG1pblxyXG4gICAgLy8gICAgIC5hdXRoKClcclxuICAgIC8vICAgICAudmVyaWZ5SWRUb2tlbihwaG9uZVZlcmlmaWNhdGlvbilcclxuICAgIC8vICAgICAudGhlbigoZGVjb2RlZFRva2VuKSA9PiB7XHJcbiAgICAvLyAgICAgICAgIHBob25lTnVtYmVyID0gZGVjb2RlZFRva2VuLnBob25lX251bWJlcjtcclxuICAgIC8vICAgICB9KVxyXG4gICAgLy8gICAgIC5jYXRjaCgoKSA9PiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoXCJFcnJvciBoYXBwZW5lZCFcIikpKTtcclxuICAgIC8vIGlmIChwaG9uZU51bWJlciA9PT0gXCJcIikge1xyXG4gICAgLy8gICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoXCJQaG9uZSBudW1iZXIgbm90IGRldGVjdGVkIVwiKSk7XHJcbiAgICAvLyB9XHJcbiAgICAvLyBjb250ZXh0LnBob25lTnVtYmVyID0gcGhvbmVOdW1iZXI7XHJcbiAgICByZXR1cm4gcmVzb2x2ZShzb3VyY2UsIGFyZ3MsIGNvbnRleHQsIGluZm8pO1xyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBwaG9uZVZlcmlmaWNhdGlvbjtcclxuIl19","map":{"version":3,"sources":["phone-verification.js"],"names":["phoneVerification","resolve","source","args","context","info"],"mappings":";;;;;;;AAAA;AAEA,MAAMA,iBAAiB,GAAG,OAAOC,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAOJ,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,CAhBD;;eAkBeL,iB","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\middlewares\\auth\\","sourcesContent":["// import admin from \"../../config/firebase-config\";\r\n\r\nconst phoneVerification = async (resolve, source, args, context, info) => {\r\n    // const {phoneVerification} = context;\r\n    // let phoneNumber = \"\";\r\n    //\r\n    // await admin\r\n    //     .auth()\r\n    //     .verifyIdToken(phoneVerification)\r\n    //     .then((decodedToken) => {\r\n    //         phoneNumber = decodedToken.phone_number;\r\n    //     })\r\n    //     .catch(() => Promise.reject(new Error(\"Error happened!\")));\r\n    // if (phoneNumber === \"\") {\r\n    //     return Promise.reject(new Error(\"Phone number not detected!\"));\r\n    // }\r\n    // context.phoneNumber = phoneNumber;\r\n    return resolve(source, args, context, info);\r\n}\r\n\r\nexport default phoneVerification;\r\n"]}},"mtime":1648583275534},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\middlewares\\\\validators\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\middlewares\\\\validators\\\\user-validator.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n// import validator from \"validators\";\nconst userValidator = {\n  changePassword: async (resolve, source, args, context, info) => {\n    const {\n      newPassword\n    } = args; // if (!validator.isLength(newPassword, {min: 6})) {\n    //     return Promise.reject(new Error(\"Error: newPassword\"));\n    // }\n\n    return resolve(source, args, context, info);\n  },\n  newPassword: async (resolve, source, args, context, info) => {\n    const {\n      newPassword\n    } = args; // if (!validator.isLength(newPassword, {min: 6})) {\n    //     return Promise.reject(new Error(\"Error: newPassword\"));\n    // }\n\n    return resolve(source, args, context, info);\n  },\n  resetPassword: async (resolve, source, args, context, info) => {\n    let {\n      email\n    } = args; // email = validator.normalizeEmail(email);\n    // email = validator.trim(email);\n    //\n    // Object.assign(args, {email});\n\n    return resolve(source, args, context, info);\n  },\n  signIn: async (resolve, source, args, context, info) => {\n    let {\n      email\n    } = args; // email = email.toString().toLowerCase();\n    // email = validator.trim(email);\n    //\n    // Object.assign(args, {email});\n\n    return resolve(source, args, context, info);\n  },\n  signUp: async (resolve, source, args, context, info) => {\n    let {\n      email\n    } = args; // email = email.toString().toLowerCase();\n    // email = validator.trim(email);\n    //\n    // Object.assign(args, {email});\n\n    const {\n      password\n    } = args; // if (!validator.isEmail(email, {allow_utf8_local_part: false})) {\n    //     return Promise.reject(new Error(\"Error: email\"));\n    // }\n    //\n    // if (!validator.isLength(password, {min: 6})) {\n    //     return Promise.reject(new Error(\"Error: password\"));\n    // }\n\n    return resolve(source, args, context, info);\n  },\n  updateUser: async (resolve, source, args, context, info) => {\n    let {\n      email\n    } = args; // email = validator.normalizeEmail(email);\n    // email = validator.trim(email);\n    //\n    // Object.assign(args, {email});\n\n    const {\n      firstName,\n      lastName\n    } = args; // if (!validator.isEmail(email, {allow_utf8_local_part: false})) {\n    //     return Promise.reject(new Error(\"Error: email\"));\n    // }\n    // if (!validator.isLength(firstName, {min: 2})) {\n    //     return Promise.reject(new Error(\"Error: firstName\"));\n    // }\n    // if (!validator.isLength(lastName, {min: 2})) {\n    //     return Promise.reject(new Error(\"Error: lastName\"));\n    // }\n\n    return resolve(source, args, context, info);\n  }\n};\nvar _default = userValidator;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXItdmFsaWRhdG9yLmpzIl0sIm5hbWVzIjpbInVzZXJWYWxpZGF0b3IiLCJjaGFuZ2VQYXNzd29yZCIsInJlc29sdmUiLCJzb3VyY2UiLCJhcmdzIiwiY29udGV4dCIsImluZm8iLCJuZXdQYXNzd29yZCIsInJlc2V0UGFzc3dvcmQiLCJlbWFpbCIsInNpZ25JbiIsInNpZ25VcCIsInBhc3N3b3JkIiwidXBkYXRlVXNlciIsImZpcnN0TmFtZSIsImxhc3ROYW1lIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUVBLE1BQU1BLGFBQWEsR0FBRztBQUNsQkMsRUFBQUEsY0FBYyxFQUFFLE9BQU9DLE9BQVAsRUFBZ0JDLE1BQWhCLEVBQXdCQyxJQUF4QixFQUE4QkMsT0FBOUIsRUFBdUNDLElBQXZDLEtBQWdEO0FBQzVELFVBQU07QUFBQ0MsTUFBQUE7QUFBRCxRQUFnQkgsSUFBdEIsQ0FENEQsQ0FHNUQ7QUFDQTtBQUNBOztBQUVBLFdBQU9GLE9BQU8sQ0FBQ0MsTUFBRCxFQUFTQyxJQUFULEVBQWVDLE9BQWYsRUFBd0JDLElBQXhCLENBQWQ7QUFDSCxHQVRpQjtBQVVsQkMsRUFBQUEsV0FBVyxFQUFFLE9BQU9MLE9BQVAsRUFBZ0JDLE1BQWhCLEVBQXdCQyxJQUF4QixFQUE4QkMsT0FBOUIsRUFBdUNDLElBQXZDLEtBQWdEO0FBQ3pELFVBQU07QUFBQ0MsTUFBQUE7QUFBRCxRQUFnQkgsSUFBdEIsQ0FEeUQsQ0FHekQ7QUFDQTtBQUNBOztBQUVBLFdBQU9GLE9BQU8sQ0FBQ0MsTUFBRCxFQUFTQyxJQUFULEVBQWVDLE9BQWYsRUFBd0JDLElBQXhCLENBQWQ7QUFDSCxHQWxCaUI7QUFtQmxCRSxFQUFBQSxhQUFhLEVBQUUsT0FBT04sT0FBUCxFQUFnQkMsTUFBaEIsRUFBd0JDLElBQXhCLEVBQThCQyxPQUE5QixFQUF1Q0MsSUFBdkMsS0FBZ0Q7QUFDM0QsUUFBSTtBQUFDRyxNQUFBQTtBQUFELFFBQVVMLElBQWQsQ0FEMkQsQ0FHM0Q7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsV0FBT0YsT0FBTyxDQUFDQyxNQUFELEVBQVNDLElBQVQsRUFBZUMsT0FBZixFQUF3QkMsSUFBeEIsQ0FBZDtBQUNILEdBNUJpQjtBQTZCbEJJLEVBQUFBLE1BQU0sRUFBRSxPQUFPUixPQUFQLEVBQWdCQyxNQUFoQixFQUF3QkMsSUFBeEIsRUFBOEJDLE9BQTlCLEVBQXVDQyxJQUF2QyxLQUFnRDtBQUNwRCxRQUFJO0FBQUNHLE1BQUFBO0FBQUQsUUFBVUwsSUFBZCxDQURvRCxDQUdwRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxXQUFPRixPQUFPLENBQUNDLE1BQUQsRUFBU0MsSUFBVCxFQUFlQyxPQUFmLEVBQXdCQyxJQUF4QixDQUFkO0FBQ0gsR0F0Q2lCO0FBdUNsQkssRUFBQUEsTUFBTSxFQUFFLE9BQU9ULE9BQVAsRUFBZ0JDLE1BQWhCLEVBQXdCQyxJQUF4QixFQUE4QkMsT0FBOUIsRUFBdUNDLElBQXZDLEtBQWdEO0FBQ3BELFFBQUk7QUFBQ0csTUFBQUE7QUFBRCxRQUFVTCxJQUFkLENBRG9ELENBR3BEO0FBQ0E7QUFDQTtBQUNBOztBQUVBLFVBQU07QUFBQ1EsTUFBQUE7QUFBRCxRQUFhUixJQUFuQixDQVJvRCxDQVVwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxXQUFPRixPQUFPLENBQUNDLE1BQUQsRUFBU0MsSUFBVCxFQUFlQyxPQUFmLEVBQXdCQyxJQUF4QixDQUFkO0FBQ0gsR0ExRGlCO0FBMkRsQk8sRUFBQUEsVUFBVSxFQUFFLE9BQU9YLE9BQVAsRUFBZ0JDLE1BQWhCLEVBQXdCQyxJQUF4QixFQUE4QkMsT0FBOUIsRUFBdUNDLElBQXZDLEtBQWdEO0FBQ3hELFFBQUk7QUFBQ0csTUFBQUE7QUFBRCxRQUFVTCxJQUFkLENBRHdELENBR3hEO0FBQ0E7QUFDQTtBQUNBOztBQUVBLFVBQU07QUFDRlUsTUFBQUEsU0FERTtBQUVGQyxNQUFBQTtBQUZFLFFBR0ZYLElBSEosQ0FSd0QsQ0FheEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBLFdBQU9GLE9BQU8sQ0FBQ0MsTUFBRCxFQUFTQyxJQUFULEVBQWVDLE9BQWYsRUFBd0JDLElBQXhCLENBQWQ7QUFDSDtBQWxGaUIsQ0FBdEI7ZUFxRmVOLGEiLCJzb3VyY2VSb290IjoiQzpcXFVzZXJzXFxSZWJiZVxcRGVza3RvcFxcaGFsZXRhLW5ldy1hcGlcXHNyY1xcbWlkZGxld2FyZXNcXHZhbGlkYXRvcnNcXCIsInNvdXJjZXNDb250ZW50IjpbIi8vIGltcG9ydCB2YWxpZGF0b3IgZnJvbSBcInZhbGlkYXRvcnNcIjtcclxuXHJcbmNvbnN0IHVzZXJWYWxpZGF0b3IgPSB7XHJcbiAgICBjaGFuZ2VQYXNzd29yZDogYXN5bmMgKHJlc29sdmUsIHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbykgPT4ge1xyXG4gICAgICAgIGNvbnN0IHtuZXdQYXNzd29yZH0gPSBhcmdzO1xyXG5cclxuICAgICAgICAvLyBpZiAoIXZhbGlkYXRvci5pc0xlbmd0aChuZXdQYXNzd29yZCwge21pbjogNn0pKSB7XHJcbiAgICAgICAgLy8gICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoXCJFcnJvcjogbmV3UGFzc3dvcmRcIikpO1xyXG4gICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHJlc29sdmUoc291cmNlLCBhcmdzLCBjb250ZXh0LCBpbmZvKTtcclxuICAgIH0sXHJcbiAgICBuZXdQYXNzd29yZDogYXN5bmMgKHJlc29sdmUsIHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbykgPT4ge1xyXG4gICAgICAgIGNvbnN0IHtuZXdQYXNzd29yZH0gPSBhcmdzO1xyXG5cclxuICAgICAgICAvLyBpZiAoIXZhbGlkYXRvci5pc0xlbmd0aChuZXdQYXNzd29yZCwge21pbjogNn0pKSB7XHJcbiAgICAgICAgLy8gICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoXCJFcnJvcjogbmV3UGFzc3dvcmRcIikpO1xyXG4gICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHJlc29sdmUoc291cmNlLCBhcmdzLCBjb250ZXh0LCBpbmZvKTtcclxuICAgIH0sXHJcbiAgICByZXNldFBhc3N3b3JkOiBhc3luYyAocmVzb2x2ZSwgc291cmNlLCBhcmdzLCBjb250ZXh0LCBpbmZvKSA9PiB7XHJcbiAgICAgICAgbGV0IHtlbWFpbH0gPSBhcmdzO1xyXG5cclxuICAgICAgICAvLyBlbWFpbCA9IHZhbGlkYXRvci5ub3JtYWxpemVFbWFpbChlbWFpbCk7XHJcbiAgICAgICAgLy8gZW1haWwgPSB2YWxpZGF0b3IudHJpbShlbWFpbCk7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyBPYmplY3QuYXNzaWduKGFyZ3MsIHtlbWFpbH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gcmVzb2x2ZShzb3VyY2UsIGFyZ3MsIGNvbnRleHQsIGluZm8pO1xyXG4gICAgfSxcclxuICAgIHNpZ25JbjogYXN5bmMgKHJlc29sdmUsIHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbykgPT4ge1xyXG4gICAgICAgIGxldCB7ZW1haWx9ID0gYXJncztcclxuXHJcbiAgICAgICAgLy8gZW1haWwgPSBlbWFpbC50b1N0cmluZygpLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgLy8gZW1haWwgPSB2YWxpZGF0b3IudHJpbShlbWFpbCk7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyBPYmplY3QuYXNzaWduKGFyZ3MsIHtlbWFpbH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gcmVzb2x2ZShzb3VyY2UsIGFyZ3MsIGNvbnRleHQsIGluZm8pO1xyXG4gICAgfSxcclxuICAgIHNpZ25VcDogYXN5bmMgKHJlc29sdmUsIHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbykgPT4ge1xyXG4gICAgICAgIGxldCB7ZW1haWx9ID0gYXJncztcclxuXHJcbiAgICAgICAgLy8gZW1haWwgPSBlbWFpbC50b1N0cmluZygpLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgLy8gZW1haWwgPSB2YWxpZGF0b3IudHJpbShlbWFpbCk7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyBPYmplY3QuYXNzaWduKGFyZ3MsIHtlbWFpbH0pO1xyXG5cclxuICAgICAgICBjb25zdCB7cGFzc3dvcmR9ID0gYXJncztcclxuXHJcbiAgICAgICAgLy8gaWYgKCF2YWxpZGF0b3IuaXNFbWFpbChlbWFpbCwge2FsbG93X3V0ZjhfbG9jYWxfcGFydDogZmFsc2V9KSkge1xyXG4gICAgICAgIC8vICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKFwiRXJyb3I6IGVtYWlsXCIpKTtcclxuICAgICAgICAvLyB9XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyBpZiAoIXZhbGlkYXRvci5pc0xlbmd0aChwYXNzd29yZCwge21pbjogNn0pKSB7XHJcbiAgICAgICAgLy8gICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoXCJFcnJvcjogcGFzc3dvcmRcIikpO1xyXG4gICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHJlc29sdmUoc291cmNlLCBhcmdzLCBjb250ZXh0LCBpbmZvKTtcclxuICAgIH0sXHJcbiAgICB1cGRhdGVVc2VyOiBhc3luYyAocmVzb2x2ZSwgc291cmNlLCBhcmdzLCBjb250ZXh0LCBpbmZvKSA9PiB7XHJcbiAgICAgICAgbGV0IHtlbWFpbH0gPSBhcmdzO1xyXG5cclxuICAgICAgICAvLyBlbWFpbCA9IHZhbGlkYXRvci5ub3JtYWxpemVFbWFpbChlbWFpbCk7XHJcbiAgICAgICAgLy8gZW1haWwgPSB2YWxpZGF0b3IudHJpbShlbWFpbCk7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyBPYmplY3QuYXNzaWduKGFyZ3MsIHtlbWFpbH0pO1xyXG5cclxuICAgICAgICBjb25zdCB7XHJcbiAgICAgICAgICAgIGZpcnN0TmFtZSxcclxuICAgICAgICAgICAgbGFzdE5hbWUsXHJcbiAgICAgICAgfSA9IGFyZ3M7XHJcblxyXG4gICAgICAgIC8vIGlmICghdmFsaWRhdG9yLmlzRW1haWwoZW1haWwsIHthbGxvd191dGY4X2xvY2FsX3BhcnQ6IGZhbHNlfSkpIHtcclxuICAgICAgICAvLyAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcIkVycm9yOiBlbWFpbFwiKSk7XHJcbiAgICAgICAgLy8gfVxyXG4gICAgICAgIC8vIGlmICghdmFsaWRhdG9yLmlzTGVuZ3RoKGZpcnN0TmFtZSwge21pbjogMn0pKSB7XHJcbiAgICAgICAgLy8gICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoXCJFcnJvcjogZmlyc3ROYW1lXCIpKTtcclxuICAgICAgICAvLyB9XHJcbiAgICAgICAgLy8gaWYgKCF2YWxpZGF0b3IuaXNMZW5ndGgobGFzdE5hbWUsIHttaW46IDJ9KSkge1xyXG4gICAgICAgIC8vICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKFwiRXJyb3I6IGxhc3ROYW1lXCIpKTtcclxuICAgICAgICAvLyB9XHJcbiAgICAgICAgcmV0dXJuIHJlc29sdmUoc291cmNlLCBhcmdzLCBjb250ZXh0LCBpbmZvKTtcclxuICAgIH0sXHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCB1c2VyVmFsaWRhdG9yO1xyXG4iXX0=","map":{"version":3,"sources":["user-validator.js"],"names":["userValidator","changePassword","resolve","source","args","context","info","newPassword","resetPassword","email","signIn","signUp","password","updateUser","firstName","lastName"],"mappings":";;;;;;AAAA;AAEA,MAAMA,aAAa,GAAG;AAClBC,EAAAA,cAAc,EAAE,OAAOC,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AAC5D,UAAM;AAACC,MAAAA;AAAD,QAAgBH,IAAtB,CAD4D,CAG5D;AACA;AACA;;AAEA,WAAOF,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,GATiB;AAUlBC,EAAAA,WAAW,EAAE,OAAOL,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AACzD,UAAM;AAACC,MAAAA;AAAD,QAAgBH,IAAtB,CADyD,CAGzD;AACA;AACA;;AAEA,WAAOF,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,GAlBiB;AAmBlBE,EAAAA,aAAa,EAAE,OAAON,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AAC3D,QAAI;AAACG,MAAAA;AAAD,QAAUL,IAAd,CAD2D,CAG3D;AACA;AACA;AACA;;AAEA,WAAOF,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,GA5BiB;AA6BlBI,EAAAA,MAAM,EAAE,OAAOR,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AACpD,QAAI;AAACG,MAAAA;AAAD,QAAUL,IAAd,CADoD,CAGpD;AACA;AACA;AACA;;AAEA,WAAOF,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,GAtCiB;AAuClBK,EAAAA,MAAM,EAAE,OAAOT,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AACpD,QAAI;AAACG,MAAAA;AAAD,QAAUL,IAAd,CADoD,CAGpD;AACA;AACA;AACA;;AAEA,UAAM;AAACQ,MAAAA;AAAD,QAAaR,IAAnB,CARoD,CAUpD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,WAAOF,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,GA1DiB;AA2DlBO,EAAAA,UAAU,EAAE,OAAOX,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AACxD,QAAI;AAACG,MAAAA;AAAD,QAAUL,IAAd,CADwD,CAGxD;AACA;AACA;AACA;;AAEA,UAAM;AACFU,MAAAA,SADE;AAEFC,MAAAA;AAFE,QAGFX,IAHJ,CARwD,CAaxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,WAAOF,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH;AAlFiB,CAAtB;eAqFeN,a","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\middlewares\\validators\\","sourcesContent":["// import validator from \"validators\";\r\n\r\nconst userValidator = {\r\n    changePassword: async (resolve, source, args, context, info) => {\r\n        const {newPassword} = args;\r\n\r\n        // if (!validator.isLength(newPassword, {min: 6})) {\r\n        //     return Promise.reject(new Error(\"Error: newPassword\"));\r\n        // }\r\n\r\n        return resolve(source, args, context, info);\r\n    },\r\n    newPassword: async (resolve, source, args, context, info) => {\r\n        const {newPassword} = args;\r\n\r\n        // if (!validator.isLength(newPassword, {min: 6})) {\r\n        //     return Promise.reject(new Error(\"Error: newPassword\"));\r\n        // }\r\n\r\n        return resolve(source, args, context, info);\r\n    },\r\n    resetPassword: async (resolve, source, args, context, info) => {\r\n        let {email} = args;\r\n\r\n        // email = validator.normalizeEmail(email);\r\n        // email = validator.trim(email);\r\n        //\r\n        // Object.assign(args, {email});\r\n\r\n        return resolve(source, args, context, info);\r\n    },\r\n    signIn: async (resolve, source, args, context, info) => {\r\n        let {email} = args;\r\n\r\n        // email = email.toString().toLowerCase();\r\n        // email = validator.trim(email);\r\n        //\r\n        // Object.assign(args, {email});\r\n\r\n        return resolve(source, args, context, info);\r\n    },\r\n    signUp: async (resolve, source, args, context, info) => {\r\n        let {email} = args;\r\n\r\n        // email = email.toString().toLowerCase();\r\n        // email = validator.trim(email);\r\n        //\r\n        // Object.assign(args, {email});\r\n\r\n        const {password} = args;\r\n\r\n        // if (!validator.isEmail(email, {allow_utf8_local_part: false})) {\r\n        //     return Promise.reject(new Error(\"Error: email\"));\r\n        // }\r\n        //\r\n        // if (!validator.isLength(password, {min: 6})) {\r\n        //     return Promise.reject(new Error(\"Error: password\"));\r\n        // }\r\n\r\n        return resolve(source, args, context, info);\r\n    },\r\n    updateUser: async (resolve, source, args, context, info) => {\r\n        let {email} = args;\r\n\r\n        // email = validator.normalizeEmail(email);\r\n        // email = validator.trim(email);\r\n        //\r\n        // Object.assign(args, {email});\r\n\r\n        const {\r\n            firstName,\r\n            lastName,\r\n        } = args;\r\n\r\n        // if (!validator.isEmail(email, {allow_utf8_local_part: false})) {\r\n        //     return Promise.reject(new Error(\"Error: email\"));\r\n        // }\r\n        // if (!validator.isLength(firstName, {min: 2})) {\r\n        //     return Promise.reject(new Error(\"Error: firstName\"));\r\n        // }\r\n        // if (!validator.isLength(lastName, {min: 2})) {\r\n        //     return Promise.reject(new Error(\"Error: lastName\"));\r\n        // }\r\n        return resolve(source, args, context, info);\r\n    },\r\n};\r\n\r\nexport default userValidator;\r\n"]}},"mtime":1648583275535},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\graphql\\\\auth\\\\resolvers\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\graphql\\\\auth\\\\resolvers\\\\auth-resolvers.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\n\nvar _user = require(\"../../../models/user\");\n\nvar _authUseCases = _interopRequireDefault(require(\"../../../services/auth/use-cases/auth-use-cases\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// import crypto from \"crypto\";\nconst signIn = {\n  name: \"signIn\",\n  type: \"AccessToken!\",\n  args: {\n    phoneNumber: \"String!\",\n    password: \"String!\"\n  },\n  resolve: async ({\n    args: {\n      phoneNumber,\n      password\n    }\n  }) => {\n    try {\n      const {\n        user,\n        accessToken\n      } = await _authUseCases.default.signIn({\n        phoneNumber,\n        password\n      });\n      return {\n        accessToken,\n        user\n      };\n    } catch (error) {\n      return Promise.reject(error);\n    }\n  }\n};\nconst signUp = {\n  name: \"signUp\",\n  type: \"AccessToken!\",\n  args: {\n    firstName: \"String!\",\n    middleName: \"String!\",\n    lastName: \"String!\",\n    password: \"String!\",\n    phoneNumber: \"String!\"\n  },\n  resolve: async ({\n    args: {\n      firstName,\n      middleName,\n      lastName,\n      password,\n      phoneNumber\n    },\n    context: {\n      phoneVerification\n    }\n  }) => {\n    try {\n      const {\n        accessToken,\n        user\n      } = _authUseCases.default.signUp({\n        firstName,\n        middleName,\n        lastName,\n        password,\n        phoneNumber\n      });\n\n      console.log(accessToken);\n      return {\n        accessToken,\n        // roles: user.roles,\n        user\n      };\n    } catch (error) {\n      return Promise.reject(error);\n    }\n  }\n};\nconst logout = {\n  name: 'logout',\n  type: 'Succeed!',\n  resolve: async ({\n    context: {\n      user,\n      accessToken\n    }\n  }) => {\n    try {\n      // await redis.set(`expiredToken:${accessToken}`, user._id, 'EX', process.env.REDIS_TOKEN_EXPIRY);\n      return {\n        succeed: true\n      };\n    } catch (error) {\n      return Promise.reject(error);\n    }\n  }\n};\nvar _default = {\n  signIn,\n  signUp,\n  logout\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGgtcmVzb2x2ZXJzLmpzIl0sIm5hbWVzIjpbInNpZ25JbiIsIm5hbWUiLCJ0eXBlIiwiYXJncyIsInBob25lTnVtYmVyIiwicGFzc3dvcmQiLCJyZXNvbHZlIiwidXNlciIsImFjY2Vzc1Rva2VuIiwiYXV0aFNlcnZpY2VzIiwiZXJyb3IiLCJQcm9taXNlIiwicmVqZWN0Iiwic2lnblVwIiwiZmlyc3ROYW1lIiwibWlkZGxlTmFtZSIsImxhc3ROYW1lIiwiY29udGV4dCIsInBob25lVmVyaWZpY2F0aW9uIiwiY29uc29sZSIsImxvZyIsImxvZ291dCIsInN1Y2NlZWQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7OztBQUNBO0FBRUEsTUFBTUEsTUFBTSxHQUFHO0FBQ1hDLEVBQUFBLElBQUksRUFBRSxRQURLO0FBRVhDLEVBQUFBLElBQUksRUFBRSxjQUZLO0FBR1hDLEVBQUFBLElBQUksRUFBRTtBQUNGQyxJQUFBQSxXQUFXLEVBQUUsU0FEWDtBQUVGQyxJQUFBQSxRQUFRLEVBQUU7QUFGUixHQUhLO0FBT1hDLEVBQUFBLE9BQU8sRUFBRSxPQUFPO0FBQUNILElBQUFBLElBQUksRUFBRTtBQUFDQyxNQUFBQSxXQUFEO0FBQWNDLE1BQUFBO0FBQWQ7QUFBUCxHQUFQLEtBQTJDO0FBQ2hELFFBQUk7QUFFQSxZQUFNO0FBQUNFLFFBQUFBLElBQUQ7QUFBT0MsUUFBQUE7QUFBUCxVQUFzQixNQUFNQyxzQkFBYVQsTUFBYixDQUFvQjtBQUFDSSxRQUFBQSxXQUFEO0FBQWNDLFFBQUFBO0FBQWQsT0FBcEIsQ0FBbEM7QUFFQSxhQUFPO0FBQUNHLFFBQUFBLFdBQUQ7QUFBY0QsUUFBQUE7QUFBZCxPQUFQO0FBQ0gsS0FMRCxDQUtFLE9BQU9HLEtBQVAsRUFBYztBQUNaLGFBQU9DLE9BQU8sQ0FBQ0MsTUFBUixDQUFlRixLQUFmLENBQVA7QUFDSDtBQUNKO0FBaEJVLENBQWY7QUFvQkEsTUFBTUcsTUFBTSxHQUFHO0FBQ1haLEVBQUFBLElBQUksRUFBRSxRQURLO0FBRVhDLEVBQUFBLElBQUksRUFBRSxjQUZLO0FBR1hDLEVBQUFBLElBQUksRUFBRTtBQUNGVyxJQUFBQSxTQUFTLEVBQUUsU0FEVDtBQUVGQyxJQUFBQSxVQUFVLEVBQUUsU0FGVjtBQUdGQyxJQUFBQSxRQUFRLEVBQUUsU0FIUjtBQUlGWCxJQUFBQSxRQUFRLEVBQUUsU0FKUjtBQUtGRCxJQUFBQSxXQUFXLEVBQUU7QUFMWCxHQUhLO0FBVVhFLEVBQUFBLE9BQU8sRUFBRSxPQUFPO0FBQ0lILElBQUFBLElBQUksRUFBRTtBQUNGVyxNQUFBQSxTQURFO0FBRUZDLE1BQUFBLFVBRkU7QUFHRkMsTUFBQUEsUUFIRTtBQUlGWCxNQUFBQSxRQUpFO0FBS0ZELE1BQUFBO0FBTEUsS0FEVjtBQVFJYSxJQUFBQSxPQUFPLEVBQUU7QUFDTEMsTUFBQUE7QUFESztBQVJiLEdBQVAsS0FXYTtBQUNsQixRQUFJO0FBRUEsWUFBTTtBQUFDVixRQUFBQSxXQUFEO0FBQWNELFFBQUFBO0FBQWQsVUFBc0JFLHNCQUFhSSxNQUFiLENBQW9CO0FBQzVDQyxRQUFBQSxTQUQ0QztBQUU1Q0MsUUFBQUEsVUFGNEM7QUFHNUNDLFFBQUFBLFFBSDRDO0FBSTVDWCxRQUFBQSxRQUo0QztBQUs1Q0QsUUFBQUE7QUFMNEMsT0FBcEIsQ0FBNUI7O0FBT0FlLE1BQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZWixXQUFaO0FBQ0EsYUFBTztBQUNIQSxRQUFBQSxXQURHO0FBRUg7QUFDQUQsUUFBQUE7QUFIRyxPQUFQO0FBS0gsS0FmRCxDQWVFLE9BQU9HLEtBQVAsRUFBYztBQUNaLGFBQU9DLE9BQU8sQ0FBQ0MsTUFBUixDQUFlRixLQUFmLENBQVA7QUFDSDtBQUNKO0FBeENVLENBQWY7QUEyQ0EsTUFBTVcsTUFBTSxHQUFHO0FBQ1hwQixFQUFBQSxJQUFJLEVBQUUsUUFESztBQUVYQyxFQUFBQSxJQUFJLEVBQUUsVUFGSztBQUdYSSxFQUFBQSxPQUFPLEVBQUUsT0FBTztBQUFDVyxJQUFBQSxPQUFPLEVBQUU7QUFBQ1YsTUFBQUEsSUFBRDtBQUFPQyxNQUFBQTtBQUFQO0FBQVYsR0FBUCxLQUEwQztBQUMvQyxRQUFJO0FBQ0E7QUFFQSxhQUFPO0FBQUNjLFFBQUFBLE9BQU8sRUFBRTtBQUFWLE9BQVA7QUFDSCxLQUpELENBSUUsT0FBT1osS0FBUCxFQUFjO0FBQ1osYUFBT0MsT0FBTyxDQUFDQyxNQUFSLENBQWVGLEtBQWYsQ0FBUDtBQUNIO0FBQ0o7QUFYVSxDQUFmO2VBY2U7QUFDWFYsRUFBQUEsTUFEVztBQUVYYSxFQUFBQSxNQUZXO0FBR1hRLEVBQUFBO0FBSFcsQyIsInNvdXJjZVJvb3QiOiJDOlxcVXNlcnNcXFJlYmJlXFxEZXNrdG9wXFxoYWxldGEtbmV3LWFwaVxcc3JjXFxncmFwaHFsXFxhdXRoXFxyZXNvbHZlcnNcXCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBqd3QgZnJvbSBcImpzb253ZWJ0b2tlblwiO1xyXG5pbXBvcnQge1VzZXJNb2RlbH0gZnJvbSBcIi4uLy4uLy4uL21vZGVscy91c2VyXCI7XHJcbmltcG9ydCBhdXRoU2VydmljZXMgZnJvbSBcIi4uLy4uLy4uL3NlcnZpY2VzL2F1dGgvdXNlLWNhc2VzL2F1dGgtdXNlLWNhc2VzXCI7XHJcbi8vIGltcG9ydCBjcnlwdG8gZnJvbSBcImNyeXB0b1wiO1xyXG5cclxuY29uc3Qgc2lnbkluID0ge1xyXG4gICAgbmFtZTogXCJzaWduSW5cIixcclxuICAgIHR5cGU6IFwiQWNjZXNzVG9rZW4hXCIsXHJcbiAgICBhcmdzOiB7XHJcbiAgICAgICAgcGhvbmVOdW1iZXI6IFwiU3RyaW5nIVwiLFxyXG4gICAgICAgIHBhc3N3b3JkOiBcIlN0cmluZyFcIixcclxuICAgIH0sXHJcbiAgICByZXNvbHZlOiBhc3luYyAoe2FyZ3M6IHtwaG9uZU51bWJlciwgcGFzc3dvcmR9fSkgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB7dXNlciwgYWNjZXNzVG9rZW59ID0gYXdhaXQgYXV0aFNlcnZpY2VzLnNpZ25Jbih7cGhvbmVOdW1iZXIsIHBhc3N3b3JkfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4ge2FjY2Vzc1Rva2VuLCB1c2VyfTtcclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbn07XHJcblxyXG5cclxuY29uc3Qgc2lnblVwID0ge1xyXG4gICAgbmFtZTogXCJzaWduVXBcIixcclxuICAgIHR5cGU6IFwiQWNjZXNzVG9rZW4hXCIsXHJcbiAgICBhcmdzOiB7XHJcbiAgICAgICAgZmlyc3ROYW1lOiBcIlN0cmluZyFcIixcclxuICAgICAgICBtaWRkbGVOYW1lOiBcIlN0cmluZyFcIixcclxuICAgICAgICBsYXN0TmFtZTogXCJTdHJpbmchXCIsXHJcbiAgICAgICAgcGFzc3dvcmQ6IFwiU3RyaW5nIVwiLFxyXG4gICAgICAgIHBob25lTnVtYmVyOiBcIlN0cmluZyFcIixcclxuICAgIH0sXHJcbiAgICByZXNvbHZlOiBhc3luYyAoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdE5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaWRkbGVOYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdE5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzd29yZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBob25lTnVtYmVyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBob25lVmVyaWZpY2F0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIH0pID0+IHtcclxuICAgICAgICB0cnkge1xyXG5cclxuICAgICAgICAgICAgY29uc3Qge2FjY2Vzc1Rva2VuLCB1c2VyfSA9IGF1dGhTZXJ2aWNlcy5zaWduVXAoe1xyXG4gICAgICAgICAgICAgICAgZmlyc3ROYW1lLFxyXG4gICAgICAgICAgICAgICAgbWlkZGxlTmFtZSxcclxuICAgICAgICAgICAgICAgIGxhc3ROYW1lLFxyXG4gICAgICAgICAgICAgICAgcGFzc3dvcmQsXHJcbiAgICAgICAgICAgICAgICBwaG9uZU51bWJlcixcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGFjY2Vzc1Rva2VuKSAgIFxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgYWNjZXNzVG9rZW4sXHJcbiAgICAgICAgICAgICAgICAvLyByb2xlczogdXNlci5yb2xlcyxcclxuICAgICAgICAgICAgICAgIHVzZXIsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG59O1xyXG5cclxuY29uc3QgbG9nb3V0ID0ge1xyXG4gICAgbmFtZTogJ2xvZ291dCcsXHJcbiAgICB0eXBlOiAnU3VjY2VlZCEnLFxyXG4gICAgcmVzb2x2ZTogYXN5bmMgKHtjb250ZXh0OiB7dXNlciwgYWNjZXNzVG9rZW59fSkgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIC8vIGF3YWl0IHJlZGlzLnNldChgZXhwaXJlZFRva2VuOiR7YWNjZXNzVG9rZW59YCwgdXNlci5faWQsICdFWCcsIHByb2Nlc3MuZW52LlJFRElTX1RPS0VOX0VYUElSWSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4ge3N1Y2NlZWQ6IHRydWV9O1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQge1xyXG4gICAgc2lnbkluLFxyXG4gICAgc2lnblVwLFxyXG4gICAgbG9nb3V0LFxyXG59Il19","map":{"version":3,"sources":["auth-resolvers.js"],"names":["signIn","name","type","args","phoneNumber","password","resolve","user","accessToken","authServices","error","Promise","reject","signUp","firstName","middleName","lastName","context","phoneVerification","console","log","logout","succeed"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;AACA;AAEA,MAAMA,MAAM,GAAG;AACXC,EAAAA,IAAI,EAAE,QADK;AAEXC,EAAAA,IAAI,EAAE,cAFK;AAGXC,EAAAA,IAAI,EAAE;AACFC,IAAAA,WAAW,EAAE,SADX;AAEFC,IAAAA,QAAQ,EAAE;AAFR,GAHK;AAOXC,EAAAA,OAAO,EAAE,OAAO;AAACH,IAAAA,IAAI,EAAE;AAACC,MAAAA,WAAD;AAAcC,MAAAA;AAAd;AAAP,GAAP,KAA2C;AAChD,QAAI;AAEA,YAAM;AAACE,QAAAA,IAAD;AAAOC,QAAAA;AAAP,UAAsB,MAAMC,sBAAaT,MAAb,CAAoB;AAACI,QAAAA,WAAD;AAAcC,QAAAA;AAAd,OAApB,CAAlC;AAEA,aAAO;AAACG,QAAAA,WAAD;AAAcD,QAAAA;AAAd,OAAP;AACH,KALD,CAKE,OAAOG,KAAP,EAAc;AACZ,aAAOC,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACH;AACJ;AAhBU,CAAf;AAoBA,MAAMG,MAAM,GAAG;AACXZ,EAAAA,IAAI,EAAE,QADK;AAEXC,EAAAA,IAAI,EAAE,cAFK;AAGXC,EAAAA,IAAI,EAAE;AACFW,IAAAA,SAAS,EAAE,SADT;AAEFC,IAAAA,UAAU,EAAE,SAFV;AAGFC,IAAAA,QAAQ,EAAE,SAHR;AAIFX,IAAAA,QAAQ,EAAE,SAJR;AAKFD,IAAAA,WAAW,EAAE;AALX,GAHK;AAUXE,EAAAA,OAAO,EAAE,OAAO;AACIH,IAAAA,IAAI,EAAE;AACFW,MAAAA,SADE;AAEFC,MAAAA,UAFE;AAGFC,MAAAA,QAHE;AAIFX,MAAAA,QAJE;AAKFD,MAAAA;AALE,KADV;AAQIa,IAAAA,OAAO,EAAE;AACLC,MAAAA;AADK;AARb,GAAP,KAWa;AAClB,QAAI;AAEA,YAAM;AAACV,QAAAA,WAAD;AAAcD,QAAAA;AAAd,UAAsBE,sBAAaI,MAAb,CAAoB;AAC5CC,QAAAA,SAD4C;AAE5CC,QAAAA,UAF4C;AAG5CC,QAAAA,QAH4C;AAI5CX,QAAAA,QAJ4C;AAK5CD,QAAAA;AAL4C,OAApB,CAA5B;;AAOAe,MAAAA,OAAO,CAACC,GAAR,CAAYZ,WAAZ;AACA,aAAO;AACHA,QAAAA,WADG;AAEH;AACAD,QAAAA;AAHG,OAAP;AAKH,KAfD,CAeE,OAAOG,KAAP,EAAc;AACZ,aAAOC,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACH;AACJ;AAxCU,CAAf;AA2CA,MAAMW,MAAM,GAAG;AACXpB,EAAAA,IAAI,EAAE,QADK;AAEXC,EAAAA,IAAI,EAAE,UAFK;AAGXI,EAAAA,OAAO,EAAE,OAAO;AAACW,IAAAA,OAAO,EAAE;AAACV,MAAAA,IAAD;AAAOC,MAAAA;AAAP;AAAV,GAAP,KAA0C;AAC/C,QAAI;AACA;AAEA,aAAO;AAACc,QAAAA,OAAO,EAAE;AAAV,OAAP;AACH,KAJD,CAIE,OAAOZ,KAAP,EAAc;AACZ,aAAOC,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACH;AACJ;AAXU,CAAf;eAce;AACXV,EAAAA,MADW;AAEXa,EAAAA,MAFW;AAGXQ,EAAAA;AAHW,C","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\graphql\\auth\\resolvers\\","sourcesContent":["import jwt from \"jsonwebtoken\";\r\nimport {UserModel} from \"../../../models/user\";\r\nimport authServices from \"../../../services/auth/use-cases/auth-use-cases\";\r\n// import crypto from \"crypto\";\r\n\r\nconst signIn = {\r\n    name: \"signIn\",\r\n    type: \"AccessToken!\",\r\n    args: {\r\n        phoneNumber: \"String!\",\r\n        password: \"String!\",\r\n    },\r\n    resolve: async ({args: {phoneNumber, password}}) => {\r\n        try {\r\n\r\n            const {user, accessToken} = await authServices.signIn({phoneNumber, password});\r\n\r\n            return {accessToken, user};\r\n        } catch (error) {\r\n            return Promise.reject(error);\r\n        }\r\n    },\r\n};\r\n\r\n\r\nconst signUp = {\r\n    name: \"signUp\",\r\n    type: \"AccessToken!\",\r\n    args: {\r\n        firstName: \"String!\",\r\n        middleName: \"String!\",\r\n        lastName: \"String!\",\r\n        password: \"String!\",\r\n        phoneNumber: \"String!\",\r\n    },\r\n    resolve: async ({\r\n                        args: {\r\n                            firstName,\r\n                            middleName,\r\n                            lastName,\r\n                            password,\r\n                            phoneNumber\r\n                        },\r\n                        context: {\r\n                            phoneVerification,\r\n                        },\r\n                    }) => {\r\n        try {\r\n\r\n            const {accessToken, user} = authServices.signUp({\r\n                firstName,\r\n                middleName,\r\n                lastName,\r\n                password,\r\n                phoneNumber,\r\n            });\r\n            console.log(accessToken)   \r\n            return {\r\n                accessToken,\r\n                // roles: user.roles,\r\n                user,\r\n            };\r\n        } catch (error) {\r\n            return Promise.reject(error);\r\n        }\r\n    },\r\n};\r\n\r\nconst logout = {\r\n    name: 'logout',\r\n    type: 'Succeed!',\r\n    resolve: async ({context: {user, accessToken}}) => {\r\n        try {\r\n            // await redis.set(`expiredToken:${accessToken}`, user._id, 'EX', process.env.REDIS_TOKEN_EXPIRY);\r\n\r\n            return {succeed: true};\r\n        } catch (error) {\r\n            return Promise.reject(error);\r\n        }\r\n    }\r\n};\r\n\r\nexport default {\r\n    signIn,\r\n    signUp,\r\n    logout,\r\n}"]}},"mtime":1648584005995},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\services\\\\auth\\\\use-cases\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\services\\\\auth\\\\use-cases\\\\auth-use-cases.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\n\nvar _user = require(\"../../../models/user\");\n\nvar _authDataAccess = _interopRequireDefault(require(\"../data-access/auth-data-access\"));\n\nvar _redisConfig = _interopRequireDefault(require(\"../../../config/redis-config\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// import crypto from \"crypto\";\n//load our .env file\nrequire('dotenv').config();\n\nconst signIn = async ({\n  phoneNumber,\n  password\n}) => {\n  try {\n    const user = await _authDataAccess.default.signIn({\n      phoneNumber,\n      password\n    }); //check if session exists in mongodb increase count on mongodb\n    //if session doesn't exist create a new one\n\n    const accessToken = await _jsonwebtoken.default.sign(user.toJSON(), process.env.JWT_SECRET, {\n      expiresIn: process.env.JWT_EXPIRATION\n    }); // storeNewSession(token, user information(id), count, last update)\n\n    return {\n      accessToken,\n      user\n    };\n  } catch (error) {\n    return Promise.reject(error);\n  }\n};\n\nconst signUp = async ({\n  firstName,\n  middleName,\n  lastName,\n  password,\n  phoneNumber\n}) => {\n  try {\n    const user = _authDataAccess.default.signUp({\n      firstName,\n      middleName,\n      lastName,\n      password,\n      phoneNumber\n    }); //check if there is an error\n\n\n    const accessToken = await _jsonwebtoken.default.sign(JSON.parse(JSON.stringify(user)), // roles: user.roles,\n    process.env.JWT_SECRET, {\n      expiresIn: process.env.JWT_EXPIRATION\n    }); // storeNewSession(token, user information(id), count, last update)\n\n    return {\n      accessToken,\n      user\n    };\n  } catch (error) {\n    return Promise.reject(error);\n  }\n};\n\nvar _default = {\n  signIn,\n  signUp\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGgtdXNlLWNhc2VzLmpzIl0sIm5hbWVzIjpbInJlcXVpcmUiLCJjb25maWciLCJzaWduSW4iLCJwaG9uZU51bWJlciIsInBhc3N3b3JkIiwidXNlciIsImF1dGhSZXBvc2l0b3J5IiwiYWNjZXNzVG9rZW4iLCJqd3QiLCJzaWduIiwidG9KU09OIiwicHJvY2VzcyIsImVudiIsIkpXVF9TRUNSRVQiLCJleHBpcmVzSW4iLCJKV1RfRVhQSVJBVElPTiIsImVycm9yIiwiUHJvbWlzZSIsInJlamVjdCIsInNpZ25VcCIsImZpcnN0TmFtZSIsIm1pZGRsZU5hbWUiLCJsYXN0TmFtZSIsIkpTT04iLCJwYXJzZSIsInN0cmluZ2lmeSJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOztBQUVBOztBQUNBOzs7O0FBRkE7QUFJQTtBQUNBQSxPQUFPLENBQUMsUUFBRCxDQUFQLENBQWtCQyxNQUFsQjs7QUFFQSxNQUFNQyxNQUFNLEdBQUcsT0FBTztBQUFDQyxFQUFBQSxXQUFEO0FBQWNDLEVBQUFBO0FBQWQsQ0FBUCxLQUFtQztBQUM5QyxNQUFJO0FBRUEsVUFBTUMsSUFBSSxHQUFHLE1BQU1DLHdCQUFlSixNQUFmLENBQXNCO0FBQUNDLE1BQUFBLFdBQUQ7QUFBY0MsTUFBQUE7QUFBZCxLQUF0QixDQUFuQixDQUZBLENBSUE7QUFDQTs7QUFDQSxVQUFNRyxXQUFXLEdBQUcsTUFBTUMsc0JBQUlDLElBQUosQ0FBU0osSUFBSSxDQUFDSyxNQUFMLEVBQVQsRUFBd0JDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxVQUFwQyxFQUFnRDtBQUN0RUMsTUFBQUEsU0FBUyxFQUFFSCxPQUFPLENBQUNDLEdBQVIsQ0FBWUc7QUFEK0MsS0FBaEQsQ0FBMUIsQ0FOQSxDQVVBOztBQUVBLFdBQU87QUFDSFIsTUFBQUEsV0FERztBQUVIRixNQUFBQTtBQUZHLEtBQVA7QUFJSCxHQWhCRCxDQWdCRSxPQUFPVyxLQUFQLEVBQWM7QUFDWixXQUFPQyxPQUFPLENBQUNDLE1BQVIsQ0FBZUYsS0FBZixDQUFQO0FBQ0g7QUFDSixDQXBCRDs7QUFzQkEsTUFBTUcsTUFBTSxHQUFHLE9BQU87QUFBQ0MsRUFBQUEsU0FBRDtBQUFXQyxFQUFBQSxVQUFYO0FBQXNCQyxFQUFBQSxRQUF0QjtBQUErQmxCLEVBQUFBLFFBQS9CO0FBQXdDRCxFQUFBQTtBQUF4QyxDQUFQLEtBQWdFO0FBQzNFLE1BQUk7QUFDQSxVQUFNRSxJQUFJLEdBQUdDLHdCQUFlYSxNQUFmLENBQXNCO0FBQUNDLE1BQUFBLFNBQUQ7QUFBV0MsTUFBQUEsVUFBWDtBQUFzQkMsTUFBQUEsUUFBdEI7QUFBK0JsQixNQUFBQSxRQUEvQjtBQUF3Q0QsTUFBQUE7QUFBeEMsS0FBdEIsQ0FBYixDQURBLENBR0E7OztBQUVBLFVBQU1JLFdBQVcsR0FBRyxNQUFNQyxzQkFBSUMsSUFBSixDQUN0QmMsSUFBSSxDQUFDQyxLQUFMLENBQVdELElBQUksQ0FBQ0UsU0FBTCxDQUFlcEIsSUFBZixDQUFYLENBRHNCLEVBRXRCO0FBQ0FNLElBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxVQUhVLEVBR0U7QUFDeEJDLE1BQUFBLFNBQVMsRUFBRUgsT0FBTyxDQUFDQyxHQUFSLENBQVlHO0FBREMsS0FIRixDQUExQixDQUxBLENBWUE7O0FBRUEsV0FBTztBQUNIUixNQUFBQSxXQURHO0FBRUhGLE1BQUFBO0FBRkcsS0FBUDtBQUlILEdBbEJELENBa0JFLE9BQU9XLEtBQVAsRUFBYztBQUNaLFdBQU9DLE9BQU8sQ0FBQ0MsTUFBUixDQUFlRixLQUFmLENBQVA7QUFDSDtBQUNKLENBdEJEOztlQXlCZTtBQUNYZCxFQUFBQSxNQURXO0FBRVhpQixFQUFBQTtBQUZXLEMiLCJzb3VyY2VSb290IjoiQzpcXFVzZXJzXFxSZWJiZVxcRGVza3RvcFxcaGFsZXRhLW5ldy1hcGlcXHNyY1xcc2VydmljZXNcXGF1dGhcXHVzZS1jYXNlc1xcIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGp3dCBmcm9tIFwianNvbndlYnRva2VuXCI7XHJcbmltcG9ydCB7VXNlck1vZGVsfSBmcm9tIFwiLi4vLi4vLi4vbW9kZWxzL3VzZXJcIjtcclxuLy8gaW1wb3J0IGNyeXB0byBmcm9tIFwiY3J5cHRvXCI7XHJcbmltcG9ydCBhdXRoUmVwb3NpdG9yeSBmcm9tIFwiLi4vZGF0YS1hY2Nlc3MvYXV0aC1kYXRhLWFjY2Vzc1wiO1xyXG5pbXBvcnQgY2xpZW50IGZyb20gXCIuLi8uLi8uLi9jb25maWcvcmVkaXMtY29uZmlnXCI7XHJcblxyXG4vL2xvYWQgb3VyIC5lbnYgZmlsZVxyXG5yZXF1aXJlKCdkb3RlbnYnKS5jb25maWcoKVxyXG5cclxuY29uc3Qgc2lnbkluID0gYXN5bmMgKHtwaG9uZU51bWJlciwgcGFzc3dvcmR9KSA9PiB7XHJcbiAgICB0cnkge1xyXG5cclxuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgYXV0aFJlcG9zaXRvcnkuc2lnbkluKHtwaG9uZU51bWJlciwgcGFzc3dvcmR9KTtcclxuXHJcbiAgICAgICAgLy9jaGVjayBpZiBzZXNzaW9uIGV4aXN0cyBpbiBtb25nb2RiIGluY3JlYXNlIGNvdW50IG9uIG1vbmdvZGJcclxuICAgICAgICAvL2lmIHNlc3Npb24gZG9lc24ndCBleGlzdCBjcmVhdGUgYSBuZXcgb25lXHJcbiAgICAgICAgY29uc3QgYWNjZXNzVG9rZW4gPSBhd2FpdCBqd3Quc2lnbih1c2VyLnRvSlNPTigpLCBwcm9jZXNzLmVudi5KV1RfU0VDUkVULCB7XHJcbiAgICAgICAgICAgIGV4cGlyZXNJbjogcHJvY2Vzcy5lbnYuSldUX0VYUElSQVRJT04sXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIHN0b3JlTmV3U2Vzc2lvbih0b2tlbiwgdXNlciBpbmZvcm1hdGlvbihpZCksIGNvdW50LCBsYXN0IHVwZGF0ZSlcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBhY2Nlc3NUb2tlbixcclxuICAgICAgICAgICAgdXNlcixcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xyXG4gICAgfVxyXG59XHJcblxyXG5jb25zdCBzaWduVXAgPSBhc3luYyAoe2ZpcnN0TmFtZSxtaWRkbGVOYW1lLGxhc3ROYW1lLHBhc3N3b3JkLHBob25lTnVtYmVyfSkgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB1c2VyID0gYXV0aFJlcG9zaXRvcnkuc2lnblVwKHtmaXJzdE5hbWUsbWlkZGxlTmFtZSxsYXN0TmFtZSxwYXNzd29yZCxwaG9uZU51bWJlcn0pXHJcblxyXG4gICAgICAgIC8vY2hlY2sgaWYgdGhlcmUgaXMgYW4gZXJyb3JcclxuXHJcbiAgICAgICAgY29uc3QgYWNjZXNzVG9rZW4gPSBhd2FpdCBqd3Quc2lnbihcclxuICAgICAgICAgICAgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh1c2VyKSksXHJcbiAgICAgICAgICAgIC8vIHJvbGVzOiB1c2VyLnJvbGVzLFxyXG4gICAgICAgICAgICBwcm9jZXNzLmVudi5KV1RfU0VDUkVULCB7XHJcbiAgICAgICAgICAgIGV4cGlyZXNJbjogcHJvY2Vzcy5lbnYuSldUX0VYUElSQVRJT04sXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIHN0b3JlTmV3U2Vzc2lvbih0b2tlbiwgdXNlciBpbmZvcm1hdGlvbihpZCksIGNvdW50LCBsYXN0IHVwZGF0ZSlcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgYWNjZXNzVG9rZW4sXHJcbiAgICAgICAgICAgIHVzZXIsXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTtcclxuICAgIH1cclxufVxyXG5cclxuXHJcbmV4cG9ydCBkZWZhdWx0IHtcclxuICAgIHNpZ25JbixcclxuICAgIHNpZ25VcFxyXG59Il19","map":{"version":3,"sources":["auth-use-cases.js"],"names":["require","config","signIn","phoneNumber","password","user","authRepository","accessToken","jwt","sign","toJSON","process","env","JWT_SECRET","expiresIn","JWT_EXPIRATION","error","Promise","reject","signUp","firstName","middleName","lastName","JSON","parse","stringify"],"mappings":";;;;;;;AAAA;;AACA;;AAEA;;AACA;;;;AAFA;AAIA;AACAA,OAAO,CAAC,QAAD,CAAP,CAAkBC,MAAlB;;AAEA,MAAMC,MAAM,GAAG,OAAO;AAACC,EAAAA,WAAD;AAAcC,EAAAA;AAAd,CAAP,KAAmC;AAC9C,MAAI;AAEA,UAAMC,IAAI,GAAG,MAAMC,wBAAeJ,MAAf,CAAsB;AAACC,MAAAA,WAAD;AAAcC,MAAAA;AAAd,KAAtB,CAAnB,CAFA,CAIA;AACA;;AACA,UAAMG,WAAW,GAAG,MAAMC,sBAAIC,IAAJ,CAASJ,IAAI,CAACK,MAAL,EAAT,EAAwBC,OAAO,CAACC,GAAR,CAAYC,UAApC,EAAgD;AACtEC,MAAAA,SAAS,EAAEH,OAAO,CAACC,GAAR,CAAYG;AAD+C,KAAhD,CAA1B,CANA,CAUA;;AAEA,WAAO;AACHR,MAAAA,WADG;AAEHF,MAAAA;AAFG,KAAP;AAIH,GAhBD,CAgBE,OAAOW,KAAP,EAAc;AACZ,WAAOC,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACH;AACJ,CApBD;;AAsBA,MAAMG,MAAM,GAAG,OAAO;AAACC,EAAAA,SAAD;AAAWC,EAAAA,UAAX;AAAsBC,EAAAA,QAAtB;AAA+BlB,EAAAA,QAA/B;AAAwCD,EAAAA;AAAxC,CAAP,KAAgE;AAC3E,MAAI;AACA,UAAME,IAAI,GAAGC,wBAAea,MAAf,CAAsB;AAACC,MAAAA,SAAD;AAAWC,MAAAA,UAAX;AAAsBC,MAAAA,QAAtB;AAA+BlB,MAAAA,QAA/B;AAAwCD,MAAAA;AAAxC,KAAtB,CAAb,CADA,CAGA;;;AAEA,UAAMI,WAAW,GAAG,MAAMC,sBAAIC,IAAJ,CACtBc,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAepB,IAAf,CAAX,CADsB,EAEtB;AACAM,IAAAA,OAAO,CAACC,GAAR,CAAYC,UAHU,EAGE;AACxBC,MAAAA,SAAS,EAAEH,OAAO,CAACC,GAAR,CAAYG;AADC,KAHF,CAA1B,CALA,CAYA;;AAEA,WAAO;AACHR,MAAAA,WADG;AAEHF,MAAAA;AAFG,KAAP;AAIH,GAlBD,CAkBE,OAAOW,KAAP,EAAc;AACZ,WAAOC,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACH;AACJ,CAtBD;;eAyBe;AACXd,EAAAA,MADW;AAEXiB,EAAAA;AAFW,C","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\services\\auth\\use-cases\\","sourcesContent":["import jwt from \"jsonwebtoken\";\r\nimport {UserModel} from \"../../../models/user\";\r\n// import crypto from \"crypto\";\r\nimport authRepository from \"../data-access/auth-data-access\";\r\nimport client from \"../../../config/redis-config\";\r\n\r\n//load our .env file\r\nrequire('dotenv').config()\r\n\r\nconst signIn = async ({phoneNumber, password}) => {\r\n    try {\r\n\r\n        const user = await authRepository.signIn({phoneNumber, password});\r\n\r\n        //check if session exists in mongodb increase count on mongodb\r\n        //if session doesn't exist create a new one\r\n        const accessToken = await jwt.sign(user.toJSON(), process.env.JWT_SECRET, {\r\n            expiresIn: process.env.JWT_EXPIRATION,\r\n        });\r\n\r\n        // storeNewSession(token, user information(id), count, last update)\r\n        \r\n        return {\r\n            accessToken,\r\n            user,\r\n        };\r\n    } catch (error) {\r\n        return Promise.reject(error);\r\n    }\r\n}\r\n\r\nconst signUp = async ({firstName,middleName,lastName,password,phoneNumber}) => {\r\n    try {\r\n        const user = authRepository.signUp({firstName,middleName,lastName,password,phoneNumber})\r\n\r\n        //check if there is an error\r\n\r\n        const accessToken = await jwt.sign(\r\n            JSON.parse(JSON.stringify(user)),\r\n            // roles: user.roles,\r\n            process.env.JWT_SECRET, {\r\n            expiresIn: process.env.JWT_EXPIRATION,\r\n        });\r\n\r\n        // storeNewSession(token, user information(id), count, last update)\r\n\r\n        return {\r\n            accessToken,\r\n            user,\r\n        };\r\n    } catch (error) {\r\n        return Promise.reject(error);\r\n    }\r\n}\r\n\r\n\r\nexport default {\r\n    signIn,\r\n    signUp\r\n}"]}},"mtime":1648584188002},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\services\\\\auth\\\\data-access\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\services\\\\auth\\\\data-access\\\\auth-data-access.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\n\nvar _user = require(\"../../../models/user\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// import crypto from \"crypto\";\nconst signIn = async ({\n  phoneNumber,\n  password\n}) => {\n  try {\n    const user = await _user.UserModel.findOne({\n      phoneNumber\n    }); // const comparePassword = await user.comparePassword(password.toString());\n\n    const comparePassword = password.toString() === user.password;\n\n    if (!comparePassword) {\n      return Promise.reject(new Error(\"Password is incorrect.\"));\n    }\n\n    return user;\n  } catch (error) {\n    return Promise.reject(error);\n  }\n};\n\nconst signUp = async ({\n  firstName,\n  middleName,\n  lastName,\n  phoneNumber,\n  password\n}) => {\n  try {\n    let user = await _user.UserModel.phoneNumberExist(phoneNumber);\n\n    if (user) {\n      console.log(\"here 2\");\n      return Promise.reject(new Error(\"Phone Number has already been taken.\"));\n    }\n\n    user = await _user.UserModel.emailExist(email);\n\n    if (user) {\n      return Promise.reject(new Error(\"Email has already been taken.\"));\n    }\n\n    const salt = bcrypt.genSalt(10);\n    const hash = bcrypt.hashSync(password, salt);\n    user = await new _user.UserModel({\n      firstName,\n      middleName,\n      lastName,\n      phoneNumber,\n      hash\n    }).save();\n    return user;\n  } catch (error) {\n    return Promise.reject(error);\n  }\n};\n\nvar _default = {\n  signIn,\n  signUp\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGgtZGF0YS1hY2Nlc3MuanMiXSwibmFtZXMiOlsic2lnbkluIiwicGhvbmVOdW1iZXIiLCJwYXNzd29yZCIsInVzZXIiLCJVc2VyTW9kZWwiLCJmaW5kT25lIiwiY29tcGFyZVBhc3N3b3JkIiwidG9TdHJpbmciLCJQcm9taXNlIiwicmVqZWN0IiwiRXJyb3IiLCJlcnJvciIsInNpZ25VcCIsImZpcnN0TmFtZSIsIm1pZGRsZU5hbWUiLCJsYXN0TmFtZSIsInBob25lTnVtYmVyRXhpc3QiLCJjb25zb2xlIiwibG9nIiwiZW1haWxFeGlzdCIsImVtYWlsIiwic2FsdCIsImJjcnlwdCIsImdlblNhbHQiLCJoYXNoIiwiaGFzaFN5bmMiLCJzYXZlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBQ0E7Ozs7QUFDQTtBQUVBLE1BQU1BLE1BQU0sR0FBRyxPQUFPO0FBQUVDLEVBQUFBLFdBQUY7QUFBZUMsRUFBQUE7QUFBZixDQUFQLEtBQXFDO0FBQ2xELE1BQUk7QUFDRixVQUFNQyxJQUFJLEdBQUcsTUFBTUMsZ0JBQVVDLE9BQVYsQ0FBa0I7QUFBRUosTUFBQUE7QUFBRixLQUFsQixDQUFuQixDQURFLENBR0Y7O0FBQ0EsVUFBTUssZUFBZSxHQUFJSixRQUFRLENBQUNLLFFBQVQsT0FBd0JKLElBQUksQ0FBQ0QsUUFBdEQ7O0FBQ0EsUUFBSSxDQUFDSSxlQUFMLEVBQXNCO0FBQ3BCLGFBQU9FLE9BQU8sQ0FBQ0MsTUFBUixDQUFlLElBQUlDLEtBQUosQ0FBVSx3QkFBVixDQUFmLENBQVA7QUFDRDs7QUFFRCxXQUFPUCxJQUFQO0FBQ0QsR0FWRCxDQVVFLE9BQU9RLEtBQVAsRUFBYztBQUNkLFdBQU9ILE9BQU8sQ0FBQ0MsTUFBUixDQUFlRSxLQUFmLENBQVA7QUFDRDtBQUNGLENBZEQ7O0FBZ0JBLE1BQU1DLE1BQU0sR0FBRyxPQUFPO0FBQ3BCQyxFQUFBQSxTQURvQjtBQUVwQkMsRUFBQUEsVUFGb0I7QUFHcEJDLEVBQUFBLFFBSG9CO0FBSXBCZCxFQUFBQSxXQUpvQjtBQUtwQkMsRUFBQUE7QUFMb0IsQ0FBUCxLQU1UO0FBQ0osTUFBSTtBQUVGLFFBQUlDLElBQUksR0FBRyxNQUFNQyxnQkFBVVksZ0JBQVYsQ0FBMkJmLFdBQTNCLENBQWpCOztBQUNBLFFBQUlFLElBQUosRUFBVTtBQUNOYyxNQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWSxRQUFaO0FBQ0EsYUFBT1YsT0FBTyxDQUFDQyxNQUFSLENBQWUsSUFBSUMsS0FBSixDQUFVLHNDQUFWLENBQWYsQ0FBUDtBQUNIOztBQUVEUCxJQUFBQSxJQUFJLEdBQUcsTUFBTUMsZ0JBQVVlLFVBQVYsQ0FBcUJDLEtBQXJCLENBQWI7O0FBQ0EsUUFBSWpCLElBQUosRUFBVTtBQUNSLGFBQU9LLE9BQU8sQ0FBQ0MsTUFBUixDQUFlLElBQUlDLEtBQUosQ0FBVSwrQkFBVixDQUFmLENBQVA7QUFDRDs7QUFDRCxVQUFNVyxJQUFJLEdBQUdDLE1BQU0sQ0FBQ0MsT0FBUCxDQUFlLEVBQWYsQ0FBYjtBQUNBLFVBQU1DLElBQUksR0FBR0YsTUFBTSxDQUFDRyxRQUFQLENBQWdCdkIsUUFBaEIsRUFBMEJtQixJQUExQixDQUFiO0FBRUFsQixJQUFBQSxJQUFJLEdBQUcsTUFBTSxJQUFJQyxlQUFKLENBQWM7QUFDekJTLE1BQUFBLFNBRHlCO0FBRXpCQyxNQUFBQSxVQUZ5QjtBQUd6QkMsTUFBQUEsUUFIeUI7QUFJekJkLE1BQUFBLFdBSnlCO0FBS3pCdUIsTUFBQUE7QUFMeUIsS0FBZCxFQU1WRSxJQU5VLEVBQWI7QUFRQSxXQUFPdkIsSUFBUDtBQUNELEdBeEJELENBd0JFLE9BQU9RLEtBQVAsRUFBYztBQUNkLFdBQU9ILE9BQU8sQ0FBQ0MsTUFBUixDQUFlRSxLQUFmLENBQVA7QUFDRDtBQUNGLENBbENEOztlQW9DZTtBQUNiWCxFQUFBQSxNQURhO0FBRWJZLEVBQUFBO0FBRmEsQyIsInNvdXJjZVJvb3QiOiJDOlxcVXNlcnNcXFJlYmJlXFxEZXNrdG9wXFxoYWxldGEtbmV3LWFwaVxcc3JjXFxzZXJ2aWNlc1xcYXV0aFxcZGF0YS1hY2Nlc3NcXCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBqd3QgZnJvbSBcImpzb253ZWJ0b2tlblwiO1xyXG5pbXBvcnQgeyBVc2VyTW9kZWwgfSBmcm9tIFwiLi4vLi4vLi4vbW9kZWxzL3VzZXJcIjtcclxuLy8gaW1wb3J0IGNyeXB0byBmcm9tIFwiY3J5cHRvXCI7XHJcblxyXG5jb25zdCBzaWduSW4gPSBhc3luYyAoeyBwaG9uZU51bWJlciwgcGFzc3dvcmQgfSkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlck1vZGVsLmZpbmRPbmUoeyBwaG9uZU51bWJlciB9KTtcclxuXHJcbiAgICAvLyBjb25zdCBjb21wYXJlUGFzc3dvcmQgPSBhd2FpdCB1c2VyLmNvbXBhcmVQYXNzd29yZChwYXNzd29yZC50b1N0cmluZygpKTtcclxuICAgIGNvbnN0IGNvbXBhcmVQYXNzd29yZCA9IChwYXNzd29yZC50b1N0cmluZygpID09PSB1c2VyLnBhc3N3b3JkKVxyXG4gICAgaWYgKCFjb21wYXJlUGFzc3dvcmQpIHtcclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcIlBhc3N3b3JkIGlzIGluY29ycmVjdC5cIikpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB1c2VyO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xyXG4gIH1cclxufTtcclxuXHJcbmNvbnN0IHNpZ25VcCA9IGFzeW5jICh7XHJcbiAgZmlyc3ROYW1lLFxyXG4gIG1pZGRsZU5hbWUsXHJcbiAgbGFzdE5hbWUsXHJcbiAgcGhvbmVOdW1iZXIsXHJcbiAgcGFzc3dvcmQsXHJcbn0pID0+IHtcclxuICB0cnkge1xyXG5cclxuICAgIGxldCB1c2VyID0gYXdhaXQgVXNlck1vZGVsLnBob25lTnVtYmVyRXhpc3QocGhvbmVOdW1iZXIpO1xyXG4gICAgaWYgKHVzZXIpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcImhlcmUgMlwiKVxyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoXCJQaG9uZSBOdW1iZXIgaGFzIGFscmVhZHkgYmVlbiB0YWtlbi5cIikpO1xyXG4gICAgfVxyXG5cclxuICAgIHVzZXIgPSBhd2FpdCBVc2VyTW9kZWwuZW1haWxFeGlzdChlbWFpbCk7XHJcbiAgICBpZiAodXNlcikge1xyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKFwiRW1haWwgaGFzIGFscmVhZHkgYmVlbiB0YWtlbi5cIikpO1xyXG4gICAgfVxyXG4gICAgY29uc3Qgc2FsdCA9IGJjcnlwdC5nZW5TYWx0KDEwKTtcclxuICAgIGNvbnN0IGhhc2ggPSBiY3J5cHQuaGFzaFN5bmMocGFzc3dvcmQsIHNhbHQpO1xyXG5cclxuICAgIHVzZXIgPSBhd2FpdCBuZXcgVXNlck1vZGVsKHtcclxuICAgICAgZmlyc3ROYW1lLFxyXG4gICAgICBtaWRkbGVOYW1lLFxyXG4gICAgICBsYXN0TmFtZSxcclxuICAgICAgcGhvbmVOdW1iZXIsXHJcbiAgICAgIGhhc2gsXHJcbiAgICB9KS5zYXZlKCk7XHJcblxyXG4gICAgcmV0dXJuIHVzZXI7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XHJcbiAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQge1xyXG4gIHNpZ25JbixcclxuICBzaWduVXAsXHJcbn07XHJcbiJdfQ==","map":{"version":3,"sources":["auth-data-access.js"],"names":["signIn","phoneNumber","password","user","UserModel","findOne","comparePassword","toString","Promise","reject","Error","error","signUp","firstName","middleName","lastName","phoneNumberExist","console","log","emailExist","email","salt","bcrypt","genSalt","hash","hashSync","save"],"mappings":";;;;;;;AAAA;;AACA;;;;AACA;AAEA,MAAMA,MAAM,GAAG,OAAO;AAAEC,EAAAA,WAAF;AAAeC,EAAAA;AAAf,CAAP,KAAqC;AAClD,MAAI;AACF,UAAMC,IAAI,GAAG,MAAMC,gBAAUC,OAAV,CAAkB;AAAEJ,MAAAA;AAAF,KAAlB,CAAnB,CADE,CAGF;;AACA,UAAMK,eAAe,GAAIJ,QAAQ,CAACK,QAAT,OAAwBJ,IAAI,CAACD,QAAtD;;AACA,QAAI,CAACI,eAAL,EAAsB;AACpB,aAAOE,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAU,wBAAV,CAAf,CAAP;AACD;;AAED,WAAOP,IAAP;AACD,GAVD,CAUE,OAAOQ,KAAP,EAAc;AACd,WAAOH,OAAO,CAACC,MAAR,CAAeE,KAAf,CAAP;AACD;AACF,CAdD;;AAgBA,MAAMC,MAAM,GAAG,OAAO;AACpBC,EAAAA,SADoB;AAEpBC,EAAAA,UAFoB;AAGpBC,EAAAA,QAHoB;AAIpBd,EAAAA,WAJoB;AAKpBC,EAAAA;AALoB,CAAP,KAMT;AACJ,MAAI;AAEF,QAAIC,IAAI,GAAG,MAAMC,gBAAUY,gBAAV,CAA2Bf,WAA3B,CAAjB;;AACA,QAAIE,IAAJ,EAAU;AACNc,MAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ;AACA,aAAOV,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAU,sCAAV,CAAf,CAAP;AACH;;AAEDP,IAAAA,IAAI,GAAG,MAAMC,gBAAUe,UAAV,CAAqBC,KAArB,CAAb;;AACA,QAAIjB,IAAJ,EAAU;AACR,aAAOK,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAU,+BAAV,CAAf,CAAP;AACD;;AACD,UAAMW,IAAI,GAAGC,MAAM,CAACC,OAAP,CAAe,EAAf,CAAb;AACA,UAAMC,IAAI,GAAGF,MAAM,CAACG,QAAP,CAAgBvB,QAAhB,EAA0BmB,IAA1B,CAAb;AAEAlB,IAAAA,IAAI,GAAG,MAAM,IAAIC,eAAJ,CAAc;AACzBS,MAAAA,SADyB;AAEzBC,MAAAA,UAFyB;AAGzBC,MAAAA,QAHyB;AAIzBd,MAAAA,WAJyB;AAKzBuB,MAAAA;AALyB,KAAd,EAMVE,IANU,EAAb;AAQA,WAAOvB,IAAP;AACD,GAxBD,CAwBE,OAAOQ,KAAP,EAAc;AACd,WAAOH,OAAO,CAACC,MAAR,CAAeE,KAAf,CAAP;AACD;AACF,CAlCD;;eAoCe;AACbX,EAAAA,MADa;AAEbY,EAAAA;AAFa,C","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\services\\auth\\data-access\\","sourcesContent":["import jwt from \"jsonwebtoken\";\r\nimport { UserModel } from \"../../../models/user\";\r\n// import crypto from \"crypto\";\r\n\r\nconst signIn = async ({ phoneNumber, password }) => {\r\n  try {\r\n    const user = await UserModel.findOne({ phoneNumber });\r\n\r\n    // const comparePassword = await user.comparePassword(password.toString());\r\n    const comparePassword = (password.toString() === user.password)\r\n    if (!comparePassword) {\r\n      return Promise.reject(new Error(\"Password is incorrect.\"));\r\n    }\r\n\r\n    return user;\r\n  } catch (error) {\r\n    return Promise.reject(error);\r\n  }\r\n};\r\n\r\nconst signUp = async ({\r\n  firstName,\r\n  middleName,\r\n  lastName,\r\n  phoneNumber,\r\n  password,\r\n}) => {\r\n  try {\r\n\r\n    let user = await UserModel.phoneNumberExist(phoneNumber);\r\n    if (user) {\r\n        console.log(\"here 2\")\r\n        return Promise.reject(new Error(\"Phone Number has already been taken.\"));\r\n    }\r\n\r\n    user = await UserModel.emailExist(email);\r\n    if (user) {\r\n      return Promise.reject(new Error(\"Email has already been taken.\"));\r\n    }\r\n    const salt = bcrypt.genSalt(10);\r\n    const hash = bcrypt.hashSync(password, salt);\r\n\r\n    user = await new UserModel({\r\n      firstName,\r\n      middleName,\r\n      lastName,\r\n      phoneNumber,\r\n      hash,\r\n    }).save();\r\n\r\n    return user;\r\n  } catch (error) {\r\n    return Promise.reject(error);\r\n  }\r\n};\r\n\r\nexport default {\r\n  signIn,\r\n  signUp,\r\n};\r\n"]}},"mtime":1648584230491},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\config\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\config\\\\redis-config.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _ioredis = _interopRequireDefault(require(\"ioredis\"));\n\nvar _winston = _interopRequireDefault(require(\"winston\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst client = new _ioredis.default({\n  host: process.env.REDIS_HOST,\n  port: process.env.REDIS_PORT //REDIS_PORT=6379\n\n});\nclient.on(\"error\", error => {\n  _winston.default.error(error);\n\n  client.quit().then(e => console.log(e));\n});\nclient.on(\"connect\", () => _winston.default.info(\"Redis client connected\"));\nvar _default = client;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlZGlzLWNvbmZpZy5qcyJdLCJuYW1lcyI6WyJjbGllbnQiLCJSZWRpcyIsImhvc3QiLCJwcm9jZXNzIiwiZW52IiwiUkVESVNfSE9TVCIsInBvcnQiLCJSRURJU19QT1JUIiwib24iLCJlcnJvciIsIndpbnN0b24iLCJxdWl0IiwidGhlbiIsImUiLCJjb25zb2xlIiwibG9nIiwiaW5mbyJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOzs7O0FBRUEsTUFBTUEsTUFBTSxHQUFHLElBQUlDLGdCQUFKLENBQVU7QUFDdkJDLEVBQUFBLElBQUksRUFBRUMsT0FBTyxDQUFDQyxHQUFSLENBQVlDLFVBREs7QUFFdkJDLEVBQUFBLElBQUksRUFBRUgsT0FBTyxDQUFDQyxHQUFSLENBQVlHLFVBRkssQ0FFTzs7QUFGUCxDQUFWLENBQWY7QUFLQVAsTUFBTSxDQUFDUSxFQUFQLENBQVUsT0FBVixFQUFvQkMsS0FBRCxJQUFXO0FBQzVCQyxtQkFBUUQsS0FBUixDQUFjQSxLQUFkOztBQUNBVCxFQUFBQSxNQUFNLENBQUNXLElBQVAsR0FBY0MsSUFBZCxDQUFvQkMsQ0FBRCxJQUFPQyxPQUFPLENBQUNDLEdBQVIsQ0FBWUYsQ0FBWixDQUExQjtBQUNELENBSEQ7QUFLQWIsTUFBTSxDQUFDUSxFQUFQLENBQVUsU0FBVixFQUFxQixNQUFNRSxpQkFBUU0sSUFBUixDQUFhLHdCQUFiLENBQTNCO2VBRWVoQixNIiwic291cmNlUm9vdCI6IkM6XFxVc2Vyc1xcUmViYmVcXERlc2t0b3BcXGhhbGV0YS1uZXctYXBpXFxzcmNcXGNvbmZpZ1xcIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlZGlzIGZyb20gXCJpb3JlZGlzXCI7XHJcbmltcG9ydCB3aW5zdG9uIGZyb20gXCJ3aW5zdG9uXCI7XHJcblxyXG5jb25zdCBjbGllbnQgPSBuZXcgUmVkaXMoe1xyXG4gIGhvc3Q6IHByb2Nlc3MuZW52LlJFRElTX0hPU1QsXHJcbiAgcG9ydDogcHJvY2Vzcy5lbnYuUkVESVNfUE9SVCwgLy9SRURJU19QT1JUPTYzNzlcclxufSk7XHJcblxyXG5jbGllbnQub24oXCJlcnJvclwiLCAoZXJyb3IpID0+IHtcclxuICB3aW5zdG9uLmVycm9yKGVycm9yKTtcclxuICBjbGllbnQucXVpdCgpLnRoZW4oKGUpID0+IGNvbnNvbGUubG9nKGUpKTtcclxufSk7XHJcblxyXG5jbGllbnQub24oXCJjb25uZWN0XCIsICgpID0+IHdpbnN0b24uaW5mbyhcIlJlZGlzIGNsaWVudCBjb25uZWN0ZWRcIikpO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xpZW50O1xyXG4iXX0=","map":{"version":3,"sources":["redis-config.js"],"names":["client","Redis","host","process","env","REDIS_HOST","port","REDIS_PORT","on","error","winston","quit","then","e","console","log","info"],"mappings":";;;;;;;AAAA;;AACA;;;;AAEA,MAAMA,MAAM,GAAG,IAAIC,gBAAJ,CAAU;AACvBC,EAAAA,IAAI,EAAEC,OAAO,CAACC,GAAR,CAAYC,UADK;AAEvBC,EAAAA,IAAI,EAAEH,OAAO,CAACC,GAAR,CAAYG,UAFK,CAEO;;AAFP,CAAV,CAAf;AAKAP,MAAM,CAACQ,EAAP,CAAU,OAAV,EAAoBC,KAAD,IAAW;AAC5BC,mBAAQD,KAAR,CAAcA,KAAd;;AACAT,EAAAA,MAAM,CAACW,IAAP,GAAcC,IAAd,CAAoBC,CAAD,IAAOC,OAAO,CAACC,GAAR,CAAYF,CAAZ,CAA1B;AACD,CAHD;AAKAb,MAAM,CAACQ,EAAP,CAAU,SAAV,EAAqB,MAAME,iBAAQM,IAAR,CAAa,wBAAb,CAA3B;eAEehB,M","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\config\\","sourcesContent":["import Redis from \"ioredis\";\r\nimport winston from \"winston\";\r\n\r\nconst client = new Redis({\r\n  host: process.env.REDIS_HOST,\r\n  port: process.env.REDIS_PORT, //REDIS_PORT=6379\r\n});\r\n\r\nclient.on(\"error\", (error) => {\r\n  winston.error(error);\r\n  client.quit().then((e) => console.log(e));\r\n});\r\n\r\nclient.on(\"connect\", () => winston.info(\"Redis client connected\"));\r\n\r\nexport default client;\r\n"]}},"mtime":1648588112363},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\graphql\\\\auth\\\\typedefs\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\graphql\\\\auth\\\\typedefs\\\\types.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nvar _graphqlCompose = require(\"graphql-compose\");\n\nvar _user = require(\"../../../models/user\");\n\n_graphqlCompose.schemaComposer.createObjectTC({\n  name: \"AccessToken\",\n  fields: {\n    accessToken: \"String!\",\n    user: _user.UserTC\n  }\n});\n\n_graphqlCompose.schemaComposer.createObjectTC({\n  name: \"Succeed\",\n  fields: {\n    succeed: \"Boolean!\"\n  }\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInR5cGVzLmpzIl0sIm5hbWVzIjpbInNjaGVtYUNvbXBvc2VyIiwiY3JlYXRlT2JqZWN0VEMiLCJuYW1lIiwiZmllbGRzIiwiYWNjZXNzVG9rZW4iLCJ1c2VyIiwiVXNlclRDIiwic3VjY2VlZCJdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7QUFDQTs7QUFFQUEsK0JBQWVDLGNBQWYsQ0FBOEI7QUFDMUJDLEVBQUFBLElBQUksRUFBRSxhQURvQjtBQUUxQkMsRUFBQUEsTUFBTSxFQUFFO0FBQ0pDLElBQUFBLFdBQVcsRUFBRSxTQURUO0FBRUpDLElBQUFBLElBQUksRUFBRUM7QUFGRjtBQUZrQixDQUE5Qjs7QUFRQU4sK0JBQWVDLGNBQWYsQ0FBOEI7QUFDMUJDLEVBQUFBLElBQUksRUFBRSxTQURvQjtBQUUxQkMsRUFBQUEsTUFBTSxFQUFFO0FBQUNJLElBQUFBLE9BQU8sRUFBRTtBQUFWO0FBRmtCLENBQTlCIiwic291cmNlUm9vdCI6IkM6XFxVc2Vyc1xcUmViYmVcXERlc2t0b3BcXGhhbGV0YS1uZXctYXBpXFxzcmNcXGdyYXBocWxcXGF1dGhcXHR5cGVkZWZzXFwiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge3NjaGVtYUNvbXBvc2VyfSBmcm9tIFwiZ3JhcGhxbC1jb21wb3NlXCI7XHJcbmltcG9ydCB7VXNlclRDfSBmcm9tIFwiLi4vLi4vLi4vbW9kZWxzL3VzZXJcIjtcclxuXHJcbnNjaGVtYUNvbXBvc2VyLmNyZWF0ZU9iamVjdFRDKHtcclxuICAgIG5hbWU6IFwiQWNjZXNzVG9rZW5cIixcclxuICAgIGZpZWxkczoge1xyXG4gICAgICAgIGFjY2Vzc1Rva2VuOiBcIlN0cmluZyFcIixcclxuICAgICAgICB1c2VyOiBVc2VyVEMsXHJcbiAgICB9LFxyXG59KTtcclxuXHJcbnNjaGVtYUNvbXBvc2VyLmNyZWF0ZU9iamVjdFRDKHtcclxuICAgIG5hbWU6IFwiU3VjY2VlZFwiLFxyXG4gICAgZmllbGRzOiB7c3VjY2VlZDogXCJCb29sZWFuIVwifSxcclxufSk7Il19","map":{"version":3,"sources":["types.js"],"names":["schemaComposer","createObjectTC","name","fields","accessToken","user","UserTC","succeed"],"mappings":";;AAAA;;AACA;;AAEAA,+BAAeC,cAAf,CAA8B;AAC1BC,EAAAA,IAAI,EAAE,aADoB;AAE1BC,EAAAA,MAAM,EAAE;AACJC,IAAAA,WAAW,EAAE,SADT;AAEJC,IAAAA,IAAI,EAAEC;AAFF;AAFkB,CAA9B;;AAQAN,+BAAeC,cAAf,CAA8B;AAC1BC,EAAAA,IAAI,EAAE,SADoB;AAE1BC,EAAAA,MAAM,EAAE;AAACI,IAAAA,OAAO,EAAE;AAAV;AAFkB,CAA9B","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\graphql\\auth\\typedefs\\","sourcesContent":["import {schemaComposer} from \"graphql-compose\";\r\nimport {UserTC} from \"../../../models/user\";\r\n\r\nschemaComposer.createObjectTC({\r\n    name: \"AccessToken\",\r\n    fields: {\r\n        accessToken: \"String!\",\r\n        user: UserTC,\r\n    },\r\n});\r\n\r\nschemaComposer.createObjectTC({\r\n    name: \"Succeed\",\r\n    fields: {succeed: \"Boolean!\"},\r\n});"]}},"mtime":1648583275527},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\graphql\\\\user\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\graphql\\\\user\\\\index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.UserQuery = exports.UserMutation = void 0;\n\nvar _user = require(\"../../models/user\");\n\nvar _middlewares = require(\"../../middlewares\");\n\n// import Resolvers from \"./use-cases\";\n//\n// for (const resolver in Resolvers) {\n//     UserTC.addResolver(Resolvers[resolver]);\n// }\nconst UserQuery = {\n  userById: _user.UserTC.getResolver(\"findById\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userByIds: _user.UserTC.getResolver(\"findByIds\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userOne: _user.UserTC.getResolver(\"findOne\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userMany: _user.UserTC.getResolver(\"findMany\", [_middlewares.authentication.isAuth, _middlewares.authorization])\n};\nexports.UserQuery = UserQuery;\nconst UserMutation = {\n  userCreateOne: _user.UserTC.getResolver(\"createOne\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userCreateMany: _user.UserTC.getResolver(\"createMany\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userUpdateById: _user.UserTC.getResolver(\"updateById\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userUpdateOne: _user.UserTC.getResolver(\"updateOne\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userUpdateMany: _user.UserTC.getResolver(\"updateMany\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userRemoveById: _user.UserTC.getResolver(\"removeById\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userRemoveOne: _user.UserTC.getResolver(\"removeOne\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userRemoveMany: _user.UserTC.getResolver(\"removeMany\", [_middlewares.authentication.isAuth, _middlewares.authorization])\n};\nexports.UserMutation = UserMutation;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbIlVzZXJRdWVyeSIsInVzZXJCeUlkIiwiVXNlclRDIiwiZ2V0UmVzb2x2ZXIiLCJhdXRoZW50aWNhdGlvbiIsImlzQXV0aCIsImF1dGhvcml6YXRpb24iLCJ1c2VyQnlJZHMiLCJ1c2VyT25lIiwidXNlck1hbnkiLCJVc2VyTXV0YXRpb24iLCJ1c2VyQ3JlYXRlT25lIiwidXNlckNyZWF0ZU1hbnkiLCJ1c2VyVXBkYXRlQnlJZCIsInVzZXJVcGRhdGVPbmUiLCJ1c2VyVXBkYXRlTWFueSIsInVzZXJSZW1vdmVCeUlkIiwidXNlclJlbW92ZU9uZSIsInVzZXJSZW1vdmVNYW55Il0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBRUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBLE1BQU1BLFNBQVMsR0FBRztBQUNkQyxFQUFBQSxRQUFRLEVBQUVDLGFBQU9DLFdBQVAsQ0FBbUIsVUFBbkIsRUFBK0IsQ0FBQ0MsNEJBQWVDLE1BQWhCLEVBQXdCQywwQkFBeEIsQ0FBL0IsQ0FESTtBQUVkQyxFQUFBQSxTQUFTLEVBQUVMLGFBQU9DLFdBQVAsQ0FBbUIsV0FBbkIsRUFBZ0MsQ0FBQ0MsNEJBQWVDLE1BQWhCLEVBQXdCQywwQkFBeEIsQ0FBaEMsQ0FGRztBQUdkRSxFQUFBQSxPQUFPLEVBQUVOLGFBQU9DLFdBQVAsQ0FBbUIsU0FBbkIsRUFBOEIsQ0FBQ0MsNEJBQWVDLE1BQWhCLEVBQXdCQywwQkFBeEIsQ0FBOUIsQ0FISztBQUlkRyxFQUFBQSxRQUFRLEVBQUVQLGFBQU9DLFdBQVAsQ0FBbUIsVUFBbkIsRUFBK0IsQ0FBQ0MsNEJBQWVDLE1BQWhCLEVBQXdCQywwQkFBeEIsQ0FBL0I7QUFKSSxDQUFsQjs7QUFPQSxNQUFNSSxZQUFZLEdBQUc7QUFDakJDLEVBQUFBLGFBQWEsRUFBRVQsYUFBT0MsV0FBUCxDQUFtQixXQUFuQixFQUFnQyxDQUFDQyw0QkFBZUMsTUFBaEIsRUFBd0JDLDBCQUF4QixDQUFoQyxDQURFO0FBRWpCTSxFQUFBQSxjQUFjLEVBQUVWLGFBQU9DLFdBQVAsQ0FBbUIsWUFBbkIsRUFBaUMsQ0FBQ0MsNEJBQWVDLE1BQWhCLEVBQXdCQywwQkFBeEIsQ0FBakMsQ0FGQztBQUdqQk8sRUFBQUEsY0FBYyxFQUFFWCxhQUFPQyxXQUFQLENBQW1CLFlBQW5CLEVBQWlDLENBQUNDLDRCQUFlQyxNQUFoQixFQUF3QkMsMEJBQXhCLENBQWpDLENBSEM7QUFJakJRLEVBQUFBLGFBQWEsRUFBRVosYUFBT0MsV0FBUCxDQUFtQixXQUFuQixFQUFnQyxDQUFDQyw0QkFBZUMsTUFBaEIsRUFBd0JDLDBCQUF4QixDQUFoQyxDQUpFO0FBS2pCUyxFQUFBQSxjQUFjLEVBQUViLGFBQU9DLFdBQVAsQ0FBbUIsWUFBbkIsRUFBaUMsQ0FBQ0MsNEJBQWVDLE1BQWhCLEVBQXdCQywwQkFBeEIsQ0FBakMsQ0FMQztBQU1qQlUsRUFBQUEsY0FBYyxFQUFFZCxhQUFPQyxXQUFQLENBQW1CLFlBQW5CLEVBQWlDLENBQUNDLDRCQUFlQyxNQUFoQixFQUF3QkMsMEJBQXhCLENBQWpDLENBTkM7QUFPakJXLEVBQUFBLGFBQWEsRUFBRWYsYUFBT0MsV0FBUCxDQUFtQixXQUFuQixFQUFnQyxDQUFDQyw0QkFBZUMsTUFBaEIsRUFBd0JDLDBCQUF4QixDQUFoQyxDQVBFO0FBUWpCWSxFQUFBQSxjQUFjLEVBQUVoQixhQUFPQyxXQUFQLENBQW1CLFlBQW5CLEVBQWlDLENBQUNDLDRCQUFlQyxNQUFoQixFQUF3QkMsMEJBQXhCLENBQWpDO0FBUkMsQ0FBckIiLCJzb3VyY2VSb290IjoiQzpcXFVzZXJzXFxSZWJiZVxcRGVza3RvcFxcaGFsZXRhLW5ldy1hcGlcXHNyY1xcZ3JhcGhxbFxcdXNlclxcIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtVc2VyVEN9IGZyb20gXCIuLi8uLi9tb2RlbHMvdXNlclwiO1xyXG5cclxuaW1wb3J0IHthdXRoZW50aWNhdGlvbiwgYXV0aG9yaXphdGlvbn0gZnJvbSBcIi4uLy4uL21pZGRsZXdhcmVzXCI7XHJcbi8vIGltcG9ydCBSZXNvbHZlcnMgZnJvbSBcIi4vdXNlLWNhc2VzXCI7XHJcbi8vXHJcbi8vIGZvciAoY29uc3QgcmVzb2x2ZXIgaW4gUmVzb2x2ZXJzKSB7XHJcbi8vICAgICBVc2VyVEMuYWRkUmVzb2x2ZXIoUmVzb2x2ZXJzW3Jlc29sdmVyXSk7XHJcbi8vIH1cclxuXHJcbmNvbnN0IFVzZXJRdWVyeSA9IHtcclxuICAgIHVzZXJCeUlkOiBVc2VyVEMuZ2V0UmVzb2x2ZXIoXCJmaW5kQnlJZFwiLCBbYXV0aGVudGljYXRpb24uaXNBdXRoLCBhdXRob3JpemF0aW9uXSksXHJcbiAgICB1c2VyQnlJZHM6IFVzZXJUQy5nZXRSZXNvbHZlcihcImZpbmRCeUlkc1wiLCBbYXV0aGVudGljYXRpb24uaXNBdXRoLCBhdXRob3JpemF0aW9uXSksXHJcbiAgICB1c2VyT25lOiBVc2VyVEMuZ2V0UmVzb2x2ZXIoXCJmaW5kT25lXCIsIFthdXRoZW50aWNhdGlvbi5pc0F1dGgsIGF1dGhvcml6YXRpb25dKSxcclxuICAgIHVzZXJNYW55OiBVc2VyVEMuZ2V0UmVzb2x2ZXIoXCJmaW5kTWFueVwiLCBbYXV0aGVudGljYXRpb24uaXNBdXRoLCBhdXRob3JpemF0aW9uXSksXHJcbn07XHJcblxyXG5jb25zdCBVc2VyTXV0YXRpb24gPSB7XHJcbiAgICB1c2VyQ3JlYXRlT25lOiBVc2VyVEMuZ2V0UmVzb2x2ZXIoXCJjcmVhdGVPbmVcIiwgW2F1dGhlbnRpY2F0aW9uLmlzQXV0aCwgYXV0aG9yaXphdGlvbl0pLFxyXG4gICAgdXNlckNyZWF0ZU1hbnk6IFVzZXJUQy5nZXRSZXNvbHZlcihcImNyZWF0ZU1hbnlcIiwgW2F1dGhlbnRpY2F0aW9uLmlzQXV0aCwgYXV0aG9yaXphdGlvbl0pLFxyXG4gICAgdXNlclVwZGF0ZUJ5SWQ6IFVzZXJUQy5nZXRSZXNvbHZlcihcInVwZGF0ZUJ5SWRcIiwgW2F1dGhlbnRpY2F0aW9uLmlzQXV0aCwgYXV0aG9yaXphdGlvbl0pLFxyXG4gICAgdXNlclVwZGF0ZU9uZTogVXNlclRDLmdldFJlc29sdmVyKFwidXBkYXRlT25lXCIsIFthdXRoZW50aWNhdGlvbi5pc0F1dGgsIGF1dGhvcml6YXRpb25dKSxcclxuICAgIHVzZXJVcGRhdGVNYW55OiBVc2VyVEMuZ2V0UmVzb2x2ZXIoXCJ1cGRhdGVNYW55XCIsIFthdXRoZW50aWNhdGlvbi5pc0F1dGgsIGF1dGhvcml6YXRpb25dKSxcclxuICAgIHVzZXJSZW1vdmVCeUlkOiBVc2VyVEMuZ2V0UmVzb2x2ZXIoXCJyZW1vdmVCeUlkXCIsIFthdXRoZW50aWNhdGlvbi5pc0F1dGgsIGF1dGhvcml6YXRpb25dKSxcclxuICAgIHVzZXJSZW1vdmVPbmU6IFVzZXJUQy5nZXRSZXNvbHZlcihcInJlbW92ZU9uZVwiLCBbYXV0aGVudGljYXRpb24uaXNBdXRoLCBhdXRob3JpemF0aW9uXSksXHJcbiAgICB1c2VyUmVtb3ZlTWFueTogVXNlclRDLmdldFJlc29sdmVyKFwicmVtb3ZlTWFueVwiLCBbYXV0aGVudGljYXRpb24uaXNBdXRoLCBhdXRob3JpemF0aW9uXSksXHJcbn07XHJcblxyXG5leHBvcnQge1VzZXJRdWVyeSwgVXNlck11dGF0aW9ufTtcclxuIl19","map":{"version":3,"sources":["index.js"],"names":["UserQuery","userById","UserTC","getResolver","authentication","isAuth","authorization","userByIds","userOne","userMany","UserMutation","userCreateOne","userCreateMany","userUpdateById","userUpdateOne","userUpdateMany","userRemoveById","userRemoveOne","userRemoveMany"],"mappings":";;;;;;;AAAA;;AAEA;;AACA;AACA;AACA;AACA;AACA;AAEA,MAAMA,SAAS,GAAG;AACdC,EAAAA,QAAQ,EAAEC,aAAOC,WAAP,CAAmB,UAAnB,EAA+B,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAA/B,CADI;AAEdC,EAAAA,SAAS,EAAEL,aAAOC,WAAP,CAAmB,WAAnB,EAAgC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAhC,CAFG;AAGdE,EAAAA,OAAO,EAAEN,aAAOC,WAAP,CAAmB,SAAnB,EAA8B,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAA9B,CAHK;AAIdG,EAAAA,QAAQ,EAAEP,aAAOC,WAAP,CAAmB,UAAnB,EAA+B,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAA/B;AAJI,CAAlB;;AAOA,MAAMI,YAAY,GAAG;AACjBC,EAAAA,aAAa,EAAET,aAAOC,WAAP,CAAmB,WAAnB,EAAgC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAhC,CADE;AAEjBM,EAAAA,cAAc,EAAEV,aAAOC,WAAP,CAAmB,YAAnB,EAAiC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAjC,CAFC;AAGjBO,EAAAA,cAAc,EAAEX,aAAOC,WAAP,CAAmB,YAAnB,EAAiC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAjC,CAHC;AAIjBQ,EAAAA,aAAa,EAAEZ,aAAOC,WAAP,CAAmB,WAAnB,EAAgC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAhC,CAJE;AAKjBS,EAAAA,cAAc,EAAEb,aAAOC,WAAP,CAAmB,YAAnB,EAAiC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAjC,CALC;AAMjBU,EAAAA,cAAc,EAAEd,aAAOC,WAAP,CAAmB,YAAnB,EAAiC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAjC,CANC;AAOjBW,EAAAA,aAAa,EAAEf,aAAOC,WAAP,CAAmB,WAAnB,EAAgC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAhC,CAPE;AAQjBY,EAAAA,cAAc,EAAEhB,aAAOC,WAAP,CAAmB,YAAnB,EAAiC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAjC;AARC,CAArB","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\graphql\\user\\","sourcesContent":["import {UserTC} from \"../../models/user\";\r\n\r\nimport {authentication, authorization} from \"../../middlewares\";\r\n// import Resolvers from \"./use-cases\";\r\n//\r\n// for (const resolver in Resolvers) {\r\n//     UserTC.addResolver(Resolvers[resolver]);\r\n// }\r\n\r\nconst UserQuery = {\r\n    userById: UserTC.getResolver(\"findById\", [authentication.isAuth, authorization]),\r\n    userByIds: UserTC.getResolver(\"findByIds\", [authentication.isAuth, authorization]),\r\n    userOne: UserTC.getResolver(\"findOne\", [authentication.isAuth, authorization]),\r\n    userMany: UserTC.getResolver(\"findMany\", [authentication.isAuth, authorization]),\r\n};\r\n\r\nconst UserMutation = {\r\n    userCreateOne: UserTC.getResolver(\"createOne\", [authentication.isAuth, authorization]),\r\n    userCreateMany: UserTC.getResolver(\"createMany\", [authentication.isAuth, authorization]),\r\n    userUpdateById: UserTC.getResolver(\"updateById\", [authentication.isAuth, authorization]),\r\n    userUpdateOne: UserTC.getResolver(\"updateOne\", [authentication.isAuth, authorization]),\r\n    userUpdateMany: UserTC.getResolver(\"updateMany\", [authentication.isAuth, authorization]),\r\n    userRemoveById: UserTC.getResolver(\"removeById\", [authentication.isAuth, authorization]),\r\n    userRemoveOne: UserTC.getResolver(\"removeOne\", [authentication.isAuth, authorization]),\r\n    userRemoveMany: UserTC.getResolver(\"removeMany\", [authentication.isAuth, authorization]),\r\n};\r\n\r\nexport {UserQuery, UserMutation};\r\n"]}},"mtime":1648583275528},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\config\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\config\\\\mongodb-config.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\n\nvar _dotenv = _interopRequireDefault(require(\"dotenv\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n_dotenv.default.config();\n\nmain().then(() => console.log(\"Mongoose connected\")).catch(err => console.log(err));\n\nasync function main() {\n  await _mongoose.default.connect(process.env.MONGODB_URI);\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vbmdvZGItY29uZmlnLmpzIl0sIm5hbWVzIjpbImRvdGVudiIsImNvbmZpZyIsIm1haW4iLCJ0aGVuIiwiY29uc29sZSIsImxvZyIsImNhdGNoIiwiZXJyIiwibW9uZ29vc2UiLCJjb25uZWN0IiwicHJvY2VzcyIsImVudiIsIk1PTkdPREJfVVJJIl0sIm1hcHBpbmdzIjoiOztBQUFBOztBQUNBOzs7O0FBRUFBLGdCQUFPQyxNQUFQOztBQUVBQyxJQUFJLEdBQ0NDLElBREwsQ0FDVSxNQUFNQyxPQUFPLENBQUNDLEdBQVIsQ0FBWSxvQkFBWixDQURoQixFQUVLQyxLQUZMLENBRVdDLEdBQUcsSUFBSUgsT0FBTyxDQUFDQyxHQUFSLENBQVlFLEdBQVosQ0FGbEI7O0FBSUEsZUFBZUwsSUFBZixHQUFzQjtBQUNsQixRQUFNTSxrQkFBU0MsT0FBVCxDQUFpQkMsT0FBTyxDQUFDQyxHQUFSLENBQVlDLFdBQTdCLENBQU47QUFDSCIsInNvdXJjZVJvb3QiOiJDOlxcVXNlcnNcXFJlYmJlXFxEZXNrdG9wXFxoYWxldGEtbmV3LWFwaVxcc3JjXFxjb25maWdcXCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtb25nb29zZSBmcm9tIFwibW9uZ29vc2VcIjtcclxuaW1wb3J0IGRvdGVudiBmcm9tIFwiZG90ZW52XCI7XHJcblxyXG5kb3RlbnYuY29uZmlnKCk7XHJcblxyXG5tYWluKClcclxuICAgIC50aGVuKCgpID0+IGNvbnNvbGUubG9nKFwiTW9uZ29vc2UgY29ubmVjdGVkXCIpKVxyXG4gICAgLmNhdGNoKGVyciA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxuXHJcbmFzeW5jIGZ1bmN0aW9uIG1haW4oKSB7XHJcbiAgICBhd2FpdCBtb25nb29zZS5jb25uZWN0KHByb2Nlc3MuZW52Lk1PTkdPREJfVVJJKTtcclxufSJdfQ==","map":{"version":3,"sources":["mongodb-config.js"],"names":["dotenv","config","main","then","console","log","catch","err","mongoose","connect","process","env","MONGODB_URI"],"mappings":";;AAAA;;AACA;;;;AAEAA,gBAAOC,MAAP;;AAEAC,IAAI,GACCC,IADL,CACU,MAAMC,OAAO,CAACC,GAAR,CAAY,oBAAZ,CADhB,EAEKC,KAFL,CAEWC,GAAG,IAAIH,OAAO,CAACC,GAAR,CAAYE,GAAZ,CAFlB;;AAIA,eAAeL,IAAf,GAAsB;AAClB,QAAMM,kBAASC,OAAT,CAAiBC,OAAO,CAACC,GAAR,CAAYC,WAA7B,CAAN;AACH","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\config\\","sourcesContent":["import mongoose from \"mongoose\";\r\nimport dotenv from \"dotenv\";\r\n\r\ndotenv.config();\r\n\r\nmain()\r\n    .then(() => console.log(\"Mongoose connected\"))\r\n    .catch(err => console.log(err));\r\n\r\nasync function main() {\r\n    await mongoose.connect(process.env.MONGODB_URI);\r\n}"]}},"mtime":1648583275522},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\graphql\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\graphql\\\\index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _graphqlCompose = require(\"graphql-compose\");\n\nvar _auth = require(\"./auth\");\n\nvar _user = require(\"./user\");\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nconst schemaComposer = new _graphqlCompose.SchemaComposer();\nschemaComposer.Query.addFields(_objectSpread({}, _user.UserQuery));\nschemaComposer.Mutation.addFields(_objectSpread(_objectSpread({}, _auth.AuthMutation), _user.UserMutation));\nconst schema = schemaComposer.buildSchema();\nvar _default = schema;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbInNjaGVtYUNvbXBvc2VyIiwiU2NoZW1hQ29tcG9zZXIiLCJRdWVyeSIsImFkZEZpZWxkcyIsIlVzZXJRdWVyeSIsIk11dGF0aW9uIiwiQXV0aE11dGF0aW9uIiwiVXNlck11dGF0aW9uIiwic2NoZW1hIiwiYnVpbGRTY2hlbWEiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7Ozs7Ozs7QUFFQSxNQUFNQSxjQUFjLEdBQUcsSUFBSUMsOEJBQUosRUFBdkI7QUFFQUQsY0FBYyxDQUFDRSxLQUFmLENBQXFCQyxTQUFyQixtQkFDT0MsZUFEUDtBQUlBSixjQUFjLENBQUNLLFFBQWYsQ0FBd0JGLFNBQXhCLGlDQUNPRyxrQkFEUCxHQUVPQyxrQkFGUDtBQUtBLE1BQU1DLE1BQU0sR0FBR1IsY0FBYyxDQUFDUyxXQUFmLEVBQWY7ZUFDZUQsTSIsInNvdXJjZVJvb3QiOiJDOlxcVXNlcnNcXFJlYmJlXFxEZXNrdG9wXFxoYWxldGEtbmV3LWFwaVxcc3JjXFxncmFwaHFsXFwiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1NjaGVtYUNvbXBvc2VyfSBmcm9tIFwiZ3JhcGhxbC1jb21wb3NlXCI7XHJcbmltcG9ydCB7QXV0aE11dGF0aW9ufSBmcm9tIFwiLi9hdXRoXCI7XHJcbmltcG9ydCB7VXNlck11dGF0aW9uLCBVc2VyUXVlcnl9IGZyb20gXCIuL3VzZXJcIjtcclxuXHJcbmNvbnN0IHNjaGVtYUNvbXBvc2VyID0gbmV3IFNjaGVtYUNvbXBvc2VyKCk7XHJcblxyXG5zY2hlbWFDb21wb3Nlci5RdWVyeS5hZGRGaWVsZHMoe1xyXG4gICAgLi4uVXNlclF1ZXJ5LFxyXG59KTtcclxuXHJcbnNjaGVtYUNvbXBvc2VyLk11dGF0aW9uLmFkZEZpZWxkcyh7XHJcbiAgICAuLi5BdXRoTXV0YXRpb24sXHJcbiAgICAuLi5Vc2VyTXV0YXRpb24sXHJcbn0pO1xyXG5cclxuY29uc3Qgc2NoZW1hID0gc2NoZW1hQ29tcG9zZXIuYnVpbGRTY2hlbWEoKTtcclxuZXhwb3J0IGRlZmF1bHQgc2NoZW1hO1xyXG4iXX0=","map":{"version":3,"sources":["index.js"],"names":["schemaComposer","SchemaComposer","Query","addFields","UserQuery","Mutation","AuthMutation","UserMutation","schema","buildSchema"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;;;;;AAEA,MAAMA,cAAc,GAAG,IAAIC,8BAAJ,EAAvB;AAEAD,cAAc,CAACE,KAAf,CAAqBC,SAArB,mBACOC,eADP;AAIAJ,cAAc,CAACK,QAAf,CAAwBF,SAAxB,iCACOG,kBADP,GAEOC,kBAFP;AAKA,MAAMC,MAAM,GAAGR,cAAc,CAACS,WAAf,EAAf;eACeD,M","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\graphql\\","sourcesContent":["import {SchemaComposer} from \"graphql-compose\";\r\nimport {AuthMutation} from \"./auth\";\r\nimport {UserMutation, UserQuery} from \"./user\";\r\n\r\nconst schemaComposer = new SchemaComposer();\r\n\r\nschemaComposer.Query.addFields({\r\n    ...UserQuery,\r\n});\r\n\r\nschemaComposer.Mutation.addFields({\r\n    ...AuthMutation,\r\n    ...UserMutation,\r\n});\r\n\r\nconst schema = schemaComposer.buildSchema();\r\nexport default schema;\r\n"]}},"mtime":1648583275527},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\graphql\\\\auth\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\graphql\\\\auth\\\\index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.AuthMutation = void 0;\n\nvar _user = require(\"../../models/user\");\n\nvar _middlewares = require(\"../../middlewares\");\n\nvar _authResolvers = _interopRequireDefault(require(\"./resolvers/auth-resolvers\"));\n\nrequire(\"./typedefs/types\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfor (const resolver in _authResolvers.default) {\n  _user.UserTC.addResolver(_authResolvers.default[resolver]);\n}\n\nconst AuthMutation = {\n  signIn: _user.UserTC.getResolver(\"signIn\", [_middlewares.authentication.isGuest, _middlewares.userValidator.signIn]),\n  signUp: _user.UserTC.getResolver(\"signUp\", [_middlewares.authentication.isGuest, _middlewares.userValidator.signUp]) // logout: UserTC.getResolver('logout', [middleware.isAuth]),\n  // resetPassword: UserTC.getResolver(\"resetPassword\", [middleware.isGuest, validators.resetPassword]),\n  // newPassword: UserTC.getResolver(\"newPassword\", [middleware.isGuest, validators.newPassword]),\n  // changePassword: UserTC.getResolver(\"changePassword\", [middleware.isAuth, validators.changePassword]),\n\n};\nexports.AuthMutation = AuthMutation;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbInJlc29sdmVyIiwiUmVzb2x2ZXJzIiwiVXNlclRDIiwiYWRkUmVzb2x2ZXIiLCJBdXRoTXV0YXRpb24iLCJzaWduSW4iLCJnZXRSZXNvbHZlciIsImF1dGhlbnRpY2F0aW9uIiwiaXNHdWVzdCIsInVzZXJWYWxpZGF0b3IiLCJzaWduVXAiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFFQTs7QUFFQTs7QUFFQTs7OztBQUVBLEtBQUssTUFBTUEsUUFBWCxJQUF1QkMsc0JBQXZCLEVBQWtDO0FBQzlCQyxlQUFPQyxXQUFQLENBQW1CRix1QkFBVUQsUUFBVixDQUFuQjtBQUNIOztBQUVELE1BQU1JLFlBQVksR0FBRztBQUNqQkMsRUFBQUEsTUFBTSxFQUFFSCxhQUFPSSxXQUFQLENBQW1CLFFBQW5CLEVBQTZCLENBQUNDLDRCQUFlQyxPQUFoQixFQUF5QkMsMkJBQWNKLE1BQXZDLENBQTdCLENBRFM7QUFFakJLLEVBQUFBLE1BQU0sRUFBRVIsYUFBT0ksV0FBUCxDQUFtQixRQUFuQixFQUE2QixDQUFDQyw0QkFBZUMsT0FBaEIsRUFBeUJDLDJCQUFjQyxNQUF2QyxDQUE3QixDQUZTLENBR2pCO0FBQ0E7QUFDQTtBQUNBOztBQU5pQixDQUFyQiIsInNvdXJjZVJvb3QiOiJDOlxcVXNlcnNcXFJlYmJlXFxEZXNrdG9wXFxoYWxldGEtbmV3LWFwaVxcc3JjXFxncmFwaHFsXFxhdXRoXFwiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1VzZXJUQ30gZnJvbSBcIi4uLy4uL21vZGVscy91c2VyXCI7XHJcblxyXG5pbXBvcnQgeyBhdXRoZW50aWNhdGlvbiwgdXNlclZhbGlkYXRvciB9IGZyb20gXCIuLi8uLi9taWRkbGV3YXJlc1wiO1xyXG5cclxuaW1wb3J0IFJlc29sdmVycyBmcm9tIFwiLi9yZXNvbHZlcnMvYXV0aC1yZXNvbHZlcnNcIjtcclxuXHJcbmltcG9ydCBcIi4vdHlwZWRlZnMvdHlwZXNcIlxyXG5cclxuZm9yIChjb25zdCByZXNvbHZlciBpbiBSZXNvbHZlcnMpIHtcclxuICAgIFVzZXJUQy5hZGRSZXNvbHZlcihSZXNvbHZlcnNbcmVzb2x2ZXJdKTtcclxufVxyXG5cclxuY29uc3QgQXV0aE11dGF0aW9uID0ge1xyXG4gICAgc2lnbkluOiBVc2VyVEMuZ2V0UmVzb2x2ZXIoXCJzaWduSW5cIiwgW2F1dGhlbnRpY2F0aW9uLmlzR3Vlc3QsIHVzZXJWYWxpZGF0b3Iuc2lnbkluXSksXHJcbiAgICBzaWduVXA6IFVzZXJUQy5nZXRSZXNvbHZlcihcInNpZ25VcFwiLCBbYXV0aGVudGljYXRpb24uaXNHdWVzdCwgdXNlclZhbGlkYXRvci5zaWduVXBdKSxcclxuICAgIC8vIGxvZ291dDogVXNlclRDLmdldFJlc29sdmVyKCdsb2dvdXQnLCBbbWlkZGxld2FyZS5pc0F1dGhdKSxcclxuICAgIC8vIHJlc2V0UGFzc3dvcmQ6IFVzZXJUQy5nZXRSZXNvbHZlcihcInJlc2V0UGFzc3dvcmRcIiwgW21pZGRsZXdhcmUuaXNHdWVzdCwgdmFsaWRhdG9ycy5yZXNldFBhc3N3b3JkXSksXHJcbiAgICAvLyBuZXdQYXNzd29yZDogVXNlclRDLmdldFJlc29sdmVyKFwibmV3UGFzc3dvcmRcIiwgW21pZGRsZXdhcmUuaXNHdWVzdCwgdmFsaWRhdG9ycy5uZXdQYXNzd29yZF0pLFxyXG4gICAgLy8gY2hhbmdlUGFzc3dvcmQ6IFVzZXJUQy5nZXRSZXNvbHZlcihcImNoYW5nZVBhc3N3b3JkXCIsIFttaWRkbGV3YXJlLmlzQXV0aCwgdmFsaWRhdG9ycy5jaGFuZ2VQYXNzd29yZF0pLFxyXG59O1xyXG5cclxuZXhwb3J0IHtBdXRoTXV0YXRpb259O1xyXG4iXX0=","map":{"version":3,"sources":["index.js"],"names":["resolver","Resolvers","UserTC","addResolver","AuthMutation","signIn","getResolver","authentication","isGuest","userValidator","signUp"],"mappings":";;;;;;;AAAA;;AAEA;;AAEA;;AAEA;;;;AAEA,KAAK,MAAMA,QAAX,IAAuBC,sBAAvB,EAAkC;AAC9BC,eAAOC,WAAP,CAAmBF,uBAAUD,QAAV,CAAnB;AACH;;AAED,MAAMI,YAAY,GAAG;AACjBC,EAAAA,MAAM,EAAEH,aAAOI,WAAP,CAAmB,QAAnB,EAA6B,CAACC,4BAAeC,OAAhB,EAAyBC,2BAAcJ,MAAvC,CAA7B,CADS;AAEjBK,EAAAA,MAAM,EAAER,aAAOI,WAAP,CAAmB,QAAnB,EAA6B,CAACC,4BAAeC,OAAhB,EAAyBC,2BAAcC,MAAvC,CAA7B,CAFS,CAGjB;AACA;AACA;AACA;;AANiB,CAArB","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\graphql\\auth\\","sourcesContent":["import {UserTC} from \"../../models/user\";\r\n\r\nimport { authentication, userValidator } from \"../../middlewares\";\r\n\r\nimport Resolvers from \"./resolvers/auth-resolvers\";\r\n\r\nimport \"./typedefs/types\"\r\n\r\nfor (const resolver in Resolvers) {\r\n    UserTC.addResolver(Resolvers[resolver]);\r\n}\r\n\r\nconst AuthMutation = {\r\n    signIn: UserTC.getResolver(\"signIn\", [authentication.isGuest, userValidator.signIn]),\r\n    signUp: UserTC.getResolver(\"signUp\", [authentication.isGuest, userValidator.signUp]),\r\n    // logout: UserTC.getResolver('logout', [middleware.isAuth]),\r\n    // resetPassword: UserTC.getResolver(\"resetPassword\", [middleware.isGuest, validators.resetPassword]),\r\n    // newPassword: UserTC.getResolver(\"newPassword\", [middleware.isGuest, validators.newPassword]),\r\n    // changePassword: UserTC.getResolver(\"changePassword\", [middleware.isAuth, validators.changePassword]),\r\n};\r\n\r\nexport {AuthMutation};\r\n"]}},"mtime":1648583440807},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\models\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\models\\\\user.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.UserTC = exports.UserSchema = exports.UserModel = void 0;\n\nvar _mongoose = _interopRequireWildcard(require(\"mongoose\"));\n\nvar _mongooseTimestamp = _interopRequireDefault(require(\"mongoose-timestamp\"));\n\nvar _graphqlComposeMongoose = require(\"graphql-compose-mongoose\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nconst UserSchema = new _mongoose.Schema({\n  firstName: String,\n  middleName: String,\n  lastName: String,\n  email: String,\n  phoneNumber: String,\n  image: String,\n  firebaseId: String,\n  password: String,\n  status: {\n    type: String,\n    default: \"ACTIVE\",\n    enum: [\"ACTIVE\", \"BLOCKED\"]\n  },\n  roles: {\n    type: String,\n    default: \"NORMAL\",\n    enum: [\"NORMAL\", \"OWNER\", \"ADMIN\", \"SALES\"]\n  },\n  account: {\n    verification: {\n      verified: {\n        type: Boolean,\n        default: false\n      },\n      token: String,\n      expiresIn: Date\n    },\n    emailVerification: {\n      verified: {\n        type: Boolean,\n        default: false\n      },\n      token: String,\n      expiresIn: Date\n    },\n    phoneVerification: {\n      verified: {\n        type: Boolean,\n        default: false\n      },\n      token: String,\n      expiresIn: Date\n    },\n    resetPassword: {\n      token: String,\n      expiresIn: Date\n    }\n  }\n}, {\n  collection: \"users\"\n});\nexports.UserSchema = UserSchema;\nUserSchema.plugin(_mongooseTimestamp.default);\nUserSchema.index({\n  createdAt: 1,\n  updatedAt: 1\n});\n\nUserSchema.statics.emailExist = function (email) {\n  return this.findOne({\n    email\n  });\n};\n\nUserSchema.statics.phoneNumberExist = function (phoneNumber) {\n  return this.findOne({\n    phoneNumber\n  });\n};\n\nUserSchema.methods.comparePassword = function (password) {\n  return bcrypt.compareSync(password, this.password);\n};\n\nconst UserModel = _mongoose.default.model(\"User\", UserSchema);\n\nexports.UserModel = UserModel;\nconst UserTC = (0, _graphqlComposeMongoose.composeWithMongoose)(UserModel); // const UserTC = composeWithMongoose(UserModel).removeField('password');\n\nexports.UserTC = UserTC;\nconst UserAccountTC = UserTC.getFieldTC(\"account\");\nUserAccountTC.getFieldTC(\"verification\").removeField([\"token\", \"expiresIn\"]); // UserAccountTC.removeField('resetPassword');\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXIuanMiXSwibmFtZXMiOlsiVXNlclNjaGVtYSIsIlNjaGVtYSIsImZpcnN0TmFtZSIsIlN0cmluZyIsIm1pZGRsZU5hbWUiLCJsYXN0TmFtZSIsImVtYWlsIiwicGhvbmVOdW1iZXIiLCJpbWFnZSIsImZpcmViYXNlSWQiLCJwYXNzd29yZCIsInN0YXR1cyIsInR5cGUiLCJkZWZhdWx0IiwiZW51bSIsInJvbGVzIiwiYWNjb3VudCIsInZlcmlmaWNhdGlvbiIsInZlcmlmaWVkIiwiQm9vbGVhbiIsInRva2VuIiwiZXhwaXJlc0luIiwiRGF0ZSIsImVtYWlsVmVyaWZpY2F0aW9uIiwicGhvbmVWZXJpZmljYXRpb24iLCJyZXNldFBhc3N3b3JkIiwiY29sbGVjdGlvbiIsInBsdWdpbiIsInRpbWVzdGFtcHMiLCJpbmRleCIsImNyZWF0ZWRBdCIsInVwZGF0ZWRBdCIsInN0YXRpY3MiLCJlbWFpbEV4aXN0IiwiZmluZE9uZSIsInBob25lTnVtYmVyRXhpc3QiLCJtZXRob2RzIiwiY29tcGFyZVBhc3N3b3JkIiwiYmNyeXB0IiwiY29tcGFyZVN5bmMiLCJVc2VyTW9kZWwiLCJtb25nb29zZSIsIm1vZGVsIiwiVXNlclRDIiwiVXNlckFjY291bnRUQyIsImdldEZpZWxkVEMiLCJyZW1vdmVGaWVsZCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOztBQUNBOzs7Ozs7OztBQUVBLE1BQU1BLFVBQVUsR0FBRyxJQUFJQyxnQkFBSixDQUFXO0FBQzFCQyxFQUFBQSxTQUFTLEVBQUVDLE1BRGU7QUFFMUJDLEVBQUFBLFVBQVUsRUFBRUQsTUFGYztBQUcxQkUsRUFBQUEsUUFBUSxFQUFFRixNQUhnQjtBQUkxQkcsRUFBQUEsS0FBSyxFQUFFSCxNQUptQjtBQUsxQkksRUFBQUEsV0FBVyxFQUFFSixNQUxhO0FBTTFCSyxFQUFBQSxLQUFLLEVBQUVMLE1BTm1CO0FBTzFCTSxFQUFBQSxVQUFVLEVBQUVOLE1BUGM7QUFRMUJPLEVBQUFBLFFBQVEsRUFBRVAsTUFSZ0I7QUFTMUJRLEVBQUFBLE1BQU0sRUFBRTtBQUNKQyxJQUFBQSxJQUFJLEVBQUVULE1BREY7QUFFSlUsSUFBQUEsT0FBTyxFQUFFLFFBRkw7QUFHSkMsSUFBQUEsSUFBSSxFQUFFLENBQUMsUUFBRCxFQUFXLFNBQVg7QUFIRixHQVRrQjtBQWMxQkMsRUFBQUEsS0FBSyxFQUFFO0FBQ0hILElBQUFBLElBQUksRUFBRVQsTUFESDtBQUVIVSxJQUFBQSxPQUFPLEVBQUUsUUFGTjtBQUdIQyxJQUFBQSxJQUFJLEVBQUUsQ0FBQyxRQUFELEVBQVcsT0FBWCxFQUFvQixPQUFwQixFQUE2QixPQUE3QjtBQUhILEdBZG1CO0FBbUIxQkUsRUFBQUEsT0FBTyxFQUFFO0FBQ0xDLElBQUFBLFlBQVksRUFBRTtBQUNWQyxNQUFBQSxRQUFRLEVBQUU7QUFDTk4sUUFBQUEsSUFBSSxFQUFFTyxPQURBO0FBRU5OLFFBQUFBLE9BQU8sRUFBRTtBQUZILE9BREE7QUFLVk8sTUFBQUEsS0FBSyxFQUFFakIsTUFMRztBQU1Wa0IsTUFBQUEsU0FBUyxFQUFFQztBQU5ELEtBRFQ7QUFTTEMsSUFBQUEsaUJBQWlCLEVBQUU7QUFDZkwsTUFBQUEsUUFBUSxFQUFFO0FBQ05OLFFBQUFBLElBQUksRUFBRU8sT0FEQTtBQUVOTixRQUFBQSxPQUFPLEVBQUU7QUFGSCxPQURLO0FBS2ZPLE1BQUFBLEtBQUssRUFBRWpCLE1BTFE7QUFNZmtCLE1BQUFBLFNBQVMsRUFBRUM7QUFOSSxLQVRkO0FBaUJMRSxJQUFBQSxpQkFBaUIsRUFBRTtBQUNmTixNQUFBQSxRQUFRLEVBQUU7QUFDTk4sUUFBQUEsSUFBSSxFQUFFTyxPQURBO0FBRU5OLFFBQUFBLE9BQU8sRUFBRTtBQUZILE9BREs7QUFLZk8sTUFBQUEsS0FBSyxFQUFFakIsTUFMUTtBQU1ma0IsTUFBQUEsU0FBUyxFQUFFQztBQU5JLEtBakJkO0FBeUJMRyxJQUFBQSxhQUFhLEVBQUU7QUFDWEwsTUFBQUEsS0FBSyxFQUFFakIsTUFESTtBQUVYa0IsTUFBQUEsU0FBUyxFQUFFQztBQUZBO0FBekJWO0FBbkJpQixDQUFYLEVBaURoQjtBQUNDSSxFQUFBQSxVQUFVLEVBQUU7QUFEYixDQWpEZ0IsQ0FBbkI7O0FBcURBMUIsVUFBVSxDQUFDMkIsTUFBWCxDQUFrQkMsMEJBQWxCO0FBQ0E1QixVQUFVLENBQUM2QixLQUFYLENBQWlCO0FBQ2JDLEVBQUFBLFNBQVMsRUFBRSxDQURFO0FBRWJDLEVBQUFBLFNBQVMsRUFBRTtBQUZFLENBQWpCOztBQUtBL0IsVUFBVSxDQUFDZ0MsT0FBWCxDQUFtQkMsVUFBbkIsR0FBZ0MsVUFBVTNCLEtBQVYsRUFBaUI7QUFDN0MsU0FBTyxLQUFLNEIsT0FBTCxDQUFhO0FBQUM1QixJQUFBQTtBQUFELEdBQWIsQ0FBUDtBQUNILENBRkQ7O0FBSUFOLFVBQVUsQ0FBQ2dDLE9BQVgsQ0FBbUJHLGdCQUFuQixHQUFzQyxVQUFVNUIsV0FBVixFQUF1QjtBQUN6RCxTQUFPLEtBQUsyQixPQUFMLENBQWE7QUFBQzNCLElBQUFBO0FBQUQsR0FBYixDQUFQO0FBQ0gsQ0FGRDs7QUFJQVAsVUFBVSxDQUFDb0MsT0FBWCxDQUFtQkMsZUFBbkIsR0FBcUMsVUFBVTNCLFFBQVYsRUFBb0I7QUFDckQsU0FBTzRCLE1BQU0sQ0FBQ0MsV0FBUCxDQUFtQjdCLFFBQW5CLEVBQTZCLEtBQUtBLFFBQWxDLENBQVA7QUFDSCxDQUZEOztBQUlBLE1BQU04QixTQUFTLEdBQUdDLGtCQUFTQyxLQUFULENBQWUsTUFBZixFQUF1QjFDLFVBQXZCLENBQWxCOzs7QUFDQSxNQUFNMkMsTUFBTSxHQUFHLGlEQUFvQkgsU0FBcEIsQ0FBZixDLENBQ0E7OztBQUVBLE1BQU1JLGFBQWEsR0FBR0QsTUFBTSxDQUFDRSxVQUFQLENBQWtCLFNBQWxCLENBQXRCO0FBRUFELGFBQWEsQ0FBQ0MsVUFBZCxDQUF5QixjQUF6QixFQUF5Q0MsV0FBekMsQ0FBcUQsQ0FBQyxPQUFELEVBQVUsV0FBVixDQUFyRCxFLENBRUEiLCJzb3VyY2VSb290IjoiQzpcXFVzZXJzXFxSZWJiZVxcRGVza3RvcFxcaGFsZXRhLW5ldy1hcGlcXHNyY1xcbW9kZWxzXFwiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9uZ29vc2UsIHtTY2hlbWF9IGZyb20gXCJtb25nb29zZVwiO1xyXG5pbXBvcnQgdGltZXN0YW1wcyBmcm9tIFwibW9uZ29vc2UtdGltZXN0YW1wXCI7XHJcbmltcG9ydCB7Y29tcG9zZVdpdGhNb25nb29zZX0gZnJvbSBcImdyYXBocWwtY29tcG9zZS1tb25nb29zZVwiO1xyXG5cclxuY29uc3QgVXNlclNjaGVtYSA9IG5ldyBTY2hlbWEoe1xyXG4gICAgZmlyc3ROYW1lOiBTdHJpbmcsXHJcbiAgICBtaWRkbGVOYW1lOiBTdHJpbmcsXHJcbiAgICBsYXN0TmFtZTogU3RyaW5nLFxyXG4gICAgZW1haWw6IFN0cmluZyxcclxuICAgIHBob25lTnVtYmVyOiBTdHJpbmcsXHJcbiAgICBpbWFnZTogU3RyaW5nLFxyXG4gICAgZmlyZWJhc2VJZDogU3RyaW5nLFxyXG4gICAgcGFzc3dvcmQ6IFN0cmluZyxcclxuICAgIHN0YXR1czoge1xyXG4gICAgICAgIHR5cGU6IFN0cmluZyxcclxuICAgICAgICBkZWZhdWx0OiBcIkFDVElWRVwiLFxyXG4gICAgICAgIGVudW06IFtcIkFDVElWRVwiLCBcIkJMT0NLRURcIl0sXHJcbiAgICB9LFxyXG4gICAgcm9sZXM6IHtcclxuICAgICAgICB0eXBlOiBTdHJpbmcsXHJcbiAgICAgICAgZGVmYXVsdDogXCJOT1JNQUxcIixcclxuICAgICAgICBlbnVtOiBbXCJOT1JNQUxcIiwgXCJPV05FUlwiLCBcIkFETUlOXCIsIFwiU0FMRVNcIl0sXHJcbiAgICB9LFxyXG4gICAgYWNjb3VudDoge1xyXG4gICAgICAgIHZlcmlmaWNhdGlvbjoge1xyXG4gICAgICAgICAgICB2ZXJpZmllZDoge1xyXG4gICAgICAgICAgICAgICAgdHlwZTogQm9vbGVhbixcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0b2tlbjogU3RyaW5nLFxyXG4gICAgICAgICAgICBleHBpcmVzSW46IERhdGUsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBlbWFpbFZlcmlmaWNhdGlvbjoge1xyXG4gICAgICAgICAgICB2ZXJpZmllZDoge1xyXG4gICAgICAgICAgICAgICAgdHlwZTogQm9vbGVhbixcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0b2tlbjogU3RyaW5nLFxyXG4gICAgICAgICAgICBleHBpcmVzSW46IERhdGUsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBwaG9uZVZlcmlmaWNhdGlvbjoge1xyXG4gICAgICAgICAgICB2ZXJpZmllZDoge1xyXG4gICAgICAgICAgICAgICAgdHlwZTogQm9vbGVhbixcclxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0b2tlbjogU3RyaW5nLFxyXG4gICAgICAgICAgICBleHBpcmVzSW46IERhdGUsXHJcbiAgICAgICAgfSxcclxuICAgICAgICByZXNldFBhc3N3b3JkOiB7XHJcbiAgICAgICAgICAgIHRva2VuOiBTdHJpbmcsXHJcbiAgICAgICAgICAgIGV4cGlyZXNJbjogRGF0ZSxcclxuICAgICAgICB9LFxyXG4gICAgfSxcclxufSwge1xyXG4gICAgY29sbGVjdGlvbjogXCJ1c2Vyc1wiLFxyXG59KTtcclxuXHJcblVzZXJTY2hlbWEucGx1Z2luKHRpbWVzdGFtcHMpO1xyXG5Vc2VyU2NoZW1hLmluZGV4KHtcclxuICAgIGNyZWF0ZWRBdDogMSxcclxuICAgIHVwZGF0ZWRBdDogMSxcclxufSk7XHJcblxyXG5Vc2VyU2NoZW1hLnN0YXRpY3MuZW1haWxFeGlzdCA9IGZ1bmN0aW9uIChlbWFpbCkge1xyXG4gICAgcmV0dXJuIHRoaXMuZmluZE9uZSh7ZW1haWx9KTtcclxufTtcclxuXHJcblVzZXJTY2hlbWEuc3RhdGljcy5waG9uZU51bWJlckV4aXN0ID0gZnVuY3Rpb24gKHBob25lTnVtYmVyKSB7XHJcbiAgICByZXR1cm4gdGhpcy5maW5kT25lKHtwaG9uZU51bWJlcn0pO1xyXG59O1xyXG5cclxuVXNlclNjaGVtYS5tZXRob2RzLmNvbXBhcmVQYXNzd29yZCA9IGZ1bmN0aW9uIChwYXNzd29yZCkge1xyXG4gICAgcmV0dXJuIGJjcnlwdC5jb21wYXJlU3luYyhwYXNzd29yZCwgdGhpcy5wYXNzd29yZCk7XHJcbn07XHJcblxyXG5jb25zdCBVc2VyTW9kZWwgPSBtb25nb29zZS5tb2RlbChcIlVzZXJcIiwgVXNlclNjaGVtYSk7XHJcbmNvbnN0IFVzZXJUQyA9IGNvbXBvc2VXaXRoTW9uZ29vc2UoVXNlck1vZGVsKTtcclxuLy8gY29uc3QgVXNlclRDID0gY29tcG9zZVdpdGhNb25nb29zZShVc2VyTW9kZWwpLnJlbW92ZUZpZWxkKCdwYXNzd29yZCcpO1xyXG5cclxuY29uc3QgVXNlckFjY291bnRUQyA9IFVzZXJUQy5nZXRGaWVsZFRDKFwiYWNjb3VudFwiKTtcclxuXHJcblVzZXJBY2NvdW50VEMuZ2V0RmllbGRUQyhcInZlcmlmaWNhdGlvblwiKS5yZW1vdmVGaWVsZChbXCJ0b2tlblwiLCBcImV4cGlyZXNJblwiXSk7XHJcblxyXG4vLyBVc2VyQWNjb3VudFRDLnJlbW92ZUZpZWxkKCdyZXNldFBhc3N3b3JkJyk7XHJcblxyXG5leHBvcnQge1VzZXJNb2RlbCwgVXNlclRDLCBVc2VyU2NoZW1hfTtcclxuIl19","map":{"version":3,"sources":["user.js"],"names":["UserSchema","Schema","firstName","String","middleName","lastName","email","phoneNumber","image","firebaseId","password","status","type","default","enum","roles","account","verification","verified","Boolean","token","expiresIn","Date","emailVerification","phoneVerification","resetPassword","collection","plugin","timestamps","index","createdAt","updatedAt","statics","emailExist","findOne","phoneNumberExist","methods","comparePassword","bcrypt","compareSync","UserModel","mongoose","model","UserTC","UserAccountTC","getFieldTC","removeField"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;;;;;AAEA,MAAMA,UAAU,GAAG,IAAIC,gBAAJ,CAAW;AAC1BC,EAAAA,SAAS,EAAEC,MADe;AAE1BC,EAAAA,UAAU,EAAED,MAFc;AAG1BE,EAAAA,QAAQ,EAAEF,MAHgB;AAI1BG,EAAAA,KAAK,EAAEH,MAJmB;AAK1BI,EAAAA,WAAW,EAAEJ,MALa;AAM1BK,EAAAA,KAAK,EAAEL,MANmB;AAO1BM,EAAAA,UAAU,EAAEN,MAPc;AAQ1BO,EAAAA,QAAQ,EAAEP,MARgB;AAS1BQ,EAAAA,MAAM,EAAE;AACJC,IAAAA,IAAI,EAAET,MADF;AAEJU,IAAAA,OAAO,EAAE,QAFL;AAGJC,IAAAA,IAAI,EAAE,CAAC,QAAD,EAAW,SAAX;AAHF,GATkB;AAc1BC,EAAAA,KAAK,EAAE;AACHH,IAAAA,IAAI,EAAET,MADH;AAEHU,IAAAA,OAAO,EAAE,QAFN;AAGHC,IAAAA,IAAI,EAAE,CAAC,QAAD,EAAW,OAAX,EAAoB,OAApB,EAA6B,OAA7B;AAHH,GAdmB;AAmB1BE,EAAAA,OAAO,EAAE;AACLC,IAAAA,YAAY,EAAE;AACVC,MAAAA,QAAQ,EAAE;AACNN,QAAAA,IAAI,EAAEO,OADA;AAENN,QAAAA,OAAO,EAAE;AAFH,OADA;AAKVO,MAAAA,KAAK,EAAEjB,MALG;AAMVkB,MAAAA,SAAS,EAAEC;AAND,KADT;AASLC,IAAAA,iBAAiB,EAAE;AACfL,MAAAA,QAAQ,EAAE;AACNN,QAAAA,IAAI,EAAEO,OADA;AAENN,QAAAA,OAAO,EAAE;AAFH,OADK;AAKfO,MAAAA,KAAK,EAAEjB,MALQ;AAMfkB,MAAAA,SAAS,EAAEC;AANI,KATd;AAiBLE,IAAAA,iBAAiB,EAAE;AACfN,MAAAA,QAAQ,EAAE;AACNN,QAAAA,IAAI,EAAEO,OADA;AAENN,QAAAA,OAAO,EAAE;AAFH,OADK;AAKfO,MAAAA,KAAK,EAAEjB,MALQ;AAMfkB,MAAAA,SAAS,EAAEC;AANI,KAjBd;AAyBLG,IAAAA,aAAa,EAAE;AACXL,MAAAA,KAAK,EAAEjB,MADI;AAEXkB,MAAAA,SAAS,EAAEC;AAFA;AAzBV;AAnBiB,CAAX,EAiDhB;AACCI,EAAAA,UAAU,EAAE;AADb,CAjDgB,CAAnB;;AAqDA1B,UAAU,CAAC2B,MAAX,CAAkBC,0BAAlB;AACA5B,UAAU,CAAC6B,KAAX,CAAiB;AACbC,EAAAA,SAAS,EAAE,CADE;AAEbC,EAAAA,SAAS,EAAE;AAFE,CAAjB;;AAKA/B,UAAU,CAACgC,OAAX,CAAmBC,UAAnB,GAAgC,UAAU3B,KAAV,EAAiB;AAC7C,SAAO,KAAK4B,OAAL,CAAa;AAAC5B,IAAAA;AAAD,GAAb,CAAP;AACH,CAFD;;AAIAN,UAAU,CAACgC,OAAX,CAAmBG,gBAAnB,GAAsC,UAAU5B,WAAV,EAAuB;AACzD,SAAO,KAAK2B,OAAL,CAAa;AAAC3B,IAAAA;AAAD,GAAb,CAAP;AACH,CAFD;;AAIAP,UAAU,CAACoC,OAAX,CAAmBC,eAAnB,GAAqC,UAAU3B,QAAV,EAAoB;AACrD,SAAO4B,MAAM,CAACC,WAAP,CAAmB7B,QAAnB,EAA6B,KAAKA,QAAlC,CAAP;AACH,CAFD;;AAIA,MAAM8B,SAAS,GAAGC,kBAASC,KAAT,CAAe,MAAf,EAAuB1C,UAAvB,CAAlB;;;AACA,MAAM2C,MAAM,GAAG,iDAAoBH,SAApB,CAAf,C,CACA;;;AAEA,MAAMI,aAAa,GAAGD,MAAM,CAACE,UAAP,CAAkB,SAAlB,CAAtB;AAEAD,aAAa,CAACC,UAAd,CAAyB,cAAzB,EAAyCC,WAAzC,CAAqD,CAAC,OAAD,EAAU,WAAV,CAArD,E,CAEA","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\models\\","sourcesContent":["import mongoose, {Schema} from \"mongoose\";\r\nimport timestamps from \"mongoose-timestamp\";\r\nimport {composeWithMongoose} from \"graphql-compose-mongoose\";\r\n\r\nconst UserSchema = new Schema({\r\n    firstName: String,\r\n    middleName: String,\r\n    lastName: String,\r\n    email: String,\r\n    phoneNumber: String,\r\n    image: String,\r\n    firebaseId: String,\r\n    password: String,\r\n    status: {\r\n        type: String,\r\n        default: \"ACTIVE\",\r\n        enum: [\"ACTIVE\", \"BLOCKED\"],\r\n    },\r\n    roles: {\r\n        type: String,\r\n        default: \"NORMAL\",\r\n        enum: [\"NORMAL\", \"OWNER\", \"ADMIN\", \"SALES\"],\r\n    },\r\n    account: {\r\n        verification: {\r\n            verified: {\r\n                type: Boolean,\r\n                default: false,\r\n            },\r\n            token: String,\r\n            expiresIn: Date,\r\n        },\r\n        emailVerification: {\r\n            verified: {\r\n                type: Boolean,\r\n                default: false,\r\n            },\r\n            token: String,\r\n            expiresIn: Date,\r\n        },\r\n        phoneVerification: {\r\n            verified: {\r\n                type: Boolean,\r\n                default: false,\r\n            },\r\n            token: String,\r\n            expiresIn: Date,\r\n        },\r\n        resetPassword: {\r\n            token: String,\r\n            expiresIn: Date,\r\n        },\r\n    },\r\n}, {\r\n    collection: \"users\",\r\n});\r\n\r\nUserSchema.plugin(timestamps);\r\nUserSchema.index({\r\n    createdAt: 1,\r\n    updatedAt: 1,\r\n});\r\n\r\nUserSchema.statics.emailExist = function (email) {\r\n    return this.findOne({email});\r\n};\r\n\r\nUserSchema.statics.phoneNumberExist = function (phoneNumber) {\r\n    return this.findOne({phoneNumber});\r\n};\r\n\r\nUserSchema.methods.comparePassword = function (password) {\r\n    return bcrypt.compareSync(password, this.password);\r\n};\r\n\r\nconst UserModel = mongoose.model(\"User\", UserSchema);\r\nconst UserTC = composeWithMongoose(UserModel);\r\n// const UserTC = composeWithMongoose(UserModel).removeField('password');\r\n\r\nconst UserAccountTC = UserTC.getFieldTC(\"account\");\r\n\r\nUserAccountTC.getFieldTC(\"verification\").removeField([\"token\", \"expiresIn\"]);\r\n\r\n// UserAccountTC.removeField('resetPassword');\r\n\r\nexport {UserModel, UserTC, UserSchema};\r\n"]}},"mtime":1648583275536},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\middlewares\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\middlewares\\\\index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"authentication\", {\n  enumerable: true,\n  get: function () {\n    return _authentication.default;\n  }\n});\nObject.defineProperty(exports, \"authorization\", {\n  enumerable: true,\n  get: function () {\n    return _authorization.default;\n  }\n});\nObject.defineProperty(exports, \"phoneVerification\", {\n  enumerable: true,\n  get: function () {\n    return _phoneVerification.default;\n  }\n});\nObject.defineProperty(exports, \"userValidator\", {\n  enumerable: true,\n  get: function () {\n    return _userValidator.default;\n  }\n});\nObject.defineProperty(exports, \"validateToken\", {\n  enumerable: true,\n  get: function () {\n    return _validateToken.default;\n  }\n});\n\nvar _authentication = _interopRequireDefault(require(\"./auth/authentication\"));\n\nvar _authorization = _interopRequireDefault(require(\"./auth/authorization\"));\n\nvar _validateToken = _interopRequireDefault(require(\"./auth/validate-token\"));\n\nvar _phoneVerification = _interopRequireDefault(require(\"./auth/phone-verification\"));\n\nvar _userValidator = _interopRequireDefault(require(\"./validators/user-validator\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUNBIiwic291cmNlUm9vdCI6IkM6XFxVc2Vyc1xcUmViYmVcXERlc2t0b3BcXGhhbGV0YS1uZXctYXBpXFxzcmNcXG1pZGRsZXdhcmVzXFwiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgYXV0aGVudGljYXRpb24gZnJvbSBcIi4vYXV0aC9hdXRoZW50aWNhdGlvblwiXHJcbmltcG9ydCBhdXRob3JpemF0aW9uIGZyb20gXCIuL2F1dGgvYXV0aG9yaXphdGlvblwiXHJcbmltcG9ydCB2YWxpZGF0ZVRva2VuIGZyb20gXCIuL2F1dGgvdmFsaWRhdGUtdG9rZW5cIlxyXG5pbXBvcnQgcGhvbmVWZXJpZmljYXRpb24gZnJvbSBcIi4vYXV0aC9waG9uZS12ZXJpZmljYXRpb25cIlxyXG5pbXBvcnQgdXNlclZhbGlkYXRvciBmcm9tIFwiLi92YWxpZGF0b3JzL3VzZXItdmFsaWRhdG9yXCI7XHJcblxyXG5leHBvcnQge1xyXG4gICAgYXV0aGVudGljYXRpb24sXHJcbiAgICBhdXRob3JpemF0aW9uLFxyXG4gICAgdmFsaWRhdGVUb2tlbixcclxuICAgIHBob25lVmVyaWZpY2F0aW9uLFxyXG4gICAgdXNlclZhbGlkYXRvcixcclxufSJdfQ==","map":{"version":3,"sources":["index.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\middlewares\\","sourcesContent":["import authentication from \"./auth/authentication\"\r\nimport authorization from \"./auth/authorization\"\r\nimport validateToken from \"./auth/validate-token\"\r\nimport phoneVerification from \"./auth/phone-verification\"\r\nimport userValidator from \"./validators/user-validator\";\r\n\r\nexport {\r\n    authentication,\r\n    authorization,\r\n    validateToken,\r\n    phoneVerification,\r\n    userValidator,\r\n}"]}},"mtime":1648583275535},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\middlewares\\\\auth\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\middlewares\\\\auth\\\\authentication.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nconst isAuth = async (resolve, source, args, context, info) => {\n  const {\n    user\n  } = context;\n\n  if (!user) {\n    return Promise.reject(new Error(\"You must be authorized.\"));\n  }\n\n  return resolve(source, args, context, info);\n};\n\nconst isGuest = async (resolve, source, args, context, info) => {\n  const {\n    user\n  } = context;\n\n  if (user) {\n    return Promise.reject(new Error(\"You have already authorized.\"));\n  }\n\n  return resolve(source, args, context, info);\n};\n\nvar _default = {\n  isAuth,\n  isGuest\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGhlbnRpY2F0aW9uLmpzIl0sIm5hbWVzIjpbImlzQXV0aCIsInJlc29sdmUiLCJzb3VyY2UiLCJhcmdzIiwiY29udGV4dCIsImluZm8iLCJ1c2VyIiwiUHJvbWlzZSIsInJlamVjdCIsIkVycm9yIiwiaXNHdWVzdCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBLE1BQU1BLE1BQU0sR0FBRyxPQUFPQyxPQUFQLEVBQWdCQyxNQUFoQixFQUF3QkMsSUFBeEIsRUFBOEJDLE9BQTlCLEVBQXVDQyxJQUF2QyxLQUFnRDtBQUMzRCxRQUFNO0FBQUNDLElBQUFBO0FBQUQsTUFBU0YsT0FBZjs7QUFDQSxNQUFJLENBQUNFLElBQUwsRUFBVztBQUNQLFdBQU9DLE9BQU8sQ0FBQ0MsTUFBUixDQUFlLElBQUlDLEtBQUosQ0FBVSx5QkFBVixDQUFmLENBQVA7QUFDSDs7QUFDRCxTQUFPUixPQUFPLENBQUNDLE1BQUQsRUFBU0MsSUFBVCxFQUFlQyxPQUFmLEVBQXdCQyxJQUF4QixDQUFkO0FBQ0gsQ0FORDs7QUFRQSxNQUFNSyxPQUFPLEdBQUcsT0FBT1QsT0FBUCxFQUFnQkMsTUFBaEIsRUFBd0JDLElBQXhCLEVBQThCQyxPQUE5QixFQUF1Q0MsSUFBdkMsS0FBZ0Q7QUFDNUQsUUFBTTtBQUFDQyxJQUFBQTtBQUFELE1BQVNGLE9BQWY7O0FBQ0EsTUFBSUUsSUFBSixFQUFVO0FBQ04sV0FBT0MsT0FBTyxDQUFDQyxNQUFSLENBQWUsSUFBSUMsS0FBSixDQUFVLDhCQUFWLENBQWYsQ0FBUDtBQUNIOztBQUNELFNBQU9SLE9BQU8sQ0FBQ0MsTUFBRCxFQUFTQyxJQUFULEVBQWVDLE9BQWYsRUFBd0JDLElBQXhCLENBQWQ7QUFDSCxDQU5EOztlQVFlO0FBQUNMLEVBQUFBLE1BQUQ7QUFBU1UsRUFBQUE7QUFBVCxDIiwic291cmNlUm9vdCI6IkM6XFxVc2Vyc1xcUmViYmVcXERlc2t0b3BcXGhhbGV0YS1uZXctYXBpXFxzcmNcXG1pZGRsZXdhcmVzXFxhdXRoXFwiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBpc0F1dGggPSBhc3luYyAocmVzb2x2ZSwgc291cmNlLCBhcmdzLCBjb250ZXh0LCBpbmZvKSA9PiB7XHJcbiAgICBjb25zdCB7dXNlcn0gPSBjb250ZXh0O1xyXG4gICAgaWYgKCF1c2VyKSB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcIllvdSBtdXN0IGJlIGF1dGhvcml6ZWQuXCIpKTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXNvbHZlKHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbyk7XHJcbn07XHJcblxyXG5jb25zdCBpc0d1ZXN0ID0gYXN5bmMgKHJlc29sdmUsIHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbykgPT4ge1xyXG4gICAgY29uc3Qge3VzZXJ9ID0gY29udGV4dDtcclxuICAgIGlmICh1c2VyKSB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcIllvdSBoYXZlIGFscmVhZHkgYXV0aG9yaXplZC5cIikpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJlc29sdmUoc291cmNlLCBhcmdzLCBjb250ZXh0LCBpbmZvKTtcclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IHtpc0F1dGgsIGlzR3Vlc3R9O1xyXG4iXX0=","map":{"version":3,"sources":["authentication.js"],"names":["isAuth","resolve","source","args","context","info","user","Promise","reject","Error","isGuest"],"mappings":";;;;;;;AAAA,MAAMA,MAAM,GAAG,OAAOC,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AAC3D,QAAM;AAACC,IAAAA;AAAD,MAASF,OAAf;;AACA,MAAI,CAACE,IAAL,EAAW;AACP,WAAOC,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAU,yBAAV,CAAf,CAAP;AACH;;AACD,SAAOR,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,CAND;;AAQA,MAAMK,OAAO,GAAG,OAAOT,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AAC5D,QAAM;AAACC,IAAAA;AAAD,MAASF,OAAf;;AACA,MAAIE,IAAJ,EAAU;AACN,WAAOC,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAU,8BAAV,CAAf,CAAP;AACH;;AACD,SAAOR,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,CAND;;eAQe;AAACL,EAAAA,MAAD;AAASU,EAAAA;AAAT,C","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\middlewares\\auth\\","sourcesContent":["const isAuth = async (resolve, source, args, context, info) => {\r\n    const {user} = context;\r\n    if (!user) {\r\n        return Promise.reject(new Error(\"You must be authorized.\"));\r\n    }\r\n    return resolve(source, args, context, info);\r\n};\r\n\r\nconst isGuest = async (resolve, source, args, context, info) => {\r\n    const {user} = context;\r\n    if (user) {\r\n        return Promise.reject(new Error(\"You have already authorized.\"));\r\n    }\r\n    return resolve(source, args, context, info);\r\n};\r\n\r\nexport default {isAuth, isGuest};\r\n"]}},"mtime":1648583275533},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\middlewares\\\\auth\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\middlewares\\\\auth\\\\authorization.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n//list from redis, list of functions for each role\nconst accessList = {\n  ADMIN: [\"findMany\", \"createOne\"],\n  SUPER_ADMIN: [\"findMany\", \"createOne\"],\n  NORMAL: [],\n  TUTOR: [],\n  CUSTOMER_SERVICE: []\n};\n\nconst authorization = async (resolve, source, args, context, info) => {\n  const {\n    user\n  } = context;\n  const fieldName = info.fieldName;\n  let hasAccess = false; //list from redis, list of functions for each role\n\n  user.roles.forEach(role => {\n    if (accessList[role].includes(fieldName)) {\n      hasAccess = true;\n    }\n  });\n\n  if (!hasAccess) {\n    return Promise.reject(new Error(\"Access denied.\"));\n  }\n\n  return resolve(source, args, context, info);\n};\n\nvar _default = authorization;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGhvcml6YXRpb24uanMiXSwibmFtZXMiOlsiYWNjZXNzTGlzdCIsIkFETUlOIiwiU1VQRVJfQURNSU4iLCJOT1JNQUwiLCJUVVRPUiIsIkNVU1RPTUVSX1NFUlZJQ0UiLCJhdXRob3JpemF0aW9uIiwicmVzb2x2ZSIsInNvdXJjZSIsImFyZ3MiLCJjb250ZXh0IiwiaW5mbyIsInVzZXIiLCJmaWVsZE5hbWUiLCJoYXNBY2Nlc3MiLCJyb2xlcyIsImZvckVhY2giLCJyb2xlIiwiaW5jbHVkZXMiLCJQcm9taXNlIiwicmVqZWN0IiwiRXJyb3IiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0EsTUFBTUEsVUFBVSxHQUFHO0FBQ2ZDLEVBQUFBLEtBQUssRUFBRSxDQUFDLFVBQUQsRUFBYSxXQUFiLENBRFE7QUFFZkMsRUFBQUEsV0FBVyxFQUFFLENBQUMsVUFBRCxFQUFhLFdBQWIsQ0FGRTtBQUdmQyxFQUFBQSxNQUFNLEVBQUUsRUFITztBQUlmQyxFQUFBQSxLQUFLLEVBQUUsRUFKUTtBQUtmQyxFQUFBQSxnQkFBZ0IsRUFBRTtBQUxILENBQW5COztBQVFBLE1BQU1DLGFBQWEsR0FBRyxPQUFPQyxPQUFQLEVBQWdCQyxNQUFoQixFQUF3QkMsSUFBeEIsRUFBOEJDLE9BQTlCLEVBQXVDQyxJQUF2QyxLQUFnRDtBQUNsRSxRQUFNO0FBQUNDLElBQUFBO0FBQUQsTUFBU0YsT0FBZjtBQUNBLFFBQU1HLFNBQVMsR0FBR0YsSUFBSSxDQUFDRSxTQUF2QjtBQUNBLE1BQUlDLFNBQVMsR0FBRyxLQUFoQixDQUhrRSxDQUlsRTs7QUFDQUYsRUFBQUEsSUFBSSxDQUFDRyxLQUFMLENBQVdDLE9BQVgsQ0FBbUJDLElBQUksSUFBSTtBQUN2QixRQUFHakIsVUFBVSxDQUFDaUIsSUFBRCxDQUFWLENBQWlCQyxRQUFqQixDQUEwQkwsU0FBMUIsQ0FBSCxFQUF3QztBQUNwQ0MsTUFBQUEsU0FBUyxHQUFHLElBQVo7QUFDSDtBQUNKLEdBSkQ7O0FBS0EsTUFBSSxDQUFDQSxTQUFMLEVBQWdCO0FBQ1osV0FBT0ssT0FBTyxDQUFDQyxNQUFSLENBQWUsSUFBSUMsS0FBSixDQUFVLGdCQUFWLENBQWYsQ0FBUDtBQUNIOztBQUNELFNBQU9kLE9BQU8sQ0FBQ0MsTUFBRCxFQUFTQyxJQUFULEVBQWVDLE9BQWYsRUFBd0JDLElBQXhCLENBQWQ7QUFDSCxDQWREOztlQWdCZUwsYSIsInNvdXJjZVJvb3QiOiJDOlxcVXNlcnNcXFJlYmJlXFxEZXNrdG9wXFxoYWxldGEtbmV3LWFwaVxcc3JjXFxtaWRkbGV3YXJlc1xcYXV0aFxcIiwic291cmNlc0NvbnRlbnQiOlsiLy9saXN0IGZyb20gcmVkaXMsIGxpc3Qgb2YgZnVuY3Rpb25zIGZvciBlYWNoIHJvbGVcclxuY29uc3QgYWNjZXNzTGlzdCA9IHtcclxuICAgIEFETUlOOiBbXCJmaW5kTWFueVwiLCBcImNyZWF0ZU9uZVwiXSxcclxuICAgIFNVUEVSX0FETUlOOiBbXCJmaW5kTWFueVwiLCBcImNyZWF0ZU9uZVwiXSxcclxuICAgIE5PUk1BTDogW10sXHJcbiAgICBUVVRPUjogW10sXHJcbiAgICBDVVNUT01FUl9TRVJWSUNFOiBbXSxcclxufTtcclxuXHJcbmNvbnN0IGF1dGhvcml6YXRpb24gPSBhc3luYyAocmVzb2x2ZSwgc291cmNlLCBhcmdzLCBjb250ZXh0LCBpbmZvKSA9PiB7XHJcbiAgICBjb25zdCB7dXNlcn0gPSBjb250ZXh0O1xyXG4gICAgY29uc3QgZmllbGROYW1lID0gaW5mby5maWVsZE5hbWVcclxuICAgIGxldCBoYXNBY2Nlc3MgPSBmYWxzZVxyXG4gICAgLy9saXN0IGZyb20gcmVkaXMsIGxpc3Qgb2YgZnVuY3Rpb25zIGZvciBlYWNoIHJvbGVcclxuICAgIHVzZXIucm9sZXMuZm9yRWFjaChyb2xlID0+IHtcclxuICAgICAgICBpZihhY2Nlc3NMaXN0W3JvbGVdLmluY2x1ZGVzKGZpZWxkTmFtZSkpe1xyXG4gICAgICAgICAgICBoYXNBY2Nlc3MgPSB0cnVlXHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxuICAgIGlmICghaGFzQWNjZXNzKSB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcIkFjY2VzcyBkZW5pZWQuXCIpKTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXNvbHZlKHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbyk7XHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBhdXRob3JpemF0aW9uO1xyXG4iXX0=","map":{"version":3,"sources":["authorization.js"],"names":["accessList","ADMIN","SUPER_ADMIN","NORMAL","TUTOR","CUSTOMER_SERVICE","authorization","resolve","source","args","context","info","user","fieldName","hasAccess","roles","forEach","role","includes","Promise","reject","Error"],"mappings":";;;;;;AAAA;AACA,MAAMA,UAAU,GAAG;AACfC,EAAAA,KAAK,EAAE,CAAC,UAAD,EAAa,WAAb,CADQ;AAEfC,EAAAA,WAAW,EAAE,CAAC,UAAD,EAAa,WAAb,CAFE;AAGfC,EAAAA,MAAM,EAAE,EAHO;AAIfC,EAAAA,KAAK,EAAE,EAJQ;AAKfC,EAAAA,gBAAgB,EAAE;AALH,CAAnB;;AAQA,MAAMC,aAAa,GAAG,OAAOC,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AAClE,QAAM;AAACC,IAAAA;AAAD,MAASF,OAAf;AACA,QAAMG,SAAS,GAAGF,IAAI,CAACE,SAAvB;AACA,MAAIC,SAAS,GAAG,KAAhB,CAHkE,CAIlE;;AACAF,EAAAA,IAAI,CAACG,KAAL,CAAWC,OAAX,CAAmBC,IAAI,IAAI;AACvB,QAAGjB,UAAU,CAACiB,IAAD,CAAV,CAAiBC,QAAjB,CAA0BL,SAA1B,CAAH,EAAwC;AACpCC,MAAAA,SAAS,GAAG,IAAZ;AACH;AACJ,GAJD;;AAKA,MAAI,CAACA,SAAL,EAAgB;AACZ,WAAOK,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAU,gBAAV,CAAf,CAAP;AACH;;AACD,SAAOd,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,CAdD;;eAgBeL,a","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\middlewares\\auth\\","sourcesContent":["//list from redis, list of functions for each role\r\nconst accessList = {\r\n    ADMIN: [\"findMany\", \"createOne\"],\r\n    SUPER_ADMIN: [\"findMany\", \"createOne\"],\r\n    NORMAL: [],\r\n    TUTOR: [],\r\n    CUSTOMER_SERVICE: [],\r\n};\r\n\r\nconst authorization = async (resolve, source, args, context, info) => {\r\n    const {user} = context;\r\n    const fieldName = info.fieldName\r\n    let hasAccess = false\r\n    //list from redis, list of functions for each role\r\n    user.roles.forEach(role => {\r\n        if(accessList[role].includes(fieldName)){\r\n            hasAccess = true\r\n        }\r\n    })\r\n    if (!hasAccess) {\r\n        return Promise.reject(new Error(\"Access denied.\"));\r\n    }\r\n    return resolve(source, args, context, info);\r\n};\r\n\r\nexport default authorization;\r\n"]}},"mtime":1648583275533},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\middlewares\\\\auth\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\middlewares\\\\auth\\\\validate-token.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\n\nvar _user = require(\"../../models/user\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// import redis from \"../config/redis-config\";\nconst validateToken = async (req, res, next) => {\n  try {\n    const authorization = req.headers.authorization;\n    Object.assign(req.headers, {\n      user: null,\n      authorization: null\n    });\n\n    if (!authorization) {\n      return next();\n    }\n\n    const accessToken = authorization.split(\" \")[1];\n    let decoded;\n\n    if (accessToken) {\n      decoded = _jsonwebtoken.default.verify(accessToken, process.env.JWT_SECRET);\n    }\n\n    if (!decoded) {\n      // invalid token, remove the token from everywhere\n      //remove from database\n      //remove from redis\n      return next();\n    }\n\n    if (decoded.exp * 1000 < Date.now()) {\n      //remove from database\n      //remove from redis\n      return next();\n    } //check if token is in redis\n    //if NOT in redis call next()\n    //else check last update time if greater than or equals to 1hour update the token\n    // if less skip else update token\n    // authorization = new token\n\n\n    const user = await _user.UserModel.findById(decoded.userId);\n\n    if (!user) {\n      //remove from database\n      //remove from redis\n      return next();\n    } // if the token has come all this way everything is good just attach it to the request header\n\n\n    Object.assign(req.headers, {\n      user,\n      authorization\n    });\n    return next();\n  } catch (error) {\n    console.log(error);\n    return Promise.reject(new Error(\"Error Happened!\"));\n  }\n};\n\nvar _default = validateToken; // ------------- authorization ------------------\n// let check_user_action = async (req,action,resource) =>{\n//   if(!['updateOwn','deleteOwn'].includes(action)){\n//     return true\n//   }\n//\n//   const userResource = new Set()\n//\n//   if(resource == 'tender'){\n//     let userTender = await Tender.find({ creator_user: req.user._id })\n//     userTender.forEach(tender => userResource.add(`${tender._id}`))\n//\n//   }else if(resource == 'company'){\n//     let userCompany = await Company.find({ creator_user: req.user._id })\n//     userCompany.forEach(company => userResource.add( `${company._id}`))\n//\n//   }else if(resource == 'award'){\n//     let userAward = await Award.find({ creator_user: req.user._id })\n//     userAward.forEach(award => userResource.add(`${award._id}`))\n//   }\n//\n//   if(!userResource.has(req.params.id)){\n//     return false\n//   }\n//\n//   return true\n// }\n//\n//\n//\n// exports.authorize = function (action, resource) {\n//   return async (req, res, next) => {\n//     try {\n//       const permission = roles.can(req.user.role)[action](resource);\n//\n//       if (!permission.granted) {\n//         return res.status(401).send(\"You don't have enough permission to perform this action\");\n//       }\n//\n//       let result = await check_user_action(req,action,resource)\n//       if(!result){\n//         return res.status(401).send({ param: resource , msg: `You are not authorized to edit this ${resource}.` })\n//       }\n//\n//       next()\n//     } catch (error) {\n//       return res.status(401).send(\"You don't have enough permission to perform this action\")\n//     }\n//   }\n// }\n\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInZhbGlkYXRlLXRva2VuLmpzIl0sIm5hbWVzIjpbInZhbGlkYXRlVG9rZW4iLCJyZXEiLCJyZXMiLCJuZXh0IiwiYXV0aG9yaXphdGlvbiIsImhlYWRlcnMiLCJPYmplY3QiLCJhc3NpZ24iLCJ1c2VyIiwiYWNjZXNzVG9rZW4iLCJzcGxpdCIsImRlY29kZWQiLCJqd3QiLCJ2ZXJpZnkiLCJwcm9jZXNzIiwiZW52IiwiSldUX1NFQ1JFVCIsImV4cCIsIkRhdGUiLCJub3ciLCJVc2VyTW9kZWwiLCJmaW5kQnlJZCIsInVzZXJJZCIsImVycm9yIiwiY29uc29sZSIsImxvZyIsIlByb21pc2UiLCJyZWplY3QiLCJFcnJvciJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUdBOzs7O0FBREE7QUFHQSxNQUFNQSxhQUFhLEdBQUcsT0FBT0MsR0FBUCxFQUFZQyxHQUFaLEVBQWlCQyxJQUFqQixLQUEwQjtBQUM1QyxNQUFJO0FBQ0EsVUFBTUMsYUFBYSxHQUFHSCxHQUFHLENBQUNJLE9BQUosQ0FBWUQsYUFBbEM7QUFFQUUsSUFBQUEsTUFBTSxDQUFDQyxNQUFQLENBQWNOLEdBQUcsQ0FBQ0ksT0FBbEIsRUFBMkI7QUFDdkJHLE1BQUFBLElBQUksRUFBRSxJQURpQjtBQUV2QkosTUFBQUEsYUFBYSxFQUFFO0FBRlEsS0FBM0I7O0FBS0EsUUFBSSxDQUFDQSxhQUFMLEVBQW9CO0FBQ2hCLGFBQU9ELElBQUksRUFBWDtBQUNIOztBQUVELFVBQU1NLFdBQVcsR0FBR0wsYUFBYSxDQUFDTSxLQUFkLENBQW9CLEdBQXBCLEVBQXlCLENBQXpCLENBQXBCO0FBRUEsUUFBSUMsT0FBSjs7QUFDQSxRQUFJRixXQUFKLEVBQWlCO0FBQ2JFLE1BQUFBLE9BQU8sR0FBR0Msc0JBQUlDLE1BQUosQ0FBV0osV0FBWCxFQUF3QkssT0FBTyxDQUFDQyxHQUFSLENBQVlDLFVBQXBDLENBQVY7QUFDSDs7QUFDRCxRQUFJLENBQUNMLE9BQUwsRUFBYztBQUNWO0FBQ0E7QUFDQTtBQUNBLGFBQU9SLElBQUksRUFBWDtBQUNIOztBQUVELFFBQUlRLE9BQU8sQ0FBQ00sR0FBUixHQUFjLElBQWQsR0FBcUJDLElBQUksQ0FBQ0MsR0FBTCxFQUF6QixFQUFxQztBQUNqQztBQUNBO0FBQ0EsYUFBT2hCLElBQUksRUFBWDtBQUNILEtBN0JELENBK0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBLFVBQU1LLElBQUksR0FBRyxNQUFNWSxnQkFBVUMsUUFBVixDQUFtQlYsT0FBTyxDQUFDVyxNQUEzQixDQUFuQjs7QUFDQSxRQUFJLENBQUNkLElBQUwsRUFBVztBQUNQO0FBQ0E7QUFDQSxhQUFPTCxJQUFJLEVBQVg7QUFDSCxLQTFDRCxDQTRDQTs7O0FBQ0FHLElBQUFBLE1BQU0sQ0FBQ0MsTUFBUCxDQUFjTixHQUFHLENBQUNJLE9BQWxCLEVBQTJCO0FBQ3ZCRyxNQUFBQSxJQUR1QjtBQUV2QkosTUFBQUE7QUFGdUIsS0FBM0I7QUFLQSxXQUFPRCxJQUFJLEVBQVg7QUFDSCxHQW5ERCxDQW1ERSxPQUFPb0IsS0FBUCxFQUFjO0FBQ1pDLElBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZRixLQUFaO0FBQ0EsV0FBT0csT0FBTyxDQUFDQyxNQUFSLENBQWUsSUFBSUMsS0FBSixDQUFVLGlCQUFWLENBQWYsQ0FBUDtBQUNIO0FBQ0osQ0F4REQ7O2VBMERlNUIsYSxFQUdmO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiQzpcXFVzZXJzXFxSZWJiZVxcRGVza3RvcFxcaGFsZXRhLW5ldy1hcGlcXHNyY1xcbWlkZGxld2FyZXNcXGF1dGhcXCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBqd3QgZnJvbSBcImpzb253ZWJ0b2tlblwiO1xyXG5cclxuLy8gaW1wb3J0IHJlZGlzIGZyb20gXCIuLi9jb25maWcvcmVkaXMtY29uZmlnXCI7XHJcbmltcG9ydCB7VXNlck1vZGVsfSBmcm9tIFwiLi4vLi4vbW9kZWxzL3VzZXJcIjtcclxuXHJcbmNvbnN0IHZhbGlkYXRlVG9rZW4gPSBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgYXV0aG9yaXphdGlvbiA9IHJlcS5oZWFkZXJzLmF1dGhvcml6YXRpb25cclxuXHJcbiAgICAgICAgT2JqZWN0LmFzc2lnbihyZXEuaGVhZGVycywge1xyXG4gICAgICAgICAgICB1c2VyOiBudWxsLFxyXG4gICAgICAgICAgICBhdXRob3JpemF0aW9uOiBudWxsLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBpZiAoIWF1dGhvcml6YXRpb24pIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5leHQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gYXV0aG9yaXphdGlvbi5zcGxpdChcIiBcIilbMV07XHJcblxyXG4gICAgICAgIGxldCBkZWNvZGVkO1xyXG4gICAgICAgIGlmIChhY2Nlc3NUb2tlbikge1xyXG4gICAgICAgICAgICBkZWNvZGVkID0gand0LnZlcmlmeShhY2Nlc3NUb2tlbiwgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICghZGVjb2RlZCkge1xyXG4gICAgICAgICAgICAvLyBpbnZhbGlkIHRva2VuLCByZW1vdmUgdGhlIHRva2VuIGZyb20gZXZlcnl3aGVyZVxyXG4gICAgICAgICAgICAvL3JlbW92ZSBmcm9tIGRhdGFiYXNlXHJcbiAgICAgICAgICAgIC8vcmVtb3ZlIGZyb20gcmVkaXNcclxuICAgICAgICAgICAgcmV0dXJuIG5leHQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmIChkZWNvZGVkLmV4cCAqIDEwMDAgPCBEYXRlLm5vdygpKSB7XHJcbiAgICAgICAgICAgIC8vcmVtb3ZlIGZyb20gZGF0YWJhc2VcclxuICAgICAgICAgICAgLy9yZW1vdmUgZnJvbSByZWRpc1xyXG4gICAgICAgICAgICByZXR1cm4gbmV4dCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy9jaGVjayBpZiB0b2tlbiBpcyBpbiByZWRpc1xyXG4gICAgICAgIC8vaWYgTk9UIGluIHJlZGlzIGNhbGwgbmV4dCgpXHJcbiAgICAgICAgLy9lbHNlIGNoZWNrIGxhc3QgdXBkYXRlIHRpbWUgaWYgZ3JlYXRlciB0aGFuIG9yIGVxdWFscyB0byAxaG91ciB1cGRhdGUgdGhlIHRva2VuXHJcbiAgICAgICAgLy8gaWYgbGVzcyBza2lwIGVsc2UgdXBkYXRlIHRva2VuXHJcbiAgICAgICAgLy8gYXV0aG9yaXphdGlvbiA9IG5ldyB0b2tlblxyXG5cclxuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlck1vZGVsLmZpbmRCeUlkKGRlY29kZWQudXNlcklkKTtcclxuICAgICAgICBpZiAoIXVzZXIpIHtcclxuICAgICAgICAgICAgLy9yZW1vdmUgZnJvbSBkYXRhYmFzZVxyXG4gICAgICAgICAgICAvL3JlbW92ZSBmcm9tIHJlZGlzXHJcbiAgICAgICAgICAgIHJldHVybiBuZXh0KCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBpZiB0aGUgdG9rZW4gaGFzIGNvbWUgYWxsIHRoaXMgd2F5IGV2ZXJ5dGhpbmcgaXMgZ29vZCBqdXN0IGF0dGFjaCBpdCB0byB0aGUgcmVxdWVzdCBoZWFkZXJcclxuICAgICAgICBPYmplY3QuYXNzaWduKHJlcS5oZWFkZXJzLCB7XHJcbiAgICAgICAgICAgIHVzZXIsXHJcbiAgICAgICAgICAgIGF1dGhvcml6YXRpb24sXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiBuZXh0KCk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGVycm9yKVxyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoXCJFcnJvciBIYXBwZW5lZCFcIikpO1xyXG4gICAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgdmFsaWRhdGVUb2tlbjtcclxuXHJcblxyXG4vLyAtLS0tLS0tLS0tLS0tIGF1dGhvcml6YXRpb24gLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4vLyBsZXQgY2hlY2tfdXNlcl9hY3Rpb24gPSBhc3luYyAocmVxLGFjdGlvbixyZXNvdXJjZSkgPT57XHJcbi8vICAgaWYoIVsndXBkYXRlT3duJywnZGVsZXRlT3duJ10uaW5jbHVkZXMoYWN0aW9uKSl7XHJcbi8vICAgICByZXR1cm4gdHJ1ZVxyXG4vLyAgIH1cclxuLy9cclxuLy8gICBjb25zdCB1c2VyUmVzb3VyY2UgPSBuZXcgU2V0KClcclxuLy9cclxuLy8gICBpZihyZXNvdXJjZSA9PSAndGVuZGVyJyl7XHJcbi8vICAgICBsZXQgdXNlclRlbmRlciA9IGF3YWl0IFRlbmRlci5maW5kKHsgY3JlYXRvcl91c2VyOiByZXEudXNlci5faWQgfSlcclxuLy8gICAgIHVzZXJUZW5kZXIuZm9yRWFjaCh0ZW5kZXIgPT4gdXNlclJlc291cmNlLmFkZChgJHt0ZW5kZXIuX2lkfWApKVxyXG4vL1xyXG4vLyAgIH1lbHNlIGlmKHJlc291cmNlID09ICdjb21wYW55Jyl7XHJcbi8vICAgICBsZXQgdXNlckNvbXBhbnkgPSBhd2FpdCBDb21wYW55LmZpbmQoeyBjcmVhdG9yX3VzZXI6IHJlcS51c2VyLl9pZCB9KVxyXG4vLyAgICAgdXNlckNvbXBhbnkuZm9yRWFjaChjb21wYW55ID0+IHVzZXJSZXNvdXJjZS5hZGQoIGAke2NvbXBhbnkuX2lkfWApKVxyXG4vL1xyXG4vLyAgIH1lbHNlIGlmKHJlc291cmNlID09ICdhd2FyZCcpe1xyXG4vLyAgICAgbGV0IHVzZXJBd2FyZCA9IGF3YWl0IEF3YXJkLmZpbmQoeyBjcmVhdG9yX3VzZXI6IHJlcS51c2VyLl9pZCB9KVxyXG4vLyAgICAgdXNlckF3YXJkLmZvckVhY2goYXdhcmQgPT4gdXNlclJlc291cmNlLmFkZChgJHthd2FyZC5faWR9YCkpXHJcbi8vICAgfVxyXG4vL1xyXG4vLyAgIGlmKCF1c2VyUmVzb3VyY2UuaGFzKHJlcS5wYXJhbXMuaWQpKXtcclxuLy8gICAgIHJldHVybiBmYWxzZVxyXG4vLyAgIH1cclxuLy9cclxuLy8gICByZXR1cm4gdHJ1ZVxyXG4vLyB9XHJcbi8vXHJcbi8vXHJcbi8vXHJcbi8vIGV4cG9ydHMuYXV0aG9yaXplID0gZnVuY3Rpb24gKGFjdGlvbiwgcmVzb3VyY2UpIHtcclxuLy8gICByZXR1cm4gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XHJcbi8vICAgICB0cnkge1xyXG4vLyAgICAgICBjb25zdCBwZXJtaXNzaW9uID0gcm9sZXMuY2FuKHJlcS51c2VyLnJvbGUpW2FjdGlvbl0ocmVzb3VyY2UpO1xyXG4vL1xyXG4vLyAgICAgICBpZiAoIXBlcm1pc3Npb24uZ3JhbnRlZCkge1xyXG4vLyAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuc2VuZChcIllvdSBkb24ndCBoYXZlIGVub3VnaCBwZXJtaXNzaW9uIHRvIHBlcmZvcm0gdGhpcyBhY3Rpb25cIik7XHJcbi8vICAgICAgIH1cclxuLy9cclxuLy8gICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IGNoZWNrX3VzZXJfYWN0aW9uKHJlcSxhY3Rpb24scmVzb3VyY2UpXHJcbi8vICAgICAgIGlmKCFyZXN1bHQpe1xyXG4vLyAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuc2VuZCh7IHBhcmFtOiByZXNvdXJjZSAsIG1zZzogYFlvdSBhcmUgbm90IGF1dGhvcml6ZWQgdG8gZWRpdCB0aGlzICR7cmVzb3VyY2V9LmAgfSlcclxuLy8gICAgICAgfVxyXG4vL1xyXG4vLyAgICAgICBuZXh0KClcclxuLy8gICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbi8vICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuc2VuZChcIllvdSBkb24ndCBoYXZlIGVub3VnaCBwZXJtaXNzaW9uIHRvIHBlcmZvcm0gdGhpcyBhY3Rpb25cIilcclxuLy8gICAgIH1cclxuLy8gICB9XHJcbi8vIH1cclxuIl19","map":{"version":3,"sources":["validate-token.js"],"names":["validateToken","req","res","next","authorization","headers","Object","assign","user","accessToken","split","decoded","jwt","verify","process","env","JWT_SECRET","exp","Date","now","UserModel","findById","userId","error","console","log","Promise","reject","Error"],"mappings":";;;;;;;AAAA;;AAGA;;;;AADA;AAGA,MAAMA,aAAa,GAAG,OAAOC,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB,KAA0B;AAC5C,MAAI;AACA,UAAMC,aAAa,GAAGH,GAAG,CAACI,OAAJ,CAAYD,aAAlC;AAEAE,IAAAA,MAAM,CAACC,MAAP,CAAcN,GAAG,CAACI,OAAlB,EAA2B;AACvBG,MAAAA,IAAI,EAAE,IADiB;AAEvBJ,MAAAA,aAAa,EAAE;AAFQ,KAA3B;;AAKA,QAAI,CAACA,aAAL,EAAoB;AAChB,aAAOD,IAAI,EAAX;AACH;;AAED,UAAMM,WAAW,GAAGL,aAAa,CAACM,KAAd,CAAoB,GAApB,EAAyB,CAAzB,CAApB;AAEA,QAAIC,OAAJ;;AACA,QAAIF,WAAJ,EAAiB;AACbE,MAAAA,OAAO,GAAGC,sBAAIC,MAAJ,CAAWJ,WAAX,EAAwBK,OAAO,CAACC,GAAR,CAAYC,UAApC,CAAV;AACH;;AACD,QAAI,CAACL,OAAL,EAAc;AACV;AACA;AACA;AACA,aAAOR,IAAI,EAAX;AACH;;AAED,QAAIQ,OAAO,CAACM,GAAR,GAAc,IAAd,GAAqBC,IAAI,CAACC,GAAL,EAAzB,EAAqC;AACjC;AACA;AACA,aAAOhB,IAAI,EAAX;AACH,KA7BD,CA+BA;AACA;AACA;AACA;AACA;;;AAEA,UAAMK,IAAI,GAAG,MAAMY,gBAAUC,QAAV,CAAmBV,OAAO,CAACW,MAA3B,CAAnB;;AACA,QAAI,CAACd,IAAL,EAAW;AACP;AACA;AACA,aAAOL,IAAI,EAAX;AACH,KA1CD,CA4CA;;;AACAG,IAAAA,MAAM,CAACC,MAAP,CAAcN,GAAG,CAACI,OAAlB,EAA2B;AACvBG,MAAAA,IADuB;AAEvBJ,MAAAA;AAFuB,KAA3B;AAKA,WAAOD,IAAI,EAAX;AACH,GAnDD,CAmDE,OAAOoB,KAAP,EAAc;AACZC,IAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACA,WAAOG,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAU,iBAAV,CAAf,CAAP;AACH;AACJ,CAxDD;;eA0De5B,a,EAGf;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\middlewares\\auth\\","sourcesContent":["import jwt from \"jsonwebtoken\";\r\n\r\n// import redis from \"../config/redis-config\";\r\nimport {UserModel} from \"../../models/user\";\r\n\r\nconst validateToken = async (req, res, next) => {\r\n    try {\r\n        const authorization = req.headers.authorization\r\n\r\n        Object.assign(req.headers, {\r\n            user: null,\r\n            authorization: null,\r\n        });\r\n\r\n        if (!authorization) {\r\n            return next();\r\n        }\r\n\r\n        const accessToken = authorization.split(\" \")[1];\r\n\r\n        let decoded;\r\n        if (accessToken) {\r\n            decoded = jwt.verify(accessToken, process.env.JWT_SECRET);\r\n        }\r\n        if (!decoded) {\r\n            // invalid token, remove the token from everywhere\r\n            //remove from database\r\n            //remove from redis\r\n            return next();\r\n        }\r\n\r\n        if (decoded.exp * 1000 < Date.now()) {\r\n            //remove from database\r\n            //remove from redis\r\n            return next();\r\n        }\r\n\r\n        //check if token is in redis\r\n        //if NOT in redis call next()\r\n        //else check last update time if greater than or equals to 1hour update the token\r\n        // if less skip else update token\r\n        // authorization = new token\r\n\r\n        const user = await UserModel.findById(decoded.userId);\r\n        if (!user) {\r\n            //remove from database\r\n            //remove from redis\r\n            return next();\r\n        }\r\n\r\n        // if the token has come all this way everything is good just attach it to the request header\r\n        Object.assign(req.headers, {\r\n            user,\r\n            authorization,\r\n        });\r\n\r\n        return next();\r\n    } catch (error) {\r\n        console.log(error)\r\n        return Promise.reject(new Error(\"Error Happened!\"));\r\n    }\r\n};\r\n\r\nexport default validateToken;\r\n\r\n\r\n// ------------- authorization ------------------\r\n\r\n// let check_user_action = async (req,action,resource) =>{\r\n//   if(!['updateOwn','deleteOwn'].includes(action)){\r\n//     return true\r\n//   }\r\n//\r\n//   const userResource = new Set()\r\n//\r\n//   if(resource == 'tender'){\r\n//     let userTender = await Tender.find({ creator_user: req.user._id })\r\n//     userTender.forEach(tender => userResource.add(`${tender._id}`))\r\n//\r\n//   }else if(resource == 'company'){\r\n//     let userCompany = await Company.find({ creator_user: req.user._id })\r\n//     userCompany.forEach(company => userResource.add( `${company._id}`))\r\n//\r\n//   }else if(resource == 'award'){\r\n//     let userAward = await Award.find({ creator_user: req.user._id })\r\n//     userAward.forEach(award => userResource.add(`${award._id}`))\r\n//   }\r\n//\r\n//   if(!userResource.has(req.params.id)){\r\n//     return false\r\n//   }\r\n//\r\n//   return true\r\n// }\r\n//\r\n//\r\n//\r\n// exports.authorize = function (action, resource) {\r\n//   return async (req, res, next) => {\r\n//     try {\r\n//       const permission = roles.can(req.user.role)[action](resource);\r\n//\r\n//       if (!permission.granted) {\r\n//         return res.status(401).send(\"You don't have enough permission to perform this action\");\r\n//       }\r\n//\r\n//       let result = await check_user_action(req,action,resource)\r\n//       if(!result){\r\n//         return res.status(401).send({ param: resource , msg: `You are not authorized to edit this ${resource}.` })\r\n//       }\r\n//\r\n//       next()\r\n//     } catch (error) {\r\n//       return res.status(401).send(\"You don't have enough permission to perform this action\")\r\n//     }\r\n//   }\r\n// }\r\n"]}},"mtime":1648583440810},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\middlewares\\\\auth\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\middlewares\\\\auth\\\\phone-verification.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\n// import admin from \"../../config/firebase-config\";\nconst phoneVerification = async (resolve, source, args, context, info) => {\n  // const {phoneVerification} = context;\n  // let phoneNumber = \"\";\n  //\n  // await admin\n  //     .auth()\n  //     .verifyIdToken(phoneVerification)\n  //     .then((decodedToken) => {\n  //         phoneNumber = decodedToken.phone_number;\n  //     })\n  //     .catch(() => Promise.reject(new Error(\"Error happened!\")));\n  // if (phoneNumber === \"\") {\n  //     return Promise.reject(new Error(\"Phone number not detected!\"));\n  // }\n  // context.phoneNumber = phoneNumber;\n  return resolve(source, args, context, info);\n};\n\nvar _default = phoneVerification;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBob25lLXZlcmlmaWNhdGlvbi5qcyJdLCJuYW1lcyI6WyJwaG9uZVZlcmlmaWNhdGlvbiIsInJlc29sdmUiLCJzb3VyY2UiLCJhcmdzIiwiY29udGV4dCIsImluZm8iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTtBQUVBLE1BQU1BLGlCQUFpQixHQUFHLE9BQU9DLE9BQVAsRUFBZ0JDLE1BQWhCLEVBQXdCQyxJQUF4QixFQUE4QkMsT0FBOUIsRUFBdUNDLElBQXZDLEtBQWdEO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFPSixPQUFPLENBQUNDLE1BQUQsRUFBU0MsSUFBVCxFQUFlQyxPQUFmLEVBQXdCQyxJQUF4QixDQUFkO0FBQ0gsQ0FoQkQ7O2VBa0JlTCxpQiIsInNvdXJjZVJvb3QiOiJDOlxcVXNlcnNcXFJlYmJlXFxEZXNrdG9wXFxoYWxldGEtbmV3LWFwaVxcc3JjXFxtaWRkbGV3YXJlc1xcYXV0aFxcIiwic291cmNlc0NvbnRlbnQiOlsiLy8gaW1wb3J0IGFkbWluIGZyb20gXCIuLi8uLi9jb25maWcvZmlyZWJhc2UtY29uZmlnXCI7XHJcblxyXG5jb25zdCBwaG9uZVZlcmlmaWNhdGlvbiA9IGFzeW5jIChyZXNvbHZlLCBzb3VyY2UsIGFyZ3MsIGNvbnRleHQsIGluZm8pID0+IHtcclxuICAgIC8vIGNvbnN0IHtwaG9uZVZlcmlmaWNhdGlvbn0gPSBjb250ZXh0O1xyXG4gICAgLy8gbGV0IHBob25lTnVtYmVyID0gXCJcIjtcclxuICAgIC8vXHJcbiAgICAvLyBhd2FpdCBhZG1pblxyXG4gICAgLy8gICAgIC5hdXRoKClcclxuICAgIC8vICAgICAudmVyaWZ5SWRUb2tlbihwaG9uZVZlcmlmaWNhdGlvbilcclxuICAgIC8vICAgICAudGhlbigoZGVjb2RlZFRva2VuKSA9PiB7XHJcbiAgICAvLyAgICAgICAgIHBob25lTnVtYmVyID0gZGVjb2RlZFRva2VuLnBob25lX251bWJlcjtcclxuICAgIC8vICAgICB9KVxyXG4gICAgLy8gICAgIC5jYXRjaCgoKSA9PiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoXCJFcnJvciBoYXBwZW5lZCFcIikpKTtcclxuICAgIC8vIGlmIChwaG9uZU51bWJlciA9PT0gXCJcIikge1xyXG4gICAgLy8gICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoXCJQaG9uZSBudW1iZXIgbm90IGRldGVjdGVkIVwiKSk7XHJcbiAgICAvLyB9XHJcbiAgICAvLyBjb250ZXh0LnBob25lTnVtYmVyID0gcGhvbmVOdW1iZXI7XHJcbiAgICByZXR1cm4gcmVzb2x2ZShzb3VyY2UsIGFyZ3MsIGNvbnRleHQsIGluZm8pO1xyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBwaG9uZVZlcmlmaWNhdGlvbjtcclxuIl19","map":{"version":3,"sources":["phone-verification.js"],"names":["phoneVerification","resolve","source","args","context","info"],"mappings":";;;;;;;AAAA;AAEA,MAAMA,iBAAiB,GAAG,OAAOC,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAOJ,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,CAhBD;;eAkBeL,iB","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\middlewares\\auth\\","sourcesContent":["// import admin from \"../../config/firebase-config\";\r\n\r\nconst phoneVerification = async (resolve, source, args, context, info) => {\r\n    // const {phoneVerification} = context;\r\n    // let phoneNumber = \"\";\r\n    //\r\n    // await admin\r\n    //     .auth()\r\n    //     .verifyIdToken(phoneVerification)\r\n    //     .then((decodedToken) => {\r\n    //         phoneNumber = decodedToken.phone_number;\r\n    //     })\r\n    //     .catch(() => Promise.reject(new Error(\"Error happened!\")));\r\n    // if (phoneNumber === \"\") {\r\n    //     return Promise.reject(new Error(\"Phone number not detected!\"));\r\n    // }\r\n    // context.phoneNumber = phoneNumber;\r\n    return resolve(source, args, context, info);\r\n}\r\n\r\nexport default phoneVerification;\r\n"]}},"mtime":1648583275534},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\middlewares\\\\validators\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\middlewares\\\\validators\\\\user-validator.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n// import validator from \"validators\";\nconst userValidator = {\n  changePassword: async (resolve, source, args, context, info) => {\n    const {\n      newPassword\n    } = args; // if (!validator.isLength(newPassword, {min: 6})) {\n    //     return Promise.reject(new Error(\"Error: newPassword\"));\n    // }\n\n    return resolve(source, args, context, info);\n  },\n  newPassword: async (resolve, source, args, context, info) => {\n    const {\n      newPassword\n    } = args; // if (!validator.isLength(newPassword, {min: 6})) {\n    //     return Promise.reject(new Error(\"Error: newPassword\"));\n    // }\n\n    return resolve(source, args, context, info);\n  },\n  resetPassword: async (resolve, source, args, context, info) => {\n    let {\n      email\n    } = args; // email = validator.normalizeEmail(email);\n    // email = validator.trim(email);\n    //\n    // Object.assign(args, {email});\n\n    return resolve(source, args, context, info);\n  },\n  signIn: async (resolve, source, args, context, info) => {\n    let {\n      email\n    } = args; // email = email.toString().toLowerCase();\n    // email = validator.trim(email);\n    //\n    // Object.assign(args, {email});\n\n    return resolve(source, args, context, info);\n  },\n  signUp: async (resolve, source, args, context, info) => {\n    let {\n      email\n    } = args; // email = email.toString().toLowerCase();\n    // email = validator.trim(email);\n    //\n    // Object.assign(args, {email});\n\n    const {\n      password\n    } = args; // if (!validator.isEmail(email, {allow_utf8_local_part: false})) {\n    //     return Promise.reject(new Error(\"Error: email\"));\n    // }\n    //\n    // if (!validator.isLength(password, {min: 6})) {\n    //     return Promise.reject(new Error(\"Error: password\"));\n    // }\n\n    return resolve(source, args, context, info);\n  },\n  updateUser: async (resolve, source, args, context, info) => {\n    let {\n      email\n    } = args; // email = validator.normalizeEmail(email);\n    // email = validator.trim(email);\n    //\n    // Object.assign(args, {email});\n\n    const {\n      firstName,\n      lastName\n    } = args; // if (!validator.isEmail(email, {allow_utf8_local_part: false})) {\n    //     return Promise.reject(new Error(\"Error: email\"));\n    // }\n    // if (!validator.isLength(firstName, {min: 2})) {\n    //     return Promise.reject(new Error(\"Error: firstName\"));\n    // }\n    // if (!validator.isLength(lastName, {min: 2})) {\n    //     return Promise.reject(new Error(\"Error: lastName\"));\n    // }\n\n    return resolve(source, args, context, info);\n  }\n};\nvar _default = userValidator;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXItdmFsaWRhdG9yLmpzIl0sIm5hbWVzIjpbInVzZXJWYWxpZGF0b3IiLCJjaGFuZ2VQYXNzd29yZCIsInJlc29sdmUiLCJzb3VyY2UiLCJhcmdzIiwiY29udGV4dCIsImluZm8iLCJuZXdQYXNzd29yZCIsInJlc2V0UGFzc3dvcmQiLCJlbWFpbCIsInNpZ25JbiIsInNpZ25VcCIsInBhc3N3b3JkIiwidXBkYXRlVXNlciIsImZpcnN0TmFtZSIsImxhc3ROYW1lIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUVBLE1BQU1BLGFBQWEsR0FBRztBQUNsQkMsRUFBQUEsY0FBYyxFQUFFLE9BQU9DLE9BQVAsRUFBZ0JDLE1BQWhCLEVBQXdCQyxJQUF4QixFQUE4QkMsT0FBOUIsRUFBdUNDLElBQXZDLEtBQWdEO0FBQzVELFVBQU07QUFBQ0MsTUFBQUE7QUFBRCxRQUFnQkgsSUFBdEIsQ0FENEQsQ0FHNUQ7QUFDQTtBQUNBOztBQUVBLFdBQU9GLE9BQU8sQ0FBQ0MsTUFBRCxFQUFTQyxJQUFULEVBQWVDLE9BQWYsRUFBd0JDLElBQXhCLENBQWQ7QUFDSCxHQVRpQjtBQVVsQkMsRUFBQUEsV0FBVyxFQUFFLE9BQU9MLE9BQVAsRUFBZ0JDLE1BQWhCLEVBQXdCQyxJQUF4QixFQUE4QkMsT0FBOUIsRUFBdUNDLElBQXZDLEtBQWdEO0FBQ3pELFVBQU07QUFBQ0MsTUFBQUE7QUFBRCxRQUFnQkgsSUFBdEIsQ0FEeUQsQ0FHekQ7QUFDQTtBQUNBOztBQUVBLFdBQU9GLE9BQU8sQ0FBQ0MsTUFBRCxFQUFTQyxJQUFULEVBQWVDLE9BQWYsRUFBd0JDLElBQXhCLENBQWQ7QUFDSCxHQWxCaUI7QUFtQmxCRSxFQUFBQSxhQUFhLEVBQUUsT0FBT04sT0FBUCxFQUFnQkMsTUFBaEIsRUFBd0JDLElBQXhCLEVBQThCQyxPQUE5QixFQUF1Q0MsSUFBdkMsS0FBZ0Q7QUFDM0QsUUFBSTtBQUFDRyxNQUFBQTtBQUFELFFBQVVMLElBQWQsQ0FEMkQsQ0FHM0Q7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsV0FBT0YsT0FBTyxDQUFDQyxNQUFELEVBQVNDLElBQVQsRUFBZUMsT0FBZixFQUF3QkMsSUFBeEIsQ0FBZDtBQUNILEdBNUJpQjtBQTZCbEJJLEVBQUFBLE1BQU0sRUFBRSxPQUFPUixPQUFQLEVBQWdCQyxNQUFoQixFQUF3QkMsSUFBeEIsRUFBOEJDLE9BQTlCLEVBQXVDQyxJQUF2QyxLQUFnRDtBQUNwRCxRQUFJO0FBQUNHLE1BQUFBO0FBQUQsUUFBVUwsSUFBZCxDQURvRCxDQUdwRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxXQUFPRixPQUFPLENBQUNDLE1BQUQsRUFBU0MsSUFBVCxFQUFlQyxPQUFmLEVBQXdCQyxJQUF4QixDQUFkO0FBQ0gsR0F0Q2lCO0FBdUNsQkssRUFBQUEsTUFBTSxFQUFFLE9BQU9ULE9BQVAsRUFBZ0JDLE1BQWhCLEVBQXdCQyxJQUF4QixFQUE4QkMsT0FBOUIsRUFBdUNDLElBQXZDLEtBQWdEO0FBQ3BELFFBQUk7QUFBQ0csTUFBQUE7QUFBRCxRQUFVTCxJQUFkLENBRG9ELENBR3BEO0FBQ0E7QUFDQTtBQUNBOztBQUVBLFVBQU07QUFBQ1EsTUFBQUE7QUFBRCxRQUFhUixJQUFuQixDQVJvRCxDQVVwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxXQUFPRixPQUFPLENBQUNDLE1BQUQsRUFBU0MsSUFBVCxFQUFlQyxPQUFmLEVBQXdCQyxJQUF4QixDQUFkO0FBQ0gsR0ExRGlCO0FBMkRsQk8sRUFBQUEsVUFBVSxFQUFFLE9BQU9YLE9BQVAsRUFBZ0JDLE1BQWhCLEVBQXdCQyxJQUF4QixFQUE4QkMsT0FBOUIsRUFBdUNDLElBQXZDLEtBQWdEO0FBQ3hELFFBQUk7QUFBQ0csTUFBQUE7QUFBRCxRQUFVTCxJQUFkLENBRHdELENBR3hEO0FBQ0E7QUFDQTtBQUNBOztBQUVBLFVBQU07QUFDRlUsTUFBQUEsU0FERTtBQUVGQyxNQUFBQTtBQUZFLFFBR0ZYLElBSEosQ0FSd0QsQ0FheEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBLFdBQU9GLE9BQU8sQ0FBQ0MsTUFBRCxFQUFTQyxJQUFULEVBQWVDLE9BQWYsRUFBd0JDLElBQXhCLENBQWQ7QUFDSDtBQWxGaUIsQ0FBdEI7ZUFxRmVOLGEiLCJzb3VyY2VSb290IjoiQzpcXFVzZXJzXFxSZWJiZVxcRGVza3RvcFxcaGFsZXRhLW5ldy1hcGlcXHNyY1xcbWlkZGxld2FyZXNcXHZhbGlkYXRvcnNcXCIsInNvdXJjZXNDb250ZW50IjpbIi8vIGltcG9ydCB2YWxpZGF0b3IgZnJvbSBcInZhbGlkYXRvcnNcIjtcclxuXHJcbmNvbnN0IHVzZXJWYWxpZGF0b3IgPSB7XHJcbiAgICBjaGFuZ2VQYXNzd29yZDogYXN5bmMgKHJlc29sdmUsIHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbykgPT4ge1xyXG4gICAgICAgIGNvbnN0IHtuZXdQYXNzd29yZH0gPSBhcmdzO1xyXG5cclxuICAgICAgICAvLyBpZiAoIXZhbGlkYXRvci5pc0xlbmd0aChuZXdQYXNzd29yZCwge21pbjogNn0pKSB7XHJcbiAgICAgICAgLy8gICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoXCJFcnJvcjogbmV3UGFzc3dvcmRcIikpO1xyXG4gICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHJlc29sdmUoc291cmNlLCBhcmdzLCBjb250ZXh0LCBpbmZvKTtcclxuICAgIH0sXHJcbiAgICBuZXdQYXNzd29yZDogYXN5bmMgKHJlc29sdmUsIHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbykgPT4ge1xyXG4gICAgICAgIGNvbnN0IHtuZXdQYXNzd29yZH0gPSBhcmdzO1xyXG5cclxuICAgICAgICAvLyBpZiAoIXZhbGlkYXRvci5pc0xlbmd0aChuZXdQYXNzd29yZCwge21pbjogNn0pKSB7XHJcbiAgICAgICAgLy8gICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoXCJFcnJvcjogbmV3UGFzc3dvcmRcIikpO1xyXG4gICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHJlc29sdmUoc291cmNlLCBhcmdzLCBjb250ZXh0LCBpbmZvKTtcclxuICAgIH0sXHJcbiAgICByZXNldFBhc3N3b3JkOiBhc3luYyAocmVzb2x2ZSwgc291cmNlLCBhcmdzLCBjb250ZXh0LCBpbmZvKSA9PiB7XHJcbiAgICAgICAgbGV0IHtlbWFpbH0gPSBhcmdzO1xyXG5cclxuICAgICAgICAvLyBlbWFpbCA9IHZhbGlkYXRvci5ub3JtYWxpemVFbWFpbChlbWFpbCk7XHJcbiAgICAgICAgLy8gZW1haWwgPSB2YWxpZGF0b3IudHJpbShlbWFpbCk7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyBPYmplY3QuYXNzaWduKGFyZ3MsIHtlbWFpbH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gcmVzb2x2ZShzb3VyY2UsIGFyZ3MsIGNvbnRleHQsIGluZm8pO1xyXG4gICAgfSxcclxuICAgIHNpZ25JbjogYXN5bmMgKHJlc29sdmUsIHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbykgPT4ge1xyXG4gICAgICAgIGxldCB7ZW1haWx9ID0gYXJncztcclxuXHJcbiAgICAgICAgLy8gZW1haWwgPSBlbWFpbC50b1N0cmluZygpLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgLy8gZW1haWwgPSB2YWxpZGF0b3IudHJpbShlbWFpbCk7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyBPYmplY3QuYXNzaWduKGFyZ3MsIHtlbWFpbH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gcmVzb2x2ZShzb3VyY2UsIGFyZ3MsIGNvbnRleHQsIGluZm8pO1xyXG4gICAgfSxcclxuICAgIHNpZ25VcDogYXN5bmMgKHJlc29sdmUsIHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbykgPT4ge1xyXG4gICAgICAgIGxldCB7ZW1haWx9ID0gYXJncztcclxuXHJcbiAgICAgICAgLy8gZW1haWwgPSBlbWFpbC50b1N0cmluZygpLnRvTG93ZXJDYXNlKCk7XHJcbiAgICAgICAgLy8gZW1haWwgPSB2YWxpZGF0b3IudHJpbShlbWFpbCk7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyBPYmplY3QuYXNzaWduKGFyZ3MsIHtlbWFpbH0pO1xyXG5cclxuICAgICAgICBjb25zdCB7cGFzc3dvcmR9ID0gYXJncztcclxuXHJcbiAgICAgICAgLy8gaWYgKCF2YWxpZGF0b3IuaXNFbWFpbChlbWFpbCwge2FsbG93X3V0ZjhfbG9jYWxfcGFydDogZmFsc2V9KSkge1xyXG4gICAgICAgIC8vICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKFwiRXJyb3I6IGVtYWlsXCIpKTtcclxuICAgICAgICAvLyB9XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyBpZiAoIXZhbGlkYXRvci5pc0xlbmd0aChwYXNzd29yZCwge21pbjogNn0pKSB7XHJcbiAgICAgICAgLy8gICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoXCJFcnJvcjogcGFzc3dvcmRcIikpO1xyXG4gICAgICAgIC8vIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHJlc29sdmUoc291cmNlLCBhcmdzLCBjb250ZXh0LCBpbmZvKTtcclxuICAgIH0sXHJcbiAgICB1cGRhdGVVc2VyOiBhc3luYyAocmVzb2x2ZSwgc291cmNlLCBhcmdzLCBjb250ZXh0LCBpbmZvKSA9PiB7XHJcbiAgICAgICAgbGV0IHtlbWFpbH0gPSBhcmdzO1xyXG5cclxuICAgICAgICAvLyBlbWFpbCA9IHZhbGlkYXRvci5ub3JtYWxpemVFbWFpbChlbWFpbCk7XHJcbiAgICAgICAgLy8gZW1haWwgPSB2YWxpZGF0b3IudHJpbShlbWFpbCk7XHJcbiAgICAgICAgLy9cclxuICAgICAgICAvLyBPYmplY3QuYXNzaWduKGFyZ3MsIHtlbWFpbH0pO1xyXG5cclxuICAgICAgICBjb25zdCB7XHJcbiAgICAgICAgICAgIGZpcnN0TmFtZSxcclxuICAgICAgICAgICAgbGFzdE5hbWUsXHJcbiAgICAgICAgfSA9IGFyZ3M7XHJcblxyXG4gICAgICAgIC8vIGlmICghdmFsaWRhdG9yLmlzRW1haWwoZW1haWwsIHthbGxvd191dGY4X2xvY2FsX3BhcnQ6IGZhbHNlfSkpIHtcclxuICAgICAgICAvLyAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcIkVycm9yOiBlbWFpbFwiKSk7XHJcbiAgICAgICAgLy8gfVxyXG4gICAgICAgIC8vIGlmICghdmFsaWRhdG9yLmlzTGVuZ3RoKGZpcnN0TmFtZSwge21pbjogMn0pKSB7XHJcbiAgICAgICAgLy8gICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoXCJFcnJvcjogZmlyc3ROYW1lXCIpKTtcclxuICAgICAgICAvLyB9XHJcbiAgICAgICAgLy8gaWYgKCF2YWxpZGF0b3IuaXNMZW5ndGgobGFzdE5hbWUsIHttaW46IDJ9KSkge1xyXG4gICAgICAgIC8vICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKFwiRXJyb3I6IGxhc3ROYW1lXCIpKTtcclxuICAgICAgICAvLyB9XHJcbiAgICAgICAgcmV0dXJuIHJlc29sdmUoc291cmNlLCBhcmdzLCBjb250ZXh0LCBpbmZvKTtcclxuICAgIH0sXHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCB1c2VyVmFsaWRhdG9yO1xyXG4iXX0=","map":{"version":3,"sources":["user-validator.js"],"names":["userValidator","changePassword","resolve","source","args","context","info","newPassword","resetPassword","email","signIn","signUp","password","updateUser","firstName","lastName"],"mappings":";;;;;;AAAA;AAEA,MAAMA,aAAa,GAAG;AAClBC,EAAAA,cAAc,EAAE,OAAOC,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AAC5D,UAAM;AAACC,MAAAA;AAAD,QAAgBH,IAAtB,CAD4D,CAG5D;AACA;AACA;;AAEA,WAAOF,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,GATiB;AAUlBC,EAAAA,WAAW,EAAE,OAAOL,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AACzD,UAAM;AAACC,MAAAA;AAAD,QAAgBH,IAAtB,CADyD,CAGzD;AACA;AACA;;AAEA,WAAOF,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,GAlBiB;AAmBlBE,EAAAA,aAAa,EAAE,OAAON,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AAC3D,QAAI;AAACG,MAAAA;AAAD,QAAUL,IAAd,CAD2D,CAG3D;AACA;AACA;AACA;;AAEA,WAAOF,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,GA5BiB;AA6BlBI,EAAAA,MAAM,EAAE,OAAOR,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AACpD,QAAI;AAACG,MAAAA;AAAD,QAAUL,IAAd,CADoD,CAGpD;AACA;AACA;AACA;;AAEA,WAAOF,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,GAtCiB;AAuClBK,EAAAA,MAAM,EAAE,OAAOT,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AACpD,QAAI;AAACG,MAAAA;AAAD,QAAUL,IAAd,CADoD,CAGpD;AACA;AACA;AACA;;AAEA,UAAM;AAACQ,MAAAA;AAAD,QAAaR,IAAnB,CARoD,CAUpD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,WAAOF,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,GA1DiB;AA2DlBO,EAAAA,UAAU,EAAE,OAAOX,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AACxD,QAAI;AAACG,MAAAA;AAAD,QAAUL,IAAd,CADwD,CAGxD;AACA;AACA;AACA;;AAEA,UAAM;AACFU,MAAAA,SADE;AAEFC,MAAAA;AAFE,QAGFX,IAHJ,CARwD,CAaxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,WAAOF,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH;AAlFiB,CAAtB;eAqFeN,a","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\middlewares\\validators\\","sourcesContent":["// import validator from \"validators\";\r\n\r\nconst userValidator = {\r\n    changePassword: async (resolve, source, args, context, info) => {\r\n        const {newPassword} = args;\r\n\r\n        // if (!validator.isLength(newPassword, {min: 6})) {\r\n        //     return Promise.reject(new Error(\"Error: newPassword\"));\r\n        // }\r\n\r\n        return resolve(source, args, context, info);\r\n    },\r\n    newPassword: async (resolve, source, args, context, info) => {\r\n        const {newPassword} = args;\r\n\r\n        // if (!validator.isLength(newPassword, {min: 6})) {\r\n        //     return Promise.reject(new Error(\"Error: newPassword\"));\r\n        // }\r\n\r\n        return resolve(source, args, context, info);\r\n    },\r\n    resetPassword: async (resolve, source, args, context, info) => {\r\n        let {email} = args;\r\n\r\n        // email = validator.normalizeEmail(email);\r\n        // email = validator.trim(email);\r\n        //\r\n        // Object.assign(args, {email});\r\n\r\n        return resolve(source, args, context, info);\r\n    },\r\n    signIn: async (resolve, source, args, context, info) => {\r\n        let {email} = args;\r\n\r\n        // email = email.toString().toLowerCase();\r\n        // email = validator.trim(email);\r\n        //\r\n        // Object.assign(args, {email});\r\n\r\n        return resolve(source, args, context, info);\r\n    },\r\n    signUp: async (resolve, source, args, context, info) => {\r\n        let {email} = args;\r\n\r\n        // email = email.toString().toLowerCase();\r\n        // email = validator.trim(email);\r\n        //\r\n        // Object.assign(args, {email});\r\n\r\n        const {password} = args;\r\n\r\n        // if (!validator.isEmail(email, {allow_utf8_local_part: false})) {\r\n        //     return Promise.reject(new Error(\"Error: email\"));\r\n        // }\r\n        //\r\n        // if (!validator.isLength(password, {min: 6})) {\r\n        //     return Promise.reject(new Error(\"Error: password\"));\r\n        // }\r\n\r\n        return resolve(source, args, context, info);\r\n    },\r\n    updateUser: async (resolve, source, args, context, info) => {\r\n        let {email} = args;\r\n\r\n        // email = validator.normalizeEmail(email);\r\n        // email = validator.trim(email);\r\n        //\r\n        // Object.assign(args, {email});\r\n\r\n        const {\r\n            firstName,\r\n            lastName,\r\n        } = args;\r\n\r\n        // if (!validator.isEmail(email, {allow_utf8_local_part: false})) {\r\n        //     return Promise.reject(new Error(\"Error: email\"));\r\n        // }\r\n        // if (!validator.isLength(firstName, {min: 2})) {\r\n        //     return Promise.reject(new Error(\"Error: firstName\"));\r\n        // }\r\n        // if (!validator.isLength(lastName, {min: 2})) {\r\n        //     return Promise.reject(new Error(\"Error: lastName\"));\r\n        // }\r\n        return resolve(source, args, context, info);\r\n    },\r\n};\r\n\r\nexport default userValidator;\r\n"]}},"mtime":1648583275535},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\graphql\\\\auth\\\\resolvers\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\graphql\\\\auth\\\\resolvers\\\\auth-resolvers.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\n\nvar _user = require(\"../../../models/user\");\n\nvar _authUseCases = _interopRequireDefault(require(\"../../../services/auth/use-cases/auth-use-cases\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// import crypto from \"crypto\";\nconst signIn = {\n  name: \"signIn\",\n  type: \"AccessToken!\",\n  args: {\n    phoneNumber: \"String!\",\n    password: \"String!\"\n  },\n  resolve: async ({\n    args: {\n      phoneNumber,\n      password\n    }\n  }) => {\n    try {\n      const {\n        user,\n        accessToken\n      } = await _authUseCases.default.signIn({\n        phoneNumber,\n        password\n      });\n      return {\n        accessToken,\n        user\n      };\n    } catch (error) {\n      return Promise.reject(error);\n    }\n  }\n};\nconst signUp = {\n  name: \"signUp\",\n  type: \"AccessToken!\",\n  args: {\n    firstName: \"String!\",\n    middleName: \"String!\",\n    lastName: \"String!\",\n    password: \"String!\",\n    phoneNumber: \"String!\"\n  },\n  resolve: async ({\n    args: {\n      firstName,\n      middleName,\n      lastName,\n      password,\n      phoneNumber\n    },\n    context: {\n      phoneVerification\n    }\n  }) => {\n    try {\n      const {\n        accessToken,\n        user\n      } = _authUseCases.default.signUp({\n        firstName,\n        middleName,\n        lastName,\n        password,\n        phoneNumber\n      });\n\n      console.log(accessToken);\n      return {\n        accessToken,\n        // roles: user.roles,\n        user\n      };\n    } catch (error) {\n      return Promise.reject(error);\n    }\n  }\n};\nconst logout = {\n  name: 'logout',\n  type: 'Succeed!',\n  resolve: async ({\n    context: {\n      user,\n      accessToken\n    }\n  }) => {\n    try {\n      // await redis.set(`expiredToken:${accessToken}`, user._id, 'EX', process.env.REDIS_TOKEN_EXPIRY);\n      return {\n        succeed: true\n      };\n    } catch (error) {\n      return Promise.reject(error);\n    }\n  }\n};\nvar _default = {\n  signIn,\n  signUp,\n  logout\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGgtcmVzb2x2ZXJzLmpzIl0sIm5hbWVzIjpbInNpZ25JbiIsIm5hbWUiLCJ0eXBlIiwiYXJncyIsInBob25lTnVtYmVyIiwicGFzc3dvcmQiLCJyZXNvbHZlIiwidXNlciIsImFjY2Vzc1Rva2VuIiwiYXV0aFNlcnZpY2VzIiwiZXJyb3IiLCJQcm9taXNlIiwicmVqZWN0Iiwic2lnblVwIiwiZmlyc3ROYW1lIiwibWlkZGxlTmFtZSIsImxhc3ROYW1lIiwiY29udGV4dCIsInBob25lVmVyaWZpY2F0aW9uIiwiY29uc29sZSIsImxvZyIsImxvZ291dCIsInN1Y2NlZWQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7OztBQUNBO0FBRUEsTUFBTUEsTUFBTSxHQUFHO0FBQ1hDLEVBQUFBLElBQUksRUFBRSxRQURLO0FBRVhDLEVBQUFBLElBQUksRUFBRSxjQUZLO0FBR1hDLEVBQUFBLElBQUksRUFBRTtBQUNGQyxJQUFBQSxXQUFXLEVBQUUsU0FEWDtBQUVGQyxJQUFBQSxRQUFRLEVBQUU7QUFGUixHQUhLO0FBT1hDLEVBQUFBLE9BQU8sRUFBRSxPQUFPO0FBQUNILElBQUFBLElBQUksRUFBRTtBQUFDQyxNQUFBQSxXQUFEO0FBQWNDLE1BQUFBO0FBQWQ7QUFBUCxHQUFQLEtBQTJDO0FBQ2hELFFBQUk7QUFFQSxZQUFNO0FBQUNFLFFBQUFBLElBQUQ7QUFBT0MsUUFBQUE7QUFBUCxVQUFzQixNQUFNQyxzQkFBYVQsTUFBYixDQUFvQjtBQUFDSSxRQUFBQSxXQUFEO0FBQWNDLFFBQUFBO0FBQWQsT0FBcEIsQ0FBbEM7QUFFQSxhQUFPO0FBQUNHLFFBQUFBLFdBQUQ7QUFBY0QsUUFBQUE7QUFBZCxPQUFQO0FBQ0gsS0FMRCxDQUtFLE9BQU9HLEtBQVAsRUFBYztBQUNaLGFBQU9DLE9BQU8sQ0FBQ0MsTUFBUixDQUFlRixLQUFmLENBQVA7QUFDSDtBQUNKO0FBaEJVLENBQWY7QUFvQkEsTUFBTUcsTUFBTSxHQUFHO0FBQ1haLEVBQUFBLElBQUksRUFBRSxRQURLO0FBRVhDLEVBQUFBLElBQUksRUFBRSxjQUZLO0FBR1hDLEVBQUFBLElBQUksRUFBRTtBQUNGVyxJQUFBQSxTQUFTLEVBQUUsU0FEVDtBQUVGQyxJQUFBQSxVQUFVLEVBQUUsU0FGVjtBQUdGQyxJQUFBQSxRQUFRLEVBQUUsU0FIUjtBQUlGWCxJQUFBQSxRQUFRLEVBQUUsU0FKUjtBQUtGRCxJQUFBQSxXQUFXLEVBQUU7QUFMWCxHQUhLO0FBVVhFLEVBQUFBLE9BQU8sRUFBRSxPQUFPO0FBQ0lILElBQUFBLElBQUksRUFBRTtBQUNGVyxNQUFBQSxTQURFO0FBRUZDLE1BQUFBLFVBRkU7QUFHRkMsTUFBQUEsUUFIRTtBQUlGWCxNQUFBQSxRQUpFO0FBS0ZELE1BQUFBO0FBTEUsS0FEVjtBQVFJYSxJQUFBQSxPQUFPLEVBQUU7QUFDTEMsTUFBQUE7QUFESztBQVJiLEdBQVAsS0FXYTtBQUNsQixRQUFJO0FBRUEsWUFBTTtBQUFDVixRQUFBQSxXQUFEO0FBQWNELFFBQUFBO0FBQWQsVUFBc0JFLHNCQUFhSSxNQUFiLENBQW9CO0FBQzVDQyxRQUFBQSxTQUQ0QztBQUU1Q0MsUUFBQUEsVUFGNEM7QUFHNUNDLFFBQUFBLFFBSDRDO0FBSTVDWCxRQUFBQSxRQUo0QztBQUs1Q0QsUUFBQUE7QUFMNEMsT0FBcEIsQ0FBNUI7O0FBT0FlLE1BQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZWixXQUFaO0FBQ0EsYUFBTztBQUNIQSxRQUFBQSxXQURHO0FBRUg7QUFDQUQsUUFBQUE7QUFIRyxPQUFQO0FBS0gsS0FmRCxDQWVFLE9BQU9HLEtBQVAsRUFBYztBQUNaLGFBQU9DLE9BQU8sQ0FBQ0MsTUFBUixDQUFlRixLQUFmLENBQVA7QUFDSDtBQUNKO0FBeENVLENBQWY7QUEyQ0EsTUFBTVcsTUFBTSxHQUFHO0FBQ1hwQixFQUFBQSxJQUFJLEVBQUUsUUFESztBQUVYQyxFQUFBQSxJQUFJLEVBQUUsVUFGSztBQUdYSSxFQUFBQSxPQUFPLEVBQUUsT0FBTztBQUFDVyxJQUFBQSxPQUFPLEVBQUU7QUFBQ1YsTUFBQUEsSUFBRDtBQUFPQyxNQUFBQTtBQUFQO0FBQVYsR0FBUCxLQUEwQztBQUMvQyxRQUFJO0FBQ0E7QUFFQSxhQUFPO0FBQUNjLFFBQUFBLE9BQU8sRUFBRTtBQUFWLE9BQVA7QUFDSCxLQUpELENBSUUsT0FBT1osS0FBUCxFQUFjO0FBQ1osYUFBT0MsT0FBTyxDQUFDQyxNQUFSLENBQWVGLEtBQWYsQ0FBUDtBQUNIO0FBQ0o7QUFYVSxDQUFmO2VBY2U7QUFDWFYsRUFBQUEsTUFEVztBQUVYYSxFQUFBQSxNQUZXO0FBR1hRLEVBQUFBO0FBSFcsQyIsInNvdXJjZVJvb3QiOiJDOlxcVXNlcnNcXFJlYmJlXFxEZXNrdG9wXFxoYWxldGEtbmV3LWFwaVxcc3JjXFxncmFwaHFsXFxhdXRoXFxyZXNvbHZlcnNcXCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBqd3QgZnJvbSBcImpzb253ZWJ0b2tlblwiO1xyXG5pbXBvcnQge1VzZXJNb2RlbH0gZnJvbSBcIi4uLy4uLy4uL21vZGVscy91c2VyXCI7XHJcbmltcG9ydCBhdXRoU2VydmljZXMgZnJvbSBcIi4uLy4uLy4uL3NlcnZpY2VzL2F1dGgvdXNlLWNhc2VzL2F1dGgtdXNlLWNhc2VzXCI7XHJcbi8vIGltcG9ydCBjcnlwdG8gZnJvbSBcImNyeXB0b1wiO1xyXG5cclxuY29uc3Qgc2lnbkluID0ge1xyXG4gICAgbmFtZTogXCJzaWduSW5cIixcclxuICAgIHR5cGU6IFwiQWNjZXNzVG9rZW4hXCIsXHJcbiAgICBhcmdzOiB7XHJcbiAgICAgICAgcGhvbmVOdW1iZXI6IFwiU3RyaW5nIVwiLFxyXG4gICAgICAgIHBhc3N3b3JkOiBcIlN0cmluZyFcIixcclxuICAgIH0sXHJcbiAgICByZXNvbHZlOiBhc3luYyAoe2FyZ3M6IHtwaG9uZU51bWJlciwgcGFzc3dvcmR9fSkgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB7dXNlciwgYWNjZXNzVG9rZW59ID0gYXdhaXQgYXV0aFNlcnZpY2VzLnNpZ25Jbih7cGhvbmVOdW1iZXIsIHBhc3N3b3JkfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4ge2FjY2Vzc1Rva2VuLCB1c2VyfTtcclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xyXG4gICAgICAgIH1cclxuICAgIH0sXHJcbn07XHJcblxyXG5cclxuY29uc3Qgc2lnblVwID0ge1xyXG4gICAgbmFtZTogXCJzaWduVXBcIixcclxuICAgIHR5cGU6IFwiQWNjZXNzVG9rZW4hXCIsXHJcbiAgICBhcmdzOiB7XHJcbiAgICAgICAgZmlyc3ROYW1lOiBcIlN0cmluZyFcIixcclxuICAgICAgICBtaWRkbGVOYW1lOiBcIlN0cmluZyFcIixcclxuICAgICAgICBsYXN0TmFtZTogXCJTdHJpbmchXCIsXHJcbiAgICAgICAgcGFzc3dvcmQ6IFwiU3RyaW5nIVwiLFxyXG4gICAgICAgIHBob25lTnVtYmVyOiBcIlN0cmluZyFcIixcclxuICAgIH0sXHJcbiAgICByZXNvbHZlOiBhc3luYyAoe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaXJzdE5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtaWRkbGVOYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdE5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzd29yZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBob25lTnVtYmVyXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQ6IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBob25lVmVyaWZpY2F0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgIH0pID0+IHtcclxuICAgICAgICB0cnkge1xyXG5cclxuICAgICAgICAgICAgY29uc3Qge2FjY2Vzc1Rva2VuLCB1c2VyfSA9IGF1dGhTZXJ2aWNlcy5zaWduVXAoe1xyXG4gICAgICAgICAgICAgICAgZmlyc3ROYW1lLFxyXG4gICAgICAgICAgICAgICAgbWlkZGxlTmFtZSxcclxuICAgICAgICAgICAgICAgIGxhc3ROYW1lLFxyXG4gICAgICAgICAgICAgICAgcGFzc3dvcmQsXHJcbiAgICAgICAgICAgICAgICBwaG9uZU51bWJlcixcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGFjY2Vzc1Rva2VuKSAgIFxyXG4gICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgYWNjZXNzVG9rZW4sXHJcbiAgICAgICAgICAgICAgICAvLyByb2xlczogdXNlci5yb2xlcyxcclxuICAgICAgICAgICAgICAgIHVzZXIsXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTtcclxuICAgICAgICB9XHJcbiAgICB9LFxyXG59O1xyXG5cclxuY29uc3QgbG9nb3V0ID0ge1xyXG4gICAgbmFtZTogJ2xvZ291dCcsXHJcbiAgICB0eXBlOiAnU3VjY2VlZCEnLFxyXG4gICAgcmVzb2x2ZTogYXN5bmMgKHtjb250ZXh0OiB7dXNlciwgYWNjZXNzVG9rZW59fSkgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIC8vIGF3YWl0IHJlZGlzLnNldChgZXhwaXJlZFRva2VuOiR7YWNjZXNzVG9rZW59YCwgdXNlci5faWQsICdFWCcsIHByb2Nlc3MuZW52LlJFRElTX1RPS0VOX0VYUElSWSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4ge3N1Y2NlZWQ6IHRydWV9O1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQge1xyXG4gICAgc2lnbkluLFxyXG4gICAgc2lnblVwLFxyXG4gICAgbG9nb3V0LFxyXG59Il19","map":{"version":3,"sources":["auth-resolvers.js"],"names":["signIn","name","type","args","phoneNumber","password","resolve","user","accessToken","authServices","error","Promise","reject","signUp","firstName","middleName","lastName","context","phoneVerification","console","log","logout","succeed"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;AACA;AAEA,MAAMA,MAAM,GAAG;AACXC,EAAAA,IAAI,EAAE,QADK;AAEXC,EAAAA,IAAI,EAAE,cAFK;AAGXC,EAAAA,IAAI,EAAE;AACFC,IAAAA,WAAW,EAAE,SADX;AAEFC,IAAAA,QAAQ,EAAE;AAFR,GAHK;AAOXC,EAAAA,OAAO,EAAE,OAAO;AAACH,IAAAA,IAAI,EAAE;AAACC,MAAAA,WAAD;AAAcC,MAAAA;AAAd;AAAP,GAAP,KAA2C;AAChD,QAAI;AAEA,YAAM;AAACE,QAAAA,IAAD;AAAOC,QAAAA;AAAP,UAAsB,MAAMC,sBAAaT,MAAb,CAAoB;AAACI,QAAAA,WAAD;AAAcC,QAAAA;AAAd,OAApB,CAAlC;AAEA,aAAO;AAACG,QAAAA,WAAD;AAAcD,QAAAA;AAAd,OAAP;AACH,KALD,CAKE,OAAOG,KAAP,EAAc;AACZ,aAAOC,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACH;AACJ;AAhBU,CAAf;AAoBA,MAAMG,MAAM,GAAG;AACXZ,EAAAA,IAAI,EAAE,QADK;AAEXC,EAAAA,IAAI,EAAE,cAFK;AAGXC,EAAAA,IAAI,EAAE;AACFW,IAAAA,SAAS,EAAE,SADT;AAEFC,IAAAA,UAAU,EAAE,SAFV;AAGFC,IAAAA,QAAQ,EAAE,SAHR;AAIFX,IAAAA,QAAQ,EAAE,SAJR;AAKFD,IAAAA,WAAW,EAAE;AALX,GAHK;AAUXE,EAAAA,OAAO,EAAE,OAAO;AACIH,IAAAA,IAAI,EAAE;AACFW,MAAAA,SADE;AAEFC,MAAAA,UAFE;AAGFC,MAAAA,QAHE;AAIFX,MAAAA,QAJE;AAKFD,MAAAA;AALE,KADV;AAQIa,IAAAA,OAAO,EAAE;AACLC,MAAAA;AADK;AARb,GAAP,KAWa;AAClB,QAAI;AAEA,YAAM;AAACV,QAAAA,WAAD;AAAcD,QAAAA;AAAd,UAAsBE,sBAAaI,MAAb,CAAoB;AAC5CC,QAAAA,SAD4C;AAE5CC,QAAAA,UAF4C;AAG5CC,QAAAA,QAH4C;AAI5CX,QAAAA,QAJ4C;AAK5CD,QAAAA;AAL4C,OAApB,CAA5B;;AAOAe,MAAAA,OAAO,CAACC,GAAR,CAAYZ,WAAZ;AACA,aAAO;AACHA,QAAAA,WADG;AAEH;AACAD,QAAAA;AAHG,OAAP;AAKH,KAfD,CAeE,OAAOG,KAAP,EAAc;AACZ,aAAOC,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACH;AACJ;AAxCU,CAAf;AA2CA,MAAMW,MAAM,GAAG;AACXpB,EAAAA,IAAI,EAAE,QADK;AAEXC,EAAAA,IAAI,EAAE,UAFK;AAGXI,EAAAA,OAAO,EAAE,OAAO;AAACW,IAAAA,OAAO,EAAE;AAACV,MAAAA,IAAD;AAAOC,MAAAA;AAAP;AAAV,GAAP,KAA0C;AAC/C,QAAI;AACA;AAEA,aAAO;AAACc,QAAAA,OAAO,EAAE;AAAV,OAAP;AACH,KAJD,CAIE,OAAOZ,KAAP,EAAc;AACZ,aAAOC,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACH;AACJ;AAXU,CAAf;eAce;AACXV,EAAAA,MADW;AAEXa,EAAAA,MAFW;AAGXQ,EAAAA;AAHW,C","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\graphql\\auth\\resolvers\\","sourcesContent":["import jwt from \"jsonwebtoken\";\r\nimport {UserModel} from \"../../../models/user\";\r\nimport authServices from \"../../../services/auth/use-cases/auth-use-cases\";\r\n// import crypto from \"crypto\";\r\n\r\nconst signIn = {\r\n    name: \"signIn\",\r\n    type: \"AccessToken!\",\r\n    args: {\r\n        phoneNumber: \"String!\",\r\n        password: \"String!\",\r\n    },\r\n    resolve: async ({args: {phoneNumber, password}}) => {\r\n        try {\r\n\r\n            const {user, accessToken} = await authServices.signIn({phoneNumber, password});\r\n\r\n            return {accessToken, user};\r\n        } catch (error) {\r\n            return Promise.reject(error);\r\n        }\r\n    },\r\n};\r\n\r\n\r\nconst signUp = {\r\n    name: \"signUp\",\r\n    type: \"AccessToken!\",\r\n    args: {\r\n        firstName: \"String!\",\r\n        middleName: \"String!\",\r\n        lastName: \"String!\",\r\n        password: \"String!\",\r\n        phoneNumber: \"String!\",\r\n    },\r\n    resolve: async ({\r\n                        args: {\r\n                            firstName,\r\n                            middleName,\r\n                            lastName,\r\n                            password,\r\n                            phoneNumber\r\n                        },\r\n                        context: {\r\n                            phoneVerification,\r\n                        },\r\n                    }) => {\r\n        try {\r\n\r\n            const {accessToken, user} = authServices.signUp({\r\n                firstName,\r\n                middleName,\r\n                lastName,\r\n                password,\r\n                phoneNumber,\r\n            });\r\n            console.log(accessToken)   \r\n            return {\r\n                accessToken,\r\n                // roles: user.roles,\r\n                user,\r\n            };\r\n        } catch (error) {\r\n            return Promise.reject(error);\r\n        }\r\n    },\r\n};\r\n\r\nconst logout = {\r\n    name: 'logout',\r\n    type: 'Succeed!',\r\n    resolve: async ({context: {user, accessToken}}) => {\r\n        try {\r\n            // await redis.set(`expiredToken:${accessToken}`, user._id, 'EX', process.env.REDIS_TOKEN_EXPIRY);\r\n\r\n            return {succeed: true};\r\n        } catch (error) {\r\n            return Promise.reject(error);\r\n        }\r\n    }\r\n};\r\n\r\nexport default {\r\n    signIn,\r\n    signUp,\r\n    logout,\r\n}"]}},"mtime":1648584005995},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\services\\\\auth\\\\use-cases\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\services\\\\auth\\\\use-cases\\\\auth-use-cases.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\n\nvar _user = require(\"../../../models/user\");\n\nvar _authDataAccess = _interopRequireDefault(require(\"../data-access/auth-data-access\"));\n\nvar _redisConfig = _interopRequireDefault(require(\"../../../config/redis-config\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// import crypto from \"crypto\";\n//load our .env file\nrequire('dotenv').config();\n\nconst signIn = async ({\n  phoneNumber,\n  password\n}) => {\n  try {\n    const user = await _authDataAccess.default.signIn({\n      phoneNumber,\n      password\n    }); //check if session exists in mongodb increase count on mongodb\n    //if session doesn't exist create a new one\n\n    const accessToken = await _jsonwebtoken.default.sign(user.toJSON(), process.env.JWT_SECRET, {\n      expiresIn: process.env.JWT_EXPIRATION\n    }); // storeNewSession(token, user information(id), count, last update)\n\n    return {\n      accessToken,\n      user\n    };\n  } catch (error) {\n    return Promise.reject(error);\n  }\n};\n\nconst signUp = async ({\n  firstName,\n  middleName,\n  lastName,\n  password,\n  phoneNumber\n}) => {\n  try {\n    const user = _authDataAccess.default.signUp({\n      firstName,\n      middleName,\n      lastName,\n      password,\n      phoneNumber\n    }); //check if there is an error\n\n\n    const accessToken = await _jsonwebtoken.default.sign(JSON.parse(JSON.stringify(user)), // roles: user.roles,\n    process.env.JWT_SECRET, {\n      expiresIn: process.env.JWT_EXPIRATION\n    }); // storeNewSession(token, user information(id), count, last update)\n\n    return {\n      accessToken,\n      user\n    };\n  } catch (error) {\n    return Promise.reject(error);\n  }\n};\n\nvar _default = {\n  signIn,\n  signUp\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGgtdXNlLWNhc2VzLmpzIl0sIm5hbWVzIjpbInJlcXVpcmUiLCJjb25maWciLCJzaWduSW4iLCJwaG9uZU51bWJlciIsInBhc3N3b3JkIiwidXNlciIsImF1dGhSZXBvc2l0b3J5IiwiYWNjZXNzVG9rZW4iLCJqd3QiLCJzaWduIiwidG9KU09OIiwicHJvY2VzcyIsImVudiIsIkpXVF9TRUNSRVQiLCJleHBpcmVzSW4iLCJKV1RfRVhQSVJBVElPTiIsImVycm9yIiwiUHJvbWlzZSIsInJlamVjdCIsInNpZ25VcCIsImZpcnN0TmFtZSIsIm1pZGRsZU5hbWUiLCJsYXN0TmFtZSIsIkpTT04iLCJwYXJzZSIsInN0cmluZ2lmeSJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOztBQUVBOztBQUNBOzs7O0FBRkE7QUFJQTtBQUNBQSxPQUFPLENBQUMsUUFBRCxDQUFQLENBQWtCQyxNQUFsQjs7QUFFQSxNQUFNQyxNQUFNLEdBQUcsT0FBTztBQUFDQyxFQUFBQSxXQUFEO0FBQWNDLEVBQUFBO0FBQWQsQ0FBUCxLQUFtQztBQUM5QyxNQUFJO0FBRUEsVUFBTUMsSUFBSSxHQUFHLE1BQU1DLHdCQUFlSixNQUFmLENBQXNCO0FBQUNDLE1BQUFBLFdBQUQ7QUFBY0MsTUFBQUE7QUFBZCxLQUF0QixDQUFuQixDQUZBLENBSUE7QUFDQTs7QUFDQSxVQUFNRyxXQUFXLEdBQUcsTUFBTUMsc0JBQUlDLElBQUosQ0FBU0osSUFBSSxDQUFDSyxNQUFMLEVBQVQsRUFBd0JDLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxVQUFwQyxFQUFnRDtBQUN0RUMsTUFBQUEsU0FBUyxFQUFFSCxPQUFPLENBQUNDLEdBQVIsQ0FBWUc7QUFEK0MsS0FBaEQsQ0FBMUIsQ0FOQSxDQVVBOztBQUVBLFdBQU87QUFDSFIsTUFBQUEsV0FERztBQUVIRixNQUFBQTtBQUZHLEtBQVA7QUFJSCxHQWhCRCxDQWdCRSxPQUFPVyxLQUFQLEVBQWM7QUFDWixXQUFPQyxPQUFPLENBQUNDLE1BQVIsQ0FBZUYsS0FBZixDQUFQO0FBQ0g7QUFDSixDQXBCRDs7QUFzQkEsTUFBTUcsTUFBTSxHQUFHLE9BQU87QUFBQ0MsRUFBQUEsU0FBRDtBQUFXQyxFQUFBQSxVQUFYO0FBQXNCQyxFQUFBQSxRQUF0QjtBQUErQmxCLEVBQUFBLFFBQS9CO0FBQXdDRCxFQUFBQTtBQUF4QyxDQUFQLEtBQWdFO0FBQzNFLE1BQUk7QUFDQSxVQUFNRSxJQUFJLEdBQUdDLHdCQUFlYSxNQUFmLENBQXNCO0FBQUNDLE1BQUFBLFNBQUQ7QUFBV0MsTUFBQUEsVUFBWDtBQUFzQkMsTUFBQUEsUUFBdEI7QUFBK0JsQixNQUFBQSxRQUEvQjtBQUF3Q0QsTUFBQUE7QUFBeEMsS0FBdEIsQ0FBYixDQURBLENBR0E7OztBQUVBLFVBQU1JLFdBQVcsR0FBRyxNQUFNQyxzQkFBSUMsSUFBSixDQUN0QmMsSUFBSSxDQUFDQyxLQUFMLENBQVdELElBQUksQ0FBQ0UsU0FBTCxDQUFlcEIsSUFBZixDQUFYLENBRHNCLEVBRXRCO0FBQ0FNLElBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZQyxVQUhVLEVBR0U7QUFDeEJDLE1BQUFBLFNBQVMsRUFBRUgsT0FBTyxDQUFDQyxHQUFSLENBQVlHO0FBREMsS0FIRixDQUExQixDQUxBLENBWUE7O0FBRUEsV0FBTztBQUNIUixNQUFBQSxXQURHO0FBRUhGLE1BQUFBO0FBRkcsS0FBUDtBQUlILEdBbEJELENBa0JFLE9BQU9XLEtBQVAsRUFBYztBQUNaLFdBQU9DLE9BQU8sQ0FBQ0MsTUFBUixDQUFlRixLQUFmLENBQVA7QUFDSDtBQUNKLENBdEJEOztlQXlCZTtBQUNYZCxFQUFBQSxNQURXO0FBRVhpQixFQUFBQTtBQUZXLEMiLCJzb3VyY2VSb290IjoiQzpcXFVzZXJzXFxSZWJiZVxcRGVza3RvcFxcaGFsZXRhLW5ldy1hcGlcXHNyY1xcc2VydmljZXNcXGF1dGhcXHVzZS1jYXNlc1xcIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGp3dCBmcm9tIFwianNvbndlYnRva2VuXCI7XHJcbmltcG9ydCB7VXNlck1vZGVsfSBmcm9tIFwiLi4vLi4vLi4vbW9kZWxzL3VzZXJcIjtcclxuLy8gaW1wb3J0IGNyeXB0byBmcm9tIFwiY3J5cHRvXCI7XHJcbmltcG9ydCBhdXRoUmVwb3NpdG9yeSBmcm9tIFwiLi4vZGF0YS1hY2Nlc3MvYXV0aC1kYXRhLWFjY2Vzc1wiO1xyXG5pbXBvcnQgY2xpZW50IGZyb20gXCIuLi8uLi8uLi9jb25maWcvcmVkaXMtY29uZmlnXCI7XHJcblxyXG4vL2xvYWQgb3VyIC5lbnYgZmlsZVxyXG5yZXF1aXJlKCdkb3RlbnYnKS5jb25maWcoKVxyXG5cclxuY29uc3Qgc2lnbkluID0gYXN5bmMgKHtwaG9uZU51bWJlciwgcGFzc3dvcmR9KSA9PiB7XHJcbiAgICB0cnkge1xyXG5cclxuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgYXV0aFJlcG9zaXRvcnkuc2lnbkluKHtwaG9uZU51bWJlciwgcGFzc3dvcmR9KTtcclxuXHJcbiAgICAgICAgLy9jaGVjayBpZiBzZXNzaW9uIGV4aXN0cyBpbiBtb25nb2RiIGluY3JlYXNlIGNvdW50IG9uIG1vbmdvZGJcclxuICAgICAgICAvL2lmIHNlc3Npb24gZG9lc24ndCBleGlzdCBjcmVhdGUgYSBuZXcgb25lXHJcbiAgICAgICAgY29uc3QgYWNjZXNzVG9rZW4gPSBhd2FpdCBqd3Quc2lnbih1c2VyLnRvSlNPTigpLCBwcm9jZXNzLmVudi5KV1RfU0VDUkVULCB7XHJcbiAgICAgICAgICAgIGV4cGlyZXNJbjogcHJvY2Vzcy5lbnYuSldUX0VYUElSQVRJT04sXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIHN0b3JlTmV3U2Vzc2lvbih0b2tlbiwgdXNlciBpbmZvcm1hdGlvbihpZCksIGNvdW50LCBsYXN0IHVwZGF0ZSlcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBhY2Nlc3NUb2tlbixcclxuICAgICAgICAgICAgdXNlcixcclxuICAgICAgICB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xyXG4gICAgfVxyXG59XHJcblxyXG5jb25zdCBzaWduVXAgPSBhc3luYyAoe2ZpcnN0TmFtZSxtaWRkbGVOYW1lLGxhc3ROYW1lLHBhc3N3b3JkLHBob25lTnVtYmVyfSkgPT4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgICBjb25zdCB1c2VyID0gYXV0aFJlcG9zaXRvcnkuc2lnblVwKHtmaXJzdE5hbWUsbWlkZGxlTmFtZSxsYXN0TmFtZSxwYXNzd29yZCxwaG9uZU51bWJlcn0pXHJcblxyXG4gICAgICAgIC8vY2hlY2sgaWYgdGhlcmUgaXMgYW4gZXJyb3JcclxuXHJcbiAgICAgICAgY29uc3QgYWNjZXNzVG9rZW4gPSBhd2FpdCBqd3Quc2lnbihcclxuICAgICAgICAgICAgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh1c2VyKSksXHJcbiAgICAgICAgICAgIC8vIHJvbGVzOiB1c2VyLnJvbGVzLFxyXG4gICAgICAgICAgICBwcm9jZXNzLmVudi5KV1RfU0VDUkVULCB7XHJcbiAgICAgICAgICAgIGV4cGlyZXNJbjogcHJvY2Vzcy5lbnYuSldUX0VYUElSQVRJT04sXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIHN0b3JlTmV3U2Vzc2lvbih0b2tlbiwgdXNlciBpbmZvcm1hdGlvbihpZCksIGNvdW50LCBsYXN0IHVwZGF0ZSlcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgYWNjZXNzVG9rZW4sXHJcbiAgICAgICAgICAgIHVzZXIsXHJcbiAgICAgICAgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTtcclxuICAgIH1cclxufVxyXG5cclxuXHJcbmV4cG9ydCBkZWZhdWx0IHtcclxuICAgIHNpZ25JbixcclxuICAgIHNpZ25VcFxyXG59Il19","map":{"version":3,"sources":["auth-use-cases.js"],"names":["require","config","signIn","phoneNumber","password","user","authRepository","accessToken","jwt","sign","toJSON","process","env","JWT_SECRET","expiresIn","JWT_EXPIRATION","error","Promise","reject","signUp","firstName","middleName","lastName","JSON","parse","stringify"],"mappings":";;;;;;;AAAA;;AACA;;AAEA;;AACA;;;;AAFA;AAIA;AACAA,OAAO,CAAC,QAAD,CAAP,CAAkBC,MAAlB;;AAEA,MAAMC,MAAM,GAAG,OAAO;AAACC,EAAAA,WAAD;AAAcC,EAAAA;AAAd,CAAP,KAAmC;AAC9C,MAAI;AAEA,UAAMC,IAAI,GAAG,MAAMC,wBAAeJ,MAAf,CAAsB;AAACC,MAAAA,WAAD;AAAcC,MAAAA;AAAd,KAAtB,CAAnB,CAFA,CAIA;AACA;;AACA,UAAMG,WAAW,GAAG,MAAMC,sBAAIC,IAAJ,CAASJ,IAAI,CAACK,MAAL,EAAT,EAAwBC,OAAO,CAACC,GAAR,CAAYC,UAApC,EAAgD;AACtEC,MAAAA,SAAS,EAAEH,OAAO,CAACC,GAAR,CAAYG;AAD+C,KAAhD,CAA1B,CANA,CAUA;;AAEA,WAAO;AACHR,MAAAA,WADG;AAEHF,MAAAA;AAFG,KAAP;AAIH,GAhBD,CAgBE,OAAOW,KAAP,EAAc;AACZ,WAAOC,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACH;AACJ,CApBD;;AAsBA,MAAMG,MAAM,GAAG,OAAO;AAACC,EAAAA,SAAD;AAAWC,EAAAA,UAAX;AAAsBC,EAAAA,QAAtB;AAA+BlB,EAAAA,QAA/B;AAAwCD,EAAAA;AAAxC,CAAP,KAAgE;AAC3E,MAAI;AACA,UAAME,IAAI,GAAGC,wBAAea,MAAf,CAAsB;AAACC,MAAAA,SAAD;AAAWC,MAAAA,UAAX;AAAsBC,MAAAA,QAAtB;AAA+BlB,MAAAA,QAA/B;AAAwCD,MAAAA;AAAxC,KAAtB,CAAb,CADA,CAGA;;;AAEA,UAAMI,WAAW,GAAG,MAAMC,sBAAIC,IAAJ,CACtBc,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAepB,IAAf,CAAX,CADsB,EAEtB;AACAM,IAAAA,OAAO,CAACC,GAAR,CAAYC,UAHU,EAGE;AACxBC,MAAAA,SAAS,EAAEH,OAAO,CAACC,GAAR,CAAYG;AADC,KAHF,CAA1B,CALA,CAYA;;AAEA,WAAO;AACHR,MAAAA,WADG;AAEHF,MAAAA;AAFG,KAAP;AAIH,GAlBD,CAkBE,OAAOW,KAAP,EAAc;AACZ,WAAOC,OAAO,CAACC,MAAR,CAAeF,KAAf,CAAP;AACH;AACJ,CAtBD;;eAyBe;AACXd,EAAAA,MADW;AAEXiB,EAAAA;AAFW,C","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\services\\auth\\use-cases\\","sourcesContent":["import jwt from \"jsonwebtoken\";\r\nimport {UserModel} from \"../../../models/user\";\r\n// import crypto from \"crypto\";\r\nimport authRepository from \"../data-access/auth-data-access\";\r\nimport client from \"../../../config/redis-config\";\r\n\r\n//load our .env file\r\nrequire('dotenv').config()\r\n\r\nconst signIn = async ({phoneNumber, password}) => {\r\n    try {\r\n\r\n        const user = await authRepository.signIn({phoneNumber, password});\r\n\r\n        //check if session exists in mongodb increase count on mongodb\r\n        //if session doesn't exist create a new one\r\n        const accessToken = await jwt.sign(user.toJSON(), process.env.JWT_SECRET, {\r\n            expiresIn: process.env.JWT_EXPIRATION,\r\n        });\r\n\r\n        // storeNewSession(token, user information(id), count, last update)\r\n        \r\n        return {\r\n            accessToken,\r\n            user,\r\n        };\r\n    } catch (error) {\r\n        return Promise.reject(error);\r\n    }\r\n}\r\n\r\nconst signUp = async ({firstName,middleName,lastName,password,phoneNumber}) => {\r\n    try {\r\n        const user = authRepository.signUp({firstName,middleName,lastName,password,phoneNumber})\r\n\r\n        //check if there is an error\r\n\r\n        const accessToken = await jwt.sign(\r\n            JSON.parse(JSON.stringify(user)),\r\n            // roles: user.roles,\r\n            process.env.JWT_SECRET, {\r\n            expiresIn: process.env.JWT_EXPIRATION,\r\n        });\r\n\r\n        // storeNewSession(token, user information(id), count, last update)\r\n\r\n        return {\r\n            accessToken,\r\n            user,\r\n        };\r\n    } catch (error) {\r\n        return Promise.reject(error);\r\n    }\r\n}\r\n\r\n\r\nexport default {\r\n    signIn,\r\n    signUp\r\n}"]}},"mtime":1648584188002},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\services\\\\auth\\\\data-access\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\services\\\\auth\\\\data-access\\\\auth-data-access.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\n\nvar _user = require(\"../../../models/user\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// import crypto from \"crypto\";\nconst signIn = async ({\n  phoneNumber,\n  password\n}) => {\n  try {\n    const user = await _user.UserModel.findOne({\n      phoneNumber\n    }); // const comparePassword = await user.comparePassword(password.toString());\n\n    const comparePassword = password.toString() === user.password;\n\n    if (!comparePassword) {\n      return Promise.reject(new Error(\"Password is incorrect.\"));\n    }\n\n    return user;\n  } catch (error) {\n    return Promise.reject(error);\n  }\n};\n\nconst signUp = async ({\n  firstName,\n  middleName,\n  lastName,\n  phoneNumber,\n  password\n}) => {\n  try {\n    let user = await _user.UserModel.phoneNumberExist(phoneNumber);\n\n    if (user) {\n      console.log(\"here 2\");\n      return Promise.reject(new Error(\"Phone Number has already been taken.\"));\n    }\n\n    user = await _user.UserModel.emailExist(email);\n\n    if (user) {\n      return Promise.reject(new Error(\"Email has already been taken.\"));\n    }\n\n    const salt = bcrypt.genSalt(10);\n    const hash = bcrypt.hashSync(password, salt);\n    user = await new _user.UserModel({\n      firstName,\n      middleName,\n      lastName,\n      phoneNumber,\n      hash\n    }).save();\n    return user;\n  } catch (error) {\n    return Promise.reject(error);\n  }\n};\n\nvar _default = {\n  signIn,\n  signUp\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGgtZGF0YS1hY2Nlc3MuanMiXSwibmFtZXMiOlsic2lnbkluIiwicGhvbmVOdW1iZXIiLCJwYXNzd29yZCIsInVzZXIiLCJVc2VyTW9kZWwiLCJmaW5kT25lIiwiY29tcGFyZVBhc3N3b3JkIiwidG9TdHJpbmciLCJQcm9taXNlIiwicmVqZWN0IiwiRXJyb3IiLCJlcnJvciIsInNpZ25VcCIsImZpcnN0TmFtZSIsIm1pZGRsZU5hbWUiLCJsYXN0TmFtZSIsInBob25lTnVtYmVyRXhpc3QiLCJjb25zb2xlIiwibG9nIiwiZW1haWxFeGlzdCIsImVtYWlsIiwic2FsdCIsImJjcnlwdCIsImdlblNhbHQiLCJoYXNoIiwiaGFzaFN5bmMiLCJzYXZlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBQ0E7Ozs7QUFDQTtBQUVBLE1BQU1BLE1BQU0sR0FBRyxPQUFPO0FBQUVDLEVBQUFBLFdBQUY7QUFBZUMsRUFBQUE7QUFBZixDQUFQLEtBQXFDO0FBQ2xELE1BQUk7QUFDRixVQUFNQyxJQUFJLEdBQUcsTUFBTUMsZ0JBQVVDLE9BQVYsQ0FBa0I7QUFBRUosTUFBQUE7QUFBRixLQUFsQixDQUFuQixDQURFLENBR0Y7O0FBQ0EsVUFBTUssZUFBZSxHQUFJSixRQUFRLENBQUNLLFFBQVQsT0FBd0JKLElBQUksQ0FBQ0QsUUFBdEQ7O0FBQ0EsUUFBSSxDQUFDSSxlQUFMLEVBQXNCO0FBQ3BCLGFBQU9FLE9BQU8sQ0FBQ0MsTUFBUixDQUFlLElBQUlDLEtBQUosQ0FBVSx3QkFBVixDQUFmLENBQVA7QUFDRDs7QUFFRCxXQUFPUCxJQUFQO0FBQ0QsR0FWRCxDQVVFLE9BQU9RLEtBQVAsRUFBYztBQUNkLFdBQU9ILE9BQU8sQ0FBQ0MsTUFBUixDQUFlRSxLQUFmLENBQVA7QUFDRDtBQUNGLENBZEQ7O0FBZ0JBLE1BQU1DLE1BQU0sR0FBRyxPQUFPO0FBQ3BCQyxFQUFBQSxTQURvQjtBQUVwQkMsRUFBQUEsVUFGb0I7QUFHcEJDLEVBQUFBLFFBSG9CO0FBSXBCZCxFQUFBQSxXQUpvQjtBQUtwQkMsRUFBQUE7QUFMb0IsQ0FBUCxLQU1UO0FBQ0osTUFBSTtBQUVGLFFBQUlDLElBQUksR0FBRyxNQUFNQyxnQkFBVVksZ0JBQVYsQ0FBMkJmLFdBQTNCLENBQWpCOztBQUNBLFFBQUlFLElBQUosRUFBVTtBQUNOYyxNQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWSxRQUFaO0FBQ0EsYUFBT1YsT0FBTyxDQUFDQyxNQUFSLENBQWUsSUFBSUMsS0FBSixDQUFVLHNDQUFWLENBQWYsQ0FBUDtBQUNIOztBQUVEUCxJQUFBQSxJQUFJLEdBQUcsTUFBTUMsZ0JBQVVlLFVBQVYsQ0FBcUJDLEtBQXJCLENBQWI7O0FBQ0EsUUFBSWpCLElBQUosRUFBVTtBQUNSLGFBQU9LLE9BQU8sQ0FBQ0MsTUFBUixDQUFlLElBQUlDLEtBQUosQ0FBVSwrQkFBVixDQUFmLENBQVA7QUFDRDs7QUFDRCxVQUFNVyxJQUFJLEdBQUdDLE1BQU0sQ0FBQ0MsT0FBUCxDQUFlLEVBQWYsQ0FBYjtBQUNBLFVBQU1DLElBQUksR0FBR0YsTUFBTSxDQUFDRyxRQUFQLENBQWdCdkIsUUFBaEIsRUFBMEJtQixJQUExQixDQUFiO0FBRUFsQixJQUFBQSxJQUFJLEdBQUcsTUFBTSxJQUFJQyxlQUFKLENBQWM7QUFDekJTLE1BQUFBLFNBRHlCO0FBRXpCQyxNQUFBQSxVQUZ5QjtBQUd6QkMsTUFBQUEsUUFIeUI7QUFJekJkLE1BQUFBLFdBSnlCO0FBS3pCdUIsTUFBQUE7QUFMeUIsS0FBZCxFQU1WRSxJQU5VLEVBQWI7QUFRQSxXQUFPdkIsSUFBUDtBQUNELEdBeEJELENBd0JFLE9BQU9RLEtBQVAsRUFBYztBQUNkLFdBQU9ILE9BQU8sQ0FBQ0MsTUFBUixDQUFlRSxLQUFmLENBQVA7QUFDRDtBQUNGLENBbENEOztlQW9DZTtBQUNiWCxFQUFBQSxNQURhO0FBRWJZLEVBQUFBO0FBRmEsQyIsInNvdXJjZVJvb3QiOiJDOlxcVXNlcnNcXFJlYmJlXFxEZXNrdG9wXFxoYWxldGEtbmV3LWFwaVxcc3JjXFxzZXJ2aWNlc1xcYXV0aFxcZGF0YS1hY2Nlc3NcXCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBqd3QgZnJvbSBcImpzb253ZWJ0b2tlblwiO1xyXG5pbXBvcnQgeyBVc2VyTW9kZWwgfSBmcm9tIFwiLi4vLi4vLi4vbW9kZWxzL3VzZXJcIjtcclxuLy8gaW1wb3J0IGNyeXB0byBmcm9tIFwiY3J5cHRvXCI7XHJcblxyXG5jb25zdCBzaWduSW4gPSBhc3luYyAoeyBwaG9uZU51bWJlciwgcGFzc3dvcmQgfSkgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlck1vZGVsLmZpbmRPbmUoeyBwaG9uZU51bWJlciB9KTtcclxuXHJcbiAgICAvLyBjb25zdCBjb21wYXJlUGFzc3dvcmQgPSBhd2FpdCB1c2VyLmNvbXBhcmVQYXNzd29yZChwYXNzd29yZC50b1N0cmluZygpKTtcclxuICAgIGNvbnN0IGNvbXBhcmVQYXNzd29yZCA9IChwYXNzd29yZC50b1N0cmluZygpID09PSB1c2VyLnBhc3N3b3JkKVxyXG4gICAgaWYgKCFjb21wYXJlUGFzc3dvcmQpIHtcclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcIlBhc3N3b3JkIGlzIGluY29ycmVjdC5cIikpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB1c2VyO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xyXG4gIH1cclxufTtcclxuXHJcbmNvbnN0IHNpZ25VcCA9IGFzeW5jICh7XHJcbiAgZmlyc3ROYW1lLFxyXG4gIG1pZGRsZU5hbWUsXHJcbiAgbGFzdE5hbWUsXHJcbiAgcGhvbmVOdW1iZXIsXHJcbiAgcGFzc3dvcmQsXHJcbn0pID0+IHtcclxuICB0cnkge1xyXG5cclxuICAgIGxldCB1c2VyID0gYXdhaXQgVXNlck1vZGVsLnBob25lTnVtYmVyRXhpc3QocGhvbmVOdW1iZXIpO1xyXG4gICAgaWYgKHVzZXIpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcImhlcmUgMlwiKVxyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoXCJQaG9uZSBOdW1iZXIgaGFzIGFscmVhZHkgYmVlbiB0YWtlbi5cIikpO1xyXG4gICAgfVxyXG5cclxuICAgIHVzZXIgPSBhd2FpdCBVc2VyTW9kZWwuZW1haWxFeGlzdChlbWFpbCk7XHJcbiAgICBpZiAodXNlcikge1xyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKFwiRW1haWwgaGFzIGFscmVhZHkgYmVlbiB0YWtlbi5cIikpO1xyXG4gICAgfVxyXG4gICAgY29uc3Qgc2FsdCA9IGJjcnlwdC5nZW5TYWx0KDEwKTtcclxuICAgIGNvbnN0IGhhc2ggPSBiY3J5cHQuaGFzaFN5bmMocGFzc3dvcmQsIHNhbHQpO1xyXG5cclxuICAgIHVzZXIgPSBhd2FpdCBuZXcgVXNlck1vZGVsKHtcclxuICAgICAgZmlyc3ROYW1lLFxyXG4gICAgICBtaWRkbGVOYW1lLFxyXG4gICAgICBsYXN0TmFtZSxcclxuICAgICAgcGhvbmVOdW1iZXIsXHJcbiAgICAgIGhhc2gsXHJcbiAgICB9KS5zYXZlKCk7XHJcblxyXG4gICAgcmV0dXJuIHVzZXI7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XHJcbiAgfVxyXG59O1xyXG5cclxuZXhwb3J0IGRlZmF1bHQge1xyXG4gIHNpZ25JbixcclxuICBzaWduVXAsXHJcbn07XHJcbiJdfQ==","map":{"version":3,"sources":["auth-data-access.js"],"names":["signIn","phoneNumber","password","user","UserModel","findOne","comparePassword","toString","Promise","reject","Error","error","signUp","firstName","middleName","lastName","phoneNumberExist","console","log","emailExist","email","salt","bcrypt","genSalt","hash","hashSync","save"],"mappings":";;;;;;;AAAA;;AACA;;;;AACA;AAEA,MAAMA,MAAM,GAAG,OAAO;AAAEC,EAAAA,WAAF;AAAeC,EAAAA;AAAf,CAAP,KAAqC;AAClD,MAAI;AACF,UAAMC,IAAI,GAAG,MAAMC,gBAAUC,OAAV,CAAkB;AAAEJ,MAAAA;AAAF,KAAlB,CAAnB,CADE,CAGF;;AACA,UAAMK,eAAe,GAAIJ,QAAQ,CAACK,QAAT,OAAwBJ,IAAI,CAACD,QAAtD;;AACA,QAAI,CAACI,eAAL,EAAsB;AACpB,aAAOE,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAU,wBAAV,CAAf,CAAP;AACD;;AAED,WAAOP,IAAP;AACD,GAVD,CAUE,OAAOQ,KAAP,EAAc;AACd,WAAOH,OAAO,CAACC,MAAR,CAAeE,KAAf,CAAP;AACD;AACF,CAdD;;AAgBA,MAAMC,MAAM,GAAG,OAAO;AACpBC,EAAAA,SADoB;AAEpBC,EAAAA,UAFoB;AAGpBC,EAAAA,QAHoB;AAIpBd,EAAAA,WAJoB;AAKpBC,EAAAA;AALoB,CAAP,KAMT;AACJ,MAAI;AAEF,QAAIC,IAAI,GAAG,MAAMC,gBAAUY,gBAAV,CAA2Bf,WAA3B,CAAjB;;AACA,QAAIE,IAAJ,EAAU;AACNc,MAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ;AACA,aAAOV,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAU,sCAAV,CAAf,CAAP;AACH;;AAEDP,IAAAA,IAAI,GAAG,MAAMC,gBAAUe,UAAV,CAAqBC,KAArB,CAAb;;AACA,QAAIjB,IAAJ,EAAU;AACR,aAAOK,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAU,+BAAV,CAAf,CAAP;AACD;;AACD,UAAMW,IAAI,GAAGC,MAAM,CAACC,OAAP,CAAe,EAAf,CAAb;AACA,UAAMC,IAAI,GAAGF,MAAM,CAACG,QAAP,CAAgBvB,QAAhB,EAA0BmB,IAA1B,CAAb;AAEAlB,IAAAA,IAAI,GAAG,MAAM,IAAIC,eAAJ,CAAc;AACzBS,MAAAA,SADyB;AAEzBC,MAAAA,UAFyB;AAGzBC,MAAAA,QAHyB;AAIzBd,MAAAA,WAJyB;AAKzBuB,MAAAA;AALyB,KAAd,EAMVE,IANU,EAAb;AAQA,WAAOvB,IAAP;AACD,GAxBD,CAwBE,OAAOQ,KAAP,EAAc;AACd,WAAOH,OAAO,CAACC,MAAR,CAAeE,KAAf,CAAP;AACD;AACF,CAlCD;;eAoCe;AACbX,EAAAA,MADa;AAEbY,EAAAA;AAFa,C","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\services\\auth\\data-access\\","sourcesContent":["import jwt from \"jsonwebtoken\";\r\nimport { UserModel } from \"../../../models/user\";\r\n// import crypto from \"crypto\";\r\n\r\nconst signIn = async ({ phoneNumber, password }) => {\r\n  try {\r\n    const user = await UserModel.findOne({ phoneNumber });\r\n\r\n    // const comparePassword = await user.comparePassword(password.toString());\r\n    const comparePassword = (password.toString() === user.password)\r\n    if (!comparePassword) {\r\n      return Promise.reject(new Error(\"Password is incorrect.\"));\r\n    }\r\n\r\n    return user;\r\n  } catch (error) {\r\n    return Promise.reject(error);\r\n  }\r\n};\r\n\r\nconst signUp = async ({\r\n  firstName,\r\n  middleName,\r\n  lastName,\r\n  phoneNumber,\r\n  password,\r\n}) => {\r\n  try {\r\n\r\n    let user = await UserModel.phoneNumberExist(phoneNumber);\r\n    if (user) {\r\n        console.log(\"here 2\")\r\n        return Promise.reject(new Error(\"Phone Number has already been taken.\"));\r\n    }\r\n\r\n    user = await UserModel.emailExist(email);\r\n    if (user) {\r\n      return Promise.reject(new Error(\"Email has already been taken.\"));\r\n    }\r\n    const salt = bcrypt.genSalt(10);\r\n    const hash = bcrypt.hashSync(password, salt);\r\n\r\n    user = await new UserModel({\r\n      firstName,\r\n      middleName,\r\n      lastName,\r\n      phoneNumber,\r\n      hash,\r\n    }).save();\r\n\r\n    return user;\r\n  } catch (error) {\r\n    return Promise.reject(error);\r\n  }\r\n};\r\n\r\nexport default {\r\n  signIn,\r\n  signUp,\r\n};\r\n"]}},"mtime":1648584230491},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\config\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\config\\\\redis-config.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _ioredis = _interopRequireDefault(require(\"ioredis\"));\n\nvar _winston = _interopRequireDefault(require(\"winston\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst client = new _ioredis.default({\n  host: process.env.REDIS_HOST,\n  port: process.env.REDIS_PORT //REDIS_PORT=6379\n\n});\nclient.on(\"error\", error => {\n  console.log(error);\n\n  _winston.default.error(error);\n\n  client.quit().then(e => console.log(e));\n});\nclient.on(\"connect\", () => _winston.default.info(\"Redis client connected\"));\nvar _default = client;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlZGlzLWNvbmZpZy5qcyJdLCJuYW1lcyI6WyJjbGllbnQiLCJSZWRpcyIsImhvc3QiLCJwcm9jZXNzIiwiZW52IiwiUkVESVNfSE9TVCIsInBvcnQiLCJSRURJU19QT1JUIiwib24iLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJ3aW5zdG9uIiwicXVpdCIsInRoZW4iLCJlIiwiaW5mbyJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOzs7O0FBRUEsTUFBTUEsTUFBTSxHQUFHLElBQUlDLGdCQUFKLENBQVU7QUFDdkJDLEVBQUFBLElBQUksRUFBRUMsT0FBTyxDQUFDQyxHQUFSLENBQVlDLFVBREs7QUFFdkJDLEVBQUFBLElBQUksRUFBRUgsT0FBTyxDQUFDQyxHQUFSLENBQVlHLFVBRkssQ0FFTzs7QUFGUCxDQUFWLENBQWY7QUFLQVAsTUFBTSxDQUFDUSxFQUFQLENBQVUsT0FBVixFQUFvQkMsS0FBRCxJQUFXO0FBQzVCQyxFQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWUYsS0FBWjs7QUFDQUcsbUJBQVFILEtBQVIsQ0FBY0EsS0FBZDs7QUFDQVQsRUFBQUEsTUFBTSxDQUFDYSxJQUFQLEdBQWNDLElBQWQsQ0FBb0JDLENBQUQsSUFBT0wsT0FBTyxDQUFDQyxHQUFSLENBQVlJLENBQVosQ0FBMUI7QUFDRCxDQUpEO0FBTUFmLE1BQU0sQ0FBQ1EsRUFBUCxDQUFVLFNBQVYsRUFBcUIsTUFBTUksaUJBQVFJLElBQVIsQ0FBYSx3QkFBYixDQUEzQjtlQUVlaEIsTSIsInNvdXJjZVJvb3QiOiJDOlxcVXNlcnNcXFJlYmJlXFxEZXNrdG9wXFxoYWxldGEtbmV3LWFwaVxcc3JjXFxjb25maWdcXCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWRpcyBmcm9tIFwiaW9yZWRpc1wiO1xyXG5pbXBvcnQgd2luc3RvbiBmcm9tIFwid2luc3RvblwiO1xyXG5cclxuY29uc3QgY2xpZW50ID0gbmV3IFJlZGlzKHtcclxuICBob3N0OiBwcm9jZXNzLmVudi5SRURJU19IT1NULFxyXG4gIHBvcnQ6IHByb2Nlc3MuZW52LlJFRElTX1BPUlQsIC8vUkVESVNfUE9SVD02Mzc5XHJcbn0pO1xyXG5cclxuY2xpZW50Lm9uKFwiZXJyb3JcIiwgKGVycm9yKSA9PiB7XHJcbiAgY29uc29sZS5sb2coZXJyb3IpXHJcbiAgd2luc3Rvbi5lcnJvcihlcnJvcik7XHJcbiAgY2xpZW50LnF1aXQoKS50aGVuKChlKSA9PiBjb25zb2xlLmxvZyhlKSk7XHJcbn0pO1xyXG5cclxuY2xpZW50Lm9uKFwiY29ubmVjdFwiLCAoKSA9PiB3aW5zdG9uLmluZm8oXCJSZWRpcyBjbGllbnQgY29ubmVjdGVkXCIpKTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsaWVudDtcclxuIl19","map":{"version":3,"sources":["redis-config.js"],"names":["client","Redis","host","process","env","REDIS_HOST","port","REDIS_PORT","on","error","console","log","winston","quit","then","e","info"],"mappings":";;;;;;;AAAA;;AACA;;;;AAEA,MAAMA,MAAM,GAAG,IAAIC,gBAAJ,CAAU;AACvBC,EAAAA,IAAI,EAAEC,OAAO,CAACC,GAAR,CAAYC,UADK;AAEvBC,EAAAA,IAAI,EAAEH,OAAO,CAACC,GAAR,CAAYG,UAFK,CAEO;;AAFP,CAAV,CAAf;AAKAP,MAAM,CAACQ,EAAP,CAAU,OAAV,EAAoBC,KAAD,IAAW;AAC5BC,EAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;;AACAG,mBAAQH,KAAR,CAAcA,KAAd;;AACAT,EAAAA,MAAM,CAACa,IAAP,GAAcC,IAAd,CAAoBC,CAAD,IAAOL,OAAO,CAACC,GAAR,CAAYI,CAAZ,CAA1B;AACD,CAJD;AAMAf,MAAM,CAACQ,EAAP,CAAU,SAAV,EAAqB,MAAMI,iBAAQI,IAAR,CAAa,wBAAb,CAA3B;eAEehB,M","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\config\\","sourcesContent":["import Redis from \"ioredis\";\r\nimport winston from \"winston\";\r\n\r\nconst client = new Redis({\r\n  host: process.env.REDIS_HOST,\r\n  port: process.env.REDIS_PORT, //REDIS_PORT=6379\r\n});\r\n\r\nclient.on(\"error\", (error) => {\r\n  console.log(error)\r\n  winston.error(error);\r\n  client.quit().then((e) => console.log(e));\r\n});\r\n\r\nclient.on(\"connect\", () => winston.info(\"Redis client connected\"));\r\n\r\nexport default client;\r\n"]}},"mtime":1648591736878},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\graphql\\\\auth\\\\typedefs\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\graphql\\\\auth\\\\typedefs\\\\types.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nvar _graphqlCompose = require(\"graphql-compose\");\n\nvar _user = require(\"../../../models/user\");\n\n_graphqlCompose.schemaComposer.createObjectTC({\n  name: \"AccessToken\",\n  fields: {\n    accessToken: \"String!\",\n    user: _user.UserTC\n  }\n});\n\n_graphqlCompose.schemaComposer.createObjectTC({\n  name: \"Succeed\",\n  fields: {\n    succeed: \"Boolean!\"\n  }\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInR5cGVzLmpzIl0sIm5hbWVzIjpbInNjaGVtYUNvbXBvc2VyIiwiY3JlYXRlT2JqZWN0VEMiLCJuYW1lIiwiZmllbGRzIiwiYWNjZXNzVG9rZW4iLCJ1c2VyIiwiVXNlclRDIiwic3VjY2VlZCJdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7QUFDQTs7QUFFQUEsK0JBQWVDLGNBQWYsQ0FBOEI7QUFDMUJDLEVBQUFBLElBQUksRUFBRSxhQURvQjtBQUUxQkMsRUFBQUEsTUFBTSxFQUFFO0FBQ0pDLElBQUFBLFdBQVcsRUFBRSxTQURUO0FBRUpDLElBQUFBLElBQUksRUFBRUM7QUFGRjtBQUZrQixDQUE5Qjs7QUFRQU4sK0JBQWVDLGNBQWYsQ0FBOEI7QUFDMUJDLEVBQUFBLElBQUksRUFBRSxTQURvQjtBQUUxQkMsRUFBQUEsTUFBTSxFQUFFO0FBQUNJLElBQUFBLE9BQU8sRUFBRTtBQUFWO0FBRmtCLENBQTlCIiwic291cmNlUm9vdCI6IkM6XFxVc2Vyc1xcUmViYmVcXERlc2t0b3BcXGhhbGV0YS1uZXctYXBpXFxzcmNcXGdyYXBocWxcXGF1dGhcXHR5cGVkZWZzXFwiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge3NjaGVtYUNvbXBvc2VyfSBmcm9tIFwiZ3JhcGhxbC1jb21wb3NlXCI7XHJcbmltcG9ydCB7VXNlclRDfSBmcm9tIFwiLi4vLi4vLi4vbW9kZWxzL3VzZXJcIjtcclxuXHJcbnNjaGVtYUNvbXBvc2VyLmNyZWF0ZU9iamVjdFRDKHtcclxuICAgIG5hbWU6IFwiQWNjZXNzVG9rZW5cIixcclxuICAgIGZpZWxkczoge1xyXG4gICAgICAgIGFjY2Vzc1Rva2VuOiBcIlN0cmluZyFcIixcclxuICAgICAgICB1c2VyOiBVc2VyVEMsXHJcbiAgICB9LFxyXG59KTtcclxuXHJcbnNjaGVtYUNvbXBvc2VyLmNyZWF0ZU9iamVjdFRDKHtcclxuICAgIG5hbWU6IFwiU3VjY2VlZFwiLFxyXG4gICAgZmllbGRzOiB7c3VjY2VlZDogXCJCb29sZWFuIVwifSxcclxufSk7Il19","map":{"version":3,"sources":["types.js"],"names":["schemaComposer","createObjectTC","name","fields","accessToken","user","UserTC","succeed"],"mappings":";;AAAA;;AACA;;AAEAA,+BAAeC,cAAf,CAA8B;AAC1BC,EAAAA,IAAI,EAAE,aADoB;AAE1BC,EAAAA,MAAM,EAAE;AACJC,IAAAA,WAAW,EAAE,SADT;AAEJC,IAAAA,IAAI,EAAEC;AAFF;AAFkB,CAA9B;;AAQAN,+BAAeC,cAAf,CAA8B;AAC1BC,EAAAA,IAAI,EAAE,SADoB;AAE1BC,EAAAA,MAAM,EAAE;AAACI,IAAAA,OAAO,EAAE;AAAV;AAFkB,CAA9B","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\graphql\\auth\\typedefs\\","sourcesContent":["import {schemaComposer} from \"graphql-compose\";\r\nimport {UserTC} from \"../../../models/user\";\r\n\r\nschemaComposer.createObjectTC({\r\n    name: \"AccessToken\",\r\n    fields: {\r\n        accessToken: \"String!\",\r\n        user: UserTC,\r\n    },\r\n});\r\n\r\nschemaComposer.createObjectTC({\r\n    name: \"Succeed\",\r\n    fields: {succeed: \"Boolean!\"},\r\n});"]}},"mtime":1648583275527},"{\"assumptions\":{},\"sourceRoot\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\graphql\\\\user\\\\\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"filename\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\\\\src\\\\graphql\\\\user\\\\index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"C:\\\\Users\\\\Rebbe\\\\Desktop\\\\haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.UserQuery = exports.UserMutation = void 0;\n\nvar _user = require(\"../../models/user\");\n\nvar _middlewares = require(\"../../middlewares\");\n\n// import Resolvers from \"./use-cases\";\n//\n// for (const resolver in Resolvers) {\n//     UserTC.addResolver(Resolvers[resolver]);\n// }\nconst UserQuery = {\n  userById: _user.UserTC.getResolver(\"findById\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userByIds: _user.UserTC.getResolver(\"findByIds\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userOne: _user.UserTC.getResolver(\"findOne\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userMany: _user.UserTC.getResolver(\"findMany\", [_middlewares.authentication.isAuth, _middlewares.authorization])\n};\nexports.UserQuery = UserQuery;\nconst UserMutation = {\n  userCreateOne: _user.UserTC.getResolver(\"createOne\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userCreateMany: _user.UserTC.getResolver(\"createMany\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userUpdateById: _user.UserTC.getResolver(\"updateById\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userUpdateOne: _user.UserTC.getResolver(\"updateOne\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userUpdateMany: _user.UserTC.getResolver(\"updateMany\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userRemoveById: _user.UserTC.getResolver(\"removeById\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userRemoveOne: _user.UserTC.getResolver(\"removeOne\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userRemoveMany: _user.UserTC.getResolver(\"removeMany\", [_middlewares.authentication.isAuth, _middlewares.authorization])\n};\nexports.UserMutation = UserMutation;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbIlVzZXJRdWVyeSIsInVzZXJCeUlkIiwiVXNlclRDIiwiZ2V0UmVzb2x2ZXIiLCJhdXRoZW50aWNhdGlvbiIsImlzQXV0aCIsImF1dGhvcml6YXRpb24iLCJ1c2VyQnlJZHMiLCJ1c2VyT25lIiwidXNlck1hbnkiLCJVc2VyTXV0YXRpb24iLCJ1c2VyQ3JlYXRlT25lIiwidXNlckNyZWF0ZU1hbnkiLCJ1c2VyVXBkYXRlQnlJZCIsInVzZXJVcGRhdGVPbmUiLCJ1c2VyVXBkYXRlTWFueSIsInVzZXJSZW1vdmVCeUlkIiwidXNlclJlbW92ZU9uZSIsInVzZXJSZW1vdmVNYW55Il0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBRUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBLE1BQU1BLFNBQVMsR0FBRztBQUNkQyxFQUFBQSxRQUFRLEVBQUVDLGFBQU9DLFdBQVAsQ0FBbUIsVUFBbkIsRUFBK0IsQ0FBQ0MsNEJBQWVDLE1BQWhCLEVBQXdCQywwQkFBeEIsQ0FBL0IsQ0FESTtBQUVkQyxFQUFBQSxTQUFTLEVBQUVMLGFBQU9DLFdBQVAsQ0FBbUIsV0FBbkIsRUFBZ0MsQ0FBQ0MsNEJBQWVDLE1BQWhCLEVBQXdCQywwQkFBeEIsQ0FBaEMsQ0FGRztBQUdkRSxFQUFBQSxPQUFPLEVBQUVOLGFBQU9DLFdBQVAsQ0FBbUIsU0FBbkIsRUFBOEIsQ0FBQ0MsNEJBQWVDLE1BQWhCLEVBQXdCQywwQkFBeEIsQ0FBOUIsQ0FISztBQUlkRyxFQUFBQSxRQUFRLEVBQUVQLGFBQU9DLFdBQVAsQ0FBbUIsVUFBbkIsRUFBK0IsQ0FBQ0MsNEJBQWVDLE1BQWhCLEVBQXdCQywwQkFBeEIsQ0FBL0I7QUFKSSxDQUFsQjs7QUFPQSxNQUFNSSxZQUFZLEdBQUc7QUFDakJDLEVBQUFBLGFBQWEsRUFBRVQsYUFBT0MsV0FBUCxDQUFtQixXQUFuQixFQUFnQyxDQUFDQyw0QkFBZUMsTUFBaEIsRUFBd0JDLDBCQUF4QixDQUFoQyxDQURFO0FBRWpCTSxFQUFBQSxjQUFjLEVBQUVWLGFBQU9DLFdBQVAsQ0FBbUIsWUFBbkIsRUFBaUMsQ0FBQ0MsNEJBQWVDLE1BQWhCLEVBQXdCQywwQkFBeEIsQ0FBakMsQ0FGQztBQUdqQk8sRUFBQUEsY0FBYyxFQUFFWCxhQUFPQyxXQUFQLENBQW1CLFlBQW5CLEVBQWlDLENBQUNDLDRCQUFlQyxNQUFoQixFQUF3QkMsMEJBQXhCLENBQWpDLENBSEM7QUFJakJRLEVBQUFBLGFBQWEsRUFBRVosYUFBT0MsV0FBUCxDQUFtQixXQUFuQixFQUFnQyxDQUFDQyw0QkFBZUMsTUFBaEIsRUFBd0JDLDBCQUF4QixDQUFoQyxDQUpFO0FBS2pCUyxFQUFBQSxjQUFjLEVBQUViLGFBQU9DLFdBQVAsQ0FBbUIsWUFBbkIsRUFBaUMsQ0FBQ0MsNEJBQWVDLE1BQWhCLEVBQXdCQywwQkFBeEIsQ0FBakMsQ0FMQztBQU1qQlUsRUFBQUEsY0FBYyxFQUFFZCxhQUFPQyxXQUFQLENBQW1CLFlBQW5CLEVBQWlDLENBQUNDLDRCQUFlQyxNQUFoQixFQUF3QkMsMEJBQXhCLENBQWpDLENBTkM7QUFPakJXLEVBQUFBLGFBQWEsRUFBRWYsYUFBT0MsV0FBUCxDQUFtQixXQUFuQixFQUFnQyxDQUFDQyw0QkFBZUMsTUFBaEIsRUFBd0JDLDBCQUF4QixDQUFoQyxDQVBFO0FBUWpCWSxFQUFBQSxjQUFjLEVBQUVoQixhQUFPQyxXQUFQLENBQW1CLFlBQW5CLEVBQWlDLENBQUNDLDRCQUFlQyxNQUFoQixFQUF3QkMsMEJBQXhCLENBQWpDO0FBUkMsQ0FBckIiLCJzb3VyY2VSb290IjoiQzpcXFVzZXJzXFxSZWJiZVxcRGVza3RvcFxcaGFsZXRhLW5ldy1hcGlcXHNyY1xcZ3JhcGhxbFxcdXNlclxcIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtVc2VyVEN9IGZyb20gXCIuLi8uLi9tb2RlbHMvdXNlclwiO1xyXG5cclxuaW1wb3J0IHthdXRoZW50aWNhdGlvbiwgYXV0aG9yaXphdGlvbn0gZnJvbSBcIi4uLy4uL21pZGRsZXdhcmVzXCI7XHJcbi8vIGltcG9ydCBSZXNvbHZlcnMgZnJvbSBcIi4vdXNlLWNhc2VzXCI7XHJcbi8vXHJcbi8vIGZvciAoY29uc3QgcmVzb2x2ZXIgaW4gUmVzb2x2ZXJzKSB7XHJcbi8vICAgICBVc2VyVEMuYWRkUmVzb2x2ZXIoUmVzb2x2ZXJzW3Jlc29sdmVyXSk7XHJcbi8vIH1cclxuXHJcbmNvbnN0IFVzZXJRdWVyeSA9IHtcclxuICAgIHVzZXJCeUlkOiBVc2VyVEMuZ2V0UmVzb2x2ZXIoXCJmaW5kQnlJZFwiLCBbYXV0aGVudGljYXRpb24uaXNBdXRoLCBhdXRob3JpemF0aW9uXSksXHJcbiAgICB1c2VyQnlJZHM6IFVzZXJUQy5nZXRSZXNvbHZlcihcImZpbmRCeUlkc1wiLCBbYXV0aGVudGljYXRpb24uaXNBdXRoLCBhdXRob3JpemF0aW9uXSksXHJcbiAgICB1c2VyT25lOiBVc2VyVEMuZ2V0UmVzb2x2ZXIoXCJmaW5kT25lXCIsIFthdXRoZW50aWNhdGlvbi5pc0F1dGgsIGF1dGhvcml6YXRpb25dKSxcclxuICAgIHVzZXJNYW55OiBVc2VyVEMuZ2V0UmVzb2x2ZXIoXCJmaW5kTWFueVwiLCBbYXV0aGVudGljYXRpb24uaXNBdXRoLCBhdXRob3JpemF0aW9uXSksXHJcbn07XHJcblxyXG5jb25zdCBVc2VyTXV0YXRpb24gPSB7XHJcbiAgICB1c2VyQ3JlYXRlT25lOiBVc2VyVEMuZ2V0UmVzb2x2ZXIoXCJjcmVhdGVPbmVcIiwgW2F1dGhlbnRpY2F0aW9uLmlzQXV0aCwgYXV0aG9yaXphdGlvbl0pLFxyXG4gICAgdXNlckNyZWF0ZU1hbnk6IFVzZXJUQy5nZXRSZXNvbHZlcihcImNyZWF0ZU1hbnlcIiwgW2F1dGhlbnRpY2F0aW9uLmlzQXV0aCwgYXV0aG9yaXphdGlvbl0pLFxyXG4gICAgdXNlclVwZGF0ZUJ5SWQ6IFVzZXJUQy5nZXRSZXNvbHZlcihcInVwZGF0ZUJ5SWRcIiwgW2F1dGhlbnRpY2F0aW9uLmlzQXV0aCwgYXV0aG9yaXphdGlvbl0pLFxyXG4gICAgdXNlclVwZGF0ZU9uZTogVXNlclRDLmdldFJlc29sdmVyKFwidXBkYXRlT25lXCIsIFthdXRoZW50aWNhdGlvbi5pc0F1dGgsIGF1dGhvcml6YXRpb25dKSxcclxuICAgIHVzZXJVcGRhdGVNYW55OiBVc2VyVEMuZ2V0UmVzb2x2ZXIoXCJ1cGRhdGVNYW55XCIsIFthdXRoZW50aWNhdGlvbi5pc0F1dGgsIGF1dGhvcml6YXRpb25dKSxcclxuICAgIHVzZXJSZW1vdmVCeUlkOiBVc2VyVEMuZ2V0UmVzb2x2ZXIoXCJyZW1vdmVCeUlkXCIsIFthdXRoZW50aWNhdGlvbi5pc0F1dGgsIGF1dGhvcml6YXRpb25dKSxcclxuICAgIHVzZXJSZW1vdmVPbmU6IFVzZXJUQy5nZXRSZXNvbHZlcihcInJlbW92ZU9uZVwiLCBbYXV0aGVudGljYXRpb24uaXNBdXRoLCBhdXRob3JpemF0aW9uXSksXHJcbiAgICB1c2VyUmVtb3ZlTWFueTogVXNlclRDLmdldFJlc29sdmVyKFwicmVtb3ZlTWFueVwiLCBbYXV0aGVudGljYXRpb24uaXNBdXRoLCBhdXRob3JpemF0aW9uXSksXHJcbn07XHJcblxyXG5leHBvcnQge1VzZXJRdWVyeSwgVXNlck11dGF0aW9ufTtcclxuIl19","map":{"version":3,"sources":["index.js"],"names":["UserQuery","userById","UserTC","getResolver","authentication","isAuth","authorization","userByIds","userOne","userMany","UserMutation","userCreateOne","userCreateMany","userUpdateById","userUpdateOne","userUpdateMany","userRemoveById","userRemoveOne","userRemoveMany"],"mappings":";;;;;;;AAAA;;AAEA;;AACA;AACA;AACA;AACA;AACA;AAEA,MAAMA,SAAS,GAAG;AACdC,EAAAA,QAAQ,EAAEC,aAAOC,WAAP,CAAmB,UAAnB,EAA+B,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAA/B,CADI;AAEdC,EAAAA,SAAS,EAAEL,aAAOC,WAAP,CAAmB,WAAnB,EAAgC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAhC,CAFG;AAGdE,EAAAA,OAAO,EAAEN,aAAOC,WAAP,CAAmB,SAAnB,EAA8B,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAA9B,CAHK;AAIdG,EAAAA,QAAQ,EAAEP,aAAOC,WAAP,CAAmB,UAAnB,EAA+B,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAA/B;AAJI,CAAlB;;AAOA,MAAMI,YAAY,GAAG;AACjBC,EAAAA,aAAa,EAAET,aAAOC,WAAP,CAAmB,WAAnB,EAAgC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAhC,CADE;AAEjBM,EAAAA,cAAc,EAAEV,aAAOC,WAAP,CAAmB,YAAnB,EAAiC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAjC,CAFC;AAGjBO,EAAAA,cAAc,EAAEX,aAAOC,WAAP,CAAmB,YAAnB,EAAiC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAjC,CAHC;AAIjBQ,EAAAA,aAAa,EAAEZ,aAAOC,WAAP,CAAmB,WAAnB,EAAgC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAhC,CAJE;AAKjBS,EAAAA,cAAc,EAAEb,aAAOC,WAAP,CAAmB,YAAnB,EAAiC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAjC,CALC;AAMjBU,EAAAA,cAAc,EAAEd,aAAOC,WAAP,CAAmB,YAAnB,EAAiC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAjC,CANC;AAOjBW,EAAAA,aAAa,EAAEf,aAAOC,WAAP,CAAmB,WAAnB,EAAgC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAhC,CAPE;AAQjBY,EAAAA,cAAc,EAAEhB,aAAOC,WAAP,CAAmB,YAAnB,EAAiC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAjC;AARC,CAArB","sourceRoot":"C:\\Users\\Rebbe\\Desktop\\haleta-new-api\\src\\graphql\\user\\","sourcesContent":["import {UserTC} from \"../../models/user\";\r\n\r\nimport {authentication, authorization} from \"../../middlewares\";\r\n// import Resolvers from \"./use-cases\";\r\n//\r\n// for (const resolver in Resolvers) {\r\n//     UserTC.addResolver(Resolvers[resolver]);\r\n// }\r\n\r\nconst UserQuery = {\r\n    userById: UserTC.getResolver(\"findById\", [authentication.isAuth, authorization]),\r\n    userByIds: UserTC.getResolver(\"findByIds\", [authentication.isAuth, authorization]),\r\n    userOne: UserTC.getResolver(\"findOne\", [authentication.isAuth, authorization]),\r\n    userMany: UserTC.getResolver(\"findMany\", [authentication.isAuth, authorization]),\r\n};\r\n\r\nconst UserMutation = {\r\n    userCreateOne: UserTC.getResolver(\"createOne\", [authentication.isAuth, authorization]),\r\n    userCreateMany: UserTC.getResolver(\"createMany\", [authentication.isAuth, authorization]),\r\n    userUpdateById: UserTC.getResolver(\"updateById\", [authentication.isAuth, authorization]),\r\n    userUpdateOne: UserTC.getResolver(\"updateOne\", [authentication.isAuth, authorization]),\r\n    userUpdateMany: UserTC.getResolver(\"updateMany\", [authentication.isAuth, authorization]),\r\n    userRemoveById: UserTC.getResolver(\"removeById\", [authentication.isAuth, authorization]),\r\n    userRemoveOne: UserTC.getResolver(\"removeOne\", [authentication.isAuth, authorization]),\r\n    userRemoveMany: UserTC.getResolver(\"removeMany\", [authentication.isAuth, authorization]),\r\n};\r\n\r\nexport {UserQuery, UserMutation};\r\n"]}},"mtime":1648583275528}}