{"{\"assumptions\":{},\"sourceRoot\":\"/home/nathnael/projects/haleta/haleta-new-api/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"filename\":\"/home/nathnael/projects/haleta/haleta-new-api/src/index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nvar _dotenv = _interopRequireDefault(require(\"dotenv\"));\n\nvar _express = _interopRequireDefault(require(\"express\"));\n\nvar _apolloServerExpress = require(\"apollo-server-express\");\n\nvar _graphql = _interopRequireDefault(require(\"./graphql\"));\n\nvar _validateToken = _interopRequireDefault(require(\"./middlewares/auth/validate-token\"));\n\nrequire(\"./config/mongodb-config\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n_dotenv.default.config();\n\nconst app = (0, _express.default)();\n\nasync function startApolloServer() {\n  const server = new _apolloServerExpress.ApolloServer({\n    schema: _graphql.default,\n    playground: true,\n    introspection: true,\n    tracing: true,\n    path: \"/\",\n    context: ({\n      req\n    }) => {\n      return {\n        user: req.headers.user,\n        headers: req.headers,\n        phoneVerification: req.headers.phoneverification || \"\"\n      };\n    }\n  });\n  app.use(_validateToken.default);\n  await server.start();\n  server.applyMiddleware({\n    app,\n    path: \"/\",\n    cors: \"no-cors\"\n  });\n  app.listen({\n    port: process.env.PORT\n  }, () => {\n    console.log(`ðŸš€ Server listening on port ${process.env.PORT}`);\n  });\n}\n\nstartApolloServer().then(() => {\n  console.log(\"Apollo server started\");\n}).catch(err => {\n  console.log(`ðŸš€ Server Error: ${err.message}`);\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbImRvdGVudiIsImNvbmZpZyIsImFwcCIsInN0YXJ0QXBvbGxvU2VydmVyIiwic2VydmVyIiwiQXBvbGxvU2VydmVyIiwic2NoZW1hIiwicGxheWdyb3VuZCIsImludHJvc3BlY3Rpb24iLCJ0cmFjaW5nIiwicGF0aCIsImNvbnRleHQiLCJyZXEiLCJ1c2VyIiwiaGVhZGVycyIsInBob25lVmVyaWZpY2F0aW9uIiwicGhvbmV2ZXJpZmljYXRpb24iLCJ1c2UiLCJ2YWxpZGF0ZVRva2VuIiwic3RhcnQiLCJhcHBseU1pZGRsZXdhcmUiLCJjb3JzIiwibGlzdGVuIiwicG9ydCIsInByb2Nlc3MiLCJlbnYiLCJQT1JUIiwiY29uc29sZSIsImxvZyIsInRoZW4iLCJjYXRjaCIsImVyciIsIm1lc3NhZ2UiXSwibWFwcGluZ3MiOiI7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7QUFFQUEsZ0JBQU9DLE1BQVA7O0FBQ0EsTUFBTUMsR0FBRyxHQUFHLHVCQUFaOztBQUVBLGVBQWVDLGlCQUFmLEdBQW1DO0FBQy9CLFFBQU1DLE1BQU0sR0FBRyxJQUFJQyxpQ0FBSixDQUFpQjtBQUM1QkMsSUFBQUEsTUFBTSxFQUFOQSxnQkFENEI7QUFFNUJDLElBQUFBLFVBQVUsRUFBRSxJQUZnQjtBQUc1QkMsSUFBQUEsYUFBYSxFQUFFLElBSGE7QUFJNUJDLElBQUFBLE9BQU8sRUFBRSxJQUptQjtBQUs1QkMsSUFBQUEsSUFBSSxFQUFFLEdBTHNCO0FBTTVCQyxJQUFBQSxPQUFPLEVBQUUsQ0FBQztBQUFDQyxNQUFBQTtBQUFELEtBQUQsS0FBVztBQUNoQixhQUFPO0FBQ0hDLFFBQUFBLElBQUksRUFBRUQsR0FBRyxDQUFDRSxPQUFKLENBQVlELElBRGY7QUFFSEMsUUFBQUEsT0FBTyxFQUFFRixHQUFHLENBQUNFLE9BRlY7QUFHSEMsUUFBQUEsaUJBQWlCLEVBQUVILEdBQUcsQ0FBQ0UsT0FBSixDQUFZRSxpQkFBWixJQUFpQztBQUhqRCxPQUFQO0FBS0g7QUFaMkIsR0FBakIsQ0FBZjtBQWVBZCxFQUFBQSxHQUFHLENBQUNlLEdBQUosQ0FBUUMsc0JBQVI7QUFFQSxRQUFNZCxNQUFNLENBQUNlLEtBQVAsRUFBTjtBQUVBZixFQUFBQSxNQUFNLENBQUNnQixlQUFQLENBQXVCO0FBQ25CbEIsSUFBQUEsR0FEbUI7QUFFbkJRLElBQUFBLElBQUksRUFBRSxHQUZhO0FBR25CVyxJQUFBQSxJQUFJLEVBQUU7QUFIYSxHQUF2QjtBQU1BbkIsRUFBQUEsR0FBRyxDQUFDb0IsTUFBSixDQUFXO0FBQUNDLElBQUFBLElBQUksRUFBRUMsT0FBTyxDQUFDQyxHQUFSLENBQVlDO0FBQW5CLEdBQVgsRUFBcUMsTUFBTTtBQUN2Q0MsSUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQWEsK0JBQThCSixPQUFPLENBQUNDLEdBQVIsQ0FBWUMsSUFBSyxFQUE1RDtBQUNILEdBRkQ7QUFHSDs7QUFFRHZCLGlCQUFpQixHQUFHMEIsSUFBcEIsQ0FBeUIsTUFBTTtBQUMzQkYsRUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVksdUJBQVo7QUFDSCxDQUZELEVBRUdFLEtBRkgsQ0FFVUMsR0FBRCxJQUFTO0FBQ2RKLEVBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFhLG9CQUFtQkcsR0FBRyxDQUFDQyxPQUFRLEVBQTVDO0FBQ0gsQ0FKRCIsInNvdXJjZVJvb3QiOiIvaG9tZS9uYXRobmFlbC9wcm9qZWN0cy9oYWxldGEvaGFsZXRhLW5ldy1hcGkvc3JjLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBkb3RlbnYgZnJvbSBcImRvdGVudlwiO1xuaW1wb3J0IGV4cHJlc3MgZnJvbSBcImV4cHJlc3NcIjtcbmltcG9ydCB7QXBvbGxvU2VydmVyfSBmcm9tIFwiYXBvbGxvLXNlcnZlci1leHByZXNzXCI7XG5pbXBvcnQgc2NoZW1hIGZyb20gXCIuL2dyYXBocWxcIjtcbmltcG9ydCB2YWxpZGF0ZVRva2VuIGZyb20gXCIuL21pZGRsZXdhcmVzL2F1dGgvdmFsaWRhdGUtdG9rZW5cIjtcbmltcG9ydCBcIi4vY29uZmlnL21vbmdvZGItY29uZmlnXCI7XG5cbmRvdGVudi5jb25maWcoKTtcbmNvbnN0IGFwcCA9IGV4cHJlc3MoKTtcblxuYXN5bmMgZnVuY3Rpb24gc3RhcnRBcG9sbG9TZXJ2ZXIoKSB7XG4gICAgY29uc3Qgc2VydmVyID0gbmV3IEFwb2xsb1NlcnZlcih7XG4gICAgICAgIHNjaGVtYSxcbiAgICAgICAgcGxheWdyb3VuZDogdHJ1ZSxcbiAgICAgICAgaW50cm9zcGVjdGlvbjogdHJ1ZSxcbiAgICAgICAgdHJhY2luZzogdHJ1ZSxcbiAgICAgICAgcGF0aDogXCIvXCIsXG4gICAgICAgIGNvbnRleHQ6ICh7cmVxfSkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICB1c2VyOiByZXEuaGVhZGVycy51c2VyLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHJlcS5oZWFkZXJzLFxuICAgICAgICAgICAgICAgIHBob25lVmVyaWZpY2F0aW9uOiByZXEuaGVhZGVycy5waG9uZXZlcmlmaWNhdGlvbiB8fCBcIlwiLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSxcbiAgICB9KTtcblxuICAgIGFwcC51c2UodmFsaWRhdGVUb2tlbilcblxuICAgIGF3YWl0IHNlcnZlci5zdGFydCgpO1xuXG4gICAgc2VydmVyLmFwcGx5TWlkZGxld2FyZSh7XG4gICAgICAgIGFwcCxcbiAgICAgICAgcGF0aDogXCIvXCIsXG4gICAgICAgIGNvcnM6IFwibm8tY29yc1wiLFxuICAgIH0pO1xuXG4gICAgYXBwLmxpc3Rlbih7cG9ydDogcHJvY2Vzcy5lbnYuUE9SVH0sICgpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coYPCfmoAgU2VydmVyIGxpc3RlbmluZyBvbiBwb3J0ICR7cHJvY2Vzcy5lbnYuUE9SVH1gKTtcbiAgICB9KTtcbn1cblxuc3RhcnRBcG9sbG9TZXJ2ZXIoKS50aGVuKCgpID0+IHtcbiAgICBjb25zb2xlLmxvZyhcIkFwb2xsbyBzZXJ2ZXIgc3RhcnRlZFwiKTtcbn0pLmNhdGNoKChlcnIpID0+IHtcbiAgICBjb25zb2xlLmxvZyhg8J+agCBTZXJ2ZXIgRXJyb3I6ICR7ZXJyLm1lc3NhZ2V9YCk7XG59KSJdfQ==","map":{"version":3,"sources":["index.js"],"names":["dotenv","config","app","startApolloServer","server","ApolloServer","schema","playground","introspection","tracing","path","context","req","user","headers","phoneVerification","phoneverification","use","validateToken","start","applyMiddleware","cors","listen","port","process","env","PORT","console","log","then","catch","err","message"],"mappings":";;AAAA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AAEAA,gBAAOC,MAAP;;AACA,MAAMC,GAAG,GAAG,uBAAZ;;AAEA,eAAeC,iBAAf,GAAmC;AAC/B,QAAMC,MAAM,GAAG,IAAIC,iCAAJ,CAAiB;AAC5BC,IAAAA,MAAM,EAANA,gBAD4B;AAE5BC,IAAAA,UAAU,EAAE,IAFgB;AAG5BC,IAAAA,aAAa,EAAE,IAHa;AAI5BC,IAAAA,OAAO,EAAE,IAJmB;AAK5BC,IAAAA,IAAI,EAAE,GALsB;AAM5BC,IAAAA,OAAO,EAAE,CAAC;AAACC,MAAAA;AAAD,KAAD,KAAW;AAChB,aAAO;AACHC,QAAAA,IAAI,EAAED,GAAG,CAACE,OAAJ,CAAYD,IADf;AAEHC,QAAAA,OAAO,EAAEF,GAAG,CAACE,OAFV;AAGHC,QAAAA,iBAAiB,EAAEH,GAAG,CAACE,OAAJ,CAAYE,iBAAZ,IAAiC;AAHjD,OAAP;AAKH;AAZ2B,GAAjB,CAAf;AAeAd,EAAAA,GAAG,CAACe,GAAJ,CAAQC,sBAAR;AAEA,QAAMd,MAAM,CAACe,KAAP,EAAN;AAEAf,EAAAA,MAAM,CAACgB,eAAP,CAAuB;AACnBlB,IAAAA,GADmB;AAEnBQ,IAAAA,IAAI,EAAE,GAFa;AAGnBW,IAAAA,IAAI,EAAE;AAHa,GAAvB;AAMAnB,EAAAA,GAAG,CAACoB,MAAJ,CAAW;AAACC,IAAAA,IAAI,EAAEC,OAAO,CAACC,GAAR,CAAYC;AAAnB,GAAX,EAAqC,MAAM;AACvCC,IAAAA,OAAO,CAACC,GAAR,CAAa,+BAA8BJ,OAAO,CAACC,GAAR,CAAYC,IAAK,EAA5D;AACH,GAFD;AAGH;;AAEDvB,iBAAiB,GAAG0B,IAApB,CAAyB,MAAM;AAC3BF,EAAAA,OAAO,CAACC,GAAR,CAAY,uBAAZ;AACH,CAFD,EAEGE,KAFH,CAEUC,GAAD,IAAS;AACdJ,EAAAA,OAAO,CAACC,GAAR,CAAa,oBAAmBG,GAAG,CAACC,OAAQ,EAA5C;AACH,CAJD","sourceRoot":"/home/nathnael/projects/haleta/haleta-new-api/src/","sourcesContent":["import dotenv from \"dotenv\";\nimport express from \"express\";\nimport {ApolloServer} from \"apollo-server-express\";\nimport schema from \"./graphql\";\nimport validateToken from \"./middlewares/auth/validate-token\";\nimport \"./config/mongodb-config\";\n\ndotenv.config();\nconst app = express();\n\nasync function startApolloServer() {\n    const server = new ApolloServer({\n        schema,\n        playground: true,\n        introspection: true,\n        tracing: true,\n        path: \"/\",\n        context: ({req}) => {\n            return {\n                user: req.headers.user,\n                headers: req.headers,\n                phoneVerification: req.headers.phoneverification || \"\",\n            };\n        },\n    });\n\n    app.use(validateToken)\n\n    await server.start();\n\n    server.applyMiddleware({\n        app,\n        path: \"/\",\n        cors: \"no-cors\",\n    });\n\n    app.listen({port: process.env.PORT}, () => {\n        console.log(`ðŸš€ Server listening on port ${process.env.PORT}`);\n    });\n}\n\nstartApolloServer().then(() => {\n    console.log(\"Apollo server started\");\n}).catch((err) => {\n    console.log(`ðŸš€ Server Error: ${err.message}`);\n})"]}},"mtime":1648317397242},"{\"assumptions\":{},\"sourceRoot\":\"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"filename\":\"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _graphqlCompose = require(\"graphql-compose\");\n\nvar _auth = require(\"./auth\");\n\nvar _user = require(\"./user\");\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nconst schemaComposer = new _graphqlCompose.SchemaComposer();\nschemaComposer.Query.addFields(_objectSpread({}, _user.UserQuery));\nschemaComposer.Mutation.addFields(_objectSpread(_objectSpread({}, _auth.AuthMutation), _user.UserMutation));\nconst schema = schemaComposer.buildSchema();\nvar _default = schema;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbInNjaGVtYUNvbXBvc2VyIiwiU2NoZW1hQ29tcG9zZXIiLCJRdWVyeSIsImFkZEZpZWxkcyIsIlVzZXJRdWVyeSIsIk11dGF0aW9uIiwiQXV0aE11dGF0aW9uIiwiVXNlck11dGF0aW9uIiwic2NoZW1hIiwiYnVpbGRTY2hlbWEiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7Ozs7Ozs7QUFFQSxNQUFNQSxjQUFjLEdBQUcsSUFBSUMsOEJBQUosRUFBdkI7QUFFQUQsY0FBYyxDQUFDRSxLQUFmLENBQXFCQyxTQUFyQixtQkFDT0MsZUFEUDtBQUlBSixjQUFjLENBQUNLLFFBQWYsQ0FBd0JGLFNBQXhCLGlDQUNPRyxrQkFEUCxHQUVPQyxrQkFGUDtBQUtBLE1BQU1DLE1BQU0sR0FBR1IsY0FBYyxDQUFDUyxXQUFmLEVBQWY7ZUFDZUQsTSIsInNvdXJjZVJvb3QiOiIvaG9tZS9uYXRobmFlbC9wcm9qZWN0cy9oYWxldGEvaGFsZXRhLW5ldy1hcGkvc3JjL2dyYXBocWwvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtTY2hlbWFDb21wb3Nlcn0gZnJvbSBcImdyYXBocWwtY29tcG9zZVwiO1xuaW1wb3J0IHtBdXRoTXV0YXRpb259IGZyb20gXCIuL2F1dGhcIjtcbmltcG9ydCB7VXNlck11dGF0aW9uLCBVc2VyUXVlcnl9IGZyb20gXCIuL3VzZXJcIjtcblxuY29uc3Qgc2NoZW1hQ29tcG9zZXIgPSBuZXcgU2NoZW1hQ29tcG9zZXIoKTtcblxuc2NoZW1hQ29tcG9zZXIuUXVlcnkuYWRkRmllbGRzKHtcbiAgICAuLi5Vc2VyUXVlcnksXG59KTtcblxuc2NoZW1hQ29tcG9zZXIuTXV0YXRpb24uYWRkRmllbGRzKHtcbiAgICAuLi5BdXRoTXV0YXRpb24sXG4gICAgLi4uVXNlck11dGF0aW9uLFxufSk7XG5cbmNvbnN0IHNjaGVtYSA9IHNjaGVtYUNvbXBvc2VyLmJ1aWxkU2NoZW1hKCk7XG5leHBvcnQgZGVmYXVsdCBzY2hlbWE7XG4iXX0=","map":{"version":3,"sources":["index.js"],"names":["schemaComposer","SchemaComposer","Query","addFields","UserQuery","Mutation","AuthMutation","UserMutation","schema","buildSchema"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;;;;;AAEA,MAAMA,cAAc,GAAG,IAAIC,8BAAJ,EAAvB;AAEAD,cAAc,CAACE,KAAf,CAAqBC,SAArB,mBACOC,eADP;AAIAJ,cAAc,CAACK,QAAf,CAAwBF,SAAxB,iCACOG,kBADP,GAEOC,kBAFP;AAKA,MAAMC,MAAM,GAAGR,cAAc,CAACS,WAAf,EAAf;eACeD,M","sourceRoot":"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/","sourcesContent":["import {SchemaComposer} from \"graphql-compose\";\nimport {AuthMutation} from \"./auth\";\nimport {UserMutation, UserQuery} from \"./user\";\n\nconst schemaComposer = new SchemaComposer();\n\nschemaComposer.Query.addFields({\n    ...UserQuery,\n});\n\nschemaComposer.Mutation.addFields({\n    ...AuthMutation,\n    ...UserMutation,\n});\n\nconst schema = schemaComposer.buildSchema();\nexport default schema;\n"]}},"mtime":1648317247190},"{\"assumptions\":{},\"sourceRoot\":\"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/auth/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"filename\":\"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/auth/index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.AuthMutation = void 0;\n\nvar _user = require(\"../../models/user\");\n\nvar _middlewares = require(\"../../middlewares\");\n\nvar _resolvers = _interopRequireDefault(require(\"./resolvers\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfor (const resolver in _resolvers.default) {\n  _user.UserTC.addResolver(_resolvers.default[resolver]);\n}\n\nconst AuthMutation = {\n  signIn: _user.UserTC.getResolver(\"signIn\", [_middlewares.authentication.isGuest, _middlewares.userValidator.signIn]) // signUp: UserTC.getResolver(\"signUp\", [authentication.isGuest, userValidator.signUp]),\n  // logout: UserTC.getResolver('logout', [middleware.isAuth]),\n  // resetPassword: UserTC.getResolver(\"resetPassword\", [middleware.isGuest, validators.resetPassword]),\n  // newPassword: UserTC.getResolver(\"newPassword\", [middleware.isGuest, validators.newPassword]),\n  // changePassword: UserTC.getResolver(\"changePassword\", [middleware.isAuth, validators.changePassword]),\n\n};\nexports.AuthMutation = AuthMutation;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbInJlc29sdmVyIiwiUmVzb2x2ZXJzIiwiVXNlclRDIiwiYWRkUmVzb2x2ZXIiLCJBdXRoTXV0YXRpb24iLCJzaWduSW4iLCJnZXRSZXNvbHZlciIsImF1dGhlbnRpY2F0aW9uIiwiaXNHdWVzdCIsInVzZXJWYWxpZGF0b3IiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFFQTs7QUFFQTs7OztBQUVBLEtBQUssTUFBTUEsUUFBWCxJQUF1QkMsa0JBQXZCLEVBQWtDO0FBQzlCQyxlQUFPQyxXQUFQLENBQW1CRixtQkFBVUQsUUFBVixDQUFuQjtBQUNIOztBQUVELE1BQU1JLFlBQVksR0FBRztBQUNqQkMsRUFBQUEsTUFBTSxFQUFFSCxhQUFPSSxXQUFQLENBQW1CLFFBQW5CLEVBQTZCLENBQUNDLDRCQUFlQyxPQUFoQixFQUF5QkMsMkJBQWNKLE1BQXZDLENBQTdCLENBRFMsQ0FFakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFOaUIsQ0FBckIiLCJzb3VyY2VSb290IjoiL2hvbWUvbmF0aG5hZWwvcHJvamVjdHMvaGFsZXRhL2hhbGV0YS1uZXctYXBpL3NyYy9ncmFwaHFsL2F1dGgvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtVc2VyVEN9IGZyb20gXCIuLi8uLi9tb2RlbHMvdXNlclwiO1xuXG5pbXBvcnQgeyBhdXRoZW50aWNhdGlvbiwgdXNlclZhbGlkYXRvciB9IGZyb20gXCIuLi8uLi9taWRkbGV3YXJlc1wiO1xuXG5pbXBvcnQgUmVzb2x2ZXJzIGZyb20gXCIuL3Jlc29sdmVyc1wiO1xuXG5mb3IgKGNvbnN0IHJlc29sdmVyIGluIFJlc29sdmVycykge1xuICAgIFVzZXJUQy5hZGRSZXNvbHZlcihSZXNvbHZlcnNbcmVzb2x2ZXJdKTtcbn1cblxuY29uc3QgQXV0aE11dGF0aW9uID0ge1xuICAgIHNpZ25JbjogVXNlclRDLmdldFJlc29sdmVyKFwic2lnbkluXCIsIFthdXRoZW50aWNhdGlvbi5pc0d1ZXN0LCB1c2VyVmFsaWRhdG9yLnNpZ25Jbl0pLFxuICAgIC8vIHNpZ25VcDogVXNlclRDLmdldFJlc29sdmVyKFwic2lnblVwXCIsIFthdXRoZW50aWNhdGlvbi5pc0d1ZXN0LCB1c2VyVmFsaWRhdG9yLnNpZ25VcF0pLFxuICAgIC8vIGxvZ291dDogVXNlclRDLmdldFJlc29sdmVyKCdsb2dvdXQnLCBbbWlkZGxld2FyZS5pc0F1dGhdKSxcbiAgICAvLyByZXNldFBhc3N3b3JkOiBVc2VyVEMuZ2V0UmVzb2x2ZXIoXCJyZXNldFBhc3N3b3JkXCIsIFttaWRkbGV3YXJlLmlzR3Vlc3QsIHZhbGlkYXRvcnMucmVzZXRQYXNzd29yZF0pLFxuICAgIC8vIG5ld1Bhc3N3b3JkOiBVc2VyVEMuZ2V0UmVzb2x2ZXIoXCJuZXdQYXNzd29yZFwiLCBbbWlkZGxld2FyZS5pc0d1ZXN0LCB2YWxpZGF0b3JzLm5ld1Bhc3N3b3JkXSksXG4gICAgLy8gY2hhbmdlUGFzc3dvcmQ6IFVzZXJUQy5nZXRSZXNvbHZlcihcImNoYW5nZVBhc3N3b3JkXCIsIFttaWRkbGV3YXJlLmlzQXV0aCwgdmFsaWRhdG9ycy5jaGFuZ2VQYXNzd29yZF0pLFxufTtcblxuZXhwb3J0IHtBdXRoTXV0YXRpb259O1xuIl19","map":{"version":3,"sources":["index.js"],"names":["resolver","Resolvers","UserTC","addResolver","AuthMutation","signIn","getResolver","authentication","isGuest","userValidator"],"mappings":";;;;;;;AAAA;;AAEA;;AAEA;;;;AAEA,KAAK,MAAMA,QAAX,IAAuBC,kBAAvB,EAAkC;AAC9BC,eAAOC,WAAP,CAAmBF,mBAAUD,QAAV,CAAnB;AACH;;AAED,MAAMI,YAAY,GAAG;AACjBC,EAAAA,MAAM,EAAEH,aAAOI,WAAP,CAAmB,QAAnB,EAA6B,CAACC,4BAAeC,OAAhB,EAAyBC,2BAAcJ,MAAvC,CAA7B,CADS,CAEjB;AACA;AACA;AACA;AACA;;AANiB,CAArB","sourceRoot":"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/auth/","sourcesContent":["import {UserTC} from \"../../models/user\";\n\nimport { authentication, userValidator } from \"../../middlewares\";\n\nimport Resolvers from \"./resolvers\";\n\nfor (const resolver in Resolvers) {\n    UserTC.addResolver(Resolvers[resolver]);\n}\n\nconst AuthMutation = {\n    signIn: UserTC.getResolver(\"signIn\", [authentication.isGuest, userValidator.signIn]),\n    // signUp: UserTC.getResolver(\"signUp\", [authentication.isGuest, userValidator.signUp]),\n    // logout: UserTC.getResolver('logout', [middleware.isAuth]),\n    // resetPassword: UserTC.getResolver(\"resetPassword\", [middleware.isGuest, validators.resetPassword]),\n    // newPassword: UserTC.getResolver(\"newPassword\", [middleware.isGuest, validators.newPassword]),\n    // changePassword: UserTC.getResolver(\"changePassword\", [middleware.isAuth, validators.changePassword]),\n};\n\nexport {AuthMutation};\n"]}},"mtime":1648313712828},"{\"assumptions\":{},\"sourceRoot\":\"/home/nathnael/projects/haleta/haleta-new-api/src/models/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"filename\":\"/home/nathnael/projects/haleta/haleta-new-api/src/models/user.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.UserTC = exports.UserSchema = exports.UserModel = void 0;\n\nvar _mongoose = _interopRequireWildcard(require(\"mongoose\"));\n\nvar _mongooseTimestamp = _interopRequireDefault(require(\"mongoose-timestamp\"));\n\nvar _graphqlComposeMongoose = require(\"graphql-compose-mongoose\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nconst UserSchema = new _mongoose.Schema({\n  firstName: String,\n  middleName: String,\n  lastName: String,\n  email: String,\n  phoneNumber: String,\n  image: String,\n  firebaseId: String,\n  password: String,\n  status: {\n    type: String,\n    default: \"ACTIVE\",\n    enum: [\"ACTIVE\", \"BLOCKED\"]\n  },\n  roles: {\n    type: String,\n    default: \"NORMAL\",\n    enum: [\"NORMAL\", \"OWNER\", \"ADMIN\", \"SALES\"]\n  },\n  account: {\n    verification: {\n      verified: {\n        type: Boolean,\n        default: false\n      },\n      token: String,\n      expiresIn: Date\n    },\n    emailVerification: {\n      verified: {\n        type: Boolean,\n        default: false\n      },\n      token: String,\n      expiresIn: Date\n    },\n    phoneVerification: {\n      verified: {\n        type: Boolean,\n        default: false\n      },\n      token: String,\n      expiresIn: Date\n    },\n    resetPassword: {\n      token: String,\n      expiresIn: Date\n    }\n  }\n}, {\n  collection: \"users\"\n});\nexports.UserSchema = UserSchema;\nUserSchema.plugin(_mongooseTimestamp.default);\nUserSchema.index({\n  createdAt: 1,\n  updatedAt: 1\n});\n\nUserSchema.statics.emailExist = function (email) {\n  return this.findOne({\n    email\n  });\n};\n\nUserSchema.statics.phoneNumberExist = function (phoneNumber) {\n  return this.findOne({\n    phoneNumber\n  });\n};\n\nUserSchema.methods.comparePassword = function (password) {\n  return bcrypt.compareSync(password, this.password);\n};\n\nconst UserModel = _mongoose.default.model(\"User\", UserSchema);\n\nexports.UserModel = UserModel;\nconst UserTC = (0, _graphqlComposeMongoose.composeWithMongoose)(UserModel); // const UserTC = composeWithMongoose(UserModel).removeField('password');\n\nexports.UserTC = UserTC;\nconst UserAccountTC = UserTC.getFieldTC(\"account\");\nUserAccountTC.getFieldTC(\"verification\").removeField([\"token\", \"expiresIn\"]); // UserAccountTC.removeField('resetPassword');\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXIuanMiXSwibmFtZXMiOlsiVXNlclNjaGVtYSIsIlNjaGVtYSIsImZpcnN0TmFtZSIsIlN0cmluZyIsIm1pZGRsZU5hbWUiLCJsYXN0TmFtZSIsImVtYWlsIiwicGhvbmVOdW1iZXIiLCJpbWFnZSIsImZpcmViYXNlSWQiLCJwYXNzd29yZCIsInN0YXR1cyIsInR5cGUiLCJkZWZhdWx0IiwiZW51bSIsInJvbGVzIiwiYWNjb3VudCIsInZlcmlmaWNhdGlvbiIsInZlcmlmaWVkIiwiQm9vbGVhbiIsInRva2VuIiwiZXhwaXJlc0luIiwiRGF0ZSIsImVtYWlsVmVyaWZpY2F0aW9uIiwicGhvbmVWZXJpZmljYXRpb24iLCJyZXNldFBhc3N3b3JkIiwiY29sbGVjdGlvbiIsInBsdWdpbiIsInRpbWVzdGFtcHMiLCJpbmRleCIsImNyZWF0ZWRBdCIsInVwZGF0ZWRBdCIsInN0YXRpY3MiLCJlbWFpbEV4aXN0IiwiZmluZE9uZSIsInBob25lTnVtYmVyRXhpc3QiLCJtZXRob2RzIiwiY29tcGFyZVBhc3N3b3JkIiwiYmNyeXB0IiwiY29tcGFyZVN5bmMiLCJVc2VyTW9kZWwiLCJtb25nb29zZSIsIm1vZGVsIiwiVXNlclRDIiwiVXNlckFjY291bnRUQyIsImdldEZpZWxkVEMiLCJyZW1vdmVGaWVsZCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOztBQUNBOzs7Ozs7OztBQUVBLE1BQU1BLFVBQVUsR0FBRyxJQUFJQyxnQkFBSixDQUFXO0FBQzFCQyxFQUFBQSxTQUFTLEVBQUVDLE1BRGU7QUFFMUJDLEVBQUFBLFVBQVUsRUFBRUQsTUFGYztBQUcxQkUsRUFBQUEsUUFBUSxFQUFFRixNQUhnQjtBQUkxQkcsRUFBQUEsS0FBSyxFQUFFSCxNQUptQjtBQUsxQkksRUFBQUEsV0FBVyxFQUFFSixNQUxhO0FBTTFCSyxFQUFBQSxLQUFLLEVBQUVMLE1BTm1CO0FBTzFCTSxFQUFBQSxVQUFVLEVBQUVOLE1BUGM7QUFRMUJPLEVBQUFBLFFBQVEsRUFBRVAs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bGV0YS1uZXctYXBpL3NyYy9tb2RlbHMvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlLCB7U2NoZW1hfSBmcm9tIFwibW9uZ29vc2VcIjtcbmltcG9ydCB0aW1lc3RhbXBzIGZyb20gXCJtb25nb29zZS10aW1lc3RhbXBcIjtcbmltcG9ydCB7Y29tcG9zZVdpdGhNb25nb29zZX0gZnJvbSBcImdyYXBocWwtY29tcG9zZS1tb25nb29zZVwiO1xuXG5jb25zdCBVc2VyU2NoZW1hID0gbmV3IFNjaGVtYSh7XG4gICAgZmlyc3ROYW1lOiBTdHJpbmcsXG4gICAgbWlkZGxlTmFtZTogU3RyaW5nLFxuICAgIGxhc3ROYW1lOiBTdHJpbmcsXG4gICAgZW1haWw6IFN0cmluZyxcbiAgICBwaG9uZU51bWJlcjogU3RyaW5nLFxuICAgIGltYWdlOiBTdHJpbmcsXG4gICAgZmlyZWJhc2VJZDogU3RyaW5nLFxuICAgIHBhc3N3b3JkOiBTdHJpbmcsXG4gICAgc3RhdHVzOiB7XG4gICAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgICAgZGVmYXVsdDogXCJBQ1RJVkVcIixcbiAgICAgICAgZW51bTogW1wiQUNUSVZFXCIsIFwiQkxPQ0tFRFwiXSxcbiAgICB9LFxuICAgIHJvbGVzOiB7XG4gICAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgICAgZGVmYXVsdDogXCJOT1JNQUxcIixcbiAgICAgICAgZW51bTogW1wiTk9STUFMXCIsIFwiT1dORVJcIiwgXCJBRE1JTlwiLCBcIlNBTEVTXCJdLFxuICAgIH0sXG4gICAgYWNjb3VudDoge1xuICAgICAgICB2ZXJpZmljYXRpb246IHtcbiAgICAgICAgICAgIHZlcmlmaWVkOiB7XG4gICAgICAgICAgICAgICAgdHlwZTogQm9vbGVhbixcbiAgICAgICAgICAgICAgICBkZWZhdWx0OiBmYWxzZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0b2tlbjogU3RyaW5nLFxuICAgICAgICAgICAgZXhwaXJlc0luOiBEYXRlLFxuICAgICAgICB9LFxuICAgICAgICBlbWFpbFZlcmlmaWNhdGlvbjoge1xuICAgICAgICAgICAgdmVyaWZpZWQ6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiBCb29sZWFuLFxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRva2VuOiBTdHJpbmcsXG4gICAgICAgICAgICBleHBpcmVzSW46IERhdGUsXG4gICAgICAgIH0sXG4gICAgICAgIHBob25lVmVyaWZpY2F0aW9uOiB7XG4gICAgICAgICAgICB2ZXJpZmllZDoge1xuICAgICAgICAgICAgICAgIHR5cGU6IEJvb2xlYW4sXG4gICAgICAgICAgICAgICAgZGVmYXVsdDogZmFsc2UsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdG9rZW46IFN0cmluZyxcbiAgICAgICAgICAgIGV4cGlyZXNJbjogRGF0ZSxcbiAgICAgICAgfSxcbiAgICAgICAgcmVzZXRQYXNzd29yZDoge1xuICAgICAgICAgICAgdG9rZW46IFN0cmluZyxcbiAgICAgICAgICAgIGV4cGlyZXNJbjogRGF0ZSxcbiAgICAgICAgfSxcbiAgICB9LFxufSwge1xuICAgIGNvbGxlY3Rpb246IFwidXNlcnNcIixcbn0pO1xuXG5Vc2VyU2NoZW1hLnBsdWdpbih0aW1lc3RhbXBzKTtcblVzZXJTY2hlbWEuaW5kZXgoe1xuICAgIGNyZWF0ZWRBdDogMSxcbiAgICB1cGRhdGVkQXQ6IDEsXG59KTtcblxuVXNlclNjaGVtYS5zdGF0aWNzLmVtYWlsRXhpc3QgPSBmdW5jdGlvbiAoZW1haWwpIHtcbiAgICByZXR1cm4gdGhpcy5maW5kT25lKHtlbWFpbH0pO1xufTtcblxuVXNlclNjaGVtYS5zdGF0aWNzLnBob25lTnVtYmVyRXhpc3QgPSBmdW5jdGlvbiAocGhvbmVOdW1iZXIpIHtcbiAgICByZXR1cm4gdGhpcy5maW5kT25lKHtwaG9uZU51bWJlcn0pO1xufTtcblxuVXNlclNjaGVtYS5tZXRob2RzLmNvbXBhcmVQYXNzd29yZCA9IGZ1bmN0aW9uIChwYXNzd29yZCkge1xuICAgIHJldHVybiBiY3J5cHQuY29tcGFyZVN5bmMocGFzc3dvcmQsIHRoaXMucGFzc3dvcmQpO1xufTtcblxuY29uc3QgVXNlck1vZGVsID0gbW9uZ29vc2UubW9kZWwoXCJVc2VyXCIsIFVzZXJTY2hlbWEpO1xuY29uc3QgVXNlclRDID0gY29tcG9zZVdpdGhNb25nb29zZShVc2VyTW9kZWwpO1xuLy8gY29uc3QgVXNlclRDID0gY29tcG9zZVdpdGhNb25nb29zZShVc2VyTW9kZWwpLnJlbW92ZUZpZWxkKCdwYXNzd29yZCcpO1xuXG5jb25zdCBVc2VyQWNjb3VudFRDID0gVXNlclRDLmdldEZpZWxkVEMoXCJhY2NvdW50XCIpO1xuXG5Vc2VyQWNjb3VudFRDLmdldEZpZWxkVEMoXCJ2ZXJpZmljYXRpb25cIikucmVtb3ZlRmllbGQoW1widG9rZW5cIiwgXCJleHBpcmVzSW5cIl0pO1xuXG4vLyBVc2VyQWNjb3VudFRDLnJlbW92ZUZpZWxkKCdyZXNldFBhc3N3b3JkJyk7XG5cbmV4cG9ydCB7VXNlck1vZGVsLCBVc2VyVEMsIFVzZXJTY2hlbWF9O1xuIl19","map":{"version":3,"sources":["user.js"],"names":["UserSchema","Schema","firstName","String","middleName","lastName","email","phoneNumber","image","firebaseId","password","status","type","default","enum","roles","account","verification","verified","Boolean","token","expiresIn","Date","emailVerification","phoneVerification","resetPassword","collection","plugin","timestamps","index","createdAt","updatedAt","statics","emailExist","findOne","phoneNumberExist","methods","comparePassword","bcrypt","compareSync","UserModel","mongoose","model","UserTC","UserAccountTC","getFieldTC","removeField"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;;;;;AAEA,MAAMA,UAAU,GAAG,IAAIC,gBAAJ,CAAW;AAC1BC,EAAAA,SAAS,EAAEC,MADe;AAE1BC,EAAAA,UAAU,EAAED,MAFc;AAG1BE,EAAAA,QAAQ,EAAEF,MAHgB;AAI1BG,EAAAA,KAAK,EAAEH,MAJmB;AAK1BI,EAAAA,WAAW,EAAEJ,MALa;AAM1BK,EAAAA,KAAK,EAAEL,MANmB;AAO1BM,EAAAA,UAAU,EAAEN,MAPc;AAQ1BO,EAAAA,QAAQ,EAAEP,MARgB;AAS1BQ,EAAAA,MAAM,EAAE;AACJC,IAAAA,IAAI,EAAET,MADF;AAEJU,IAAAA,OAAO,EAAE,QAFL;AAGJC,IAAAA,IAAI,EAAE,CAAC,QAAD,EAAW,SAAX;AAHF,GATkB;AAc1BC,EAAAA,KAAK,EAAE;AACHH,IAAAA,IAAI,EAAET,MADH;AAEHU,IAAAA,OAAO,EAAE,QAFN;AAGHC,IAAAA,IAAI,EAAE,CAAC,QAAD,EAAW,OAAX,EAAoB,OAApB,EAA6B,OAA7B;AAHH,GAdmB;AAmB1BE,EAAAA,OAAO,EAAE;AACLC,IAAAA,YAAY,EAAE;AACVC,MAAAA,QAAQ,EAAE;AACNN,QAAAA,IAAI,EAAEO,OADA;AAENN,QAAAA,OAAO,EAAE;AAFH,OADA;AAKVO,MAAAA,KAAK,EAAEjB,MALG;AAMVkB,MAAAA,SAAS,EAAEC;AAND,KADT;AASLC,IAAAA,iBAAiB,EAAE;AACfL,MAAAA,QAAQ,EAAE;AACNN,QAAAA,IAAI,EAAEO,OADA;AAENN,QAAAA,OAAO,EAAE;AAFH,OADK;AAKfO,MAAAA,KAAK,EAAEjB,MALQ;AAMfkB,MAAAA,SAAS,EAAEC;AANI,KATd;AAiBLE,IAAAA,iBAAiB,EAAE;AACfN,MAAAA,QAAQ,EAAE;AACNN,QAAAA,IAAI,EAAEO,OADA;AAENN,QAAAA,OAAO,EAAE;AAFH,OADK;AAKfO,MAAAA,KAAK,EAAEjB,MALQ;AAMfkB,MAAAA,SAAS,EAAEC;AANI,KAjBd;AAyBLG,IAAAA,aAAa,EAAE;AACXL,MAAAA,KAAK,EAAEjB,MADI;AAEXkB,MAAAA,SAAS,EAAEC;AAFA;AAzBV;AAnBiB,CAAX,EAiDhB;AACCI,EAAAA,UAAU,EAAE;AADb,CAjDgB,CAAnB;;AAqDA1B,UAAU,CAAC2B,MAAX,CAAkBC,0BAAlB;AACA5B,UAAU,CAAC6B,KAAX,CAAiB;AACbC,EAAAA,SAAS,EAAE,CADE;AAEbC,EAAAA,SAAS,EAAE;AAFE,CAAjB;;AAKA/B,UAAU,CAACgC,OAAX,CAAmBC,UAAnB,GAAgC,UAAU3B,KAAV,EAAiB;AAC7C,SAAO,KAAK4B,OAAL,CAAa;AAAC5B,IAAAA;AAAD,GAAb,CAAP;AACH,CAFD;;AAIAN,UAAU,CAACgC,OAAX,CAAmBG,gBAAnB,GAAsC,UAAU5B,WAAV,EAAuB;AACzD,SAAO,KAAK2B,OAAL,CAAa;AAAC3B,IAAAA;AAAD,GAAb,CAAP;AACH,CAFD;;AAIAP,UAAU,CAACoC,OAAX,CAAmBC,eAAnB,GAAqC,UAAU3B,QAAV,EAAoB;AACrD,SAAO4B,MAAM,CAACC,WAAP,CAAmB7B,QAAnB,EAA6B,KAAKA,QAAlC,CAAP;AACH,CAFD;;AAIA,MAAM8B,SAAS,GAAGC,kBAASC,KAAT,CAAe,MAAf,EAAuB1C,UAAvB,CAAlB;;;AACA,MAAM2C,MAAM,GAAG,iDAAoBH,SAApB,CAAf,C,CACA;;;AAEA,MAAMI,aAAa,GAAGD,MAAM,CAACE,UAAP,CAAkB,SAAlB,CAAtB;AAEAD,aAAa,CAACC,UAAd,CAAyB,cAAzB,EAAyCC,WAAzC,CAAqD,CAAC,OAAD,EAAU,WAAV,CAArD,E,CAEA","sourceRoot":"/home/nathnael/projects/haleta/haleta-new-api/src/models/","sourcesContent":["import mongoose, {Schema} from \"mongoose\";\nimport timestamps from \"mongoose-timestamp\";\nimport {composeWithMongoose} from \"graphql-compose-mongoose\";\n\nconst UserSchema = new Schema({\n    firstName: String,\n    middleName: String,\n    lastName: String,\n    email: String,\n    phoneNumber: String,\n    image: String,\n    firebaseId: String,\n    password: String,\n    status: {\n        type: String,\n        default: \"ACTIVE\",\n        enum: [\"ACTIVE\", \"BLOCKED\"],\n    },\n    roles: {\n        type: String,\n        default: \"NORMAL\",\n        enum: [\"NORMAL\", \"OWNER\", \"ADMIN\", \"SALES\"],\n    },\n    account: {\n        verification: {\n            verified: {\n                type: Boolean,\n                default: false,\n            },\n            token: String,\n            expiresIn: Date,\n        },\n        emailVerification: {\n            verified: {\n                type: Boolean,\n                default: false,\n            },\n            token: String,\n            expiresIn: Date,\n        },\n        phoneVerification: {\n            verified: {\n                type: Boolean,\n                default: false,\n            },\n            token: String,\n            expiresIn: Date,\n        },\n        resetPassword: {\n            token: String,\n            expiresIn: Date,\n        },\n    },\n}, {\n    collection: \"users\",\n});\n\nUserSchema.plugin(timestamps);\nUserSchema.index({\n    createdAt: 1,\n    updatedAt: 1,\n});\n\nUserSchema.statics.emailExist = function (email) {\n    return this.findOne({email});\n};\n\nUserSchema.statics.phoneNumberExist = function (phoneNumber) {\n    return this.findOne({phoneNumber});\n};\n\nUserSchema.methods.comparePassword = function (password) {\n    return bcrypt.compareSync(password, this.password);\n};\n\nconst UserModel = mongoose.model(\"User\", UserSchema);\nconst UserTC = composeWithMongoose(UserModel);\n// const UserTC = composeWithMongoose(UserModel).removeField('password');\n\nconst UserAccountTC = UserTC.getFieldTC(\"account\");\n\nUserAccountTC.getFieldTC(\"verification\").removeField([\"token\", \"expiresIn\"]);\n\n// UserAccountTC.removeField('resetPassword');\n\nexport {UserModel, UserTC, UserSchema};\n"]}},"mtime":1648313712832},"{\"assumptions\":{},\"sourceRoot\":\"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"filename\":\"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _graphqlCompose = require(\"graphql-compose\");\n\nvar _auth = require(\"./auth\");\n\nvar _user = require(\"./user\");\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nconst schemaComposer = new _graphqlCompose.SchemaComposer();\nschemaComposer.Query.addFields(_objectSpread({}, _user.UserQuery));\nschemaComposer.Mutation.addFields(_objectSpread(_objectSpread({}, _auth.AuthMutation), _user.UserMutation));\nconst schema = schemaComposer.buildSchema();\nvar _default = schema;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbInNjaGVtYUNvbXBvc2VyIiwiU2NoZW1hQ29tcG9zZXIiLCJRdWVyeSIsImFkZEZpZWxkcyIsIlVzZXJRdWVyeSIsIk11dGF0aW9uIiwiQXV0aE11dGF0aW9uIiwiVXNlck11dGF0aW9uIiwic2NoZW1hIiwiYnVpbGRTY2hlbWEiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7Ozs7Ozs7QUFFQSxNQUFNQSxjQUFjLEdBQUcsSUFBSUMsOEJBQUosRUFBdkI7QUFFQUQsY0FBYyxDQUFDRSxLQUFmLENBQXFCQyxTQUFyQixtQkFDT0MsZUFEUDtBQUlBSixjQUFjLENBQUNLLFFBQWYsQ0FBd0JGLFNBQXhCLGlDQUNPRyxrQkFEUCxHQUVPQyxrQkFGUDtBQUtBLE1BQU1DLE1BQU0sR0FBR1IsY0FBYyxDQUFDUyxXQUFmLEVBQWY7ZUFDZUQsTSIsInNvdXJjZVJvb3QiOiIvaG9tZS9uYXRobmFlbC9wcm9qZWN0cy9oYWxldGEvaGFsZXRhLW5ldy1hcGkvc3JjL2dyYXBocWwvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtTY2hlbWFDb21wb3Nlcn0gZnJvbSBcImdyYXBocWwtY29tcG9zZVwiO1xuaW1wb3J0IHtBdXRoTXV0YXRpb259IGZyb20gXCIuL2F1dGhcIjtcbmltcG9ydCB7VXNlck11dGF0aW9uLCBVc2VyUXVlcnl9IGZyb20gXCIuL3VzZXJcIjtcblxuY29uc3Qgc2NoZW1hQ29tcG9zZXIgPSBuZXcgU2NoZW1hQ29tcG9zZXIoKTtcblxuc2NoZW1hQ29tcG9zZXIuUXVlcnkuYWRkRmllbGRzKHtcbiAgICAuLi5Vc2VyUXVlcnksXG59KTtcblxuc2NoZW1hQ29tcG9zZXIuTXV0YXRpb24uYWRkRmllbGRzKHtcbiAgICAuLi5BdXRoTXV0YXRpb24sXG4gICAgLi4uVXNlck11dGF0aW9uLFxufSk7XG5cbmNvbnN0IHNjaGVtYSA9IHNjaGVtYUNvbXBvc2VyLmJ1aWxkU2NoZW1hKCk7XG5leHBvcnQgZGVmYXVsdCBzY2hlbWE7XG4iXX0=","map":{"version":3,"sources":["index.js"],"names":["schemaComposer","SchemaComposer","Query","addFields","UserQuery","Mutation","AuthMutation","UserMutation","schema","buildSchema"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;;;;;AAEA,MAAMA,cAAc,GAAG,IAAIC,8BAAJ,EAAvB;AAEAD,cAAc,CAACE,KAAf,CAAqBC,SAArB,mBACOC,eADP;AAIAJ,cAAc,CAACK,QAAf,CAAwBF,SAAxB,iCACOG,kBADP,GAEOC,kBAFP;AAKA,MAAMC,MAAM,GAAGR,cAAc,CAACS,WAAf,EAAf;eACeD,M","sourceRoot":"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/","sourcesContent":["import {SchemaComposer} from \"graphql-compose\";\nimport {AuthMutation} from \"./auth\";\nimport {UserMutation, UserQuery} from \"./user\";\n\nconst schemaComposer = new SchemaComposer();\n\nschemaComposer.Query.addFields({\n    ...UserQuery,\n});\n\nschemaComposer.Mutation.addFields({\n    ...AuthMutation,\n    ...UserMutation,\n});\n\nconst schema = schemaComposer.buildSchema();\nexport default schema;\n"]}},"mtime":1648317247190},"{\"assumptions\":{},\"sourceRoot\":\"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"filename\":\"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"authentication\", {\n  enumerable: true,\n  get: function () {\n    return _authentication.default;\n  }\n});\nObject.defineProperty(exports, \"authorization\", {\n  enumerable: true,\n  get: function () {\n    return _authorization.default;\n  }\n});\nObject.defineProperty(exports, \"phoneVerification\", {\n  enumerable: true,\n  get: function () {\n    return _phoneVerification.default;\n  }\n});\nObject.defineProperty(exports, \"userValidator\", {\n  enumerable: true,\n  get: function () {\n    return _userValidator.default;\n  }\n});\nObject.defineProperty(exports, \"validateToken\", {\n  enumerable: true,\n  get: function () {\n    return _validateToken.default;\n  }\n});\n\nvar _authentication = _interopRequireDefault(require(\"./auth/authentication\"));\n\nvar _authorization = _interopRequireDefault(require(\"./auth/authorization\"));\n\nvar _validateToken = _interopRequireDefault(require(\"./auth/validate-token\"));\n\nvar _phoneVerification = _interopRequireDefault(require(\"./auth/phone-verification\"));\n\nvar _userValidator = _interopRequireDefault(require(\"./validators/user-validator\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUNBIiwic291cmNlUm9vdCI6Ii9ob21lL25hdGhuYWVsL3Byb2plY3RzL2hhbGV0YS9oYWxldGEtbmV3LWFwaS9zcmMvbWlkZGxld2FyZXMvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGF1dGhlbnRpY2F0aW9uIGZyb20gXCIuL2F1dGgvYXV0aGVudGljYXRpb25cIlxuaW1wb3J0IGF1dGhvcml6YXRpb24gZnJvbSBcIi4vYXV0aC9hdXRob3JpemF0aW9uXCJcbmltcG9ydCB2YWxpZGF0ZVRva2VuIGZyb20gXCIuL2F1dGgvdmFsaWRhdGUtdG9rZW5cIlxuaW1wb3J0IHBob25lVmVyaWZpY2F0aW9uIGZyb20gXCIuL2F1dGgvcGhvbmUtdmVyaWZpY2F0aW9uXCJcbmltcG9ydCB1c2VyVmFsaWRhdG9yIGZyb20gXCIuL3ZhbGlkYXRvcnMvdXNlci12YWxpZGF0b3JcIjtcblxuZXhwb3J0IHtcbiAgICBhdXRoZW50aWNhdGlvbixcbiAgICBhdXRob3JpemF0aW9uLFxuICAgIHZhbGlkYXRlVG9rZW4sXG4gICAgcGhvbmVWZXJpZmljYXRpb24sXG4gICAgdXNlclZhbGlkYXRvcixcbn0iXX0=","map":{"version":3,"sources":["index.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA","sourceRoot":"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/","sourcesContent":["import authentication from \"./auth/authentication\"\nimport authorization from \"./auth/authorization\"\nimport validateToken from \"./auth/validate-token\"\nimport phoneVerification from \"./auth/phone-verification\"\nimport userValidator from \"./validators/user-validator\";\n\nexport {\n    authentication,\n    authorization,\n    validateToken,\n    phoneVerification,\n    userValidator,\n}"]}},"mtime":1648313712832},"{\"assumptions\":{},\"sourceRoot\":\"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/auth/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"filename\":\"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/auth/authentication.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nconst isAuth = async (resolve, source, args, context, info) => {\n  const {\n    user\n  } = context;\n\n  if (!user) {\n    return Promise.reject(new Error(\"You must be authorized.\"));\n  }\n\n  return resolve(source, args, context, info);\n};\n\nconst isGuest = async (resolve, source, args, context, info) => {\n  const {\n    user\n  } = context;\n\n  if (user) {\n    return Promise.reject(new Error(\"You have already authorized.\"));\n  }\n\n  return resolve(source, args, context, info);\n};\n\nvar _default = {\n  isAuth,\n  isGuest\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGhlbnRpY2F0aW9uLmpzIl0sIm5hbWVzIjpbImlzQXV0aCIsInJlc29sdmUiLCJzb3VyY2UiLCJhcmdzIiwiY29udGV4dCIsImluZm8iLCJ1c2VyIiwiUHJvbWlzZSIsInJlamVjdCIsIkVycm9yIiwiaXNHdWVzdCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBLE1BQU1BLE1BQU0sR0FBRyxPQUFPQyxPQUFQLEVBQWdCQyxNQUFoQixFQUF3QkMsSUFBeEIsRUFBOEJDLE9BQTlCLEVBQXVDQyxJQUF2QyxLQUFnRDtBQUMzRCxRQUFNO0FBQUNDLElBQUFBO0FBQUQsTUFBU0YsT0FBZjs7QUFDQSxNQUFJLENBQUNFLElBQUwsRUFBVztBQUNQLFdBQU9DLE9BQU8sQ0FBQ0MsTUFBUixDQUFlLElBQUlDLEtBQUosQ0FBVSx5QkFBVixDQUFmLENBQVA7QUFDSDs7QUFDRCxTQUFPUixPQUFPLENBQUNDLE1BQUQsRUFBU0MsSUFBVCxFQUFlQyxPQUFmLEVBQXdCQyxJQUF4QixDQUFkO0FBQ0gsQ0FORDs7QUFRQSxNQUFNSyxPQUFPLEdBQUcsT0FBT1QsT0FBUCxFQUFnQkMsTUFBaEIsRUFBd0JDLElBQXhCLEVBQThCQyxPQUE5QixFQUF1Q0MsSUFBdkMsS0FBZ0Q7QUFDNUQsUUFBTTtBQUFDQyxJQUFBQTtBQUFELE1BQVNGLE9BQWY7O0FBQ0EsTUFBSUUsSUFBSixFQUFVO0FBQ04sV0FBT0MsT0FBTyxDQUFDQyxNQUFSLENBQWUsSUFBSUMsS0FBSixDQUFVLDhCQUFWLENBQWYsQ0FBUDtBQUNIOztBQUNELFNBQU9SLE9BQU8sQ0FBQ0MsTUFBRCxFQUFTQyxJQUFULEVBQWVDLE9BQWYsRUFBd0JDLElBQXhCLENBQWQ7QUFDSCxDQU5EOztlQVFlO0FBQUNMLEVBQUFBLE1BQUQ7QUFBU1UsRUFBQUE7QUFBVCxDIiwic291cmNlUm9vdCI6Ii9ob21lL25hdGhuYWVsL3Byb2plY3RzL2hhbGV0YS9oYWxldGEtbmV3LWFwaS9zcmMvbWlkZGxld2FyZXMvYXV0aC8iLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBpc0F1dGggPSBhc3luYyAocmVzb2x2ZSwgc291cmNlLCBhcmdzLCBjb250ZXh0LCBpbmZvKSA9PiB7XG4gICAgY29uc3Qge3VzZXJ9ID0gY29udGV4dDtcbiAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcIllvdSBtdXN0IGJlIGF1dGhvcml6ZWQuXCIpKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc29sdmUoc291cmNlLCBhcmdzLCBjb250ZXh0LCBpbmZvKTtcbn07XG5cbmNvbnN0IGlzR3Vlc3QgPSBhc3luYyAocmVzb2x2ZSwgc291cmNlLCBhcmdzLCBjb250ZXh0LCBpbmZvKSA9PiB7XG4gICAgY29uc3Qge3VzZXJ9ID0gY29udGV4dDtcbiAgICBpZiAodXNlcikge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKFwiWW91IGhhdmUgYWxyZWFkeSBhdXRob3JpemVkLlwiKSk7XG4gICAgfVxuICAgIHJldHVybiByZXNvbHZlKHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbyk7XG59O1xuXG5leHBvcnQgZGVmYXVsdCB7aXNBdXRoLCBpc0d1ZXN0fTtcbiJdfQ==","map":{"version":3,"sources":["authentication.js"],"names":["isAuth","resolve","source","args","context","info","user","Promise","reject","Error","isGuest"],"mappings":";;;;;;;AAAA,MAAMA,MAAM,GAAG,OAAOC,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AAC3D,QAAM;AAACC,IAAAA;AAAD,MAASF,OAAf;;AACA,MAAI,CAACE,IAAL,EAAW;AACP,WAAOC,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAU,yBAAV,CAAf,CAAP;AACH;;AACD,SAAOR,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,CAND;;AAQA,MAAMK,OAAO,GAAG,OAAOT,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AAC5D,QAAM;AAACC,IAAAA;AAAD,MAASF,OAAf;;AACA,MAAIE,IAAJ,EAAU;AACN,WAAOC,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAU,8BAAV,CAAf,CAAP;AACH;;AACD,SAAOR,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,CAND;;eAQe;AAACL,EAAAA,MAAD;AAASU,EAAAA;AAAT,C","sourceRoot":"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/auth/","sourcesContent":["const isAuth = async (resolve, source, args, context, info) => {\n    const {user} = context;\n    if (!user) {\n        return Promise.reject(new Error(\"You must be authorized.\"));\n    }\n    return resolve(source, args, context, info);\n};\n\nconst isGuest = async (resolve, source, args, context, info) => {\n    const {user} = context;\n    if (user) {\n        return Promise.reject(new Error(\"You have already authorized.\"));\n    }\n    return resolve(source, args, context, info);\n};\n\nexport default {isAuth, isGuest};\n"]}},"mtime":1648313712832},"{\"assumptions\":{},\"sourceRoot\":\"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/auth/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"filename\":\"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/auth/authorization.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n//list from redis, list of functions for each role\nconst accessList = {\n  ADMIN: [\"findMany\", \"createOne\"],\n  SUPER_ADMIN: [\"findMany\", \"createOne\"],\n  NORMAL: [],\n  TUTOR: [],\n  CUSTOMER_SERVICE: []\n};\n\nconst authorization = async (resolve, source, args, context, info) => {\n  const {\n    user\n  } = context;\n  const fieldName = info.fieldName;\n  let hasAccess = false; //list from redis, list of functions for each role\n\n  user.roles.forEach(role => {\n    if (accessList[role].includes(fieldName)) {\n      hasAccess = true;\n    }\n  });\n\n  if (!hasAccess) {\n    return Promise.reject(new Error(\"Access denied.\"));\n  }\n\n  return resolve(source, args, context, info);\n};\n\nvar _default = authorization;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGhvcml6YXRpb24uanMiXSwibmFtZXMiOlsiYWNjZXNzTGlzdCIsIkFETUlOIiwiU1VQRVJfQURNSU4iLCJOT1JNQUwiLCJUVVRPUiIsIkNVU1RPTUVSX1NFUlZJQ0UiLCJhdXRob3JpemF0aW9uIiwicmVzb2x2ZSIsInNvdXJjZSIsImFyZ3MiLCJjb250ZXh0IiwiaW5mbyIsInVzZXIiLCJmaWVsZE5hbWUiLCJoYXNBY2Nlc3MiLCJyb2xlcyIsImZvckVhY2giLCJyb2xlIiwiaW5jbHVkZXMiLCJQcm9taXNlIiwicmVqZWN0IiwiRXJyb3IiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0EsTUFBTUEsVUFBVSxHQUFHO0FBQ2ZDLEVBQUFBLEtBQUssRUFBRSxDQUFDLFVBQUQsRUFBYSxXQUFiLENBRFE7QUFFZkMsRUFBQUEsV0FBVyxFQUFFLENBQUMsVUFBRCxFQUFhLFdBQWIsQ0FGRTtBQUdmQyxFQUFBQSxNQUFNLEVBQUUsRUFITztBQUlmQyxFQUFBQSxLQUFLLEVBQUUsRUFKUTtBQUtmQyxFQUFBQSxnQkFBZ0IsRUFBRTtBQUxILENBQW5COztBQVFBLE1BQU1DLGFBQWEsR0FBRyxPQUFPQyxPQUFQLEVBQWdCQyxNQUFoQixFQUF3QkMsSUFBeEIsRUFBOEJDLE9BQTlCLEVBQXVDQyxJQUF2QyxLQUFnRDtBQUNsRSxRQUFNO0FBQUNDLElBQUFBO0FBQUQsTUFBU0YsT0FBZjtBQUNBLFFBQU1HLFNBQVMsR0FBR0YsSUFBSSxDQUFDRSxTQUF2QjtBQUNBLE1BQUlDLFNBQVMsR0FBRyxLQUFoQixDQUhrRSxDQUlsRTs7QUFDQUYsRUFBQUEsSUFBSSxDQUFDRyxLQUFMLENBQVdDLE9BQVgsQ0FBbUJDLElBQUksSUFBSTtBQUN2QixRQUFHakIsVUFBVSxDQUFDaUIsSUFBRCxDQUFWLENBQWlCQyxRQUFqQixDQUEwQkwsU0FBMUIsQ0FBSCxFQUF3QztBQUNwQ0MsTUFBQUEsU0FBUyxHQUFHLElBQVo7QUFDSDtBQUNKLEdBSkQ7O0FBS0EsTUFBSSxDQUFDQSxTQUFMLEVBQWdCO0FBQ1osV0FBT0ssT0FBTyxDQUFDQyxNQUFSLENBQWUsSUFBSUMsS0FBSixDQUFVLGdCQUFWLENBQWYsQ0FBUDtBQUNIOztBQUNELFNBQU9kLE9BQU8sQ0FBQ0MsTUFBRCxFQUFTQyxJQUFULEVBQWVDLE9BQWYsRUFBd0JDLElBQXhCLENBQWQ7QUFDSCxDQWREOztlQWdCZUwsYSIsInNvdXJjZVJvb3QiOiIvaG9tZS9uYXRobmFlbC9wcm9qZWN0cy9oYWxldGEvaGFsZXRhLW5ldy1hcGkvc3JjL21pZGRsZXdhcmVzL2F1dGgvIiwic291cmNlc0NvbnRlbnQiOlsiLy9saXN0IGZyb20gcmVkaXMsIGxpc3Qgb2YgZnVuY3Rpb25zIGZvciBlYWNoIHJvbGVcbmNvbnN0IGFjY2Vzc0xpc3QgPSB7XG4gICAgQURNSU46IFtcImZpbmRNYW55XCIsIFwiY3JlYXRlT25lXCJdLFxuICAgIFNVUEVSX0FETUlOOiBbXCJmaW5kTWFueVwiLCBcImNyZWF0ZU9uZVwiXSxcbiAgICBOT1JNQUw6IFtdLFxuICAgIFRVVE9SOiBbXSxcbiAgICBDVVNUT01FUl9TRVJWSUNFOiBbXSxcbn07XG5cbmNvbnN0IGF1dGhvcml6YXRpb24gPSBhc3luYyAocmVzb2x2ZSwgc291cmNlLCBhcmdzLCBjb250ZXh0LCBpbmZvKSA9PiB7XG4gICAgY29uc3Qge3VzZXJ9ID0gY29udGV4dDtcbiAgICBjb25zdCBmaWVsZE5hbWUgPSBpbmZvLmZpZWxkTmFtZVxuICAgIGxldCBoYXNBY2Nlc3MgPSBmYWxzZVxuICAgIC8vbGlzdCBmcm9tIHJlZGlzLCBsaXN0IG9mIGZ1bmN0aW9ucyBmb3IgZWFjaCByb2xlXG4gICAgdXNlci5yb2xlcy5mb3JFYWNoKHJvbGUgPT4ge1xuICAgICAgICBpZihhY2Nlc3NMaXN0W3JvbGVdLmluY2x1ZGVzKGZpZWxkTmFtZSkpe1xuICAgICAgICAgICAgaGFzQWNjZXNzID0gdHJ1ZVxuICAgICAgICB9XG4gICAgfSlcbiAgICBpZiAoIWhhc0FjY2Vzcykge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKFwiQWNjZXNzIGRlbmllZC5cIikpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzb2x2ZShzb3VyY2UsIGFyZ3MsIGNvbnRleHQsIGluZm8pO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgYXV0aG9yaXphdGlvbjtcbiJdfQ==","map":{"version":3,"sources":["authorization.js"],"names":["accessList","ADMIN","SUPER_ADMIN","NORMAL","TUTOR","CUSTOMER_SERVICE","authorization","resolve","source","args","context","info","user","fieldName","hasAccess","roles","forEach","role","includes","Promise","reject","Error"],"mappings":";;;;;;AAAA;AACA,MAAMA,UAAU,GAAG;AACfC,EAAAA,KAAK,EAAE,CAAC,UAAD,EAAa,WAAb,CADQ;AAEfC,EAAAA,WAAW,EAAE,CAAC,UAAD,EAAa,WAAb,CAFE;AAGfC,EAAAA,MAAM,EAAE,EAHO;AAIfC,EAAAA,KAAK,EAAE,EAJQ;AAKfC,EAAAA,gBAAgB,EAAE;AALH,CAAnB;;AAQA,MAAMC,aAAa,GAAG,OAAOC,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AAClE,QAAM;AAACC,IAAAA;AAAD,MAASF,OAAf;AACA,QAAMG,SAAS,GAAGF,IAAI,CAACE,SAAvB;AACA,MAAIC,SAAS,GAAG,KAAhB,CAHkE,CAIlE;;AACAF,EAAAA,IAAI,CAACG,KAAL,CAAWC,OAAX,CAAmBC,IAAI,IAAI;AACvB,QAAGjB,UAAU,CAACiB,IAAD,CAAV,CAAiBC,QAAjB,CAA0BL,SAA1B,CAAH,EAAwC;AACpCC,MAAAA,SAAS,GAAG,IAAZ;AACH;AACJ,GAJD;;AAKA,MAAI,CAACA,SAAL,EAAgB;AACZ,WAAOK,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAU,gBAAV,CAAf,CAAP;AACH;;AACD,SAAOd,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,CAdD;;eAgBeL,a","sourceRoot":"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/auth/","sourcesContent":["//list from redis, list of functions for each role\nconst accessList = {\n    ADMIN: [\"findMany\", \"createOne\"],\n    SUPER_ADMIN: [\"findMany\", \"createOne\"],\n    NORMAL: [],\n    TUTOR: [],\n    CUSTOMER_SERVICE: [],\n};\n\nconst authorization = async (resolve, source, args, context, info) => {\n    const {user} = context;\n    const fieldName = info.fieldName\n    let hasAccess = false\n    //list from redis, list of functions for each role\n    user.roles.forEach(role => {\n        if(accessList[role].includes(fieldName)){\n            hasAccess = true\n        }\n    })\n    if (!hasAccess) {\n        return Promise.reject(new Error(\"Access denied.\"));\n    }\n    return resolve(source, args, context, info);\n};\n\nexport default authorization;\n"]}},"mtime":1648313712832},"{\"assumptions\":{},\"sourceRoot\":\"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/auth/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"filename\":\"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/auth/validate-token.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\n\nvar _user = require(\"../../models/user\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// import redis from \"../config/redis-config\";\nconst validateToken = async (req, res, next) => {\n  try {\n    const authorization = req.headers.authorization || req.cookies.jwt;\n    Object.assign(req.headers, {\n      user: null,\n      authorization: null\n    });\n\n    if (!authorization) {\n      return next();\n    }\n\n    const accessToken = authorization.split(\" \")[1];\n    let decoded;\n\n    if (accessToken) {\n      decoded = _jsonwebtoken.default.verify(accessToken, process.env.JWT_SECRET);\n    }\n\n    if (!decoded) {\n      // invalid token, remove the token from everywhere\n      //remove from database\n      //remove from redis\n      return next();\n    }\n\n    if (decoded.exp * 1000 < Date.now()) {\n      //remove from database\n      //remove from redis\n      return next();\n    } //check if token is in redis\n    //if NOT in redis call next()\n    //else check last update time if greater than or equals to 1hour update the token\n    // if less skip else update token\n    // authorization = new token\n\n\n    const user = await _user.UserModel.findById(decoded.userId);\n\n    if (!user) {\n      //remove from database\n      //remove from redis\n      return next();\n    } // if the token has come all this way everything is good just attach it to the request header\n    //attach it to https response cookie\n\n\n    Object.assign(req.headers, {\n      user,\n      authorization\n    });\n    res.cookie(\"jwt\", authorization, {\n      secure: true,\n      httpOnly: true\n    });\n    return next();\n  } catch (error) {\n    return Promise.reject(new Error(\"Error Happened!\"));\n  }\n};\n\nvar _default = validateToken; // ------------- authorization ------------------\n// let check_user_action = async (req,action,resource) =>{\n//   if(!['updateOwn','deleteOwn'].includes(action)){\n//     return true\n//   }\n//\n//   const userResource = new Set()\n//\n//   if(resource == 'tender'){\n//     let userTender = await Tender.find({ creator_user: req.user._id })\n//     userTender.forEach(tender => userResource.add(`${tender._id}`))\n//\n//   }else if(resource == 'company'){\n//     let userCompany = await Company.find({ creator_user: req.user._id })\n//     userCompany.forEach(company => userResource.add( `${company._id}`))\n//\n//   }else if(resource == 'award'){\n//     let userAward = await Award.find({ creator_user: req.user._id })\n//     userAward.forEach(award => userResource.add(`${award._id}`))\n//   }\n//\n//   if(!userResource.has(req.params.id)){\n//     return false\n//   }\n//\n//   return true\n// }\n//\n//\n//\n// exports.authorize = function (action, resource) {\n//   return async (req, res, next) => {\n//     try {\n//       const permission = roles.can(req.user.role)[action](resource);\n//\n//       if (!permission.granted) {\n//         return res.status(401).send(\"You don't have enough permission to perform this action\");\n//       }\n//\n//       let result = await check_user_action(req,action,resource)\n//       if(!result){\n//         return res.status(401).send({ param: resource , msg: `You are not authorized to edit this ${resource}.` })\n//       }\n//\n//       next()\n//     } catch (error) {\n//       return res.status(401).send(\"You don't have enough permission to perform this action\")\n//     }\n//   }\n// }\n\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInZhbGlkYXRlLXRva2VuLmpzIl0sIm5hbWVzIjpbInZhbGlkYXRlVG9rZW4iLCJyZXEiLCJyZXMiLCJuZXh0IiwiYXV0aG9yaXphdGlvbiIsImhlYWRlcnMiLCJjb29raWVzIiwiand0IiwiT2JqZWN0IiwiYXNzaWduIiwidXNlciIsImFjY2Vzc1Rva2VuIiwic3BsaXQiLCJkZWNvZGVkIiwidmVyaWZ5IiwicHJvY2VzcyIsImVudiIsIkpXVF9TRUNSRVQiLCJleHAiLCJEYXRlIiwibm93IiwiVXNlck1vZGVsIiwiZmluZEJ5SWQiLCJ1c2VySWQiLCJjb29raWUiLCJzZWN1cmUiLCJodHRwT25seSIsImVycm9yIiwiUHJvbWlzZSIsInJlamVjdCIsIkVycm9yIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBR0E7Ozs7QUFEQTtBQUdBLE1BQU1BLGFBQWEsR0FBRyxPQUFPQyxHQUFQLEVBQVlDLEdBQVosRUFBaUJDLElBQWpCLEtBQTBCO0FBQzVDLE1BQUk7QUFDQSxVQUFNQyxhQUFhLEdBQUdILEdBQUcsQ0FBQ0ksT0FBSixDQUFZRCxhQUFaLElBQTZCSCxHQUFHLENBQUNLLE9BQUosQ0FBWUMsR0FBL0Q7QUFFQUMsSUFBQUEsTUFBTSxDQUFDQyxNQUFQLENBQWNSLEdBQUcsQ0FBQ0ksT0FBbEIsRUFBMkI7QUFDdkJLLE1BQUFBLElBQUksRUFBRSxJQURpQjtBQUV2Qk4sTUFBQUEsYUFBYSxFQUFFO0FBRlEsS0FBM0I7O0FBS0EsUUFBSSxDQUFDQSxhQUFMLEVBQW9CO0FBQ2hCLGFBQU9ELElBQUksRUFBWDtBQUNIOztBQUVELFVBQU1RLFdBQVcsR0FBR1AsYUFBYSxDQUFDUSxLQUFkLENBQW9CLEdBQXBCLEVBQXlCLENBQXpCLENBQXBCO0FBRUEsUUFBSUMsT0FBSjs7QUFDQSxRQUFJRixXQUFKLEVBQWlCO0FBQ2JFLE1BQUFBLE9BQU8sR0FBR04sc0JBQUlPLE1BQUosQ0FBV0gsV0FBWCxFQUF3QkksT0FBTyxDQUFDQyxHQUFSLENBQVlDLFVBQXBDLENBQVY7QUFDSDs7QUFDRCxRQUFJLENBQUNKLE9BQUwsRUFBYztBQUNWO0FBQ0E7QUFDQTtBQUNBLGFBQU9WLElBQUksRUFBWDtBQUNIOztBQUVELFFBQUlVLE9BQU8sQ0FBQ0ssR0FBUixHQUFjLElBQWQsR0FBcUJDLElBQUksQ0FBQ0MsR0FBTCxFQUF6QixFQUFxQztBQUNqQztBQUNBO0FBQ0EsYUFBT2pCLElBQUksRUFBWDtBQUNILEtBN0JELENBK0JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQUVBLFVBQU1PLElBQUksR0FBRyxNQUFNVyxnQkFBVUMsUUFBVixDQUFtQlQsT0FBTyxDQUFDVSxNQUEzQixDQUFuQjs7QUFDQSxRQUFJLENBQUNiLElBQUwsRUFBVztBQUNQO0FBQ0E7QUFDQSxhQUFPUCxJQUFJLEVBQVg7QUFDSCxLQTFDRCxDQTRDQTtBQUNBOzs7QUFDQUssSUFBQUEsTUFBTSxDQUFDQyxNQUFQLENBQWNSLEdBQUcsQ0FBQ0ksT0FBbEIsRUFBMkI7QUFDdkJLLE1BQUFBLElBRHVCO0FBRXZCTixNQUFBQTtBQUZ1QixLQUEzQjtBQUtBRixJQUFBQSxHQUFHLENBQUNzQixNQUFKLENBQVcsS0FBWCxFQUFrQnBCLGFBQWxCLEVBQWlDO0FBQUNxQixNQUFBQSxNQUFNLEVBQUUsSUFBVDtBQUFlQyxNQUFBQSxRQUFRLEVBQUU7QUFBekIsS0FBakM7QUFFQSxXQUFPdkIsSUFBSSxFQUFYO0FBQ0gsR0F0REQsQ0FzREUsT0FBT3dCLEtBQVAsRUFBYztBQUNaLFdBQU9DLE9BQU8sQ0FBQ0MsTUFBUixDQUFlLElBQUlDLEtBQUosQ0FBVSxpQkFBVixDQUFmLENBQVA7QUFDSDtBQUNKLENBMUREOztlQTREZTlCLGEsRUFHZjtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6Ii9ob21lL25hdGhuYWVsL3Byb2plY3RzL2hhbGV0YS9oYWxldGEtbmV3LWFwaS9zcmMvbWlkZGxld2FyZXMvYXV0aC8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgand0IGZyb20gXCJqc29ud2VidG9rZW5cIjtcblxuLy8gaW1wb3J0IHJlZGlzIGZyb20gXCIuLi9jb25maWcvcmVkaXMtY29uZmlnXCI7XG5pbXBvcnQge1VzZXJNb2RlbH0gZnJvbSBcIi4uLy4uL21vZGVscy91c2VyXCI7XG5cbmNvbnN0IHZhbGlkYXRlVG9rZW4gPSBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCBhdXRob3JpemF0aW9uID0gcmVxLmhlYWRlcnMuYXV0aG9yaXphdGlvbiB8fCByZXEuY29va2llcy5qd3RcblxuICAgICAgICBPYmplY3QuYXNzaWduKHJlcS5oZWFkZXJzLCB7XG4gICAgICAgICAgICB1c2VyOiBudWxsLFxuICAgICAgICAgICAgYXV0aG9yaXphdGlvbjogbnVsbCxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKCFhdXRob3JpemF0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4gbmV4dCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgYWNjZXNzVG9rZW4gPSBhdXRob3JpemF0aW9uLnNwbGl0KFwiIFwiKVsxXTtcblxuICAgICAgICBsZXQgZGVjb2RlZDtcbiAgICAgICAgaWYgKGFjY2Vzc1Rva2VuKSB7XG4gICAgICAgICAgICBkZWNvZGVkID0gand0LnZlcmlmeShhY2Nlc3NUb2tlbiwgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFkZWNvZGVkKSB7XG4gICAgICAgICAgICAvLyBpbnZhbGlkIHRva2VuLCByZW1vdmUgdGhlIHRva2VuIGZyb20gZXZlcnl3aGVyZVxuICAgICAgICAgICAgLy9yZW1vdmUgZnJvbSBkYXRhYmFzZVxuICAgICAgICAgICAgLy9yZW1vdmUgZnJvbSByZWRpc1xuICAgICAgICAgICAgcmV0dXJuIG5leHQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkZWNvZGVkLmV4cCAqIDEwMDAgPCBEYXRlLm5vdygpKSB7XG4gICAgICAgICAgICAvL3JlbW92ZSBmcm9tIGRhdGFiYXNlXG4gICAgICAgICAgICAvL3JlbW92ZSBmcm9tIHJlZGlzXG4gICAgICAgICAgICByZXR1cm4gbmV4dCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy9jaGVjayBpZiB0b2tlbiBpcyBpbiByZWRpc1xuICAgICAgICAvL2lmIE5PVCBpbiByZWRpcyBjYWxsIG5leHQoKVxuICAgICAgICAvL2Vsc2UgY2hlY2sgbGFzdCB1cGRhdGUgdGltZSBpZiBncmVhdGVyIHRoYW4gb3IgZXF1YWxzIHRvIDFob3VyIHVwZGF0ZSB0aGUgdG9rZW5cbiAgICAgICAgLy8gaWYgbGVzcyBza2lwIGVsc2UgdXBkYXRlIHRva2VuXG4gICAgICAgIC8vIGF1dGhvcml6YXRpb24gPSBuZXcgdG9rZW5cblxuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlck1vZGVsLmZpbmRCeUlkKGRlY29kZWQudXNlcklkKTtcbiAgICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgICAgICAvL3JlbW92ZSBmcm9tIGRhdGFiYXNlXG4gICAgICAgICAgICAvL3JlbW92ZSBmcm9tIHJlZGlzXG4gICAgICAgICAgICByZXR1cm4gbmV4dCgpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gaWYgdGhlIHRva2VuIGhhcyBjb21lIGFsbCB0aGlzIHdheSBldmVyeXRoaW5nIGlzIGdvb2QganVzdCBhdHRhY2ggaXQgdG8gdGhlIHJlcXVlc3QgaGVhZGVyXG4gICAgICAgIC8vYXR0YWNoIGl0IHRvIGh0dHBzIHJlc3BvbnNlIGNvb2tpZVxuICAgICAgICBPYmplY3QuYXNzaWduKHJlcS5oZWFkZXJzLCB7XG4gICAgICAgICAgICB1c2VyLFxuICAgICAgICAgICAgYXV0aG9yaXphdGlvbixcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmVzLmNvb2tpZShcImp3dFwiLCBhdXRob3JpemF0aW9uLCB7c2VjdXJlOiB0cnVlLCBodHRwT25seTogdHJ1ZX0pXG5cbiAgICAgICAgcmV0dXJuIG5leHQoKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKFwiRXJyb3IgSGFwcGVuZWQhXCIpKTtcbiAgICB9XG59O1xuXG5leHBvcnQgZGVmYXVsdCB2YWxpZGF0ZVRva2VuO1xuXG5cbi8vIC0tLS0tLS0tLS0tLS0gYXV0aG9yaXphdGlvbiAtLS0tLS0tLS0tLS0tLS0tLS1cblxuLy8gbGV0IGNoZWNrX3VzZXJfYWN0aW9uID0gYXN5bmMgKHJlcSxhY3Rpb24scmVzb3VyY2UpID0+e1xuLy8gICBpZighWyd1cGRhdGVPd24nLCdkZWxldGVPd24nXS5pbmNsdWRlcyhhY3Rpb24pKXtcbi8vICAgICByZXR1cm4gdHJ1ZVxuLy8gICB9XG4vL1xuLy8gICBjb25zdCB1c2VyUmVzb3VyY2UgPSBuZXcgU2V0KClcbi8vXG4vLyAgIGlmKHJlc291cmNlID09ICd0ZW5kZXInKXtcbi8vICAgICBsZXQgdXNlclRlbmRlciA9IGF3YWl0IFRlbmRlci5maW5kKHsgY3JlYXRvcl91c2VyOiByZXEudXNlci5faWQgfSlcbi8vICAgICB1c2VyVGVuZGVyLmZvckVhY2godGVuZGVyID0+IHVzZXJSZXNvdXJjZS5hZGQoYCR7dGVuZGVyLl9pZH1gKSlcbi8vXG4vLyAgIH1lbHNlIGlmKHJlc291cmNlID09ICdjb21wYW55Jyl7XG4vLyAgICAgbGV0IHVzZXJDb21wYW55ID0gYXdhaXQgQ29tcGFueS5maW5kKHsgY3JlYXRvcl91c2VyOiByZXEudXNlci5faWQgfSlcbi8vICAgICB1c2VyQ29tcGFueS5mb3JFYWNoKGNvbXBhbnkgPT4gdXNlclJlc291cmNlLmFkZCggYCR7Y29tcGFueS5faWR9YCkpXG4vL1xuLy8gICB9ZWxzZSBpZihyZXNvdXJjZSA9PSAnYXdhcmQnKXtcbi8vICAgICBsZXQgdXNlckF3YXJkID0gYXdhaXQgQXdhcmQuZmluZCh7IGNyZWF0b3JfdXNlcjogcmVxLnVzZXIuX2lkIH0pXG4vLyAgICAgdXNlckF3YXJkLmZvckVhY2goYXdhcmQgPT4gdXNlclJlc291cmNlLmFkZChgJHthd2FyZC5faWR9YCkpXG4vLyAgIH1cbi8vXG4vLyAgIGlmKCF1c2VyUmVzb3VyY2UuaGFzKHJlcS5wYXJhbXMuaWQpKXtcbi8vICAgICByZXR1cm4gZmFsc2Vcbi8vICAgfVxuLy9cbi8vICAgcmV0dXJuIHRydWVcbi8vIH1cbi8vXG4vL1xuLy9cbi8vIGV4cG9ydHMuYXV0aG9yaXplID0gZnVuY3Rpb24gKGFjdGlvbiwgcmVzb3VyY2UpIHtcbi8vICAgcmV0dXJuIGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuLy8gICAgIHRyeSB7XG4vLyAgICAgICBjb25zdCBwZXJtaXNzaW9uID0gcm9sZXMuY2FuKHJlcS51c2VyLnJvbGUpW2FjdGlvbl0ocmVzb3VyY2UpO1xuLy9cbi8vICAgICAgIGlmICghcGVybWlzc2lvbi5ncmFudGVkKSB7XG4vLyAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuc2VuZChcIllvdSBkb24ndCBoYXZlIGVub3VnaCBwZXJtaXNzaW9uIHRvIHBlcmZvcm0gdGhpcyBhY3Rpb25cIik7XG4vLyAgICAgICB9XG4vL1xuLy8gICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IGNoZWNrX3VzZXJfYWN0aW9uKHJlcSxhY3Rpb24scmVzb3VyY2UpXG4vLyAgICAgICBpZighcmVzdWx0KXtcbi8vICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5zZW5kKHsgcGFyYW06IHJlc291cmNlICwgbXNnOiBgWW91IGFyZSBub3QgYXV0aG9yaXplZCB0byBlZGl0IHRoaXMgJHtyZXNvdXJjZX0uYCB9KVxuLy8gICAgICAgfVxuLy9cbi8vICAgICAgIG5leHQoKVxuLy8gICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4vLyAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLnNlbmQoXCJZb3UgZG9uJ3QgaGF2ZSBlbm91Z2ggcGVybWlzc2lvbiB0byBwZXJmb3JtIHRoaXMgYWN0aW9uXCIpXG4vLyAgICAgfVxuLy8gICB9XG4vLyB9XG4iXX0=","map":{"version":3,"sources":["validate-token.js"],"names":["validateToken","req","res","next","authorization","headers","cookies","jwt","Object","assign","user","accessToken","split","decoded","verify","process","env","JWT_SECRET","exp","Date","now","UserModel","findById","userId","cookie","secure","httpOnly","error","Promise","reject","Error"],"mappings":";;;;;;;AAAA;;AAGA;;;;AADA;AAGA,MAAMA,aAAa,GAAG,OAAOC,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB,KAA0B;AAC5C,MAAI;AACA,UAAMC,aAAa,GAAGH,GAAG,CAACI,OAAJ,CAAYD,aAAZ,IAA6BH,GAAG,CAACK,OAAJ,CAAYC,GAA/D;AAEAC,IAAAA,MAAM,CAACC,MAAP,CAAcR,GAAG,CAACI,OAAlB,EAA2B;AACvBK,MAAAA,IAAI,EAAE,IADiB;AAEvBN,MAAAA,aAAa,EAAE;AAFQ,KAA3B;;AAKA,QAAI,CAACA,aAAL,EAAoB;AAChB,aAAOD,IAAI,EAAX;AACH;;AAED,UAAMQ,WAAW,GAAGP,aAAa,CAACQ,KAAd,CAAoB,GAApB,EAAyB,CAAzB,CAApB;AAEA,QAAIC,OAAJ;;AACA,QAAIF,WAAJ,EAAiB;AACbE,MAAAA,OAAO,GAAGN,sBAAIO,MAAJ,CAAWH,WAAX,EAAwBI,OAAO,CAACC,GAAR,CAAYC,UAApC,CAAV;AACH;;AACD,QAAI,CAACJ,OAAL,EAAc;AACV;AACA;AACA;AACA,aAAOV,IAAI,EAAX;AACH;;AAED,QAAIU,OAAO,CAACK,GAAR,GAAc,IAAd,GAAqBC,IAAI,CAACC,GAAL,EAAzB,EAAqC;AACjC;AACA;AACA,aAAOjB,IAAI,EAAX;AACH,KA7BD,CA+BA;AACA;AACA;AACA;AACA;;;AAEA,UAAMO,IAAI,GAAG,MAAMW,gBAAUC,QAAV,CAAmBT,OAAO,CAACU,MAA3B,CAAnB;;AACA,QAAI,CAACb,IAAL,EAAW;AACP;AACA;AACA,aAAOP,IAAI,EAAX;AACH,KA1CD,CA4CA;AACA;;;AACAK,IAAAA,MAAM,CAACC,MAAP,CAAcR,GAAG,CAACI,OAAlB,EAA2B;AACvBK,MAAAA,IADuB;AAEvBN,MAAAA;AAFuB,KAA3B;AAKAF,IAAAA,GAAG,CAACsB,MAAJ,CAAW,KAAX,EAAkBpB,aAAlB,EAAiC;AAACqB,MAAAA,MAAM,EAAE,IAAT;AAAeC,MAAAA,QAAQ,EAAE;AAAzB,KAAjC;AAEA,WAAOvB,IAAI,EAAX;AACH,GAtDD,CAsDE,OAAOwB,KAAP,EAAc;AACZ,WAAOC,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAU,iBAAV,CAAf,CAAP;AACH;AACJ,CA1DD;;eA4De9B,a,EAGf;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourceRoot":"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/auth/","sourcesContent":["import jwt from \"jsonwebtoken\";\n\n// import redis from \"../config/redis-config\";\nimport {UserModel} from \"../../models/user\";\n\nconst validateToken = async (req, res, next) => {\n    try {\n        const authorization = req.headers.authorization || req.cookies.jwt\n\n        Object.assign(req.headers, {\n            user: null,\n            authorization: null,\n        });\n\n        if (!authorization) {\n            return next();\n        }\n\n        const accessToken = authorization.split(\" \")[1];\n\n        let decoded;\n        if (accessToken) {\n            decoded = jwt.verify(accessToken, process.env.JWT_SECRET);\n        }\n        if (!decoded) {\n            // invalid token, remove the token from everywhere\n            //remove from database\n            //remove from redis\n            return next();\n        }\n\n        if (decoded.exp * 1000 < Date.now()) {\n            //remove from database\n            //remove from redis\n            return next();\n        }\n\n        //check if token is in redis\n        //if NOT in redis call next()\n        //else check last update time if greater than or equals to 1hour update the token\n        // if less skip else update token\n        // authorization = new token\n\n        const user = await UserModel.findById(decoded.userId);\n        if (!user) {\n            //remove from database\n            //remove from redis\n            return next();\n        }\n\n        // if the token has come all this way everything is good just attach it to the request header\n        //attach it to https response cookie\n        Object.assign(req.headers, {\n            user,\n            authorization,\n        });\n\n        res.cookie(\"jwt\", authorization, {secure: true, httpOnly: true})\n\n        return next();\n    } catch (error) {\n        return Promise.reject(new Error(\"Error Happened!\"));\n    }\n};\n\nexport default validateToken;\n\n\n// ------------- authorization ------------------\n\n// let check_user_action = async (req,action,resource) =>{\n//   if(!['updateOwn','deleteOwn'].includes(action)){\n//     return true\n//   }\n//\n//   const userResource = new Set()\n//\n//   if(resource == 'tender'){\n//     let userTender = await Tender.find({ creator_user: req.user._id })\n//     userTender.forEach(tender => userResource.add(`${tender._id}`))\n//\n//   }else if(resource == 'company'){\n//     let userCompany = await Company.find({ creator_user: req.user._id })\n//     userCompany.forEach(company => userResource.add( `${company._id}`))\n//\n//   }else if(resource == 'award'){\n//     let userAward = await Award.find({ creator_user: req.user._id })\n//     userAward.forEach(award => userResource.add(`${award._id}`))\n//   }\n//\n//   if(!userResource.has(req.params.id)){\n//     return false\n//   }\n//\n//   return true\n// }\n//\n//\n//\n// exports.authorize = function (action, resource) {\n//   return async (req, res, next) => {\n//     try {\n//       const permission = roles.can(req.user.role)[action](resource);\n//\n//       if (!permission.granted) {\n//         return res.status(401).send(\"You don't have enough permission to perform this action\");\n//       }\n//\n//       let result = await check_user_action(req,action,resource)\n//       if(!result){\n//         return res.status(401).send({ param: resource , msg: `You are not authorized to edit this ${resource}.` })\n//       }\n//\n//       next()\n//     } catch (error) {\n//       return res.status(401).send(\"You don't have enough permission to perform this action\")\n//     }\n//   }\n// }\n"]}},"mtime":1648313712832},"{\"assumptions\":{},\"sourceRoot\":\"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/auth/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"filename\":\"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/auth/index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.AuthMutation = void 0;\n\nvar _user = require(\"../../models/user\");\n\nvar _middlewares = require(\"../../middlewares\");\n\nvar _authResolvers = _interopRequireDefault(require(\"./resolvers/auth-resolvers\"));\n\nrequire(\"./typedefs/types\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfor (const resolver in _authResolvers.default) {\n  _user.UserTC.addResolver(_authResolvers.default[resolver]);\n}\n\nconst AuthMutation = {\n  signIn: _user.UserTC.getResolver(\"signIn\", [_middlewares.authentication.isGuest, _middlewares.userValidator.signIn]) // signUp: UserTC.getResolver(\"signUp\", [authentication.isGuest, userValidator.signUp]),\n  // logout: UserTC.getResolver('logout', [middleware.isAuth]),\n  // resetPassword: UserTC.getResolver(\"resetPassword\", [middleware.isGuest, validators.resetPassword]),\n  // newPassword: UserTC.getResolver(\"newPassword\", [middleware.isGuest, validators.newPassword]),\n  // changePassword: UserTC.getResolver(\"changePassword\", [middleware.isAuth, validators.changePassword]),\n\n};\nexports.AuthMutation = AuthMutation;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbInJlc29sdmVyIiwiUmVzb2x2ZXJzIiwiVXNlclRDIiwiYWRkUmVzb2x2ZXIiLCJBdXRoTXV0YXRpb24iLCJzaWduSW4iLCJnZXRSZXNvbHZlciIsImF1dGhlbnRpY2F0aW9uIiwiaXNHdWVzdCIsInVzZXJWYWxpZGF0b3IiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFFQTs7QUFFQTs7QUFFQTs7OztBQUVBLEtBQUssTUFBTUEsUUFBWCxJQUF1QkMsc0JBQXZCLEVBQWtDO0FBQzlCQyxlQUFPQyxXQUFQLENBQW1CRix1QkFBVUQsUUFBVixDQUFuQjtBQUNIOztBQUVELE1BQU1JLFlBQVksR0FBRztBQUNqQkMsRUFBQUEsTUFBTSxFQUFFSCxhQUFPSSxXQUFQLENBQW1CLFFBQW5CLEVBQTZCLENBQUNDLDRCQUFlQyxPQUFoQixFQUF5QkMsMkJBQWNKLE1BQXZDLENBQTdCLENBRFMsQ0FFakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFOaUIsQ0FBckIiLCJzb3VyY2VSb290IjoiL2hvbWUvbmF0aG5hZWwvcHJvamVjdHMvaGFsZXRhL2hhbGV0YS1uZXctYXBpL3NyYy9ncmFwaHFsL2F1dGgvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtVc2VyVEN9IGZyb20gXCIuLi8uLi9tb2RlbHMvdXNlclwiO1xuXG5pbXBvcnQgeyBhdXRoZW50aWNhdGlvbiwgdXNlclZhbGlkYXRvciB9IGZyb20gXCIuLi8uLi9taWRkbGV3YXJlc1wiO1xuXG5pbXBvcnQgUmVzb2x2ZXJzIGZyb20gXCIuL3Jlc29sdmVycy9hdXRoLXJlc29sdmVyc1wiO1xuXG5pbXBvcnQgXCIuL3R5cGVkZWZzL3R5cGVzXCJcblxuZm9yIChjb25zdCByZXNvbHZlciBpbiBSZXNvbHZlcnMpIHtcbiAgICBVc2VyVEMuYWRkUmVzb2x2ZXIoUmVzb2x2ZXJzW3Jlc29sdmVyXSk7XG59XG5cbmNvbnN0IEF1dGhNdXRhdGlvbiA9IHtcbiAgICBzaWduSW46IFVzZXJUQy5nZXRSZXNvbHZlcihcInNpZ25JblwiLCBbYXV0aGVudGljYXRpb24uaXNHdWVzdCwgdXNlclZhbGlkYXRvci5zaWduSW5dKSxcbiAgICAvLyBzaWduVXA6IFVzZXJUQy5nZXRSZXNvbHZlcihcInNpZ25VcFwiLCBbYXV0aGVudGljYXRpb24uaXNHdWVzdCwgdXNlclZhbGlkYXRvci5zaWduVXBdKSxcbiAgICAvLyBsb2dvdXQ6IFVzZXJUQy5nZXRSZXNvbHZlcignbG9nb3V0JywgW21pZGRsZXdhcmUuaXNBdXRoXSksXG4gICAgLy8gcmVzZXRQYXNzd29yZDogVXNlclRDLmdldFJlc29sdmVyKFwicmVzZXRQYXNzd29yZFwiLCBbbWlkZGxld2FyZS5pc0d1ZXN0LCB2YWxpZGF0b3JzLnJlc2V0UGFzc3dvcmRdKSxcbiAgICAvLyBuZXdQYXNzd29yZDogVXNlclRDLmdldFJlc29sdmVyKFwibmV3UGFzc3dvcmRcIiwgW21pZGRsZXdhcmUuaXNHdWVzdCwgdmFsaWRhdG9ycy5uZXdQYXNzd29yZF0pLFxuICAgIC8vIGNoYW5nZVBhc3N3b3JkOiBVc2VyVEMuZ2V0UmVzb2x2ZXIoXCJjaGFuZ2VQYXNzd29yZFwiLCBbbWlkZGxld2FyZS5pc0F1dGgsIHZhbGlkYXRvcnMuY2hhbmdlUGFzc3dvcmRdKSxcbn07XG5cbmV4cG9ydCB7QXV0aE11dGF0aW9ufTtcbiJdfQ==","map":{"version":3,"sources":["index.js"],"names":["resolver","Resolvers","UserTC","addResolver","AuthMutation","signIn","getResolver","authentication","isGuest","userValidator"],"mappings":";;;;;;;AAAA;;AAEA;;AAEA;;AAEA;;;;AAEA,KAAK,MAAMA,QAAX,IAAuBC,sBAAvB,EAAkC;AAC9BC,eAAOC,WAAP,CAAmBF,uBAAUD,QAAV,CAAnB;AACH;;AAED,MAAMI,YAAY,GAAG;AACjBC,EAAAA,MAAM,EAAEH,aAAOI,WAAP,CAAmB,QAAnB,EAA6B,CAACC,4BAAeC,OAAhB,EAAyBC,2BAAcJ,MAAvC,CAA7B,CADS,CAEjB;AACA;AACA;AACA;AACA;;AANiB,CAArB","sourceRoot":"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/auth/","sourcesContent":["import {UserTC} from \"../../models/user\";\n\nimport { authentication, userValidator } from \"../../middlewares\";\n\nimport Resolvers from \"./resolvers/auth-resolvers\";\n\nimport \"./typedefs/types\"\n\nfor (const resolver in Resolvers) {\n    UserTC.addResolver(Resolvers[resolver]);\n}\n\nconst AuthMutation = {\n    signIn: UserTC.getResolver(\"signIn\", [authentication.isGuest, userValidator.signIn]),\n    // signUp: UserTC.getResolver(\"signUp\", [authentication.isGuest, userValidator.signUp]),\n    // logout: UserTC.getResolver('logout', [middleware.isAuth]),\n    // resetPassword: UserTC.getResolver(\"resetPassword\", [middleware.isGuest, validators.resetPassword]),\n    // newPassword: UserTC.getResolver(\"newPassword\", [middleware.isGuest, validators.newPassword]),\n    // changePassword: UserTC.getResolver(\"changePassword\", [middleware.isAuth, validators.changePassword]),\n};\n\nexport {AuthMutation};\n"]}},"mtime":1648317794488},"{\"assumptions\":{},\"sourceRoot\":\"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/auth/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"filename\":\"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/auth/phone-verification.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\n// import admin from \"../../config/firebase-config\";\nconst phoneVerification = async (resolve, source, args, context, info) => {\n  // const {phoneVerification} = context;\n  // let phoneNumber = \"\";\n  //\n  // await admin\n  //     .auth()\n  //     .verifyIdToken(phoneVerification)\n  //     .then((decodedToken) => {\n  //         phoneNumber = decodedToken.phone_number;\n  //     })\n  //     .catch(() => Promise.reject(new Error(\"Error happened!\")));\n  // if (phoneNumber === \"\") {\n  //     return Promise.reject(new Error(\"Phone number not detected!\"));\n  // }\n  // context.phoneNumber = phoneNumber;\n  return resolve(source, args, context, info);\n};\n\nvar _default = phoneVerification;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBob25lLXZlcmlmaWNhdGlvbi5qcyJdLCJuYW1lcyI6WyJwaG9uZVZlcmlmaWNhdGlvbiIsInJlc29sdmUiLCJzb3VyY2UiLCJhcmdzIiwiY29udGV4dCIsImluZm8iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTtBQUVBLE1BQU1BLGlCQUFpQixHQUFHLE9BQU9DLE9BQVAsRUFBZ0JDLE1BQWhCLEVBQXdCQyxJQUF4QixFQUE4QkMsT0FBOUIsRUFBdUNDLElBQXZDLEtBQWdEO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFPSixPQUFPLENBQUNDLE1BQUQsRUFBU0MsSUFBVCxFQUFlQyxPQUFmLEVBQXdCQyxJQUF4QixDQUFkO0FBQ0gsQ0FoQkQ7O2VBa0JlTCxpQiIsInNvdXJjZVJvb3QiOiIvaG9tZS9uYXRobmFlbC9wcm9qZWN0cy9oYWxldGEvaGFsZXRhLW5ldy1hcGkvc3JjL21pZGRsZXdhcmVzL2F1dGgvIiwic291cmNlc0NvbnRlbnQiOlsiLy8gaW1wb3J0IGFkbWluIGZyb20gXCIuLi8uLi9jb25maWcvZmlyZWJhc2UtY29uZmlnXCI7XG5cbmNvbnN0IHBob25lVmVyaWZpY2F0aW9uID0gYXN5bmMgKHJlc29sdmUsIHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbykgPT4ge1xuICAgIC8vIGNvbnN0IHtwaG9uZVZlcmlmaWNhdGlvbn0gPSBjb250ZXh0O1xuICAgIC8vIGxldCBwaG9uZU51bWJlciA9IFwiXCI7XG4gICAgLy9cbiAgICAvLyBhd2FpdCBhZG1pblxuICAgIC8vICAgICAuYXV0aCgpXG4gICAgLy8gICAgIC52ZXJpZnlJZFRva2VuKHBob25lVmVyaWZpY2F0aW9uKVxuICAgIC8vICAgICAudGhlbigoZGVjb2RlZFRva2VuKSA9PiB7XG4gICAgLy8gICAgICAgICBwaG9uZU51bWJlciA9IGRlY29kZWRUb2tlbi5waG9uZV9udW1iZXI7XG4gICAgLy8gICAgIH0pXG4gICAgLy8gICAgIC5jYXRjaCgoKSA9PiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoXCJFcnJvciBoYXBwZW5lZCFcIikpKTtcbiAgICAvLyBpZiAocGhvbmVOdW1iZXIgPT09IFwiXCIpIHtcbiAgICAvLyAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcIlBob25lIG51bWJlciBub3QgZGV0ZWN0ZWQhXCIpKTtcbiAgICAvLyB9XG4gICAgLy8gY29udGV4dC5waG9uZU51bWJlciA9IHBob25lTnVtYmVyO1xuICAgIHJldHVybiByZXNvbHZlKHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbyk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHBob25lVmVyaWZpY2F0aW9uO1xuIl19","map":{"version":3,"sources":["phone-verification.js"],"names":["phoneVerification","resolve","source","args","context","info"],"mappings":";;;;;;;AAAA;AAEA,MAAMA,iBAAiB,GAAG,OAAOC,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAOJ,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,CAhBD;;eAkBeL,iB","sourceRoot":"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/auth/","sourcesContent":["// import admin from \"../../config/firebase-config\";\n\nconst phoneVerification = async (resolve, source, args, context, info) => {\n    // const {phoneVerification} = context;\n    // let phoneNumber = \"\";\n    //\n    // await admin\n    //     .auth()\n    //     .verifyIdToken(phoneVerification)\n    //     .then((decodedToken) => {\n    //         phoneNumber = decodedToken.phone_number;\n    //     })\n    //     .catch(() => Promise.reject(new Error(\"Error happened!\")));\n    // if (phoneNumber === \"\") {\n    //     return Promise.reject(new Error(\"Phone number not detected!\"));\n    // }\n    // context.phoneNumber = phoneNumber;\n    return resolve(source, args, context, info);\n}\n\nexport default phoneVerification;\n"]}},"mtime":1648313712832},"{\"assumptions\":{},\"sourceRoot\":\"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/validators/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"filename\":\"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/validators/user-validator.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n// import validator from \"validators\";\nconst userValidator = {\n  changePassword: async (resolve, source, args, context, info) => {\n    const {\n      newPassword\n    } = args; // if (!validator.isLength(newPassword, {min: 6})) {\n    //     return Promise.reject(new Error(\"Error: newPassword\"));\n    // }\n\n    return resolve(source, args, context, info);\n  },\n  newPassword: async (resolve, source, args, context, info) => {\n    const {\n      newPassword\n    } = args; // if (!validator.isLength(newPassword, {min: 6})) {\n    //     return Promise.reject(new Error(\"Error: newPassword\"));\n    // }\n\n    return resolve(source, args, context, info);\n  },\n  resetPassword: async (resolve, source, args, context, info) => {\n    let {\n      email\n    } = args; // email = validator.normalizeEmail(email);\n    // email = validator.trim(email);\n    //\n    // Object.assign(args, {email});\n\n    return resolve(source, args, context, info);\n  },\n  signIn: async (resolve, source, args, context, info) => {\n    let {\n      email\n    } = args; // email = email.toString().toLowerCase();\n    // email = validator.trim(email);\n    //\n    // Object.assign(args, {email});\n\n    return resolve(source, args, context, info);\n  },\n  signUp: async (resolve, source, args, context, info) => {\n    let {\n      email\n    } = args; // email = email.toString().toLowerCase();\n    // email = validator.trim(email);\n    //\n    // Object.assign(args, {email});\n\n    const {\n      password\n    } = args; // if (!validator.isEmail(email, {allow_utf8_local_part: false})) {\n    //     return Promise.reject(new Error(\"Error: email\"));\n    // }\n    //\n    // if (!validator.isLength(password, {min: 6})) {\n    //     return Promise.reject(new Error(\"Error: password\"));\n    // }\n\n    return resolve(source, args, context, info);\n  },\n  updateUser: async (resolve, source, args, context, info) => {\n    let {\n      email\n    } = args; // email = validator.normalizeEmail(email);\n    // email = validator.trim(email);\n    //\n    // Object.assign(args, {email});\n\n    const {\n      firstName,\n      lastName\n    } = args; // if (!validator.isEmail(email, {allow_utf8_local_part: false})) {\n    //     return Promise.reject(new Error(\"Error: email\"));\n    // }\n    // if (!validator.isLength(firstName, {min: 2})) {\n    //     return Promise.reject(new Error(\"Error: firstName\"));\n    // }\n    // if (!validator.isLength(lastName, {min: 2})) {\n    //     return Promise.reject(new Error(\"Error: lastName\"));\n    // }\n\n    return resolve(source, args, context, info);\n  }\n};\nvar _default = userValidator;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXItdmFsaWRhdG9yLmpzIl0sIm5hbWVzIjpbInVzZXJWYWxpZGF0b3IiLCJjaGFuZ2VQYXNzd29yZCIsInJlc29sdmUiLCJzb3VyY2UiLCJhcmdzIiwiY29udGV4dCIsImluZm8iLCJuZXdQYXNzd29yZCIsInJlc2V0UGFzc3dvcmQiLCJlbWFpbCIsInNpZ25JbiIsInNpZ25VcCIsInBhc3N3b3JkIiwidXBkYXRlVXNlciIsImZpcnN0TmFtZSIsImxhc3ROYW1lIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUVBLE1BQU1BLGFBQWEsR0FBRztBQUNsQkMsRUFBQUEsY0FBYyxFQUFFLE9BQU9DLE9BQVAsRUFBZ0JDLE1BQWhCLEVBQXdCQyxJQUF4QixFQUE4QkMsT0FBOUIsRUFBdUNDLElBQXZDLEtBQWdEO0FBQzVELFVBQU07QUFBQ0MsTUFBQUE7QUFBRCxRQUFnQkgsSUFBdEIsQ0FENEQsQ0FHNUQ7QUFDQTtBQUNBOztBQUVBLFdBQU9GLE9BQU8sQ0FBQ0MsTUFBRCxFQUFTQyxJQUFULEVBQWVDLE9BQWYsRUFBd0JDLElBQXhCLENBQWQ7QUFDSCxHQVRpQjtBQVVsQkMsRUFBQUEsV0FBVyxFQUFFLE9BQU9MLE9BQVAsRUFBZ0JDLE1BQWhCLEVBQXdCQyxJQUF4QixFQUE4QkMsT0FBOUIsRUFBdUNDLElBQXZDLEtBQWdEO0FBQ3pELFVBQU07QUFBQ0MsTUFBQUE7QUFBRCxRQUFnQkgsSUFBdEIsQ0FEeUQsQ0FHekQ7QUFDQTtBQUNBOztBQUVBLFdBQU9GLE9BQU8sQ0FBQ0MsTUFBRCxFQUFTQyxJQUFULEVBQWVDLE9BQWYsRUFBd0JDLElBQXhCLENBQWQ7QUFDSCxHQWxCaUI7QUFtQmxCRSxFQUFBQSxhQUFhLEVBQUUsT0FBT04sT0FBUCxFQUFnQkMsTUFBaEIsRUFBd0JDLElBQXhCLEVBQThCQyxPQUE5QixFQUF1Q0MsSUFBdkMsS0FBZ0Q7QUFDM0QsUUFBSTtBQUFDRyxNQUFBQTtBQUFELFFBQVVMLElBQWQsQ0FEMkQsQ0FHM0Q7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsV0FBT0YsT0FBTyxDQUFDQyxNQUFELEVBQVNDLElBQVQsRUFBZUMsT0FBZixFQUF3QkMsSUFBeEIsQ0FBZDtBQUNILEdBNUJpQjtBQTZCbEJJLEVBQUFBLE1BQU0sRUFBRSxPQUFPUixPQUFQLEVBQWdCQyxNQUFoQixFQUF3QkMsSUFBeEIsRUFBOEJDLE9BQTlCLEVBQXVDQyxJQUF2QyxLQUFnRDtBQUNwRCxRQUFJO0FBQUNHLE1BQUFBO0FBQUQsUUFBVUwsSUFBZCxDQURvRCxDQUdwRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxXQUFPRixPQUFPLENBQUNDLE1BQUQsRUFBU0MsSUFBVCxFQUFlQyxPQUFmLEVBQXdCQyxJQUF4QixDQUFkO0FBQ0gsR0F0Q2lCO0FBdUNsQkssRUFBQUEsTUFBTSxFQUFFLE9BQU9ULE9BQVAsRUFBZ0JDLE1BQWhCLEVBQXdCQyxJQUF4QixFQUE4QkMsT0FBOUIsRUFBdUNDLElBQXZDLEtBQWdEO0FBQ3BELFFBQUk7QUFBQ0csTUFBQUE7QUFBRCxRQUFVTCxJQUFkLENBRG9ELENBR3BEO0FBQ0E7QUFDQTtBQUNBOztBQUVBLFVBQU07QUFBQ1EsTUFBQUE7QUFBRCxRQUFhUixJQUFuQixDQVJvRCxDQVVwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxXQUFPRixPQUFPLENBQUNDLE1BQUQsRUFBU0MsSUFBVCxFQUFlQyxPQUFmLEVBQXdCQyxJQUF4QixDQUFkO0FBQ0gsR0ExRGlCO0FBMkRsQk8sRUFBQUEsVUFBVSxFQUFFLE9BQU9YLE9BQVAsRUFBZ0JDLE1BQWhCLEVBQXdCQyxJQUF4QixFQUE4QkMsT0FBOUIsRUFBdUNDLElBQXZDLEtBQWdEO0FBQ3hELFFBQUk7QUFBQ0csTUFBQUE7QUFBRCxRQUFVTCxJQUFkLENBRHdELENBR3hEO0FBQ0E7QUFDQTtBQUNBOztBQUVBLFVBQU07QUFDRlUsTUFBQUEsU0FERTtBQUVGQyxNQUFBQTtBQUZFLFFBR0ZYLElBSEosQ0FSd0QsQ0FheEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBLFdBQU9GLE9BQU8sQ0FBQ0MsTUFBRCxFQUFTQyxJQUFULEVBQWVDLE9BQWYsRUFBd0JDLElBQXhCLENBQWQ7QUFDSDtBQWxGaUIsQ0FBdEI7ZUFxRmVOLGEiLCJzb3VyY2VSb290IjoiL2hvbWUvbmF0aG5hZWwvcHJvamVjdHMvaGFsZXRhL2hhbGV0YS1uZXctYXBpL3NyYy9taWRkbGV3YXJlcy92YWxpZGF0b3JzLyIsInNvdXJjZXNDb250ZW50IjpbIi8vIGltcG9ydCB2YWxpZGF0b3IgZnJvbSBcInZhbGlkYXRvcnNcIjtcblxuY29uc3QgdXNlclZhbGlkYXRvciA9IHtcbiAgICBjaGFuZ2VQYXNzd29yZDogYXN5bmMgKHJlc29sdmUsIHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbykgPT4ge1xuICAgICAgICBjb25zdCB7bmV3UGFzc3dvcmR9ID0gYXJncztcblxuICAgICAgICAvLyBpZiAoIXZhbGlkYXRvci5pc0xlbmd0aChuZXdQYXNzd29yZCwge21pbjogNn0pKSB7XG4gICAgICAgIC8vICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKFwiRXJyb3I6IG5ld1Bhc3N3b3JkXCIpKTtcbiAgICAgICAgLy8gfVxuXG4gICAgICAgIHJldHVybiByZXNvbHZlKHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbyk7XG4gICAgfSxcbiAgICBuZXdQYXNzd29yZDogYXN5bmMgKHJlc29sdmUsIHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbykgPT4ge1xuICAgICAgICBjb25zdCB7bmV3UGFzc3dvcmR9ID0gYXJncztcblxuICAgICAgICAvLyBpZiAoIXZhbGlkYXRvci5pc0xlbmd0aChuZXdQYXNzd29yZCwge21pbjogNn0pKSB7XG4gICAgICAgIC8vICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKFwiRXJyb3I6IG5ld1Bhc3N3b3JkXCIpKTtcbiAgICAgICAgLy8gfVxuXG4gICAgICAgIHJldHVybiByZXNvbHZlKHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbyk7XG4gICAgfSxcbiAgICByZXNldFBhc3N3b3JkOiBhc3luYyAocmVzb2x2ZSwgc291cmNlLCBhcmdzLCBjb250ZXh0LCBpbmZvKSA9PiB7XG4gICAgICAgIGxldCB7ZW1haWx9ID0gYXJncztcblxuICAgICAgICAvLyBlbWFpbCA9IHZhbGlkYXRvci5ub3JtYWxpemVFbWFpbChlbWFpbCk7XG4gICAgICAgIC8vIGVtYWlsID0gdmFsaWRhdG9yLnRyaW0oZW1haWwpO1xuICAgICAgICAvL1xuICAgICAgICAvLyBPYmplY3QuYXNzaWduKGFyZ3MsIHtlbWFpbH0pO1xuXG4gICAgICAgIHJldHVybiByZXNvbHZlKHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbyk7XG4gICAgfSxcbiAgICBzaWduSW46IGFzeW5jIChyZXNvbHZlLCBzb3VyY2UsIGFyZ3MsIGNvbnRleHQsIGluZm8pID0+IHtcbiAgICAgICAgbGV0IHtlbWFpbH0gPSBhcmdzO1xuXG4gICAgICAgIC8vIGVtYWlsID0gZW1haWwudG9TdHJpbmcoKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAvLyBlbWFpbCA9IHZhbGlkYXRvci50cmltKGVtYWlsKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy8gT2JqZWN0LmFzc2lnbihhcmdzLCB7ZW1haWx9KTtcblxuICAgICAgICByZXR1cm4gcmVzb2x2ZShzb3VyY2UsIGFyZ3MsIGNvbnRleHQsIGluZm8pO1xuICAgIH0sXG4gICAgc2lnblVwOiBhc3luYyAocmVzb2x2ZSwgc291cmNlLCBhcmdzLCBjb250ZXh0LCBpbmZvKSA9PiB7XG4gICAgICAgIGxldCB7ZW1haWx9ID0gYXJncztcblxuICAgICAgICAvLyBlbWFpbCA9IGVtYWlsLnRvU3RyaW5nKCkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgLy8gZW1haWwgPSB2YWxpZGF0b3IudHJpbShlbWFpbCk7XG4gICAgICAgIC8vXG4gICAgICAgIC8vIE9iamVjdC5hc3NpZ24oYXJncywge2VtYWlsfSk7XG5cbiAgICAgICAgY29uc3Qge3Bhc3N3b3JkfSA9IGFyZ3M7XG5cbiAgICAgICAgLy8gaWYgKCF2YWxpZGF0b3IuaXNFbWFpbChlbWFpbCwge2FsbG93X3V0ZjhfbG9jYWxfcGFydDogZmFsc2V9KSkge1xuICAgICAgICAvLyAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcIkVycm9yOiBlbWFpbFwiKSk7XG4gICAgICAgIC8vIH1cbiAgICAgICAgLy9cbiAgICAgICAgLy8gaWYgKCF2YWxpZGF0b3IuaXNMZW5ndGgocGFzc3dvcmQsIHttaW46IDZ9KSkge1xuICAgICAgICAvLyAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcIkVycm9yOiBwYXNzd29yZFwiKSk7XG4gICAgICAgIC8vIH1cblxuICAgICAgICByZXR1cm4gcmVzb2x2ZShzb3VyY2UsIGFyZ3MsIGNvbnRleHQsIGluZm8pO1xuICAgIH0sXG4gICAgdXBkYXRlVXNlcjogYXN5bmMgKHJlc29sdmUsIHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbykgPT4ge1xuICAgICAgICBsZXQge2VtYWlsfSA9IGFyZ3M7XG5cbiAgICAgICAgLy8gZW1haWwgPSB2YWxpZGF0b3Iubm9ybWFsaXplRW1haWwoZW1haWwpO1xuICAgICAgICAvLyBlbWFpbCA9IHZhbGlkYXRvci50cmltKGVtYWlsKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy8gT2JqZWN0LmFzc2lnbihhcmdzLCB7ZW1haWx9KTtcblxuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICBmaXJzdE5hbWUsXG4gICAgICAgICAgICBsYXN0TmFtZSxcbiAgICAgICAgfSA9IGFyZ3M7XG5cbiAgICAgICAgLy8gaWYgKCF2YWxpZGF0b3IuaXNFbWFpbChlbWFpbCwge2FsbG93X3V0ZjhfbG9jYWxfcGFydDogZmFsc2V9KSkge1xuICAgICAgICAvLyAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcIkVycm9yOiBlbWFpbFwiKSk7XG4gICAgICAgIC8vIH1cbiAgICAgICAgLy8gaWYgKCF2YWxpZGF0b3IuaXNMZW5ndGgoZmlyc3ROYW1lLCB7bWluOiAyfSkpIHtcbiAgICAgICAgLy8gICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoXCJFcnJvcjogZmlyc3ROYW1lXCIpKTtcbiAgICAgICAgLy8gfVxuICAgICAgICAvLyBpZiAoIXZhbGlkYXRvci5pc0xlbmd0aChsYXN0TmFtZSwge21pbjogMn0pKSB7XG4gICAgICAgIC8vICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKFwiRXJyb3I6IGxhc3ROYW1lXCIpKTtcbiAgICAgICAgLy8gfVxuICAgICAgICByZXR1cm4gcmVzb2x2ZShzb3VyY2UsIGFyZ3MsIGNvbnRleHQsIGluZm8pO1xuICAgIH0sXG59O1xuXG5leHBvcnQgZGVmYXVsdCB1c2VyVmFsaWRhdG9yO1xuIl19","map":{"version":3,"sources":["user-validator.js"],"names":["userValidator","changePassword","resolve","source","args","context","info","newPassword","resetPassword","email","signIn","signUp","password","updateUser","firstName","lastName"],"mappings":";;;;;;AAAA;AAEA,MAAMA,aAAa,GAAG;AAClBC,EAAAA,cAAc,EAAE,OAAOC,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AAC5D,UAAM;AAACC,MAAAA;AAAD,QAAgBH,IAAtB,CAD4D,CAG5D;AACA;AACA;;AAEA,WAAOF,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,GATiB;AAUlBC,EAAAA,WAAW,EAAE,OAAOL,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AACzD,UAAM;AAACC,MAAAA;AAAD,QAAgBH,IAAtB,CADyD,CAGzD;AACA;AACA;;AAEA,WAAOF,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,GAlBiB;AAmBlBE,EAAAA,aAAa,EAAE,OAAON,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AAC3D,QAAI;AAACG,MAAAA;AAAD,QAAUL,IAAd,CAD2D,CAG3D;AACA;AACA;AACA;;AAEA,WAAOF,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,GA5BiB;AA6BlBI,EAAAA,MAAM,EAAE,OAAOR,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AACpD,QAAI;AAACG,MAAAA;AAAD,QAAUL,IAAd,CADoD,CAGpD;AACA;AACA;AACA;;AAEA,WAAOF,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,GAtCiB;AAuClBK,EAAAA,MAAM,EAAE,OAAOT,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AACpD,QAAI;AAACG,MAAAA;AAAD,QAAUL,IAAd,CADoD,CAGpD;AACA;AACA;AACA;;AAEA,UAAM;AAACQ,MAAAA;AAAD,QAAaR,IAAnB,CARoD,CAUpD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,WAAOF,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,GA1DiB;AA2DlBO,EAAAA,UAAU,EAAE,OAAOX,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AACxD,QAAI;AAACG,MAAAA;AAAD,QAAUL,IAAd,CADwD,CAGxD;AACA;AACA;AACA;;AAEA,UAAM;AACFU,MAAAA,SADE;AAEFC,MAAAA;AAFE,QAGFX,IAHJ,CARwD,CAaxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,WAAOF,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH;AAlFiB,CAAtB;eAqFeN,a","sourceRoot":"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/validators/","sourcesContent":["// import validator from \"validators\";\n\nconst userValidator = {\n    changePassword: async (resolve, source, args, context, info) => {\n        const {newPassword} = args;\n\n        // if (!validator.isLength(newPassword, {min: 6})) {\n        //     return Promise.reject(new Error(\"Error: newPassword\"));\n        // }\n\n        return resolve(source, args, context, info);\n    },\n    newPassword: async (resolve, source, args, context, info) => {\n        const {newPassword} = args;\n\n        // if (!validator.isLength(newPassword, {min: 6})) {\n        //     return Promise.reject(new Error(\"Error: newPassword\"));\n        // }\n\n        return resolve(source, args, context, info);\n    },\n    resetPassword: async (resolve, source, args, context, info) => {\n        let {email} = args;\n\n        // email = validator.normalizeEmail(email);\n        // email = validator.trim(email);\n        //\n        // Object.assign(args, {email});\n\n        return resolve(source, args, context, info);\n    },\n    signIn: async (resolve, source, args, context, info) => {\n        let {email} = args;\n\n        // email = email.toString().toLowerCase();\n        // email = validator.trim(email);\n        //\n        // Object.assign(args, {email});\n\n        return resolve(source, args, context, info);\n    },\n    signUp: async (resolve, source, args, context, info) => {\n        let {email} = args;\n\n        // email = email.toString().toLowerCase();\n        // email = validator.trim(email);\n        //\n        // Object.assign(args, {email});\n\n        const {password} = args;\n\n        // if (!validator.isEmail(email, {allow_utf8_local_part: false})) {\n        //     return Promise.reject(new Error(\"Error: email\"));\n        // }\n        //\n        // if (!validator.isLength(password, {min: 6})) {\n        //     return Promise.reject(new Error(\"Error: password\"));\n        // }\n\n        return resolve(source, args, context, info);\n    },\n    updateUser: async (resolve, source, args, context, info) => {\n        let {email} = args;\n\n        // email = validator.normalizeEmail(email);\n        // email = validator.trim(email);\n        //\n        // Object.assign(args, {email});\n\n        const {\n            firstName,\n            lastName,\n        } = args;\n\n        // if (!validator.isEmail(email, {allow_utf8_local_part: false})) {\n        //     return Promise.reject(new Error(\"Error: email\"));\n        // }\n        // if (!validator.isLength(firstName, {min: 2})) {\n        //     return Promise.reject(new Error(\"Error: firstName\"));\n        // }\n        // if (!validator.isLength(lastName, {min: 2})) {\n        //     return Promise.reject(new Error(\"Error: lastName\"));\n        // }\n        return resolve(source, args, context, info);\n    },\n};\n\nexport default userValidator;\n"]}},"mtime":1648317478224},"{\"assumptions\":{},\"sourceRoot\":\"/home/nathnael/projects/haleta/haleta-new-api/src/models/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"filename\":\"/home/nathnael/projects/haleta/haleta-new-api/src/models/user.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.UserTC = exports.UserSchema = exports.UserModel = void 0;\n\nvar _mongoose = _interopRequireWildcard(require(\"mongoose\"));\n\nvar _mongooseTimestamp = _interopRequireDefault(require(\"mongoose-timestamp\"));\n\nvar _graphqlComposeMongoose = require(\"graphql-compose-mongoose\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\n\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nconst UserSchema = new _mongoose.Schema({\n  firstName: String,\n  middleName: String,\n  lastName: String,\n  email: String,\n  phoneNumber: String,\n  image: String,\n  firebaseId: String,\n  password: String,\n  status: {\n    type: String,\n    default: \"ACTIVE\",\n    enum: [\"ACTIVE\", \"BLOCKED\"]\n  },\n  roles: {\n    type: String,\n    default: \"NORMAL\",\n    enum: [\"NORMAL\", \"OWNER\", \"ADMIN\", \"SALES\"]\n  },\n  account: {\n    verification: {\n      verified: {\n        type: Boolean,\n        default: false\n      },\n      token: String,\n      expiresIn: Date\n    },\n    emailVerification: {\n      verified: {\n        type: Boolean,\n        default: false\n      },\n      token: String,\n      expiresIn: Date\n    },\n    phoneVerification: {\n      verified: {\n        type: Boolean,\n        default: false\n      },\n      token: String,\n      expiresIn: Date\n    },\n    resetPassword: {\n      token: String,\n      expiresIn: Date\n    }\n  }\n}, {\n  collection: \"users\"\n});\nexports.UserSchema = UserSchema;\nUserSchema.plugin(_mongooseTimestamp.default);\nUserSchema.index({\n  createdAt: 1,\n  updatedAt: 1\n});\n\nUserSchema.statics.emailExist = function (email) {\n  return this.findOne({\n    email\n  });\n};\n\nUserSchema.statics.phoneNumberExist = function (phoneNumber) {\n  return this.findOne({\n    phoneNumber\n  });\n};\n\nUserSchema.methods.comparePassword = function (password) {\n  return bcrypt.compareSync(password, this.password);\n};\n\nconst UserModel = _mongoose.default.model(\"User\", UserSchema);\n\nexports.UserModel = UserModel;\nconst UserTC = (0, _graphqlComposeMongoose.composeWithMongoose)(UserModel); // const UserTC = composeWithMongoose(UserModel).removeField('password');\n\nexports.UserTC = UserTC;\nconst UserAccountTC = UserTC.getFieldTC(\"account\");\nUserAccountTC.getFieldTC(\"verification\").removeField([\"token\", \"expiresIn\"]); // UserAccountTC.removeField('resetPassword');\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXIuanMiXSwibmFtZXMiOlsiVXNlclNjaGVtYSIsIlNjaGVtYSIsImZpcnN0TmFtZSIsIlN0cmluZyIsIm1pZGRsZU5hbWUiLCJsYXN0TmFtZSIsImVtYWlsIiwicGhvbmVOdW1iZXIiLCJpbWFnZSIsImZpcmViYXNlSWQiLCJwYXNzd29yZCIsInN0YXR1cyIsInR5cGUiLCJkZWZhdWx0IiwiZW51bSIsInJvbGVzIiwiYWNjb3VudCIsInZlcmlmaWNhdGlvbiIsInZlcmlmaWVkIiwiQm9vbGVhbiIsInRva2VuIiwiZXhwaXJlc0luIiwiRGF0ZSIsImVtYWlsVmVyaWZpY2F0aW9uIiwicGhvbmVWZXJpZmljYXRpb24iLCJyZXNldFBhc3N3b3JkIiwiY29sbGVjdGlvbiIsInBsdWdpbiIsInRpbWVzdGFtcHMiLCJpbmRleCIsImNyZWF0ZWRBdCIsInVwZGF0ZWRBdCIsInN0YXRpY3MiLCJlbWFpbEV4aXN0IiwiZmluZE9uZSIsInBob25lTnVtYmVyRXhpc3QiLCJtZXRob2RzIiwiY29tcGFyZVBhc3N3b3JkIiwiYmNyeXB0IiwiY29tcGFyZVN5bmMiLCJVc2VyTW9kZWwiLCJtb25nb29zZSIsIm1vZGVsIiwiVXNlclRDIiwiVXNlckFjY291bnRUQyIsImdldEZpZWxkVEMiLCJyZW1vdmVGaWVsZCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOztBQUNBOzs7Ozs7OztBQUVBLE1BQU1BLFVBQVUsR0FBRyxJQUFJQyxnQkFBSixDQUFXO0FBQzFCQyxFQUFBQSxTQUFTLEVBQUVDLE1BRGU7QUFFMUJDLEVBQUFBLFVBQVUsRUFBRUQsTUFGYztBQUcxQkUsRUFBQUEsUUFBUSxFQUFFRixNQUhnQjtBQUkxQkcsRUFBQUEsS0FBSyxFQUFFSCxNQUptQjtBQUsxQkksRUFBQUEsV0FBVyxFQUFFSixNQUxhO0FBTTFCSyxFQUFBQSxLQUFLLEVBQUVMLE1BTm1CO0FBTzFCTSxFQUFBQSxVQUFVLEVBQUVOLE1BUGM7QUFRMUJPLEVBQUFBLFFBQVEsRUFBRVAs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bGV0YS1uZXctYXBpL3NyYy9tb2RlbHMvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlLCB7U2NoZW1hfSBmcm9tIFwibW9uZ29vc2VcIjtcbmltcG9ydCB0aW1lc3RhbXBzIGZyb20gXCJtb25nb29zZS10aW1lc3RhbXBcIjtcbmltcG9ydCB7Y29tcG9zZVdpdGhNb25nb29zZX0gZnJvbSBcImdyYXBocWwtY29tcG9zZS1tb25nb29zZVwiO1xuXG5jb25zdCBVc2VyU2NoZW1hID0gbmV3IFNjaGVtYSh7XG4gICAgZmlyc3ROYW1lOiBTdHJpbmcsXG4gICAgbWlkZGxlTmFtZTogU3RyaW5nLFxuICAgIGxhc3ROYW1lOiBTdHJpbmcsXG4gICAgZW1haWw6IFN0cmluZyxcbiAgICBwaG9uZU51bWJlcjogU3RyaW5nLFxuICAgIGltYWdlOiBTdHJpbmcsXG4gICAgZmlyZWJhc2VJZDogU3RyaW5nLFxuICAgIHBhc3N3b3JkOiBTdHJpbmcsXG4gICAgc3RhdHVzOiB7XG4gICAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgICAgZGVmYXVsdDogXCJBQ1RJVkVcIixcbiAgICAgICAgZW51bTogW1wiQUNUSVZFXCIsIFwiQkxPQ0tFRFwiXSxcbiAgICB9LFxuICAgIHJvbGVzOiB7XG4gICAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgICAgZGVmYXVsdDogXCJOT1JNQUxcIixcbiAgICAgICAgZW51bTogW1wiTk9STUFMXCIsIFwiT1dORVJcIiwgXCJBRE1JTlwiLCBcIlNBTEVTXCJdLFxuICAgIH0sXG4gICAgYWNjb3VudDoge1xuICAgICAgICB2ZXJpZmljYXRpb246IHtcbiAgICAgICAgICAgIHZlcmlmaWVkOiB7XG4gICAgICAgICAgICAgICAgdHlwZTogQm9vbGVhbixcbiAgICAgICAgICAgICAgICBkZWZhdWx0OiBmYWxzZSxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB0b2tlbjogU3RyaW5nLFxuICAgICAgICAgICAgZXhwaXJlc0luOiBEYXRlLFxuICAgICAgICB9LFxuICAgICAgICBlbWFpbFZlcmlmaWNhdGlvbjoge1xuICAgICAgICAgICAgdmVyaWZpZWQ6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiBCb29sZWFuLFxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6IGZhbHNlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHRva2VuOiBTdHJpbmcsXG4gICAgICAgICAgICBleHBpcmVzSW46IERhdGUsXG4gICAgICAgIH0sXG4gICAgICAgIHBob25lVmVyaWZpY2F0aW9uOiB7XG4gICAgICAgICAgICB2ZXJpZmllZDoge1xuICAgICAgICAgICAgICAgIHR5cGU6IEJvb2xlYW4sXG4gICAgICAgICAgICAgICAgZGVmYXVsdDogZmFsc2UsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgdG9rZW46IFN0cmluZyxcbiAgICAgICAgICAgIGV4cGlyZXNJbjogRGF0ZSxcbiAgICAgICAgfSxcbiAgICAgICAgcmVzZXRQYXNzd29yZDoge1xuICAgICAgICAgICAgdG9rZW46IFN0cmluZyxcbiAgICAgICAgICAgIGV4cGlyZXNJbjogRGF0ZSxcbiAgICAgICAgfSxcbiAgICB9LFxufSwge1xuICAgIGNvbGxlY3Rpb246IFwidXNlcnNcIixcbn0pO1xuXG5Vc2VyU2NoZW1hLnBsdWdpbih0aW1lc3RhbXBzKTtcblVzZXJTY2hlbWEuaW5kZXgoe1xuICAgIGNyZWF0ZWRBdDogMSxcbiAgICB1cGRhdGVkQXQ6IDEsXG59KTtcblxuVXNlclNjaGVtYS5zdGF0aWNzLmVtYWlsRXhpc3QgPSBmdW5jdGlvbiAoZW1haWwpIHtcbiAgICByZXR1cm4gdGhpcy5maW5kT25lKHtlbWFpbH0pO1xufTtcblxuVXNlclNjaGVtYS5zdGF0aWNzLnBob25lTnVtYmVyRXhpc3QgPSBmdW5jdGlvbiAocGhvbmVOdW1iZXIpIHtcbiAgICByZXR1cm4gdGhpcy5maW5kT25lKHtwaG9uZU51bWJlcn0pO1xufTtcblxuVXNlclNjaGVtYS5tZXRob2RzLmNvbXBhcmVQYXNzd29yZCA9IGZ1bmN0aW9uIChwYXNzd29yZCkge1xuICAgIHJldHVybiBiY3J5cHQuY29tcGFyZVN5bmMocGFzc3dvcmQsIHRoaXMucGFzc3dvcmQpO1xufTtcblxuY29uc3QgVXNlck1vZGVsID0gbW9uZ29vc2UubW9kZWwoXCJVc2VyXCIsIFVzZXJTY2hlbWEpO1xuY29uc3QgVXNlclRDID0gY29tcG9zZVdpdGhNb25nb29zZShVc2VyTW9kZWwpO1xuLy8gY29uc3QgVXNlclRDID0gY29tcG9zZVdpdGhNb25nb29zZShVc2VyTW9kZWwpLnJlbW92ZUZpZWxkKCdwYXNzd29yZCcpO1xuXG5jb25zdCBVc2VyQWNjb3VudFRDID0gVXNlclRDLmdldEZpZWxkVEMoXCJhY2NvdW50XCIpO1xuXG5Vc2VyQWNjb3VudFRDLmdldEZpZWxkVEMoXCJ2ZXJpZmljYXRpb25cIikucmVtb3ZlRmllbGQoW1widG9rZW5cIiwgXCJleHBpcmVzSW5cIl0pO1xuXG4vLyBVc2VyQWNjb3VudFRDLnJlbW92ZUZpZWxkKCdyZXNldFBhc3N3b3JkJyk7XG5cbmV4cG9ydCB7VXNlck1vZGVsLCBVc2VyVEMsIFVzZXJTY2hlbWF9O1xuIl19","map":{"version":3,"sources":["user.js"],"names":["UserSchema","Schema","firstName","String","middleName","lastName","email","phoneNumber","image","firebaseId","password","status","type","default","enum","roles","account","verification","verified","Boolean","token","expiresIn","Date","emailVerification","phoneVerification","resetPassword","collection","plugin","timestamps","index","createdAt","updatedAt","statics","emailExist","findOne","phoneNumberExist","methods","comparePassword","bcrypt","compareSync","UserModel","mongoose","model","UserTC","UserAccountTC","getFieldTC","removeField"],"mappings":"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","sourceRoot":"/home/nathnael/projects/haleta/haleta-new-api/src/models/","sourcesContent":["import mongoose, {Schema} from \"mongoose\";\nimport timestamps from \"mongoose-timestamp\";\nimport {composeWithMongoose} from \"graphql-compose-mongoose\";\n\nconst UserSchema = new Schema({\n    firstName: String,\n    middleName: String,\n    lastName: String,\n    email: String,\n    phoneNumber: String,\n    image: String,\n    firebaseId: String,\n    password: String,\n    status: {\n        type: String,\n        default: \"ACTIVE\",\n        enum: [\"ACTIVE\", \"BLOCKED\"],\n    },\n    roles: {\n        type: String,\n        default: \"NORMAL\",\n        enum: [\"NORMAL\", \"OWNER\", \"ADMIN\", \"SALES\"],\n    },\n    account: {\n        verification: {\n            verified: {\n                type: Boolean,\n                default: false,\n            },\n            token: String,\n            expiresIn: Date,\n        },\n        emailVerification: {\n            verified: {\n                type: Boolean,\n                default: false,\n            },\n            token: String,\n            expiresIn: Date,\n        },\n        phoneVerification: {\n            verified: {\n                type: Boolean,\n                default: false,\n            },\n            token: String,\n            expiresIn: Date,\n        },\n        resetPassword: {\n            token: String,\n            expiresIn: Date,\n        },\n    },\n}, {\n    collection: \"users\",\n});\n\nUserSchema.plugin(timestamps);\nUserSchema.index({\n    createdAt: 1,\n    updatedAt: 1,\n});\n\nUserSchema.statics.emailExist = function (email) {\n    return this.findOne({email});\n};\n\nUserSchema.statics.phoneNumberExist = function (phoneNumber) {\n    return this.findOne({phoneNumber});\n};\n\nUserSchema.methods.comparePassword = function (password) {\n    return bcrypt.compareSync(password, this.password);\n};\n\nconst UserModel = mongoose.model(\"User\", UserSchema);\nconst UserTC = composeWithMongoose(UserModel);\n// const UserTC = composeWithMongoose(UserModel).removeField('password');\n\nconst UserAccountTC = UserTC.getFieldTC(\"account\");\n\nUserAccountTC.getFieldTC(\"verification\").removeField([\"token\", \"expiresIn\"]);\n\n// UserAccountTC.removeField('resetPassword');\n\nexport {UserModel, UserTC, UserSchema};\n"]}},"mtime":1648313712832},"{\"assumptions\":{},\"sourceRoot\":\"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"filename\":\"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"authentication\", {\n  enumerable: true,\n  get: function () {\n    return _authentication.default;\n  }\n});\nObject.defineProperty(exports, \"authorization\", {\n  enumerable: true,\n  get: function () {\n    return _authorization.default;\n  }\n});\nObject.defineProperty(exports, \"phoneVerification\", {\n  enumerable: true,\n  get: function () {\n    return _phoneVerification.default;\n  }\n});\nObject.defineProperty(exports, \"userValidator\", {\n  enumerable: true,\n  get: function () {\n    return _userValidator.default;\n  }\n});\nObject.defineProperty(exports, \"validateToken\", {\n  enumerable: true,\n  get: function () {\n    return _validateToken.default;\n  }\n});\n\nvar _authentication = _interopRequireDefault(require(\"./auth/authentication\"));\n\nvar _authorization = _interopRequireDefault(require(\"./auth/authorization\"));\n\nvar _validateToken = _interopRequireDefault(require(\"./auth/validate-token\"));\n\nvar _phoneVerification = _interopRequireDefault(require(\"./auth/phone-verification\"));\n\nvar _userValidator = _interopRequireDefault(require(\"./validators/user-validator\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUNBIiwic291cmNlUm9vdCI6Ii9ob21lL25hdGhuYWVsL3Byb2plY3RzL2hhbGV0YS9oYWxldGEtbmV3LWFwaS9zcmMvbWlkZGxld2FyZXMvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGF1dGhlbnRpY2F0aW9uIGZyb20gXCIuL2F1dGgvYXV0aGVudGljYXRpb25cIlxuaW1wb3J0IGF1dGhvcml6YXRpb24gZnJvbSBcIi4vYXV0aC9hdXRob3JpemF0aW9uXCJcbmltcG9ydCB2YWxpZGF0ZVRva2VuIGZyb20gXCIuL2F1dGgvdmFsaWRhdGUtdG9rZW5cIlxuaW1wb3J0IHBob25lVmVyaWZpY2F0aW9uIGZyb20gXCIuL2F1dGgvcGhvbmUtdmVyaWZpY2F0aW9uXCJcbmltcG9ydCB1c2VyVmFsaWRhdG9yIGZyb20gXCIuL3ZhbGlkYXRvcnMvdXNlci12YWxpZGF0b3JcIjtcblxuZXhwb3J0IHtcbiAgICBhdXRoZW50aWNhdGlvbixcbiAgICBhdXRob3JpemF0aW9uLFxuICAgIHZhbGlkYXRlVG9rZW4sXG4gICAgcGhvbmVWZXJpZmljYXRpb24sXG4gICAgdXNlclZhbGlkYXRvcixcbn0iXX0=","map":{"version":3,"sources":["index.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;AACA","sourceRoot":"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/","sourcesContent":["import authentication from \"./auth/authentication\"\nimport authorization from \"./auth/authorization\"\nimport validateToken from \"./auth/validate-token\"\nimport phoneVerification from \"./auth/phone-verification\"\nimport userValidator from \"./validators/user-validator\";\n\nexport {\n    authentication,\n    authorization,\n    validateToken,\n    phoneVerification,\n    userValidator,\n}"]}},"mtime":1648313712832},"{\"assumptions\":{},\"sourceRoot\":\"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/auth/resolvers/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"filename\":\"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/auth/resolvers/index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIvaG9tZS9uYXRobmFlbC9wcm9qZWN0cy9oYWxldGEvaGFsZXRhLW5ldy1hcGkvc3JjL2dyYXBocWwvYXV0aC9yZXNvbHZlcnMvIiwic291cmNlc0NvbnRlbnQiOltdfQ==","map":{"version":3,"sources":[],"names":[],"mappings":"","sourceRoot":"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/auth/resolvers/","sourcesContent":[]}},"mtime":1648313712828},"{\"assumptions\":{},\"sourceRoot\":\"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/auth/resolvers/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"filename\":\"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/auth/resolvers/auth-resolvers.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\n\nvar _user = require(\"../../../models/user\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// import crypto from \"crypto\";\nconst signIn = {\n  name: \"signIn\",\n  type: \"AccessToken!\",\n  args: {\n    phoneNumber: \"String!\",\n    password: \"String!\"\n  },\n  resolve: async ({\n    args: {\n      phoneNumber,\n      password\n    }\n  }) => {\n    try {\n      // const user = await UserModel.phoneNumberExist(phoneNumber);\n      // if (!user) {\n      //     return Promise.reject(new Error(\"User not found.\"));\n      // }\n      const user = await _user.UserModel.find({\n        phoneNumber\n      }); // const comparePassword = await user.comparePassword(password.toString());\n      // if (!comparePassword) {\n      //     return Promise.reject(new Error(\"Password is incorrect.\"));\n      // }\n\n      console.log(user);\n      const accessToken = await _jsonwebtoken.default.sign(user, process.env.JWT_SECRET, {\n        expiresIn: process.env.JWT_EXPIRATION\n      });\n      return {\n        accessToken,\n        // roles: user.roles,\n        user\n      };\n    } catch (error) {\n      return Promise.reject(error);\n    }\n  }\n};\nconst signUp = {\n  name: \"signUp\",\n  type: \"AccessToken!\",\n  args: {\n    firstName: \"String!\",\n    middleName: \"String!\",\n    lastName: \"String!\",\n    password: \"String!\",\n    phoneNumber: \"String!\"\n  },\n  resolve: async ({\n    args: {\n      firstName,\n      middleName,\n      lastName,\n      password,\n      phoneNumber\n    },\n    context: {\n      phoneVerification\n    }\n  }) => {\n    try {\n      console.log(\"here 1\"); // let user = await UserModel.phoneNumberExist(phoneNumber);\n      // if (user) {\n      //     console.log(\"here 2\")\n      //     return Promise.reject(new Error(\"Phone Number has already been taken.\"));\n      // }\n      // user = await UserModel.emailExist(email);\n      // if (user) {\n      //   return Promise.reject(new Error(\"Email has already been taken.\"));\n      // }\n      // const salt = bcrypt.genSalt(10);\n      // const hash = bcrypt.hashSync(password, salt);\n\n      let user = await new _user.UserModel({\n        firstName,\n        middleName,\n        lastName,\n        phoneNumber,\n        password // password: hash,\n        // roles: [roles.OWNER],\n        // account: {\n        //     phoneVerification: {\n        //         verified: true,\n        //         token: phoneVerification,\n        //     },\n        // },\n\n      }).save();\n      console.log(\"here 3\");\n      const accessToken = await _jsonwebtoken.default.sign({\n        _id: user._id,\n        firstName: user.firstName,\n        middleName: user.middleName,\n        lastName: user.lastName,\n        phoneNumber: user.phoneNumber // roles: user.roles,\n\n      }, process.env.JWT_SECRET, {\n        expiresIn: process.env.JWT_EXPIRATION\n      }); // await userService.verifyRequest(user);\n      // userMail.verifyRequest(user, token);\n\n      return {\n        accessToken,\n        // roles: user.roles,\n        user\n      };\n    } catch (error) {\n      return Promise.reject(error);\n    }\n  }\n};\nconst logout = {\n  name: 'logout',\n  type: 'Succeed!',\n  resolve: async ({\n    context: {\n      user,\n      accessToken\n    }\n  }) => {\n    try {\n      // await redis.set(`expiredToken:${accessToken}`, user._id, 'EX', process.env.REDIS_TOKEN_EXPIRY);\n      return {\n        succeed: true\n      };\n    } catch (error) {\n      return Promise.reject(error);\n    }\n  }\n};\nconst resetPassword = {\n  name: \"resetPassword\",\n  type: \"Succeed!\",\n  args: {\n    email: \"String!\"\n  },\n  resolve: async ({\n    args: {\n      email\n    }\n  }) => {\n    try {\n      const user = await _user.UserModel.findOne({\n        email\n      });\n\n      if (!user) {\n        return Promise.reject(new Error(\"User not found.\"));\n      } // const token = crypto.randomBytes(48, (err, buffer) => buffer.toString(\"hex\"));\n      // const expiresIn = moment().add(7, \"days\");\n      // user.set({\n      //     account: {\n      //         resetPassword: {\n      //             token,\n      //             expiresIn,\n      //         },\n      //     },\n      // });\n\n\n      await user.save(); // userMail.resetPassword(user, token);\n\n      return {\n        succeed: true\n      };\n    } catch (error) {\n      return Promise.reject(error);\n    }\n  }\n};\nconst newPassword = {\n  name: \"newPassword\",\n  type: \"AccessToken!\",\n  args: {\n    token: \"String!\",\n    newPassword: \"String!\"\n  },\n  resolve: async ({\n    args: {\n      token,\n      newPassword\n    }\n  }) => {\n    try {\n      const user = await _user.UserModel.findOne({\n        \"account.resetPassword.token\": token\n      });\n\n      if (!user) {\n        return Promise.reject(new Error(\"Access Token is not valid or has expired.\"));\n      }\n\n      const hash = bcrypt.hashSync(newPassword, 10);\n      user.set({\n        password: hash,\n        account: {\n          resetPassword: {\n            token: null,\n            expiresIn: null\n          }\n        }\n      });\n      await user.save();\n      const accessToken = await _jsonwebtoken.default.sign({\n        userId: user._id\n      }, process.env.JWT_SECRET, {\n        expiresIn: process.env.JWT_EXPIRATION\n      });\n      return {\n        accessToken\n      };\n    } catch (error) {\n      return Promise.reject(error);\n    }\n  }\n};\nconst changePassword = {\n  name: \"changePassword\",\n  type: \"Succeed!\",\n  args: {\n    currentPassword: \"String!\",\n    newPassword: \"String!\"\n  },\n  resolve: async ({\n    args: {\n      currentPassword,\n      newPassword\n    },\n    context: {\n      user\n    }\n  }) => {\n    try {\n      const comparePassword = await user.comparePassword(currentPassword);\n\n      if (!comparePassword) {\n        return Promise.reject(new Error(\"Current password is incorrect.\"));\n      }\n\n      const hash = bcrypt.hashSync(newPassword, 10);\n      user.set({\n        password: hash\n      });\n      await user.save();\n      return {\n        succeed: true\n      };\n    } catch (error) {\n      return Promise.reject(error);\n    }\n  }\n};\nconst verifyRequest = {\n  name: \"verifyRequest\",\n  type: \"Succeed!\",\n  resolve: async ({\n    context: {\n      user\n    }\n  }) => {\n    try {\n      // await userService.verifyRequest(user);\n      // userMail.verifyRequest(user, token);\n      return {\n        succeed: true\n      };\n    } catch (error) {\n      return Promise.reject(error);\n    }\n  }\n};\nconst verify = {\n  name: \"verify\",\n  type: \"AccessToken!\",\n  args: {\n    token: \"String!\"\n  },\n  resolve: async ({\n    args: {\n      token\n    }\n  }) => {\n    try {// const user = await UserModel.findOne({\n      //   \"account.verification.token\": token,\n      // });\n      // if (!user) {\n      //   return Promise.reject(new Error(\"Access Token is not valid or has expired.\"));\n      // }\n      //\n      // user.set({\n      //   account: {\n      //     verification: {\n      //       verified: true,\n      //       token: null,\n      //       expiresIn: null,\n      //     },\n      //   },\n      // });\n      //\n      // await user.save();\n      //\n      // const accessToken = jwt.sign({ userId: user._id }, process.env.JWT_SECRET, {\n      //   expiresIn: process.env.JWT_EXPIRATION,\n      // });\n      // userMail.verify(user);\n      // return { accessToken };\n    } catch (error) {\n      return Promise.reject(error);\n    }\n  }\n};\nvar _default = {\n  signIn,\n  signUp,\n  logout,\n  newPassword,\n  changePassword,\n  verify,\n  verifyRequest\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGgtcmVzb2x2ZXJzLmpzIl0sIm5hbWVzIjpbInNpZ25JbiIsIm5hbWUiLCJ0eXBlIiwiYXJncyIsInBob25lTnVtYmVyIiwicGFzc3dvcmQiLCJyZXNvbHZlIiwidXNlciIsIlVzZXJNb2RlbCIsImZpbmQiLCJjb25zb2xlIiwibG9nIiwiYWNjZXNzVG9rZW4iLCJqd3QiLCJzaWduIiwicHJvY2VzcyIsImVudiIsIkpXVF9TRUNSRVQiLCJleHBpcmVzSW4iLCJKV1RfRVhQSVJBVElPTiIsImVycm9yIiwiUHJvbWlzZSIsInJlamVjdCIsInNpZ25VcCIsImZpcnN0TmFtZSIsIm1pZGRsZU5hbWUiLCJsYXN0TmFtZSIsImNvbnRleHQiLCJwaG9uZVZlcmlmaWNhdGlvbiIsInNhdmUiLCJfaWQiLCJsb2dvdXQiLCJzdWNjZWVkIiwicmVzZXRQYXNzd29yZCIsImVtYWlsIiwiZmluZE9uZSIsIkVycm9yIiwibmV3UGFzc3dvcmQiLCJ0b2tlbiIsImhhc2giLCJiY3J5cHQiLCJoYXNoU3luYyIsInNldCIsImFjY291bnQiLCJ1c2VySWQiLCJjaGFuZ2VQYXNzd29yZCIsImN1cnJlbnRQYXNzd29yZCIsImNvbXBhcmVQYXNzd29yZCIsInZlcmlmeVJlcXVlc3QiLCJ2ZXJpZnkiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFDQTs7OztBQUNBO0FBRUEsTUFBTUEsTUFBTSxHQUFHO0FBQ1hDLEVBQUFBLElBQUksRUFBRSxRQURLO0FBRVhDLEVBQUFBLElBQUksRUFBRSxjQUZLO0FBR1hDLEVBQUFBLElBQUksRUFBRTtBQUNGQyxJQUFBQSxXQUFXLEVBQUUsU0FEWDtBQUVGQyxJQUFBQSxRQUFRLEVBQUU7QUFGUixHQUhLO0FBT1hDLEVBQUFBLE9BQU8sRUFBRSxPQUFPO0FBQ0lILElBQUFBLElBQUksRUFBRTtBQUNGQyxNQUFBQSxXQURFO0FBRUZDLE1BQUFBO0FBRkU7QUFEVixHQUFQLEtBS2E7QUFDbEIsUUFBSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBTUUsSUFBSSxHQUFHLE1BQU1DLGdCQUFVQyxJQUFWLENBQWU7QUFBQ0wsUUFBQUE7QUFBRCxPQUFmLENBQW5CLENBTEEsQ0FPQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQU0sTUFBQUEsT0FBTyxDQUFDQyxHQUFSLENBQVlKLElBQVo7QUFDQSxZQUFNSyxXQUFXLEdBQUcsTUFBTUMsc0JBQUlDLElBQUosQ0FBU1AsSUFBVCxFQUFlUSxPQUFPLENBQUNDLEdBQVIsQ0FBWUMsVUFBM0IsRUFBdUM7QUFDN0RDLFFBQUFBLFNBQVMsRUFBRUgsT0FBTyxDQUFDQyxHQUFSLENBQVlHO0FBRHNDLE9BQXZDLENBQTFCO0FBSUEsYUFBTztBQUNIUCxRQUFBQSxXQURHO0FBRUg7QUFDQUwsUUFBQUE7QUFIRyxPQUFQO0FBS0gsS0F0QkQsQ0FzQkUsT0FBT2EsS0FBUCxFQUFjO0FBQ1osYUFBT0MsT0FBTyxDQUFDQyxNQUFSLENBQWVGLEtBQWYsQ0FBUDtBQUNIO0FBQ0o7QUF0Q1UsQ0FBZjtBQTBDQSxNQUFNRyxNQUFNLEdBQUc7QUFDWHRCLEVBQUFBLElBQUksRUFBRSxRQURLO0FBRVhDLEVBQUFBLElBQUksRUFBRSxjQUZLO0FBR1hDLEVBQUFBLElBQUksRUFBRTtBQUNGcUIsSUFBQUEsU0FBUyxFQUFFLFNBRFQ7QUFFRkMsSUFBQUEsVUFBVSxFQUFFLFNBRlY7QUFHRkMsSUFBQUEsUUFBUSxFQUFFLFNBSFI7QUFJRnJCLElBQUFBLFFBQVEsRUFBRSxTQUpSO0FBS0ZELElBQUFBLFdBQVcsRUFBRTtBQUxYLEdBSEs7QUFVWEUsRUFBQUEsT0FBTyxFQUFFLE9BQU87QUFDSUgsSUFBQUEsSUFBSSxFQUFFO0FBQ0ZxQixNQUFBQSxTQURFO0FBRUZDLE1BQUFBLFVBRkU7QUFHRkMsTUFBQUEsUUFIRTtBQUlGckIsTUFBQUEsUUFKRTtBQUtGRCxNQUFBQTtBQUxFLEtBRFY7QUFRSXVCLElBQUFBLE9BQU8sRUFBRTtBQUNMQyxNQUFBQTtBQURLO0FBUmIsR0FBUCxLQVdhO0FBQ2xCLFFBQUk7QUFDQWxCLE1BQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZLFFBQVosRUFEQSxDQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsVUFBSUosSUFBSSxHQUFHLE1BQU0sSUFBSUMsZUFBSixDQUFjO0FBQzNCZ0IsUUFBQUEsU0FEMkI7QUFFM0JDLFFBQUFBLFVBRjJCO0FBRzNCQyxRQUFBQSxRQUgyQjtBQUkzQnRCLFFBQUFBLFdBSjJCO0FBSzNCQyxRQUFBQSxRQUwyQixDQU0zQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQWIyQixPQUFkLEVBY2R3QixJQWRjLEVBQWpCO0FBZUFuQixNQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWSxRQUFaO0FBQ0EsWUFBTUMsV0FBVyxHQUFHLE1BQU1DLHNCQUFJQyxJQUFKLENBQVM7QUFDL0JnQixRQUFBQSxHQUFHLEVBQUV2QixJQUFJLENBQUN1QixHQURxQjtBQUUvQk4sUUFBQUEsU0FBUyxFQUFFakIsSUFBSSxDQUFDaUIsU0FGZTtBQUcvQkMsUUFBQUEsVUFBVSxFQUFFbEIsSUFBSSxDQUFDa0IsVUFIYztBQUkvQkMsUUFBQUEsUUFBUSxFQUFFbkIsSUFBSSxDQUFDbUIsUUFKZ0I7QUFLL0J0QixRQUFBQSxXQUFXLEVBQUVHLElBQUksQ0FBQ0gsV0FMYSxDQU0vQjs7QUFOK0IsT0FBVCxFQU92QlcsT0FBTyxDQUFDQyxHQUFSLENBQVlDLFVBUFcsRUFPQztBQUN2QkMsUUFBQUEsU0FBUyxFQUFFSCxPQUFPLENBQUNDLEdBQVIsQ0FBWUc7QUFEQSxPQVBELENBQTFCLENBL0JBLENBMENBO0FBRUE7O0FBRUEsYUFBTztBQUNIUCxRQUFBQSxXQURHO0FBRUg7QUFDQUwsUUFBQUE7QUFIRyxPQUFQO0FBS0gsS0FuREQsQ0FtREUsT0FBT2EsS0FBUCxFQUFjO0FBQ1osYUFBT0MsT0FBTyxDQUFDQyxNQUFSLENBQWVGLEtBQWYsQ0FBUDtBQUNIO0FBQ0o7QUE1RVUsQ0FBZjtBQStFQSxNQUFNVyxNQUFNLEdBQUc7QUFDWDlCLEVBQUFBLElBQUksRUFBRSxRQURLO0FBRVhDLEVBQUFBLElBQUksRUFBRSxVQUZLO0FBR1hJLEVBQUFBLE9BQU8sRUFBRSxPQUFPO0FBQUNxQixJQUFBQSxPQUFPLEVBQUU7QUFBQ3BCLE1BQUFBLElBQUQ7QUFBT0ssTUFBQUE7QUFBUDtBQUFWLEdBQVAsS0FBMEM7QUFDL0MsUUFBSTtBQUNBO0FBRUEsYUFBTztBQUFDb0IsUUFBQUEsT0FBTyxFQUFFO0FBQVYsT0FBUDtBQUNILEtBSkQsQ0FJRSxPQUFPWixLQUFQLEVBQWM7QUFDWixhQUFPQyxPQUFPLENBQUNDLE1BQVIsQ0FBZUYsS0FBZixDQUFQO0FBQ0g7QUFDSjtBQVhVLENBQWY7QUFjQSxNQUFNYSxhQUFhLEdBQUc7QUFDbEJoQyxFQUFBQSxJQUFJLEVBQUUsZUFEWTtBQUVsQkMsRUFBQUEsSUFBSSxFQUFFLFVBRlk7QUFHbEJDLEVBQUFBLElBQUksRUFBRTtBQUFDK0IsSUFBQUEsS0FBSyxFQUFFO0FBQVIsR0FIWTtBQUlsQjVCLEVBQUFBLE9BQU8sRUFBRSxPQUFPO0FBQUNILElBQUFBLElBQUksRUFBRTtBQUFDK0IsTUFBQUE7QUFBRDtBQUFQLEdBQVAsS0FBMkI7QUFDaEMsUUFBSTtBQUNBLFlBQU0zQixJQUFJLEdBQUcsTUFBTUMsZ0JBQVUyQixPQUFWLENBQWtCO0FBQUNELFFBQUFBO0FBQUQsT0FBbEIsQ0FBbkI7O0FBQ0EsVUFBSSxDQUFDM0IsSUFBTCxFQUFXO0FBQ1AsZUFBT2MsT0FBTyxDQUFDQyxNQUFSLENBQWUsSUFBSWMsS0FBSixDQUFVLGlCQUFWLENBQWYsQ0FBUDtBQUNILE9BSkQsQ0FNQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUEsWUFBTTdCLElBQUksQ0FBQ3NCLElBQUwsRUFBTixDQWxCQSxDQW9CQTs7QUFFQSxhQUFPO0FBQUNHLFFBQUFBLE9BQU8sRUFBRTtBQUFWLE9BQVA7QUFDSCxLQXZCRCxDQXVCRSxPQUFPWixLQUFQLEVBQWM7QUFDWixhQUFPQyxPQUFPLENBQUNDLE1BQVIsQ0FBZUYsS0FBZixDQUFQO0FBQ0g7QUFDSjtBQS9CaUIsQ0FBdEI7QUFrQ0EsTUFBTWlCLFdBQVcsR0FBRztBQUNoQnBDLEVBQUFBLElBQUksRUFBRSxhQURVO0FBRWhCQyxFQUFBQSxJQUFJLEVBQUUsY0FGVTtBQUdoQkMsRUFBQUEsSUFBSSxFQUFFO0FBQ0ZtQyxJQUFBQSxLQUFLLEVBQUUsU0FETDtBQUVGRCxJQUFBQSxXQUFXLEVBQUU7QUFGWCxHQUhVO0FBT2hCL0IsRUFBQUEsT0FBTyxFQUFFLE9BQU87QUFDSUgsSUFBQUEsSUFBSSxFQUFFO0FBQ0ZtQyxNQUFBQSxLQURFO0FBRUZELE1BQUFBO0FBRkU7QUFEVixHQUFQLEtBS2E7QUFDbEIsUUFBSTtBQUNBLFlBQU05QixJQUFJLEdBQUcsTUFBTUMsZ0JBQVUyQixPQUFWLENBQWtCO0FBQ2pDLHVDQUErQkc7QUFERSxPQUFsQixDQUFuQjs7QUFHQSxVQUFJLENBQUMvQixJQUFMLEVBQVc7QUFDUCxlQUFPYyxPQUFPLENBQUNDLE1BQVIsQ0FBZSxJQUFJYyxLQUFKLENBQVUsMkNBQVYsQ0FBZixDQUFQO0FBQ0g7O0FBRUQsWUFBTUcsSUFBSSxHQUFHQyxNQUFNLENBQUNDLFFBQVAsQ0FBZ0JKLFdBQWhCLEVBQTZCLEVBQTdCLENBQWI7QUFFQTlCLE1BQUFBLElBQUksQ0FBQ21DLEdBQUwsQ0FBUztBQUNMckMsUUFBQUEsUUFBUSxFQUFFa0MsSUFETDtBQUVMSSxRQUFBQSxPQUFPLEVBQUU7QUFDTFYsVUFBQUEsYUFBYSxFQUFFO0FBQ1hLLFlBQUFBLEtBQUssRUFBRSxJQURJO0FBRVhwQixZQUFBQSxTQUFTLEVBQUU7QUFGQTtBQURWO0FBRkosT0FBVDtBQVVBLFlBQU1YLElBQUksQ0FBQ3NCLElBQUwsRUFBTjtBQUVBLFlBQU1qQixXQUFXLEdBQUcsTUFBTUMsc0JBQUlDLElBQUosQ0FBUztBQUFDOEIsUUFBQUEsTUFBTSxFQUFFckMsSUFBSSxDQUFDdUI7QUFBZCxPQUFULEVBQTZCZixPQUFPLENBQUNDLEdBQVIsQ0FBWUMsVUFBekMsRUFBcUQ7QUFDM0VDLFFBQUFBLFNBQVMsRUFBRUgsT0FBTyxDQUFDQyxHQUFSLENBQVlHO0FBRG9ELE9BQXJELENBQTFCO0FBSUEsYUFBTztBQUFDUCxRQUFBQTtBQUFELE9BQVA7QUFDSCxLQTNCRCxDQTJCRSxPQUFPUSxLQUFQLEVBQWM7QUFDWixhQUFPQyxPQUFPLENBQUNDLE1BQVIsQ0FBZUYsS0FBZixDQUFQO0FBQ0g7QUFDSjtBQTNDZSxDQUFwQjtBQThDQSxNQUFNeUIsY0FBYyxHQUFHO0FBQ25CNUMsRUFBQUEsSUFBSSxFQUFFLGdCQURhO0FBRW5CQyxFQUFBQSxJQUFJLEVBQUUsVUFGYTtBQUduQkMsRUFBQUEsSUFBSSxFQUFFO0FBQ0YyQyxJQUFBQSxlQUFlLEVBQUUsU0FEZjtBQUVGVCxJQUFBQSxXQUFXLEVBQUU7QUFGWCxHQUhhO0FBT25CL0IsRUFBQUEsT0FBTyxFQUFFLE9BQU87QUFDSUgsSUFBQUEsSUFBSSxFQUFFO0FBQ0YyQyxNQUFBQSxlQURFO0FBRUZULE1BQUFBO0FBRkUsS0FEVjtBQUtJVixJQUFBQSxPQUFPLEVBQUU7QUFBQ3BCLE1BQUFBO0FBQUQ7QUFMYixHQUFQLEtBTWE7QUFDbEIsUUFBSTtBQUNBLFlBQU13QyxlQUFlLEdBQUcsTUFBTXhDLElBQUksQ0FBQ3dDLGVBQUwsQ0FBcUJELGVBQXJCLENBQTlCOztBQUNBLFVBQUksQ0FBQ0MsZUFBTCxFQUFzQjtBQUNsQixlQUFPMUIsT0FBTyxDQUFDQyxNQUFSLENBQWUsSUFBSWMsS0FBSixDQUFVLGdDQUFWLENBQWYsQ0FBUDtBQUNIOztBQUVELFlBQU1HLElBQUksR0FBR0MsTUFBTSxDQUFDQyxRQUFQLENBQWdCSixXQUFoQixFQUE2QixFQUE3QixDQUFiO0FBRUE5QixNQUFBQSxJQUFJLENBQUNtQyxHQUFMLENBQVM7QUFBQ3JDLFFBQUFBLFFBQVEsRUFBRWtDO0FBQVgsT0FBVDtBQUVBLFlBQU1oQyxJQUFJLENBQUNzQixJQUFMLEVBQU47QUFFQSxhQUFPO0FBQUNHLFFBQUFBLE9BQU8sRUFBRTtBQUFWLE9BQVA7QUFDSCxLQWJELENBYUUsT0FBT1osS0FBUCxFQUFjO0FBQ1osYUFBT0MsT0FBTyxDQUFDQyxNQUFSLENBQWVGLEtBQWYsQ0FBUDtBQUNIO0FBQ0o7QUE5QmtCLENBQXZCO0FBaUNBLE1BQU00QixhQUFhLEdBQUc7QUFDbEIvQyxFQUFBQSxJQUFJLEVBQUUsZUFEWTtBQUVsQkMsRUFBQUEsSUFBSSxFQUFFLFVBRlk7QUFHbEJJLEVBQUFBLE9BQU8sRUFBRSxPQUFPO0FBQUNxQixJQUFBQSxPQUFPLEVBQUU7QUFBQ3BCLE1BQUFBO0FBQUQ7QUFBVixHQUFQLEtBQTZCO0FBQ2xDLFFBQUk7QUFDQTtBQUVBO0FBRUEsYUFBTztBQUFDeUIsUUFBQUEsT0FBTyxFQUFFO0FBQVYsT0FBUDtBQUNILEtBTkQsQ0FNRSxPQUFPWixLQUFQLEVBQWM7QUFDWixhQUFPQyxPQUFPLENBQUNDLE1BQVIsQ0FBZUYsS0FBZixDQUFQO0FBQ0g7QUFDSjtBQWJpQixDQUF0QjtBQWdCQSxNQUFNNkIsTUFBTSxHQUFHO0FBQ1hoRCxFQUFBQSxJQUFJLEVBQUUsUUFESztBQUVYQyxFQUFBQSxJQUFJLEVBQUUsY0FGSztBQUdYQyxFQUFBQSxJQUFJLEVBQUU7QUFBQ21DLElBQUFBLEtBQUssRUFBRTtBQUFSLEdBSEs7QUFJWGhDLEVBQUFBLE9BQU8sRUFBRSxPQUFPO0FBQUNILElBQUFBLElBQUksRUFBRTtBQUFDbUMsTUFBQUE7QUFBRDtBQUFQLEdBQVAsS0FBMkI7QUFDaEMsUUFBSSxDQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNILEtBM0JELENBMkJFLE9BQU9sQixLQUFQLEVBQWM7QUFDWixhQUFPQyxPQUFPLENBQUNDLE1BQVIsQ0FBZUYsS0FBZixDQUFQO0FBQ0g7QUFDSjtBQW5DVSxDQUFmO2VBc0NlO0FBQ1hwQixFQUFBQSxNQURXO0FBRVh1QixFQUFBQSxNQUZXO0FBR1hRLEVBQUFBLE1BSFc7QUFJWE0sRUFBQUEsV0FKVztBQUtYUSxFQUFBQSxjQUxXO0FBTVhJLEVBQUFBLE1BTlc7QUFPWEQsRUFBQUE7QUFQVyxDIiwic291cmNlUm9vdCI6Ii9ob21lL25hdGhuYWVsL3Byb2plY3RzL2hhbGV0YS9oYWxldGEtbmV3LWFwaS9zcmMvZ3JhcGhxbC9hdXRoL3Jlc29sdmVycy8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgand0IGZyb20gXCJqc29ud2VidG9rZW5cIjtcbmltcG9ydCB7VXNlck1vZGVsfSBmcm9tIFwiLi4vLi4vLi4vbW9kZWxzL3VzZXJcIjtcbi8vIGltcG9ydCBjcnlwdG8gZnJvbSBcImNyeXB0b1wiO1xuXG5jb25zdCBzaWduSW4gPSB7XG4gICAgbmFtZTogXCJzaWduSW5cIixcbiAgICB0eXBlOiBcIkFjY2Vzc1Rva2VuIVwiLFxuICAgIGFyZ3M6IHtcbiAgICAgICAgcGhvbmVOdW1iZXI6IFwiU3RyaW5nIVwiLFxuICAgICAgICBwYXNzd29yZDogXCJTdHJpbmchXCIsXG4gICAgfSxcbiAgICByZXNvbHZlOiBhc3luYyAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJnczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBob25lTnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSkgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gY29uc3QgdXNlciA9IGF3YWl0IFVzZXJNb2RlbC5waG9uZU51bWJlckV4aXN0KHBob25lTnVtYmVyKTtcbiAgICAgICAgICAgIC8vIGlmICghdXNlcikge1xuICAgICAgICAgICAgLy8gICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoXCJVc2VyIG5vdCBmb3VuZC5cIikpO1xuICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXJNb2RlbC5maW5kKHtwaG9uZU51bWJlcn0pO1xuXG4gICAgICAgICAgICAvLyBjb25zdCBjb21wYXJlUGFzc3dvcmQgPSBhd2FpdCB1c2VyLmNvbXBhcmVQYXNzd29yZChwYXNzd29yZC50b1N0cmluZygpKTtcbiAgICAgICAgICAgIC8vIGlmICghY29tcGFyZVBhc3N3b3JkKSB7XG4gICAgICAgICAgICAvLyAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcIlBhc3N3b3JkIGlzIGluY29ycmVjdC5cIikpO1xuICAgICAgICAgICAgLy8gfVxuXG4gICAgICAgICAgICBjb25zb2xlLmxvZyh1c2VyKVxuICAgICAgICAgICAgY29uc3QgYWNjZXNzVG9rZW4gPSBhd2FpdCBqd3Quc2lnbih1c2VyLCBwcm9jZXNzLmVudi5KV1RfU0VDUkVULCB7XG4gICAgICAgICAgICAgICAgZXhwaXJlc0luOiBwcm9jZXNzLmVudi5KV1RfRVhQSVJBVElPTixcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuLFxuICAgICAgICAgICAgICAgIC8vIHJvbGVzOiB1c2VyLnJvbGVzLFxuICAgICAgICAgICAgICAgIHVzZXIsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTtcbiAgICAgICAgfVxuICAgIH0sXG59O1xuXG5cbmNvbnN0IHNpZ25VcCA9IHtcbiAgICBuYW1lOiBcInNpZ25VcFwiLFxuICAgIHR5cGU6IFwiQWNjZXNzVG9rZW4hXCIsXG4gICAgYXJnczoge1xuICAgICAgICBmaXJzdE5hbWU6IFwiU3RyaW5nIVwiLFxuICAgICAgICBtaWRkbGVOYW1lOiBcIlN0cmluZyFcIixcbiAgICAgICAgbGFzdE5hbWU6IFwiU3RyaW5nIVwiLFxuICAgICAgICBwYXNzd29yZDogXCJTdHJpbmchXCIsXG4gICAgICAgIHBob25lTnVtYmVyOiBcIlN0cmluZyFcIixcbiAgICB9LFxuICAgIHJlc29sdmU6IGFzeW5jICh7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3ROYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pZGRsZU5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdE5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGhvbmVOdW1iZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGhvbmVWZXJpZmljYXRpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9KSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImhlcmUgMVwiKVxuICAgICAgICAgICAgLy8gbGV0IHVzZXIgPSBhd2FpdCBVc2VyTW9kZWwucGhvbmVOdW1iZXJFeGlzdChwaG9uZU51bWJlcik7XG4gICAgICAgICAgICAvLyBpZiAodXNlcikge1xuICAgICAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKFwiaGVyZSAyXCIpXG4gICAgICAgICAgICAvLyAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcIlBob25lIE51bWJlciBoYXMgYWxyZWFkeSBiZWVuIHRha2VuLlwiKSk7XG4gICAgICAgICAgICAvLyB9XG5cbiAgICAgICAgICAgIC8vIHVzZXIgPSBhd2FpdCBVc2VyTW9kZWwuZW1haWxFeGlzdChlbWFpbCk7XG4gICAgICAgICAgICAvLyBpZiAodXNlcikge1xuICAgICAgICAgICAgLy8gICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKFwiRW1haWwgaGFzIGFscmVhZHkgYmVlbiB0YWtlbi5cIikpO1xuICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgLy8gY29uc3Qgc2FsdCA9IGJjcnlwdC5nZW5TYWx0KDEwKTtcbiAgICAgICAgICAgIC8vIGNvbnN0IGhhc2ggPSBiY3J5cHQuaGFzaFN5bmMocGFzc3dvcmQsIHNhbHQpO1xuXG4gICAgICAgICAgICBsZXQgdXNlciA9IGF3YWl0IG5ldyBVc2VyTW9kZWwoe1xuICAgICAgICAgICAgICAgIGZpcnN0TmFtZSxcbiAgICAgICAgICAgICAgICBtaWRkbGVOYW1lLFxuICAgICAgICAgICAgICAgIGxhc3ROYW1lLFxuICAgICAgICAgICAgICAgIHBob25lTnVtYmVyLFxuICAgICAgICAgICAgICAgIHBhc3N3b3JkLFxuICAgICAgICAgICAgICAgIC8vIHBhc3N3b3JkOiBoYXNoLFxuICAgICAgICAgICAgICAgIC8vIHJvbGVzOiBbcm9sZXMuT1dORVJdLFxuICAgICAgICAgICAgICAgIC8vIGFjY291bnQ6IHtcbiAgICAgICAgICAgICAgICAvLyAgICAgcGhvbmVWZXJpZmljYXRpb246IHtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIHZlcmlmaWVkOiB0cnVlLFxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgdG9rZW46IHBob25lVmVyaWZpY2F0aW9uLFxuICAgICAgICAgICAgICAgIC8vICAgICB9LFxuICAgICAgICAgICAgICAgIC8vIH0sXG4gICAgICAgICAgICB9KS5zYXZlKCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImhlcmUgM1wiKVxuICAgICAgICAgICAgY29uc3QgYWNjZXNzVG9rZW4gPSBhd2FpdCBqd3Quc2lnbih7XG4gICAgICAgICAgICAgICAgX2lkOiB1c2VyLl9pZCxcbiAgICAgICAgICAgICAgICBmaXJzdE5hbWU6IHVzZXIuZmlyc3ROYW1lLFxuICAgICAgICAgICAgICAgIG1pZGRsZU5hbWU6IHVzZXIubWlkZGxlTmFtZSxcbiAgICAgICAgICAgICAgICBsYXN0TmFtZTogdXNlci5sYXN0TmFtZSxcbiAgICAgICAgICAgICAgICBwaG9uZU51bWJlcjogdXNlci5waG9uZU51bWJlcixcbiAgICAgICAgICAgICAgICAvLyByb2xlczogdXNlci5yb2xlcyxcbiAgICAgICAgICAgIH0sIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQsIHtcbiAgICAgICAgICAgICAgICBleHBpcmVzSW46IHByb2Nlc3MuZW52LkpXVF9FWFBJUkFUSU9OLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIGF3YWl0IHVzZXJTZXJ2aWNlLnZlcmlmeVJlcXVlc3QodXNlcik7XG5cbiAgICAgICAgICAgIC8vIHVzZXJNYWlsLnZlcmlmeVJlcXVlc3QodXNlciwgdG9rZW4pO1xuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuLFxuICAgICAgICAgICAgICAgIC8vIHJvbGVzOiB1c2VyLnJvbGVzLFxuICAgICAgICAgICAgICAgIHVzZXIsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTtcbiAgICAgICAgfVxuICAgIH0sXG59O1xuXG5jb25zdCBsb2dvdXQgPSB7XG4gICAgbmFtZTogJ2xvZ291dCcsXG4gICAgdHlwZTogJ1N1Y2NlZWQhJyxcbiAgICByZXNvbHZlOiBhc3luYyAoe2NvbnRleHQ6IHt1c2VyLCBhY2Nlc3NUb2tlbn19KSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBhd2FpdCByZWRpcy5zZXQoYGV4cGlyZWRUb2tlbjoke2FjY2Vzc1Rva2VufWAsIHVzZXIuX2lkLCAnRVgnLCBwcm9jZXNzLmVudi5SRURJU19UT0tFTl9FWFBJUlkpO1xuXG4gICAgICAgICAgICByZXR1cm4ge3N1Y2NlZWQ6IHRydWV9O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbmNvbnN0IHJlc2V0UGFzc3dvcmQgPSB7XG4gICAgbmFtZTogXCJyZXNldFBhc3N3b3JkXCIsXG4gICAgdHlwZTogXCJTdWNjZWVkIVwiLFxuICAgIGFyZ3M6IHtlbWFpbDogXCJTdHJpbmchXCJ9LFxuICAgIHJlc29sdmU6IGFzeW5jICh7YXJnczoge2VtYWlsfX0pID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyTW9kZWwuZmluZE9uZSh7ZW1haWx9KTtcbiAgICAgICAgICAgIGlmICghdXNlcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoXCJVc2VyIG5vdCBmb3VuZC5cIikpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBjb25zdCB0b2tlbiA9IGNyeXB0by5yYW5kb21CeXRlcyg0OCwgKGVyciwgYnVmZmVyKSA9PiBidWZmZXIudG9TdHJpbmcoXCJoZXhcIikpO1xuICAgICAgICAgICAgLy8gY29uc3QgZXhwaXJlc0luID0gbW9tZW50KCkuYWRkKDcsIFwiZGF5c1wiKTtcblxuICAgICAgICAgICAgLy8gdXNlci5zZXQoe1xuICAgICAgICAgICAgLy8gICAgIGFjY291bnQ6IHtcbiAgICAgICAgICAgIC8vICAgICAgICAgcmVzZXRQYXNzd29yZDoge1xuICAgICAgICAgICAgLy8gICAgICAgICAgICAgdG9rZW4sXG4gICAgICAgICAgICAvLyAgICAgICAgICAgICBleHBpcmVzSW4sXG4gICAgICAgICAgICAvLyAgICAgICAgIH0sXG4gICAgICAgICAgICAvLyAgICAgfSxcbiAgICAgICAgICAgIC8vIH0pO1xuXG4gICAgICAgICAgICBhd2FpdCB1c2VyLnNhdmUoKTtcblxuICAgICAgICAgICAgLy8gdXNlck1haWwucmVzZXRQYXNzd29yZCh1c2VyLCB0b2tlbik7XG5cbiAgICAgICAgICAgIHJldHVybiB7c3VjY2VlZDogdHJ1ZX07XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xuICAgICAgICB9XG4gICAgfSxcbn07XG5cbmNvbnN0IG5ld1Bhc3N3b3JkID0ge1xuICAgIG5hbWU6IFwibmV3UGFzc3dvcmRcIixcbiAgICB0eXBlOiBcIkFjY2Vzc1Rva2VuIVwiLFxuICAgIGFyZ3M6IHtcbiAgICAgICAgdG9rZW46IFwiU3RyaW5nIVwiLFxuICAgICAgICBuZXdQYXNzd29yZDogXCJTdHJpbmchXCIsXG4gICAgfSxcbiAgICByZXNvbHZlOiBhc3luYyAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJnczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRva2VuLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1Bhc3N3b3JkLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSkgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXJNb2RlbC5maW5kT25lKHtcbiAgICAgICAgICAgICAgICBcImFjY291bnQucmVzZXRQYXNzd29yZC50b2tlblwiOiB0b2tlbixcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcIkFjY2VzcyBUb2tlbiBpcyBub3QgdmFsaWQgb3IgaGFzIGV4cGlyZWQuXCIpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgaGFzaCA9IGJjcnlwdC5oYXNoU3luYyhuZXdQYXNzd29yZCwgMTApO1xuXG4gICAgICAgICAgICB1c2VyLnNldCh7XG4gICAgICAgICAgICAgICAgcGFzc3dvcmQ6IGhhc2gsXG4gICAgICAgICAgICAgICAgYWNjb3VudDoge1xuICAgICAgICAgICAgICAgICAgICByZXNldFBhc3N3b3JkOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b2tlbjogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cGlyZXNJbjogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGF3YWl0IHVzZXIuc2F2ZSgpO1xuXG4gICAgICAgICAgICBjb25zdCBhY2Nlc3NUb2tlbiA9IGF3YWl0IGp3dC5zaWduKHt1c2VySWQ6IHVzZXIuX2lkfSwgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCwge1xuICAgICAgICAgICAgICAgIGV4cGlyZXNJbjogcHJvY2Vzcy5lbnYuSldUX0VYUElSQVRJT04sXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIHthY2Nlc3NUb2tlbn07XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xuICAgICAgICB9XG4gICAgfSxcbn07XG5cbmNvbnN0IGNoYW5nZVBhc3N3b3JkID0ge1xuICAgIG5hbWU6IFwiY2hhbmdlUGFzc3dvcmRcIixcbiAgICB0eXBlOiBcIlN1Y2NlZWQhXCIsXG4gICAgYXJnczoge1xuICAgICAgICBjdXJyZW50UGFzc3dvcmQ6IFwiU3RyaW5nIVwiLFxuICAgICAgICBuZXdQYXNzd29yZDogXCJTdHJpbmchXCIsXG4gICAgfSxcbiAgICByZXNvbHZlOiBhc3luYyAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJnczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQYXNzd29yZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdQYXNzd29yZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0OiB7dXNlcn0sXG4gICAgICAgICAgICAgICAgICAgIH0pID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGNvbXBhcmVQYXNzd29yZCA9IGF3YWl0IHVzZXIuY29tcGFyZVBhc3N3b3JkKGN1cnJlbnRQYXNzd29yZCk7XG4gICAgICAgICAgICBpZiAoIWNvbXBhcmVQYXNzd29yZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoXCJDdXJyZW50IHBhc3N3b3JkIGlzIGluY29ycmVjdC5cIikpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBoYXNoID0gYmNyeXB0Lmhhc2hTeW5jKG5ld1Bhc3N3b3JkLCAxMCk7XG5cbiAgICAgICAgICAgIHVzZXIuc2V0KHtwYXNzd29yZDogaGFzaH0pO1xuXG4gICAgICAgICAgICBhd2FpdCB1c2VyLnNhdmUoKTtcblxuICAgICAgICAgICAgcmV0dXJuIHtzdWNjZWVkOiB0cnVlfTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XG4gICAgICAgIH1cbiAgICB9LFxufTtcblxuY29uc3QgdmVyaWZ5UmVxdWVzdCA9IHtcbiAgICBuYW1lOiBcInZlcmlmeVJlcXVlc3RcIixcbiAgICB0eXBlOiBcIlN1Y2NlZWQhXCIsXG4gICAgcmVzb2x2ZTogYXN5bmMgKHtjb250ZXh0OiB7dXNlcn19KSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBhd2FpdCB1c2VyU2VydmljZS52ZXJpZnlSZXF1ZXN0KHVzZXIpO1xuXG4gICAgICAgICAgICAvLyB1c2VyTWFpbC52ZXJpZnlSZXF1ZXN0KHVzZXIsIHRva2VuKTtcblxuICAgICAgICAgICAgcmV0dXJuIHtzdWNjZWVkOiB0cnVlfTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XG4gICAgICAgIH1cbiAgICB9LFxufTtcblxuY29uc3QgdmVyaWZ5ID0ge1xuICAgIG5hbWU6IFwidmVyaWZ5XCIsXG4gICAgdHlwZTogXCJBY2Nlc3NUb2tlbiFcIixcbiAgICBhcmdzOiB7dG9rZW46IFwiU3RyaW5nIVwifSxcbiAgICByZXNvbHZlOiBhc3luYyAoe2FyZ3M6IHt0b2tlbn19KSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBjb25zdCB1c2VyID0gYXdhaXQgVXNlck1vZGVsLmZpbmRPbmUoe1xuICAgICAgICAgICAgLy8gICBcImFjY291bnQudmVyaWZpY2F0aW9uLnRva2VuXCI6IHRva2VuLFxuICAgICAgICAgICAgLy8gfSk7XG4gICAgICAgICAgICAvLyBpZiAoIXVzZXIpIHtcbiAgICAgICAgICAgIC8vICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcIkFjY2VzcyBUb2tlbiBpcyBub3QgdmFsaWQgb3IgaGFzIGV4cGlyZWQuXCIpKTtcbiAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAvLyB1c2VyLnNldCh7XG4gICAgICAgICAgICAvLyAgIGFjY291bnQ6IHtcbiAgICAgICAgICAgIC8vICAgICB2ZXJpZmljYXRpb246IHtcbiAgICAgICAgICAgIC8vICAgICAgIHZlcmlmaWVkOiB0cnVlLFxuICAgICAgICAgICAgLy8gICAgICAgdG9rZW46IG51bGwsXG4gICAgICAgICAgICAvLyAgICAgICBleHBpcmVzSW46IG51bGwsXG4gICAgICAgICAgICAvLyAgICAgfSxcbiAgICAgICAgICAgIC8vICAgfSxcbiAgICAgICAgICAgIC8vIH0pO1xuICAgICAgICAgICAgLy9cbiAgICAgICAgICAgIC8vIGF3YWl0IHVzZXIuc2F2ZSgpO1xuICAgICAgICAgICAgLy9cbiAgICAgICAgICAgIC8vIGNvbnN0IGFjY2Vzc1Rva2VuID0gand0LnNpZ24oeyB1c2VySWQ6IHVzZXIuX2lkIH0sIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQsIHtcbiAgICAgICAgICAgIC8vICAgZXhwaXJlc0luOiBwcm9jZXNzLmVudi5KV1RfRVhQSVJBVElPTixcbiAgICAgICAgICAgIC8vIH0pO1xuXG4gICAgICAgICAgICAvLyB1c2VyTWFpbC52ZXJpZnkodXNlcik7XG5cbiAgICAgICAgICAgIC8vIHJldHVybiB7IGFjY2Vzc1Rva2VuIH07XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xuICAgICAgICB9XG4gICAgfSxcbn07XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgICBzaWduSW4sXG4gICAgc2lnblVwLFxuICAgIGxvZ291dCxcbiAgICBuZXdQYXNzd29yZCxcbiAgICBjaGFuZ2VQYXNzd29yZCxcbiAgICB2ZXJpZnksXG4gICAgdmVyaWZ5UmVxdWVzdFxufSJdfQ==","map":{"version":3,"sources":["auth-resolvers.js"],"names":["signIn","name","type","args","phoneNumber","password","resolve","user","UserModel","find","console","log","accessToken","jwt","sign","process","env","JWT_SECRET","expiresIn","JWT_EXPIRATION","error","Promise","reject","signUp","firstName","middleName","lastName","context","phoneVerification","save","_id","logout","succeed","resetPassword","email","findOne","Error","newPassword","token","hash","bcrypt","hashSync","set","account","userId","changePassword","currentPassword","comparePassword","verifyRequest","verify"],"mappings":"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","sourceRoot":"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/auth/resolvers/","sourcesContent":["import jwt from \"jsonwebtoken\";\nimport {UserModel} from \"../../../models/user\";\n// import crypto from \"crypto\";\n\nconst signIn = {\n    name: \"signIn\",\n    type: \"AccessToken!\",\n    args: {\n        phoneNumber: \"String!\",\n        password: \"String!\",\n    },\n    resolve: async ({\n                        args: {\n                            phoneNumber,\n                            password,\n                        },\n                    }) => {\n        try {\n            // const user = await UserModel.phoneNumberExist(phoneNumber);\n            // if (!user) {\n            //     return Promise.reject(new Error(\"User not found.\"));\n            // }\n            const user = await UserModel.find({phoneNumber});\n\n            // const comparePassword = await user.comparePassword(password.toString());\n            // if (!comparePassword) {\n            //     return Promise.reject(new Error(\"Password is incorrect.\"));\n            // }\n\n            console.log(user)\n            const accessToken = await jwt.sign(user, process.env.JWT_SECRET, {\n                expiresIn: process.env.JWT_EXPIRATION,\n            });\n\n            return {\n                accessToken,\n                // roles: user.roles,\n                user,\n            };\n        } catch (error) {\n            return Promise.reject(error);\n        }\n    },\n};\n\n\nconst signUp = {\n    name: \"signUp\",\n    type: \"AccessToken!\",\n    args: {\n        firstName: \"String!\",\n        middleName: \"String!\",\n        lastName: \"String!\",\n        password: \"String!\",\n        phoneNumber: \"String!\",\n    },\n    resolve: async ({\n                        args: {\n                            firstName,\n                            middleName,\n                            lastName,\n                            password,\n                            phoneNumber\n                        },\n                        context: {\n                            phoneVerification,\n                        },\n                    }) => {\n        try {\n            console.log(\"here 1\")\n            // let user = await UserModel.phoneNumberExist(phoneNumber);\n            // if (user) {\n            //     console.log(\"here 2\")\n            //     return Promise.reject(new Error(\"Phone Number has already been taken.\"));\n            // }\n\n            // user = await UserModel.emailExist(email);\n            // if (user) {\n            //   return Promise.reject(new Error(\"Email has already been taken.\"));\n            // }\n            // const salt = bcrypt.genSalt(10);\n            // const hash = bcrypt.hashSync(password, salt);\n\n            let user = await new UserModel({\n                firstName,\n                middleName,\n                lastName,\n                phoneNumber,\n                password,\n                // password: hash,\n                // roles: [roles.OWNER],\n                // account: {\n                //     phoneVerification: {\n                //         verified: true,\n                //         token: phoneVerification,\n                //     },\n                // },\n            }).save();\n            console.log(\"here 3\")\n            const accessToken = await jwt.sign({\n                _id: user._id,\n                firstName: user.firstName,\n                middleName: user.middleName,\n                lastName: user.lastName,\n                phoneNumber: user.phoneNumber,\n                // roles: user.roles,\n            }, process.env.JWT_SECRET, {\n                expiresIn: process.env.JWT_EXPIRATION,\n            });\n\n            // await userService.verifyRequest(user);\n\n            // userMail.verifyRequest(user, token);\n\n            return {\n                accessToken,\n                // roles: user.roles,\n                user,\n            };\n        } catch (error) {\n            return Promise.reject(error);\n        }\n    },\n};\n\nconst logout = {\n    name: 'logout',\n    type: 'Succeed!',\n    resolve: async ({context: {user, accessToken}}) => {\n        try {\n            // await redis.set(`expiredToken:${accessToken}`, user._id, 'EX', process.env.REDIS_TOKEN_EXPIRY);\n\n            return {succeed: true};\n        } catch (error) {\n            return Promise.reject(error);\n        }\n    }\n};\n\nconst resetPassword = {\n    name: \"resetPassword\",\n    type: \"Succeed!\",\n    args: {email: \"String!\"},\n    resolve: async ({args: {email}}) => {\n        try {\n            const user = await UserModel.findOne({email});\n            if (!user) {\n                return Promise.reject(new Error(\"User not found.\"));\n            }\n\n            // const token = crypto.randomBytes(48, (err, buffer) => buffer.toString(\"hex\"));\n            // const expiresIn = moment().add(7, \"days\");\n\n            // user.set({\n            //     account: {\n            //         resetPassword: {\n            //             token,\n            //             expiresIn,\n            //         },\n            //     },\n            // });\n\n            await user.save();\n\n            // userMail.resetPassword(user, token);\n\n            return {succeed: true};\n        } catch (error) {\n            return Promise.reject(error);\n        }\n    },\n};\n\nconst newPassword = {\n    name: \"newPassword\",\n    type: \"AccessToken!\",\n    args: {\n        token: \"String!\",\n        newPassword: \"String!\",\n    },\n    resolve: async ({\n                        args: {\n                            token,\n                            newPassword,\n                        },\n                    }) => {\n        try {\n            const user = await UserModel.findOne({\n                \"account.resetPassword.token\": token,\n            });\n            if (!user) {\n                return Promise.reject(new Error(\"Access Token is not valid or has expired.\"));\n            }\n\n            const hash = bcrypt.hashSync(newPassword, 10);\n\n            user.set({\n                password: hash,\n                account: {\n                    resetPassword: {\n                        token: null,\n                        expiresIn: null,\n                    },\n                },\n            });\n\n            await user.save();\n\n            const accessToken = await jwt.sign({userId: user._id}, process.env.JWT_SECRET, {\n                expiresIn: process.env.JWT_EXPIRATION,\n            });\n\n            return {accessToken};\n        } catch (error) {\n            return Promise.reject(error);\n        }\n    },\n};\n\nconst changePassword = {\n    name: \"changePassword\",\n    type: \"Succeed!\",\n    args: {\n        currentPassword: \"String!\",\n        newPassword: \"String!\",\n    },\n    resolve: async ({\n                        args: {\n                            currentPassword,\n                            newPassword,\n                        },\n                        context: {user},\n                    }) => {\n        try {\n            const comparePassword = await user.comparePassword(currentPassword);\n            if (!comparePassword) {\n                return Promise.reject(new Error(\"Current password is incorrect.\"));\n            }\n\n            const hash = bcrypt.hashSync(newPassword, 10);\n\n            user.set({password: hash});\n\n            await user.save();\n\n            return {succeed: true};\n        } catch (error) {\n            return Promise.reject(error);\n        }\n    },\n};\n\nconst verifyRequest = {\n    name: \"verifyRequest\",\n    type: \"Succeed!\",\n    resolve: async ({context: {user}}) => {\n        try {\n            // await userService.verifyRequest(user);\n\n            // userMail.verifyRequest(user, token);\n\n            return {succeed: true};\n        } catch (error) {\n            return Promise.reject(error);\n        }\n    },\n};\n\nconst verify = {\n    name: \"verify\",\n    type: \"AccessToken!\",\n    args: {token: \"String!\"},\n    resolve: async ({args: {token}}) => {\n        try {\n            // const user = await UserModel.findOne({\n            //   \"account.verification.token\": token,\n            // });\n            // if (!user) {\n            //   return Promise.reject(new Error(\"Access Token is not valid or has expired.\"));\n            // }\n            //\n            // user.set({\n            //   account: {\n            //     verification: {\n            //       verified: true,\n            //       token: null,\n            //       expiresIn: null,\n            //     },\n            //   },\n            // });\n            //\n            // await user.save();\n            //\n            // const accessToken = jwt.sign({ userId: user._id }, process.env.JWT_SECRET, {\n            //   expiresIn: process.env.JWT_EXPIRATION,\n            // });\n\n            // userMail.verify(user);\n\n            // return { accessToken };\n        } catch (error) {\n            return Promise.reject(error);\n        }\n    },\n};\n\nexport default {\n    signIn,\n    signUp,\n    logout,\n    newPassword,\n    changePassword,\n    verify,\n    verifyRequest\n}"]}},"mtime":1648317650632},"{\"assumptions\":{},\"sourceRoot\":\"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/auth/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"filename\":\"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/auth/authentication.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nconst isAuth = async (resolve, source, args, context, info) => {\n  const {\n    user\n  } = context;\n\n  if (!user) {\n    return Promise.reject(new Error(\"You must be authorized.\"));\n  }\n\n  return resolve(source, args, context, info);\n};\n\nconst isGuest = async (resolve, source, args, context, info) => {\n  const {\n    user\n  } = context;\n\n  if (user) {\n    return Promise.reject(new Error(\"You have already authorized.\"));\n  }\n\n  return resolve(source, args, context, info);\n};\n\nvar _default = {\n  isAuth,\n  isGuest\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGhlbnRpY2F0aW9uLmpzIl0sIm5hbWVzIjpbImlzQXV0aCIsInJlc29sdmUiLCJzb3VyY2UiLCJhcmdzIiwiY29udGV4dCIsImluZm8iLCJ1c2VyIiwiUHJvbWlzZSIsInJlamVjdCIsIkVycm9yIiwiaXNHdWVzdCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBLE1BQU1BLE1BQU0sR0FBRyxPQUFPQyxPQUFQLEVBQWdCQyxNQUFoQixFQUF3QkMsSUFBeEIsRUFBOEJDLE9BQTlCLEVBQXVDQyxJQUF2QyxLQUFnRDtBQUMzRCxRQUFNO0FBQUNDLElBQUFBO0FBQUQsTUFBU0YsT0FBZjs7QUFDQSxNQUFJLENBQUNFLElBQUwsRUFBVztBQUNQLFdBQU9DLE9BQU8sQ0FBQ0MsTUFBUixDQUFlLElBQUlDLEtBQUosQ0FBVSx5QkFBVixDQUFmLENBQVA7QUFDSDs7QUFDRCxTQUFPUixPQUFPLENBQUNDLE1BQUQsRUFBU0MsSUFBVCxFQUFlQyxPQUFmLEVBQXdCQyxJQUF4QixDQUFkO0FBQ0gsQ0FORDs7QUFRQSxNQUFNSyxPQUFPLEdBQUcsT0FBT1QsT0FBUCxFQUFnQkMsTUFBaEIsRUFBd0JDLElBQXhCLEVBQThCQyxPQUE5QixFQUF1Q0MsSUFBdkMsS0FBZ0Q7QUFDNUQsUUFBTTtBQUFDQyxJQUFBQTtBQUFELE1BQVNGLE9BQWY7O0FBQ0EsTUFBSUUsSUFBSixFQUFVO0FBQ04sV0FBT0MsT0FBTyxDQUFDQyxNQUFSLENBQWUsSUFBSUMsS0FBSixDQUFVLDhCQUFWLENBQWYsQ0FBUDtBQUNIOztBQUNELFNBQU9SLE9BQU8sQ0FBQ0MsTUFBRCxFQUFTQyxJQUFULEVBQWVDLE9BQWYsRUFBd0JDLElBQXhCLENBQWQ7QUFDSCxDQU5EOztlQVFlO0FBQUNMLEVBQUFBLE1BQUQ7QUFBU1UsRUFBQUE7QUFBVCxDIiwic291cmNlUm9vdCI6Ii9ob21lL25hdGhuYWVsL3Byb2plY3RzL2hhbGV0YS9oYWxldGEtbmV3LWFwaS9zcmMvbWlkZGxld2FyZXMvYXV0aC8iLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBpc0F1dGggPSBhc3luYyAocmVzb2x2ZSwgc291cmNlLCBhcmdzLCBjb250ZXh0LCBpbmZvKSA9PiB7XG4gICAgY29uc3Qge3VzZXJ9ID0gY29udGV4dDtcbiAgICBpZiAoIXVzZXIpIHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcIllvdSBtdXN0IGJlIGF1dGhvcml6ZWQuXCIpKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc29sdmUoc291cmNlLCBhcmdzLCBjb250ZXh0LCBpbmZvKTtcbn07XG5cbmNvbnN0IGlzR3Vlc3QgPSBhc3luYyAocmVzb2x2ZSwgc291cmNlLCBhcmdzLCBjb250ZXh0LCBpbmZvKSA9PiB7XG4gICAgY29uc3Qge3VzZXJ9ID0gY29udGV4dDtcbiAgICBpZiAodXNlcikge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKFwiWW91IGhhdmUgYWxyZWFkeSBhdXRob3JpemVkLlwiKSk7XG4gICAgfVxuICAgIHJldHVybiByZXNvbHZlKHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbyk7XG59O1xuXG5leHBvcnQgZGVmYXVsdCB7aXNBdXRoLCBpc0d1ZXN0fTtcbiJdfQ==","map":{"version":3,"sources":["authentication.js"],"names":["isAuth","resolve","source","args","context","info","user","Promise","reject","Error","isGuest"],"mappings":";;;;;;;AAAA,MAAMA,MAAM,GAAG,OAAOC,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AAC3D,QAAM;AAACC,IAAAA;AAAD,MAASF,OAAf;;AACA,MAAI,CAACE,IAAL,EAAW;AACP,WAAOC,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAU,yBAAV,CAAf,CAAP;AACH;;AACD,SAAOR,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,CAND;;AAQA,MAAMK,OAAO,GAAG,OAAOT,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AAC5D,QAAM;AAACC,IAAAA;AAAD,MAASF,OAAf;;AACA,MAAIE,IAAJ,EAAU;AACN,WAAOC,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAU,8BAAV,CAAf,CAAP;AACH;;AACD,SAAOR,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,CAND;;eAQe;AAACL,EAAAA,MAAD;AAASU,EAAAA;AAAT,C","sourceRoot":"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/auth/","sourcesContent":["const isAuth = async (resolve, source, args, context, info) => {\n    const {user} = context;\n    if (!user) {\n        return Promise.reject(new Error(\"You must be authorized.\"));\n    }\n    return resolve(source, args, context, info);\n};\n\nconst isGuest = async (resolve, source, args, context, info) => {\n    const {user} = context;\n    if (user) {\n        return Promise.reject(new Error(\"You have already authorized.\"));\n    }\n    return resolve(source, args, context, info);\n};\n\nexport default {isAuth, isGuest};\n"]}},"mtime":1648313712832},"{\"assumptions\":{},\"sourceRoot\":\"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/user/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"filename\":\"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/user/index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.UserQuery = exports.UserMutation = void 0;\n\nvar _user = require(\"../../models/user\");\n\nvar _middlewares = require(\"../../middlewares\");\n\n// import Resolvers from \"./services\";\n//\n// for (const resolver in Resolvers) {\n//     UserTC.addResolver(Resolvers[resolver]);\n// }\nconst UserQuery = {\n  userById: _user.UserTC.getResolver(\"findById\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userByIds: _user.UserTC.getResolver(\"findByIds\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userOne: _user.UserTC.getResolver(\"findOne\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userMany: _user.UserTC.getResolver(\"findMany\", [_middlewares.authentication.isAuth, _middlewares.authorization])\n};\nexports.UserQuery = UserQuery;\nconst UserMutation = {\n  userCreateOne: _user.UserTC.getResolver(\"createOne\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userCreateMany: _user.UserTC.getResolver(\"createMany\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userUpdateById: _user.UserTC.getResolver(\"updateById\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userUpdateOne: _user.UserTC.getResolver(\"updateOne\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userUpdateMany: _user.UserTC.getResolver(\"updateMany\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userRemoveById: _user.UserTC.getResolver(\"removeById\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userRemoveOne: _user.UserTC.getResolver(\"removeOne\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userRemoveMany: _user.UserTC.getResolver(\"removeMany\", [_middlewares.authentication.isAuth, _middlewares.authorization])\n};\nexports.UserMutation = UserMutation;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbIlVzZXJRdWVyeSIsInVzZXJCeUlkIiwiVXNlclRDIiwiZ2V0UmVzb2x2ZXIiLCJhdXRoZW50aWNhdGlvbiIsImlzQXV0aCIsImF1dGhvcml6YXRpb24iLCJ1c2VyQnlJZHMiLCJ1c2VyT25lIiwidXNlck1hbnkiLCJVc2VyTXV0YXRpb24iLCJ1c2VyQ3JlYXRlT25lIiwidXNlckNyZWF0ZU1hbnkiLCJ1c2VyVXBkYXRlQnlJZCIsInVzZXJVcGRhdGVPbmUiLCJ1c2VyVXBkYXRlTWFueSIsInVzZXJSZW1vdmVCeUlkIiwidXNlclJlbW92ZU9uZSIsInVzZXJSZW1vdmVNYW55Il0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBRUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBLE1BQU1BLFNBQVMsR0FBRztBQUNkQyxFQUFBQSxRQUFRLEVBQUVDLGFBQU9DLFdBQVAsQ0FBbUIsVUFBbkIsRUFBK0IsQ0FBQ0MsNEJBQWVDLE1BQWhCLEVBQXdCQywwQkFBeEIsQ0FBL0IsQ0FESTtBQUVkQyxFQUFBQSxTQUFTLEVBQUVMLGFBQU9DLFdBQVAsQ0FBbUIsV0FBbkIsRUFBZ0MsQ0FBQ0MsNEJBQWVDLE1BQWhCLEVBQXdCQywwQkFBeEIsQ0FBaEMsQ0FGRztBQUdkRSxFQUFBQSxPQUFPLEVBQUVOLGFBQU9DLFdBQVAsQ0FBbUIsU0FBbkIsRUFBOEIsQ0FBQ0MsNEJBQWVDLE1BQWhCLEVBQXdCQywwQkFBeEIsQ0FBOUIsQ0FISztBQUlkRyxFQUFBQSxRQUFRLEVBQUVQLGFBQU9DLFdBQVAsQ0FBbUIsVUFBbkIsRUFBK0IsQ0FBQ0MsNEJBQWVDLE1BQWhCLEVBQXdCQywwQkFBeEIsQ0FBL0I7QUFKSSxDQUFsQjs7QUFPQSxNQUFNSSxZQUFZLEdBQUc7QUFDakJDLEVBQUFBLGFBQWEsRUFBRVQsYUFBT0MsV0FBUCxDQUFtQixXQUFuQixFQUFnQyxDQUFDQyw0QkFBZUMsTUFBaEIsRUFBd0JDLDBCQUF4QixDQUFoQyxDQURFO0FBRWpCTSxFQUFBQSxjQUFjLEVBQUVWLGFBQU9DLFdBQVAsQ0FBbUIsWUFBbkIsRUFBaUMsQ0FBQ0MsNEJBQWVDLE1BQWhCLEVBQXdCQywwQkFBeEIsQ0FBakMsQ0FGQztBQUdqQk8sRUFBQUEsY0FBYyxFQUFFWCxhQUFPQyxXQUFQLENBQW1CLFlBQW5CLEVBQWlDLENBQUNDLDRCQUFlQyxNQUFoQixFQUF3QkMsMEJBQXhCLENBQWpDLENBSEM7QUFJakJRLEVBQUFBLGFBQWEsRUFBRVosYUFBT0MsV0FBUCxDQUFtQixXQUFuQixFQUFnQyxDQUFDQyw0QkFBZUMsTUFBaEIsRUFBd0JDLDBCQUF4QixDQUFoQyxDQUpFO0FBS2pCUyxFQUFBQSxjQUFjLEVBQUViLGFBQU9DLFdBQVAsQ0FBbUIsWUFBbkIsRUFBaUMsQ0FBQ0MsNEJBQWVDLE1BQWhCLEVBQXdCQywwQkFBeEIsQ0FBakMsQ0FMQztBQU1qQlUsRUFBQUEsY0FBYyxFQUFFZCxhQUFPQyxXQUFQLENBQW1CLFlBQW5CLEVBQWlDLENBQUNDLDRCQUFlQyxNQUFoQixFQUF3QkMsMEJBQXhCLENBQWpDLENBTkM7QUFPakJXLEVBQUFBLGFBQWEsRUFBRWYsYUFBT0MsV0FBUCxDQUFtQixXQUFuQixFQUFnQyxDQUFDQyw0QkFBZUMsTUFBaEIsRUFBd0JDLDBCQUF4QixDQUFoQyxDQVBFO0FBUWpCWSxFQUFBQSxjQUFjLEVBQUVoQixhQUFPQyxXQUFQLENBQW1CLFlBQW5CLEVBQWlDLENBQUNDLDRCQUFlQyxNQUFoQixFQUF3QkMsMEJBQXhCLENBQWpDO0FBUkMsQ0FBckIiLCJzb3VyY2VSb290IjoiL2hvbWUvbmF0aG5hZWwvcHJvamVjdHMvaGFsZXRhL2hhbGV0YS1uZXctYXBpL3NyYy9ncmFwaHFsL3VzZXIvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtVc2VyVEN9IGZyb20gXCIuLi8uLi9tb2RlbHMvdXNlclwiO1xuXG5pbXBvcnQge2F1dGhlbnRpY2F0aW9uLCBhdXRob3JpemF0aW9ufSBmcm9tIFwiLi4vLi4vbWlkZGxld2FyZXNcIjtcbi8vIGltcG9ydCBSZXNvbHZlcnMgZnJvbSBcIi4vc2VydmljZXNcIjtcbi8vXG4vLyBmb3IgKGNvbnN0IHJlc29sdmVyIGluIFJlc29sdmVycykge1xuLy8gICAgIFVzZXJUQy5hZGRSZXNvbHZlcihSZXNvbHZlcnNbcmVzb2x2ZXJdKTtcbi8vIH1cblxuY29uc3QgVXNlclF1ZXJ5ID0ge1xuICAgIHVzZXJCeUlkOiBVc2VyVEMuZ2V0UmVzb2x2ZXIoXCJmaW5kQnlJZFwiLCBbYXV0aGVudGljYXRpb24uaXNBdXRoLCBhdXRob3JpemF0aW9uXSksXG4gICAgdXNlckJ5SWRzOiBVc2VyVEMuZ2V0UmVzb2x2ZXIoXCJmaW5kQnlJZHNcIiwgW2F1dGhlbnRpY2F0aW9uLmlzQXV0aCwgYXV0aG9yaXphdGlvbl0pLFxuICAgIHVzZXJPbmU6IFVzZXJUQy5nZXRSZXNvbHZlcihcImZpbmRPbmVcIiwgW2F1dGhlbnRpY2F0aW9uLmlzQXV0aCwgYXV0aG9yaXphdGlvbl0pLFxuICAgIHVzZXJNYW55OiBVc2VyVEMuZ2V0UmVzb2x2ZXIoXCJmaW5kTWFueVwiLCBbYXV0aGVudGljYXRpb24uaXNBdXRoLCBhdXRob3JpemF0aW9uXSksXG59O1xuXG5jb25zdCBVc2VyTXV0YXRpb24gPSB7XG4gICAgdXNlckNyZWF0ZU9uZTogVXNlclRDLmdldFJlc29sdmVyKFwiY3JlYXRlT25lXCIsIFthdXRoZW50aWNhdGlvbi5pc0F1dGgsIGF1dGhvcml6YXRpb25dKSxcbiAgICB1c2VyQ3JlYXRlTWFueTogVXNlclRDLmdldFJlc29sdmVyKFwiY3JlYXRlTWFueVwiLCBbYXV0aGVudGljYXRpb24uaXNBdXRoLCBhdXRob3JpemF0aW9uXSksXG4gICAgdXNlclVwZGF0ZUJ5SWQ6IFVzZXJUQy5nZXRSZXNvbHZlcihcInVwZGF0ZUJ5SWRcIiwgW2F1dGhlbnRpY2F0aW9uLmlzQXV0aCwgYXV0aG9yaXphdGlvbl0pLFxuICAgIHVzZXJVcGRhdGVPbmU6IFVzZXJUQy5nZXRSZXNvbHZlcihcInVwZGF0ZU9uZVwiLCBbYXV0aGVudGljYXRpb24uaXNBdXRoLCBhdXRob3JpemF0aW9uXSksXG4gICAgdXNlclVwZGF0ZU1hbnk6IFVzZXJUQy5nZXRSZXNvbHZlcihcInVwZGF0ZU1hbnlcIiwgW2F1dGhlbnRpY2F0aW9uLmlzQXV0aCwgYXV0aG9yaXphdGlvbl0pLFxuICAgIHVzZXJSZW1vdmVCeUlkOiBVc2VyVEMuZ2V0UmVzb2x2ZXIoXCJyZW1vdmVCeUlkXCIsIFthdXRoZW50aWNhdGlvbi5pc0F1dGgsIGF1dGhvcml6YXRpb25dKSxcbiAgICB1c2VyUmVtb3ZlT25lOiBVc2VyVEMuZ2V0UmVzb2x2ZXIoXCJyZW1vdmVPbmVcIiwgW2F1dGhlbnRpY2F0aW9uLmlzQXV0aCwgYXV0aG9yaXphdGlvbl0pLFxuICAgIHVzZXJSZW1vdmVNYW55OiBVc2VyVEMuZ2V0UmVzb2x2ZXIoXCJyZW1vdmVNYW55XCIsIFthdXRoZW50aWNhdGlvbi5pc0F1dGgsIGF1dGhvcml6YXRpb25dKSxcbn07XG5cbmV4cG9ydCB7VXNlclF1ZXJ5LCBVc2VyTXV0YXRpb259O1xuIl19","map":{"version":3,"sources":["index.js"],"names":["UserQuery","userById","UserTC","getResolver","authentication","isAuth","authorization","userByIds","userOne","userMany","UserMutation","userCreateOne","userCreateMany","userUpdateById","userUpdateOne","userUpdateMany","userRemoveById","userRemoveOne","userRemoveMany"],"mappings":";;;;;;;AAAA;;AAEA;;AACA;AACA;AACA;AACA;AACA;AAEA,MAAMA,SAAS,GAAG;AACdC,EAAAA,QAAQ,EAAEC,aAAOC,WAAP,CAAmB,UAAnB,EAA+B,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAA/B,CADI;AAEdC,EAAAA,SAAS,EAAEL,aAAOC,WAAP,CAAmB,WAAnB,EAAgC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAhC,CAFG;AAGdE,EAAAA,OAAO,EAAEN,aAAOC,WAAP,CAAmB,SAAnB,EAA8B,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAA9B,CAHK;AAIdG,EAAAA,QAAQ,EAAEP,aAAOC,WAAP,CAAmB,UAAnB,EAA+B,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAA/B;AAJI,CAAlB;;AAOA,MAAMI,YAAY,GAAG;AACjBC,EAAAA,aAAa,EAAET,aAAOC,WAAP,CAAmB,WAAnB,EAAgC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAhC,CADE;AAEjBM,EAAAA,cAAc,EAAEV,aAAOC,WAAP,CAAmB,YAAnB,EAAiC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAjC,CAFC;AAGjBO,EAAAA,cAAc,EAAEX,aAAOC,WAAP,CAAmB,YAAnB,EAAiC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAjC,CAHC;AAIjBQ,EAAAA,aAAa,EAAEZ,aAAOC,WAAP,CAAmB,WAAnB,EAAgC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAhC,CAJE;AAKjBS,EAAAA,cAAc,EAAEb,aAAOC,WAAP,CAAmB,YAAnB,EAAiC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAjC,CALC;AAMjBU,EAAAA,cAAc,EAAEd,aAAOC,WAAP,CAAmB,YAAnB,EAAiC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAjC,CANC;AAOjBW,EAAAA,aAAa,EAAEf,aAAOC,WAAP,CAAmB,WAAnB,EAAgC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAhC,CAPE;AAQjBY,EAAAA,cAAc,EAAEhB,aAAOC,WAAP,CAAmB,YAAnB,EAAiC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAjC;AARC,CAArB","sourceRoot":"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/user/","sourcesContent":["import {UserTC} from \"../../models/user\";\n\nimport {authentication, authorization} from \"../../middlewares\";\n// import Resolvers from \"./services\";\n//\n// for (const resolver in Resolvers) {\n//     UserTC.addResolver(Resolvers[resolver]);\n// }\n\nconst UserQuery = {\n    userById: UserTC.getResolver(\"findById\", [authentication.isAuth, authorization]),\n    userByIds: UserTC.getResolver(\"findByIds\", [authentication.isAuth, authorization]),\n    userOne: UserTC.getResolver(\"findOne\", [authentication.isAuth, authorization]),\n    userMany: UserTC.getResolver(\"findMany\", [authentication.isAuth, authorization]),\n};\n\nconst UserMutation = {\n    userCreateOne: UserTC.getResolver(\"createOne\", [authentication.isAuth, authorization]),\n    userCreateMany: UserTC.getResolver(\"createMany\", [authentication.isAuth, authorization]),\n    userUpdateById: UserTC.getResolver(\"updateById\", [authentication.isAuth, authorization]),\n    userUpdateOne: UserTC.getResolver(\"updateOne\", [authentication.isAuth, authorization]),\n    userUpdateMany: UserTC.getResolver(\"updateMany\", [authentication.isAuth, authorization]),\n    userRemoveById: UserTC.getResolver(\"removeById\", [authentication.isAuth, authorization]),\n    userRemoveOne: UserTC.getResolver(\"removeOne\", [authentication.isAuth, authorization]),\n    userRemoveMany: UserTC.getResolver(\"removeMany\", [authentication.isAuth, authorization]),\n};\n\nexport {UserQuery, UserMutation};\n"]}},"mtime":1648317682657},"{\"assumptions\":{},\"sourceRoot\":\"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/auth/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"filename\":\"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/auth/authorization.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n//list from redis, list of functions for each role\nconst accessList = {\n  ADMIN: [\"findMany\", \"createOne\"],\n  SUPER_ADMIN: [\"findMany\", \"createOne\"],\n  NORMAL: [],\n  TUTOR: [],\n  CUSTOMER_SERVICE: []\n};\n\nconst authorization = async (resolve, source, args, context, info) => {\n  const {\n    user\n  } = context;\n  const fieldName = info.fieldName;\n  let hasAccess = false; //list from redis, list of functions for each role\n\n  user.roles.forEach(role => {\n    if (accessList[role].includes(fieldName)) {\n      hasAccess = true;\n    }\n  });\n\n  if (!hasAccess) {\n    return Promise.reject(new Error(\"Access denied.\"));\n  }\n\n  return resolve(source, args, context, info);\n};\n\nvar _default = authorization;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGhvcml6YXRpb24uanMiXSwibmFtZXMiOlsiYWNjZXNzTGlzdCIsIkFETUlOIiwiU1VQRVJfQURNSU4iLCJOT1JNQUwiLCJUVVRPUiIsIkNVU1RPTUVSX1NFUlZJQ0UiLCJhdXRob3JpemF0aW9uIiwicmVzb2x2ZSIsInNvdXJjZSIsImFyZ3MiLCJjb250ZXh0IiwiaW5mbyIsInVzZXIiLCJmaWVsZE5hbWUiLCJoYXNBY2Nlc3MiLCJyb2xlcyIsImZvckVhY2giLCJyb2xlIiwiaW5jbHVkZXMiLCJQcm9taXNlIiwicmVqZWN0IiwiRXJyb3IiXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBQ0EsTUFBTUEsVUFBVSxHQUFHO0FBQ2ZDLEVBQUFBLEtBQUssRUFBRSxDQUFDLFVBQUQsRUFBYSxXQUFiLENBRFE7QUFFZkMsRUFBQUEsV0FBVyxFQUFFLENBQUMsVUFBRCxFQUFhLFdBQWIsQ0FGRTtBQUdmQyxFQUFBQSxNQUFNLEVBQUUsRUFITztBQUlmQyxFQUFBQSxLQUFLLEVBQUUsRUFKUTtBQUtmQyxFQUFBQSxnQkFBZ0IsRUFBRTtBQUxILENBQW5COztBQVFBLE1BQU1DLGFBQWEsR0FBRyxPQUFPQyxPQUFQLEVBQWdCQyxNQUFoQixFQUF3QkMsSUFBeEIsRUFBOEJDLE9BQTlCLEVBQXVDQyxJQUF2QyxLQUFnRDtBQUNsRSxRQUFNO0FBQUNDLElBQUFBO0FBQUQsTUFBU0YsT0FBZjtBQUNBLFFBQU1HLFNBQVMsR0FBR0YsSUFBSSxDQUFDRSxTQUF2QjtBQUNBLE1BQUlDLFNBQVMsR0FBRyxLQUFoQixDQUhrRSxDQUlsRTs7QUFDQUYsRUFBQUEsSUFBSSxDQUFDRyxLQUFMLENBQVdDLE9BQVgsQ0FBbUJDLElBQUksSUFBSTtBQUN2QixRQUFHakIsVUFBVSxDQUFDaUIsSUFBRCxDQUFWLENBQWlCQyxRQUFqQixDQUEwQkwsU0FBMUIsQ0FBSCxFQUF3QztBQUNwQ0MsTUFBQUEsU0FBUyxHQUFHLElBQVo7QUFDSDtBQUNKLEdBSkQ7O0FBS0EsTUFBSSxDQUFDQSxTQUFMLEVBQWdCO0FBQ1osV0FBT0ssT0FBTyxDQUFDQyxNQUFSLENBQWUsSUFBSUMsS0FBSixDQUFVLGdCQUFWLENBQWYsQ0FBUDtBQUNIOztBQUNELFNBQU9kLE9BQU8sQ0FBQ0MsTUFBRCxFQUFTQyxJQUFULEVBQWVDLE9BQWYsRUFBd0JDLElBQXhCLENBQWQ7QUFDSCxDQWREOztlQWdCZUwsYSIsInNvdXJjZVJvb3QiOiIvaG9tZS9uYXRobmFlbC9wcm9qZWN0cy9oYWxldGEvaGFsZXRhLW5ldy1hcGkvc3JjL21pZGRsZXdhcmVzL2F1dGgvIiwic291cmNlc0NvbnRlbnQiOlsiLy9saXN0IGZyb20gcmVkaXMsIGxpc3Qgb2YgZnVuY3Rpb25zIGZvciBlYWNoIHJvbGVcbmNvbnN0IGFjY2Vzc0xpc3QgPSB7XG4gICAgQURNSU46IFtcImZpbmRNYW55XCIsIFwiY3JlYXRlT25lXCJdLFxuICAgIFNVUEVSX0FETUlOOiBbXCJmaW5kTWFueVwiLCBcImNyZWF0ZU9uZVwiXSxcbiAgICBOT1JNQUw6IFtdLFxuICAgIFRVVE9SOiBbXSxcbiAgICBDVVNUT01FUl9TRVJWSUNFOiBbXSxcbn07XG5cbmNvbnN0IGF1dGhvcml6YXRpb24gPSBhc3luYyAocmVzb2x2ZSwgc291cmNlLCBhcmdzLCBjb250ZXh0LCBpbmZvKSA9PiB7XG4gICAgY29uc3Qge3VzZXJ9ID0gY29udGV4dDtcbiAgICBjb25zdCBmaWVsZE5hbWUgPSBpbmZvLmZpZWxkTmFtZVxuICAgIGxldCBoYXNBY2Nlc3MgPSBmYWxzZVxuICAgIC8vbGlzdCBmcm9tIHJlZGlzLCBsaXN0IG9mIGZ1bmN0aW9ucyBmb3IgZWFjaCByb2xlXG4gICAgdXNlci5yb2xlcy5mb3JFYWNoKHJvbGUgPT4ge1xuICAgICAgICBpZihhY2Nlc3NMaXN0W3JvbGVdLmluY2x1ZGVzKGZpZWxkTmFtZSkpe1xuICAgICAgICAgICAgaGFzQWNjZXNzID0gdHJ1ZVxuICAgICAgICB9XG4gICAgfSlcbiAgICBpZiAoIWhhc0FjY2Vzcykge1xuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKFwiQWNjZXNzIGRlbmllZC5cIikpO1xuICAgIH1cbiAgICByZXR1cm4gcmVzb2x2ZShzb3VyY2UsIGFyZ3MsIGNvbnRleHQsIGluZm8pO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgYXV0aG9yaXphdGlvbjtcbiJdfQ==","map":{"version":3,"sources":["authorization.js"],"names":["accessList","ADMIN","SUPER_ADMIN","NORMAL","TUTOR","CUSTOMER_SERVICE","authorization","resolve","source","args","context","info","user","fieldName","hasAccess","roles","forEach","role","includes","Promise","reject","Error"],"mappings":";;;;;;AAAA;AACA,MAAMA,UAAU,GAAG;AACfC,EAAAA,KAAK,EAAE,CAAC,UAAD,EAAa,WAAb,CADQ;AAEfC,EAAAA,WAAW,EAAE,CAAC,UAAD,EAAa,WAAb,CAFE;AAGfC,EAAAA,MAAM,EAAE,EAHO;AAIfC,EAAAA,KAAK,EAAE,EAJQ;AAKfC,EAAAA,gBAAgB,EAAE;AALH,CAAnB;;AAQA,MAAMC,aAAa,GAAG,OAAOC,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AAClE,QAAM;AAACC,IAAAA;AAAD,MAASF,OAAf;AACA,QAAMG,SAAS,GAAGF,IAAI,CAACE,SAAvB;AACA,MAAIC,SAAS,GAAG,KAAhB,CAHkE,CAIlE;;AACAF,EAAAA,IAAI,CAACG,KAAL,CAAWC,OAAX,CAAmBC,IAAI,IAAI;AACvB,QAAGjB,UAAU,CAACiB,IAAD,CAAV,CAAiBC,QAAjB,CAA0BL,SAA1B,CAAH,EAAwC;AACpCC,MAAAA,SAAS,GAAG,IAAZ;AACH;AACJ,GAJD;;AAKA,MAAI,CAACA,SAAL,EAAgB;AACZ,WAAOK,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAU,gBAAV,CAAf,CAAP;AACH;;AACD,SAAOd,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,CAdD;;eAgBeL,a","sourceRoot":"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/auth/","sourcesContent":["//list from redis, list of functions for each role\nconst accessList = {\n    ADMIN: [\"findMany\", \"createOne\"],\n    SUPER_ADMIN: [\"findMany\", \"createOne\"],\n    NORMAL: [],\n    TUTOR: [],\n    CUSTOMER_SERVICE: [],\n};\n\nconst authorization = async (resolve, source, args, context, info) => {\n    const {user} = context;\n    const fieldName = info.fieldName\n    let hasAccess = false\n    //list from redis, list of functions for each role\n    user.roles.forEach(role => {\n        if(accessList[role].includes(fieldName)){\n            hasAccess = true\n        }\n    })\n    if (!hasAccess) {\n        return Promise.reject(new Error(\"Access denied.\"));\n    }\n    return resolve(source, args, context, info);\n};\n\nexport default authorization;\n"]}},"mtime":1648313712832},"{\"assumptions\":{},\"sourceRoot\":\"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/auth/typedefs/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"filename\":\"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/auth/typedefs/types.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nvar _graphqlCompose = require(\"graphql-compose\");\n\nvar _user = require(\"../../../models/user\");\n\n_graphqlCompose.schemaComposer.createObjectTC({\n  name: \"AccessToken\",\n  fields: {\n    accessToken: \"String!\",\n    roles: \"[String]\",\n    user: _user.UserTC\n  }\n});\n\n_graphqlCompose.schemaComposer.createObjectTC({\n  name: \"Succeed\",\n  fields: {\n    succeed: \"Boolean!\"\n  }\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInR5cGVzLmpzIl0sIm5hbWVzIjpbInNjaGVtYUNvbXBvc2VyIiwiY3JlYXRlT2JqZWN0VEMiLCJuYW1lIiwiZmllbGRzIiwiYWNjZXNzVG9rZW4iLCJyb2xlcyIsInVzZXIiLCJVc2VyVEMiLCJzdWNjZWVkIl0sIm1hcHBpbmdzIjoiOztBQUFBOztBQUNBOztBQUVBQSwrQkFBZUMsY0FBZixDQUE4QjtBQUMxQkMsRUFBQUEsSUFBSSxFQUFFLGFBRG9CO0FBRTFCQyxFQUFBQSxNQUFNLEVBQUU7QUFDSkMsSUFBQUEsV0FBVyxFQUFFLFNBRFQ7QUFFSkMsSUFBQUEsS0FBSyxFQUFFLFVBRkg7QUFHSkMsSUFBQUEsSUFBSSxFQUFFQztBQUhGO0FBRmtCLENBQTlCOztBQVNBUCwrQkFBZUMsY0FBZixDQUE4QjtBQUMxQkMsRUFBQUEsSUFBSSxFQUFFLFNBRG9CO0FBRTFCQyxFQUFBQSxNQUFNLEVBQUU7QUFBQ0ssSUFBQUEsT0FBTyxFQUFFO0FBQVY7QUFGa0IsQ0FBOUIiLCJzb3VyY2VSb290IjoiL2hvbWUvbmF0aG5hZWwvcHJvamVjdHMvaGFsZXRhL2hhbGV0YS1uZXctYXBpL3NyYy9ncmFwaHFsL2F1dGgvdHlwZWRlZnMvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtzY2hlbWFDb21wb3Nlcn0gZnJvbSBcImdyYXBocWwtY29tcG9zZVwiO1xuaW1wb3J0IHtVc2VyVEN9IGZyb20gXCIuLi8uLi8uLi9tb2RlbHMvdXNlclwiO1xuXG5zY2hlbWFDb21wb3Nlci5jcmVhdGVPYmplY3RUQyh7XG4gICAgbmFtZTogXCJBY2Nlc3NUb2tlblwiLFxuICAgIGZpZWxkczoge1xuICAgICAgICBhY2Nlc3NUb2tlbjogXCJTdHJpbmchXCIsXG4gICAgICAgIHJvbGVzOiBcIltTdHJpbmddXCIsXG4gICAgICAgIHVzZXI6IFVzZXJUQyxcbiAgICB9LFxufSk7XG5cbnNjaGVtYUNvbXBvc2VyLmNyZWF0ZU9iamVjdFRDKHtcbiAgICBuYW1lOiBcIlN1Y2NlZWRcIixcbiAgICBmaWVsZHM6IHtzdWNjZWVkOiBcIkJvb2xlYW4hXCJ9LFxufSk7Il19","map":{"version":3,"sources":["types.js"],"names":["schemaComposer","createObjectTC","name","fields","accessToken","roles","user","UserTC","succeed"],"mappings":";;AAAA;;AACA;;AAEAA,+BAAeC,cAAf,CAA8B;AAC1BC,EAAAA,IAAI,EAAE,aADoB;AAE1BC,EAAAA,MAAM,EAAE;AACJC,IAAAA,WAAW,EAAE,SADT;AAEJC,IAAAA,KAAK,EAAE,UAFH;AAGJC,IAAAA,IAAI,EAAEC;AAHF;AAFkB,CAA9B;;AASAP,+BAAeC,cAAf,CAA8B;AAC1BC,EAAAA,IAAI,EAAE,SADoB;AAE1BC,EAAAA,MAAM,EAAE;AAACK,IAAAA,OAAO,EAAE;AAAV;AAFkB,CAA9B","sourceRoot":"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/auth/typedefs/","sourcesContent":["import {schemaComposer} from \"graphql-compose\";\nimport {UserTC} from \"../../../models/user\";\n\nschemaComposer.createObjectTC({\n    name: \"AccessToken\",\n    fields: {\n        accessToken: \"String!\",\n        roles: \"[String]\",\n        user: UserTC,\n    },\n});\n\nschemaComposer.createObjectTC({\n    name: \"Succeed\",\n    fields: {succeed: \"Boolean!\"},\n});"]}},"mtime":1648313712828},"{\"assumptions\":{},\"sourceRoot\":\"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/auth/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"filename\":\"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/auth/validate-token.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\n\nvar _user = require(\"../../models/user\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// import redis from \"../config/redis-config\";\nconst validateToken = async (req, res, next) => {\n  try {\n    const authorization = req.headers.authorization;\n    Object.assign(req.headers, {\n      user: null,\n      authorization: null\n    });\n\n    if (!authorization) {\n      return next();\n    }\n\n    const accessToken = authorization.split(\" \")[1];\n    let decoded;\n\n    if (accessToken) {\n      decoded = _jsonwebtoken.default.verify(accessToken, process.env.JWT_SECRET);\n    }\n\n    if (!decoded) {\n      // invalid token, remove the token from everywhere\n      //remove from database\n      //remove from redis\n      return next();\n    }\n\n    if (decoded.exp * 1000 < Date.now()) {\n      //remove from database\n      //remove from redis\n      return next();\n    } //check if token is in redis\n    //if NOT in redis call next()\n    //else check last update time if greater than or equals to 1hour update the token\n    // if less skip else update token\n    // authorization = new token\n\n\n    const user = await _user.UserModel.findById(decoded.userId);\n\n    if (!user) {\n      //remove from database\n      //remove from redis\n      return next();\n    } // if the token has come all this way everything is good just attach it to the request header\n    //attach it to https response cookie\n\n\n    Object.assign(req.headers, {\n      user,\n      authorization\n    });\n    res.cookie(\"jwt\", authorization, {\n      secure: true,\n      httpOnly: true\n    });\n    return next();\n  } catch (error) {\n    console.log(error);\n    return Promise.reject(new Error(\"Error Happened!\"));\n  }\n};\n\nvar _default = validateToken; // ------------- authorization ------------------\n// let check_user_action = async (req,action,resource) =>{\n//   if(!['updateOwn','deleteOwn'].includes(action)){\n//     return true\n//   }\n//\n//   const userResource = new Set()\n//\n//   if(resource == 'tender'){\n//     let userTender = await Tender.find({ creator_user: req.user._id })\n//     userTender.forEach(tender => userResource.add(`${tender._id}`))\n//\n//   }else if(resource == 'company'){\n//     let userCompany = await Company.find({ creator_user: req.user._id })\n//     userCompany.forEach(company => userResource.add( `${company._id}`))\n//\n//   }else if(resource == 'award'){\n//     let userAward = await Award.find({ creator_user: req.user._id })\n//     userAward.forEach(award => userResource.add(`${award._id}`))\n//   }\n//\n//   if(!userResource.has(req.params.id)){\n//     return false\n//   }\n//\n//   return true\n// }\n//\n//\n//\n// exports.authorize = function (action, resource) {\n//   return async (req, res, next) => {\n//     try {\n//       const permission = roles.can(req.user.role)[action](resource);\n//\n//       if (!permission.granted) {\n//         return res.status(401).send(\"You don't have enough permission to perform this action\");\n//       }\n//\n//       let result = await check_user_action(req,action,resource)\n//       if(!result){\n//         return res.status(401).send({ param: resource , msg: `You are not authorized to edit this ${resource}.` })\n//       }\n//\n//       next()\n//     } catch (error) {\n//       return res.status(401).send(\"You don't have enough permission to perform this action\")\n//     }\n//   }\n// }\n\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInZhbGlkYXRlLXRva2VuLmpzIl0sIm5hbWVzIjpbInZhbGlkYXRlVG9rZW4iLCJyZXEiLCJyZXMiLCJuZXh0IiwiYXV0aG9yaXphdGlvbiIsImhlYWRlcnMiLCJPYmplY3QiLCJhc3NpZ24iLCJ1c2VyIiwiYWNjZXNzVG9rZW4iLCJzcGxpdCIsImRlY29kZWQiLCJqd3QiLCJ2ZXJpZnkiLCJwcm9jZXNzIiwiZW52IiwiSldUX1NFQ1JFVCIsImV4cCIsIkRhdGUiLCJub3ciLCJVc2VyTW9kZWwiLCJmaW5kQnlJZCIsInVzZXJJZCIsImNvb2tpZSIsInNlY3VyZSIsImh0dHBPbmx5IiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwiUHJvbWlzZSIsInJlamVjdCIsIkVycm9yIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBR0E7Ozs7QUFEQTtBQUdBLE1BQU1BLGFBQWEsR0FBRyxPQUFPQyxHQUFQLEVBQVlDLEdBQVosRUFBaUJDLElBQWpCLEtBQTBCO0FBQzVDLE1BQUk7QUFDQSxVQUFNQyxhQUFhLEdBQUdILEdBQUcsQ0FBQ0ksT0FBSixDQUFZRCxhQUFsQztBQUVBRSxJQUFBQSxNQUFNLENBQUNDLE1BQVAsQ0FBY04sR0FBRyxDQUFDSSxPQUFsQixFQUEyQjtBQUN2QkcsTUFBQUEsSUFBSSxFQUFFLElBRGlCO0FBRXZCSixNQUFBQSxhQUFhLEVBQUU7QUFGUSxLQUEzQjs7QUFLQSxRQUFJLENBQUNBLGFBQUwsRUFBb0I7QUFDaEIsYUFBT0QsSUFBSSxFQUFYO0FBQ0g7O0FBRUQsVUFBTU0sV0FBVyxHQUFHTCxhQUFhLENBQUNNLEtBQWQsQ0FBb0IsR0FBcEIsRUFBeUIsQ0FBekIsQ0FBcEI7QUFFQSxRQUFJQyxPQUFKOztBQUNBLFFBQUlGLFdBQUosRUFBaUI7QUFDYkUsTUFBQUEsT0FBTyxHQUFHQyxzQkFBSUMsTUFBSixDQUFXSixXQUFYLEVBQXdCSyxPQUFPLENBQUNDLEdBQVIsQ0FBWUMsVUFBcEMsQ0FBVjtBQUNIOztBQUNELFFBQUksQ0FBQ0wsT0FBTCxFQUFjO0FBQ1Y7QUFDQTtBQUNBO0FBQ0EsYUFBT1IsSUFBSSxFQUFYO0FBQ0g7O0FBRUQsUUFBSVEsT0FBTyxDQUFDTSxHQUFSLEdBQWMsSUFBZCxHQUFxQkMsSUFBSSxDQUFDQyxHQUFMLEVBQXpCLEVBQXFDO0FBQ2pDO0FBQ0E7QUFDQSxhQUFPaEIsSUFBSSxFQUFYO0FBQ0gsS0E3QkQsQ0ErQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBRUEsVUFBTUssSUFBSSxHQUFHLE1BQU1ZLGdCQUFVQyxRQUFWLENBQW1CVixPQUFPLENBQUNXLE1BQTNCLENBQW5COztBQUNBLFFBQUksQ0FBQ2QsSUFBTCxFQUFXO0FBQ1A7QUFDQTtBQUNBLGFBQU9MLElBQUksRUFBWDtBQUNILEtBMUNELENBNENBO0FBQ0E7OztBQUNBRyxJQUFBQSxNQUFNLENBQUNDLE1BQVAsQ0FBY04sR0FBRyxDQUFDSSxPQUFsQixFQUEyQjtBQUN2QkcsTUFBQUEsSUFEdUI7QUFFdkJKLE1BQUFBO0FBRnVCLEtBQTNCO0FBS0FGLElBQUFBLEdBQUcsQ0FBQ3FCLE1BQUosQ0FBVyxLQUFYLEVBQWtCbkIsYUFBbEIsRUFBaUM7QUFBQ29CLE1BQUFBLE1BQU0sRUFBRSxJQUFUO0FBQWVDLE1BQUFBLFFBQVEsRUFBRTtBQUF6QixLQUFqQztBQUVBLFdBQU90QixJQUFJLEVBQVg7QUFDSCxHQXRERCxDQXNERSxPQUFPdUIsS0FBUCxFQUFjO0FBQ1pDLElBQUFBLE9BQU8sQ0FBQ0MsR0FBUixDQUFZRixLQUFaO0FBQ0EsV0FBT0csT0FBTyxDQUFDQyxNQUFSLENBQWUsSUFBSUMsS0FBSixDQUFVLGlCQUFWLENBQWYsQ0FBUDtBQUNIO0FBQ0osQ0EzREQ7O2VBNkRlL0IsYSxFQUdmO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VSb290IjoiL2hvbWUvbmF0aG5hZWwvcHJvamVjdHMvaGFsZXRhL2hhbGV0YS1uZXctYXBpL3NyYy9taWRkbGV3YXJlcy9hdXRoLyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBqd3QgZnJvbSBcImpzb253ZWJ0b2tlblwiO1xuXG4vLyBpbXBvcnQgcmVkaXMgZnJvbSBcIi4uL2NvbmZpZy9yZWRpcy1jb25maWdcIjtcbmltcG9ydCB7VXNlck1vZGVsfSBmcm9tIFwiLi4vLi4vbW9kZWxzL3VzZXJcIjtcblxuY29uc3QgdmFsaWRhdGVUb2tlbiA9IGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGF1dGhvcml6YXRpb24gPSByZXEuaGVhZGVycy5hdXRob3JpemF0aW9uXG5cbiAgICAgICAgT2JqZWN0LmFzc2lnbihyZXEuaGVhZGVycywge1xuICAgICAgICAgICAgdXNlcjogbnVsbCxcbiAgICAgICAgICAgIGF1dGhvcml6YXRpb246IG51bGwsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmICghYXV0aG9yaXphdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIG5leHQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gYXV0aG9yaXphdGlvbi5zcGxpdChcIiBcIilbMV07XG5cbiAgICAgICAgbGV0IGRlY29kZWQ7XG4gICAgICAgIGlmIChhY2Nlc3NUb2tlbikge1xuICAgICAgICAgICAgZGVjb2RlZCA9IGp3dC52ZXJpZnkoYWNjZXNzVG9rZW4sIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghZGVjb2RlZCkge1xuICAgICAgICAgICAgLy8gaW52YWxpZCB0b2tlbiwgcmVtb3ZlIHRoZSB0b2tlbiBmcm9tIGV2ZXJ5d2hlcmVcbiAgICAgICAgICAgIC8vcmVtb3ZlIGZyb20gZGF0YWJhc2VcbiAgICAgICAgICAgIC8vcmVtb3ZlIGZyb20gcmVkaXNcbiAgICAgICAgICAgIHJldHVybiBuZXh0KCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZGVjb2RlZC5leHAgKiAxMDAwIDwgRGF0ZS5ub3coKSkge1xuICAgICAgICAgICAgLy9yZW1vdmUgZnJvbSBkYXRhYmFzZVxuICAgICAgICAgICAgLy9yZW1vdmUgZnJvbSByZWRpc1xuICAgICAgICAgICAgcmV0dXJuIG5leHQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vY2hlY2sgaWYgdG9rZW4gaXMgaW4gcmVkaXNcbiAgICAgICAgLy9pZiBOT1QgaW4gcmVkaXMgY2FsbCBuZXh0KClcbiAgICAgICAgLy9lbHNlIGNoZWNrIGxhc3QgdXBkYXRlIHRpbWUgaWYgZ3JlYXRlciB0aGFuIG9yIGVxdWFscyB0byAxaG91ciB1cGRhdGUgdGhlIHRva2VuXG4gICAgICAgIC8vIGlmIGxlc3Mgc2tpcCBlbHNlIHVwZGF0ZSB0b2tlblxuICAgICAgICAvLyBhdXRob3JpemF0aW9uID0gbmV3IHRva2VuXG5cbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXJNb2RlbC5maW5kQnlJZChkZWNvZGVkLnVzZXJJZCk7XG4gICAgICAgIGlmICghdXNlcikge1xuICAgICAgICAgICAgLy9yZW1vdmUgZnJvbSBkYXRhYmFzZVxuICAgICAgICAgICAgLy9yZW1vdmUgZnJvbSByZWRpc1xuICAgICAgICAgICAgcmV0dXJuIG5leHQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGlmIHRoZSB0b2tlbiBoYXMgY29tZSBhbGwgdGhpcyB3YXkgZXZlcnl0aGluZyBpcyBnb29kIGp1c3QgYXR0YWNoIGl0IHRvIHRoZSByZXF1ZXN0IGhlYWRlclxuICAgICAgICAvL2F0dGFjaCBpdCB0byBodHRwcyByZXNwb25zZSBjb29raWVcbiAgICAgICAgT2JqZWN0LmFzc2lnbihyZXEuaGVhZGVycywge1xuICAgICAgICAgICAgdXNlcixcbiAgICAgICAgICAgIGF1dGhvcml6YXRpb24sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJlcy5jb29raWUoXCJqd3RcIiwgYXV0aG9yaXphdGlvbiwge3NlY3VyZTogdHJ1ZSwgaHR0cE9ubHk6IHRydWV9KVxuXG4gICAgICAgIHJldHVybiBuZXh0KCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoXCJFcnJvciBIYXBwZW5lZCFcIikpO1xuICAgIH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IHZhbGlkYXRlVG9rZW47XG5cblxuLy8gLS0tLS0tLS0tLS0tLSBhdXRob3JpemF0aW9uIC0tLS0tLS0tLS0tLS0tLS0tLVxuXG4vLyBsZXQgY2hlY2tfdXNlcl9hY3Rpb24gPSBhc3luYyAocmVxLGFjdGlvbixyZXNvdXJjZSkgPT57XG4vLyAgIGlmKCFbJ3VwZGF0ZU93bicsJ2RlbGV0ZU93biddLmluY2x1ZGVzKGFjdGlvbikpe1xuLy8gICAgIHJldHVybiB0cnVlXG4vLyAgIH1cbi8vXG4vLyAgIGNvbnN0IHVzZXJSZXNvdXJjZSA9IG5ldyBTZXQoKVxuLy9cbi8vICAgaWYocmVzb3VyY2UgPT0gJ3RlbmRlcicpe1xuLy8gICAgIGxldCB1c2VyVGVuZGVyID0gYXdhaXQgVGVuZGVyLmZpbmQoeyBjcmVhdG9yX3VzZXI6IHJlcS51c2VyLl9pZCB9KVxuLy8gICAgIHVzZXJUZW5kZXIuZm9yRWFjaCh0ZW5kZXIgPT4gdXNlclJlc291cmNlLmFkZChgJHt0ZW5kZXIuX2lkfWApKVxuLy9cbi8vICAgfWVsc2UgaWYocmVzb3VyY2UgPT0gJ2NvbXBhbnknKXtcbi8vICAgICBsZXQgdXNlckNvbXBhbnkgPSBhd2FpdCBDb21wYW55LmZpbmQoeyBjcmVhdG9yX3VzZXI6IHJlcS51c2VyLl9pZCB9KVxuLy8gICAgIHVzZXJDb21wYW55LmZvckVhY2goY29tcGFueSA9PiB1c2VyUmVzb3VyY2UuYWRkKCBgJHtjb21wYW55Ll9pZH1gKSlcbi8vXG4vLyAgIH1lbHNlIGlmKHJlc291cmNlID09ICdhd2FyZCcpe1xuLy8gICAgIGxldCB1c2VyQXdhcmQgPSBhd2FpdCBBd2FyZC5maW5kKHsgY3JlYXRvcl91c2VyOiByZXEudXNlci5faWQgfSlcbi8vICAgICB1c2VyQXdhcmQuZm9yRWFjaChhd2FyZCA9PiB1c2VyUmVzb3VyY2UuYWRkKGAke2F3YXJkLl9pZH1gKSlcbi8vICAgfVxuLy9cbi8vICAgaWYoIXVzZXJSZXNvdXJjZS5oYXMocmVxLnBhcmFtcy5pZCkpe1xuLy8gICAgIHJldHVybiBmYWxzZVxuLy8gICB9XG4vL1xuLy8gICByZXR1cm4gdHJ1ZVxuLy8gfVxuLy9cbi8vXG4vL1xuLy8gZXhwb3J0cy5hdXRob3JpemUgPSBmdW5jdGlvbiAoYWN0aW9uLCByZXNvdXJjZSkge1xuLy8gICByZXR1cm4gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4vLyAgICAgdHJ5IHtcbi8vICAgICAgIGNvbnN0IHBlcm1pc3Npb24gPSByb2xlcy5jYW4ocmVxLnVzZXIucm9sZSlbYWN0aW9uXShyZXNvdXJjZSk7XG4vL1xuLy8gICAgICAgaWYgKCFwZXJtaXNzaW9uLmdyYW50ZWQpIHtcbi8vICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5zZW5kKFwiWW91IGRvbid0IGhhdmUgZW5vdWdoIHBlcm1pc3Npb24gdG8gcGVyZm9ybSB0aGlzIGFjdGlvblwiKTtcbi8vICAgICAgIH1cbi8vXG4vLyAgICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgY2hlY2tfdXNlcl9hY3Rpb24ocmVxLGFjdGlvbixyZXNvdXJjZSlcbi8vICAgICAgIGlmKCFyZXN1bHQpe1xuLy8gICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLnNlbmQoeyBwYXJhbTogcmVzb3VyY2UgLCBtc2c6IGBZb3UgYXJlIG5vdCBhdXRob3JpemVkIHRvIGVkaXQgdGhpcyAke3Jlc291cmNlfS5gIH0pXG4vLyAgICAgICB9XG4vL1xuLy8gICAgICAgbmV4dCgpXG4vLyAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbi8vICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuc2VuZChcIllvdSBkb24ndCBoYXZlIGVub3VnaCBwZXJtaXNzaW9uIHRvIHBlcmZvcm0gdGhpcyBhY3Rpb25cIilcbi8vICAgICB9XG4vLyAgIH1cbi8vIH1cbiJdfQ==","map":{"version":3,"sources":["validate-token.js"],"names":["validateToken","req","res","next","authorization","headers","Object","assign","user","accessToken","split","decoded","jwt","verify","process","env","JWT_SECRET","exp","Date","now","UserModel","findById","userId","cookie","secure","httpOnly","error","console","log","Promise","reject","Error"],"mappings":";;;;;;;AAAA;;AAGA;;;;AADA;AAGA,MAAMA,aAAa,GAAG,OAAOC,GAAP,EAAYC,GAAZ,EAAiBC,IAAjB,KAA0B;AAC5C,MAAI;AACA,UAAMC,aAAa,GAAGH,GAAG,CAACI,OAAJ,CAAYD,aAAlC;AAEAE,IAAAA,MAAM,CAACC,MAAP,CAAcN,GAAG,CAACI,OAAlB,EAA2B;AACvBG,MAAAA,IAAI,EAAE,IADiB;AAEvBJ,MAAAA,aAAa,EAAE;AAFQ,KAA3B;;AAKA,QAAI,CAACA,aAAL,EAAoB;AAChB,aAAOD,IAAI,EAAX;AACH;;AAED,UAAMM,WAAW,GAAGL,aAAa,CAACM,KAAd,CAAoB,GAApB,EAAyB,CAAzB,CAApB;AAEA,QAAIC,OAAJ;;AACA,QAAIF,WAAJ,EAAiB;AACbE,MAAAA,OAAO,GAAGC,sBAAIC,MAAJ,CAAWJ,WAAX,EAAwBK,OAAO,CAACC,GAAR,CAAYC,UAApC,CAAV;AACH;;AACD,QAAI,CAACL,OAAL,EAAc;AACV;AACA;AACA;AACA,aAAOR,IAAI,EAAX;AACH;;AAED,QAAIQ,OAAO,CAACM,GAAR,GAAc,IAAd,GAAqBC,IAAI,CAACC,GAAL,EAAzB,EAAqC;AACjC;AACA;AACA,aAAOhB,IAAI,EAAX;AACH,KA7BD,CA+BA;AACA;AACA;AACA;AACA;;;AAEA,UAAMK,IAAI,GAAG,MAAMY,gBAAUC,QAAV,CAAmBV,OAAO,CAACW,MAA3B,CAAnB;;AACA,QAAI,CAACd,IAAL,EAAW;AACP;AACA;AACA,aAAOL,IAAI,EAAX;AACH,KA1CD,CA4CA;AACA;;;AACAG,IAAAA,MAAM,CAACC,MAAP,CAAcN,GAAG,CAACI,OAAlB,EAA2B;AACvBG,MAAAA,IADuB;AAEvBJ,MAAAA;AAFuB,KAA3B;AAKAF,IAAAA,GAAG,CAACqB,MAAJ,CAAW,KAAX,EAAkBnB,aAAlB,EAAiC;AAACoB,MAAAA,MAAM,EAAE,IAAT;AAAeC,MAAAA,QAAQ,EAAE;AAAzB,KAAjC;AAEA,WAAOtB,IAAI,EAAX;AACH,GAtDD,CAsDE,OAAOuB,KAAP,EAAc;AACZC,IAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACA,WAAOG,OAAO,CAACC,MAAR,CAAe,IAAIC,KAAJ,CAAU,iBAAV,CAAf,CAAP;AACH;AACJ,CA3DD;;eA6De/B,a,EAGf;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourceRoot":"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/auth/","sourcesContent":["import jwt from \"jsonwebtoken\";\n\n// import redis from \"../config/redis-config\";\nimport {UserModel} from \"../../models/user\";\n\nconst validateToken = async (req, res, next) => {\n    try {\n        const authorization = req.headers.authorization\n\n        Object.assign(req.headers, {\n            user: null,\n            authorization: null,\n        });\n\n        if (!authorization) {\n            return next();\n        }\n\n        const accessToken = authorization.split(\" \")[1];\n\n        let decoded;\n        if (accessToken) {\n            decoded = jwt.verify(accessToken, process.env.JWT_SECRET);\n        }\n        if (!decoded) {\n            // invalid token, remove the token from everywhere\n            //remove from database\n            //remove from redis\n            return next();\n        }\n\n        if (decoded.exp * 1000 < Date.now()) {\n            //remove from database\n            //remove from redis\n            return next();\n        }\n\n        //check if token is in redis\n        //if NOT in redis call next()\n        //else check last update time if greater than or equals to 1hour update the token\n        // if less skip else update token\n        // authorization = new token\n\n        const user = await UserModel.findById(decoded.userId);\n        if (!user) {\n            //remove from database\n            //remove from redis\n            return next();\n        }\n\n        // if the token has come all this way everything is good just attach it to the request header\n        //attach it to https response cookie\n        Object.assign(req.headers, {\n            user,\n            authorization,\n        });\n\n        res.cookie(\"jwt\", authorization, {secure: true, httpOnly: true})\n\n        return next();\n    } catch (error) {\n        console.log(error)\n        return Promise.reject(new Error(\"Error Happened!\"));\n    }\n};\n\nexport default validateToken;\n\n\n// ------------- authorization ------------------\n\n// let check_user_action = async (req,action,resource) =>{\n//   if(!['updateOwn','deleteOwn'].includes(action)){\n//     return true\n//   }\n//\n//   const userResource = new Set()\n//\n//   if(resource == 'tender'){\n//     let userTender = await Tender.find({ creator_user: req.user._id })\n//     userTender.forEach(tender => userResource.add(`${tender._id}`))\n//\n//   }else if(resource == 'company'){\n//     let userCompany = await Company.find({ creator_user: req.user._id })\n//     userCompany.forEach(company => userResource.add( `${company._id}`))\n//\n//   }else if(resource == 'award'){\n//     let userAward = await Award.find({ creator_user: req.user._id })\n//     userAward.forEach(award => userResource.add(`${award._id}`))\n//   }\n//\n//   if(!userResource.has(req.params.id)){\n//     return false\n//   }\n//\n//   return true\n// }\n//\n//\n//\n// exports.authorize = function (action, resource) {\n//   return async (req, res, next) => {\n//     try {\n//       const permission = roles.can(req.user.role)[action](resource);\n//\n//       if (!permission.granted) {\n//         return res.status(401).send(\"You don't have enough permission to perform this action\");\n//       }\n//\n//       let result = await check_user_action(req,action,resource)\n//       if(!result){\n//         return res.status(401).send({ param: resource , msg: `You are not authorized to edit this ${resource}.` })\n//       }\n//\n//       next()\n//     } catch (error) {\n//       return res.status(401).send(\"You don't have enough permission to perform this action\")\n//     }\n//   }\n// }\n"]}},"mtime":1648318721095},"{\"assumptions\":{},\"sourceRoot\":\"/home/nathnael/projects/haleta/haleta-new-api/src/config/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"filename\":\"/home/nathnael/projects/haleta/haleta-new-api/src/config/mongodb-config.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\n\nvar _dotenv = _interopRequireDefault(require(\"dotenv\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n_dotenv.default.config();\n\nmain().then(() => console.log(\"Mongoose connected\")).catch(err => console.log(err));\n\nasync function main() {\n  await _mongoose.default.connect(process.env.MONGODB_URI);\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vbmdvZGItY29uZmlnLmpzIl0sIm5hbWVzIjpbImRvdGVudiIsImNvbmZpZyIsIm1haW4iLCJ0aGVuIiwiY29uc29sZSIsImxvZyIsImNhdGNoIiwiZXJyIiwibW9uZ29vc2UiLCJjb25uZWN0IiwicHJvY2VzcyIsImVudiIsIk1PTkdPREJfVVJJIl0sIm1hcHBpbmdzIjoiOztBQUFBOztBQUNBOzs7O0FBRUFBLGdCQUFPQyxNQUFQOztBQUVBQyxJQUFJLEdBQ0NDLElBREwsQ0FDVSxNQUFNQyxPQUFPLENBQUNDLEdBQVIsQ0FBWSxvQkFBWixDQURoQixFQUVLQyxLQUZMLENBRVdDLEdBQUcsSUFBSUgsT0FBTyxDQUFDQyxHQUFSLENBQVlFLEdBQVosQ0FGbEI7O0FBSUEsZUFBZUwsSUFBZixHQUFzQjtBQUNsQixRQUFNTSxrQkFBU0MsT0FBVCxDQUFpQkMsT0FBTyxDQUFDQyxHQUFSLENBQVlDLFdBQTdCLENBQU47QUFDSCIsInNvdXJjZVJvb3QiOiIvaG9tZS9uYXRobmFlbC9wcm9qZWN0cy9oYWxldGEvaGFsZXRhLW5ldy1hcGkvc3JjL2NvbmZpZy8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9uZ29vc2UgZnJvbSBcIm1vbmdvb3NlXCI7XG5pbXBvcnQgZG90ZW52IGZyb20gXCJkb3RlbnZcIjtcblxuZG90ZW52LmNvbmZpZygpO1xuXG5tYWluKClcbiAgICAudGhlbigoKSA9PiBjb25zb2xlLmxvZyhcIk1vbmdvb3NlIGNvbm5lY3RlZFwiKSlcbiAgICAuY2F0Y2goZXJyID0+IGNvbnNvbGUubG9nKGVycikpO1xuXG5hc3luYyBmdW5jdGlvbiBtYWluKCkge1xuICAgIGF3YWl0IG1vbmdvb3NlLmNvbm5lY3QocHJvY2Vzcy5lbnYuTU9OR09EQl9VUkkpO1xufSJdfQ==","map":{"version":3,"sources":["mongodb-config.js"],"names":["dotenv","config","main","then","console","log","catch","err","mongoose","connect","process","env","MONGODB_URI"],"mappings":";;AAAA;;AACA;;;;AAEAA,gBAAOC,MAAP;;AAEAC,IAAI,GACCC,IADL,CACU,MAAMC,OAAO,CAACC,GAAR,CAAY,oBAAZ,CADhB,EAEKC,KAFL,CAEWC,GAAG,IAAIH,OAAO,CAACC,GAAR,CAAYE,GAAZ,CAFlB;;AAIA,eAAeL,IAAf,GAAsB;AAClB,QAAMM,kBAASC,OAAT,CAAiBC,OAAO,CAACC,GAAR,CAAYC,WAA7B,CAAN;AACH","sourceRoot":"/home/nathnael/projects/haleta/haleta-new-api/src/config/","sourcesContent":["import mongoose from \"mongoose\";\nimport dotenv from \"dotenv\";\n\ndotenv.config();\n\nmain()\n    .then(() => console.log(\"Mongoose connected\"))\n    .catch(err => console.log(err));\n\nasync function main() {\n    await mongoose.connect(process.env.MONGODB_URI);\n}"]}},"mtime":1648318431053},"{\"assumptions\":{},\"sourceRoot\":\"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/auth/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"filename\":\"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/auth/phone-verification.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\n// import admin from \"../../config/firebase-config\";\nconst phoneVerification = async (resolve, source, args, context, info) => {\n  // const {phoneVerification} = context;\n  // let phoneNumber = \"\";\n  //\n  // await admin\n  //     .auth()\n  //     .verifyIdToken(phoneVerification)\n  //     .then((decodedToken) => {\n  //         phoneNumber = decodedToken.phone_number;\n  //     })\n  //     .catch(() => Promise.reject(new Error(\"Error happened!\")));\n  // if (phoneNumber === \"\") {\n  //     return Promise.reject(new Error(\"Phone number not detected!\"));\n  // }\n  // context.phoneNumber = phoneNumber;\n  return resolve(source, args, context, info);\n};\n\nvar _default = phoneVerification;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBob25lLXZlcmlmaWNhdGlvbi5qcyJdLCJuYW1lcyI6WyJwaG9uZVZlcmlmaWNhdGlvbiIsInJlc29sdmUiLCJzb3VyY2UiLCJhcmdzIiwiY29udGV4dCIsImluZm8iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTtBQUVBLE1BQU1BLGlCQUFpQixHQUFHLE9BQU9DLE9BQVAsRUFBZ0JDLE1BQWhCLEVBQXdCQyxJQUF4QixFQUE4QkMsT0FBOUIsRUFBdUNDLElBQXZDLEtBQWdEO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFPSixPQUFPLENBQUNDLE1BQUQsRUFBU0MsSUFBVCxFQUFlQyxPQUFmLEVBQXdCQyxJQUF4QixDQUFkO0FBQ0gsQ0FoQkQ7O2VBa0JlTCxpQiIsInNvdXJjZVJvb3QiOiIvaG9tZS9uYXRobmFlbC9wcm9qZWN0cy9oYWxldGEvaGFsZXRhLW5ldy1hcGkvc3JjL21pZGRsZXdhcmVzL2F1dGgvIiwic291cmNlc0NvbnRlbnQiOlsiLy8gaW1wb3J0IGFkbWluIGZyb20gXCIuLi8uLi9jb25maWcvZmlyZWJhc2UtY29uZmlnXCI7XG5cbmNvbnN0IHBob25lVmVyaWZpY2F0aW9uID0gYXN5bmMgKHJlc29sdmUsIHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbykgPT4ge1xuICAgIC8vIGNvbnN0IHtwaG9uZVZlcmlmaWNhdGlvbn0gPSBjb250ZXh0O1xuICAgIC8vIGxldCBwaG9uZU51bWJlciA9IFwiXCI7XG4gICAgLy9cbiAgICAvLyBhd2FpdCBhZG1pblxuICAgIC8vICAgICAuYXV0aCgpXG4gICAgLy8gICAgIC52ZXJpZnlJZFRva2VuKHBob25lVmVyaWZpY2F0aW9uKVxuICAgIC8vICAgICAudGhlbigoZGVjb2RlZFRva2VuKSA9PiB7XG4gICAgLy8gICAgICAgICBwaG9uZU51bWJlciA9IGRlY29kZWRUb2tlbi5waG9uZV9udW1iZXI7XG4gICAgLy8gICAgIH0pXG4gICAgLy8gICAgIC5jYXRjaCgoKSA9PiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoXCJFcnJvciBoYXBwZW5lZCFcIikpKTtcbiAgICAvLyBpZiAocGhvbmVOdW1iZXIgPT09IFwiXCIpIHtcbiAgICAvLyAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcIlBob25lIG51bWJlciBub3QgZGV0ZWN0ZWQhXCIpKTtcbiAgICAvLyB9XG4gICAgLy8gY29udGV4dC5waG9uZU51bWJlciA9IHBob25lTnVtYmVyO1xuICAgIHJldHVybiByZXNvbHZlKHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbyk7XG59XG5cbmV4cG9ydCBkZWZhdWx0IHBob25lVmVyaWZpY2F0aW9uO1xuIl19","map":{"version":3,"sources":["phone-verification.js"],"names":["phoneVerification","resolve","source","args","context","info"],"mappings":";;;;;;;AAAA;AAEA,MAAMA,iBAAiB,GAAG,OAAOC,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAOJ,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,CAhBD;;eAkBeL,iB","sourceRoot":"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/auth/","sourcesContent":["// import admin from \"../../config/firebase-config\";\n\nconst phoneVerification = async (resolve, source, args, context, info) => {\n    // const {phoneVerification} = context;\n    // let phoneNumber = \"\";\n    //\n    // await admin\n    //     .auth()\n    //     .verifyIdToken(phoneVerification)\n    //     .then((decodedToken) => {\n    //         phoneNumber = decodedToken.phone_number;\n    //     })\n    //     .catch(() => Promise.reject(new Error(\"Error happened!\")));\n    // if (phoneNumber === \"\") {\n    //     return Promise.reject(new Error(\"Phone number not detected!\"));\n    // }\n    // context.phoneNumber = phoneNumber;\n    return resolve(source, args, context, info);\n}\n\nexport default phoneVerification;\n"]}},"mtime":1648313712832},"{\"assumptions\":{},\"sourceRoot\":\"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/validators/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"filename\":\"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/validators/user-validator.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n// import validator from \"validators\";\nconst userValidator = {\n  changePassword: async (resolve, source, args, context, info) => {\n    const {\n      newPassword\n    } = args; // if (!validator.isLength(newPassword, {min: 6})) {\n    //     return Promise.reject(new Error(\"Error: newPassword\"));\n    // }\n\n    return resolve(source, args, context, info);\n  },\n  newPassword: async (resolve, source, args, context, info) => {\n    const {\n      newPassword\n    } = args; // if (!validator.isLength(newPassword, {min: 6})) {\n    //     return Promise.reject(new Error(\"Error: newPassword\"));\n    // }\n\n    return resolve(source, args, context, info);\n  },\n  resetPassword: async (resolve, source, args, context, info) => {\n    let {\n      email\n    } = args; // email = validator.normalizeEmail(email);\n    // email = validator.trim(email);\n    //\n    // Object.assign(args, {email});\n\n    return resolve(source, args, context, info);\n  },\n  signIn: async (resolve, source, args, context, info) => {\n    let {\n      email\n    } = args; // email = email.toString().toLowerCase();\n    // email = validator.trim(email);\n    //\n    // Object.assign(args, {email});\n\n    return resolve(source, args, context, info);\n  },\n  signUp: async (resolve, source, args, context, info) => {\n    let {\n      email\n    } = args; // email = email.toString().toLowerCase();\n    // email = validator.trim(email);\n    //\n    // Object.assign(args, {email});\n\n    const {\n      password\n    } = args; // if (!validator.isEmail(email, {allow_utf8_local_part: false})) {\n    //     return Promise.reject(new Error(\"Error: email\"));\n    // }\n    //\n    // if (!validator.isLength(password, {min: 6})) {\n    //     return Promise.reject(new Error(\"Error: password\"));\n    // }\n\n    return resolve(source, args, context, info);\n  },\n  updateUser: async (resolve, source, args, context, info) => {\n    let {\n      email\n    } = args; // email = validator.normalizeEmail(email);\n    // email = validator.trim(email);\n    //\n    // Object.assign(args, {email});\n\n    const {\n      firstName,\n      lastName\n    } = args; // if (!validator.isEmail(email, {allow_utf8_local_part: false})) {\n    //     return Promise.reject(new Error(\"Error: email\"));\n    // }\n    // if (!validator.isLength(firstName, {min: 2})) {\n    //     return Promise.reject(new Error(\"Error: firstName\"));\n    // }\n    // if (!validator.isLength(lastName, {min: 2})) {\n    //     return Promise.reject(new Error(\"Error: lastName\"));\n    // }\n\n    return resolve(source, args, context, info);\n  }\n};\nvar _default = userValidator;\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVzZXItdmFsaWRhdG9yLmpzIl0sIm5hbWVzIjpbInVzZXJWYWxpZGF0b3IiLCJjaGFuZ2VQYXNzd29yZCIsInJlc29sdmUiLCJzb3VyY2UiLCJhcmdzIiwiY29udGV4dCIsImluZm8iLCJuZXdQYXNzd29yZCIsInJlc2V0UGFzc3dvcmQiLCJlbWFpbCIsInNpZ25JbiIsInNpZ25VcCIsInBhc3N3b3JkIiwidXBkYXRlVXNlciIsImZpcnN0TmFtZSIsImxhc3ROYW1lIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQTtBQUVBLE1BQU1BLGFBQWEsR0FBRztBQUNsQkMsRUFBQUEsY0FBYyxFQUFFLE9BQU9DLE9BQVAsRUFBZ0JDLE1BQWhCLEVBQXdCQyxJQUF4QixFQUE4QkMsT0FBOUIsRUFBdUNDLElBQXZDLEtBQWdEO0FBQzVELFVBQU07QUFBQ0MsTUFBQUE7QUFBRCxRQUFnQkgsSUFBdEIsQ0FENEQsQ0FHNUQ7QUFDQTtBQUNBOztBQUVBLFdBQU9GLE9BQU8sQ0FBQ0MsTUFBRCxFQUFTQyxJQUFULEVBQWVDLE9BQWYsRUFBd0JDLElBQXhCLENBQWQ7QUFDSCxHQVRpQjtBQVVsQkMsRUFBQUEsV0FBVyxFQUFFLE9BQU9MLE9BQVAsRUFBZ0JDLE1BQWhCLEVBQXdCQyxJQUF4QixFQUE4QkMsT0FBOUIsRUFBdUNDLElBQXZDLEtBQWdEO0FBQ3pELFVBQU07QUFBQ0MsTUFBQUE7QUFBRCxRQUFnQkgsSUFBdEIsQ0FEeUQsQ0FHekQ7QUFDQTtBQUNBOztBQUVBLFdBQU9GLE9BQU8sQ0FBQ0MsTUFBRCxFQUFTQyxJQUFULEVBQWVDLE9BQWYsRUFBd0JDLElBQXhCLENBQWQ7QUFDSCxHQWxCaUI7QUFtQmxCRSxFQUFBQSxhQUFhLEVBQUUsT0FBT04sT0FBUCxFQUFnQkMsTUFBaEIsRUFBd0JDLElBQXhCLEVBQThCQyxPQUE5QixFQUF1Q0MsSUFBdkMsS0FBZ0Q7QUFDM0QsUUFBSTtBQUFDRyxNQUFBQTtBQUFELFFBQVVMLElBQWQsQ0FEMkQsQ0FHM0Q7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsV0FBT0YsT0FBTyxDQUFDQyxNQUFELEVBQVNDLElBQVQsRUFBZUMsT0FBZixFQUF3QkMsSUFBeEIsQ0FBZDtBQUNILEdBNUJpQjtBQTZCbEJJLEVBQUFBLE1BQU0sRUFBRSxPQUFPUixPQUFQLEVBQWdCQyxNQUFoQixFQUF3QkMsSUFBeEIsRUFBOEJDLE9BQTlCLEVBQXVDQyxJQUF2QyxLQUFnRDtBQUNwRCxRQUFJO0FBQUNHLE1BQUFBO0FBQUQsUUFBVUwsSUFBZCxDQURvRCxDQUdwRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxXQUFPRixPQUFPLENBQUNDLE1BQUQsRUFBU0MsSUFBVCxFQUFlQyxPQUFmLEVBQXdCQyxJQUF4QixDQUFkO0FBQ0gsR0F0Q2lCO0FBdUNsQkssRUFBQUEsTUFBTSxFQUFFLE9BQU9ULE9BQVAsRUFBZ0JDLE1BQWhCLEVBQXdCQyxJQUF4QixFQUE4QkMsT0FBOUIsRUFBdUNDLElBQXZDLEtBQWdEO0FBQ3BELFFBQUk7QUFBQ0csTUFBQUE7QUFBRCxRQUFVTCxJQUFkLENBRG9ELENBR3BEO0FBQ0E7QUFDQTtBQUNBOztBQUVBLFVBQU07QUFBQ1EsTUFBQUE7QUFBRCxRQUFhUixJQUFuQixDQVJvRCxDQVVwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxXQUFPRixPQUFPLENBQUNDLE1BQUQsRUFBU0MsSUFBVCxFQUFlQyxPQUFmLEVBQXdCQyxJQUF4QixDQUFkO0FBQ0gsR0ExRGlCO0FBMkRsQk8sRUFBQUEsVUFBVSxFQUFFLE9BQU9YLE9BQVAsRUFBZ0JDLE1BQWhCLEVBQXdCQyxJQUF4QixFQUE4QkMsT0FBOUIsRUFBdUNDLElBQXZDLEtBQWdEO0FBQ3hELFFBQUk7QUFBQ0csTUFBQUE7QUFBRCxRQUFVTCxJQUFkLENBRHdELENBR3hEO0FBQ0E7QUFDQTtBQUNBOztBQUVBLFVBQU07QUFDRlUsTUFBQUEsU0FERTtBQUVGQyxNQUFBQTtBQUZFLFFBR0ZYLElBSEosQ0FSd0QsQ0FheEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBLFdBQU9GLE9BQU8sQ0FBQ0MsTUFBRCxFQUFTQyxJQUFULEVBQWVDLE9BQWYsRUFBd0JDLElBQXhCLENBQWQ7QUFDSDtBQWxGaUIsQ0FBdEI7ZUFxRmVOLGEiLCJzb3VyY2VSb290IjoiL2hvbWUvbmF0aG5hZWwvcHJvamVjdHMvaGFsZXRhL2hhbGV0YS1uZXctYXBpL3NyYy9taWRkbGV3YXJlcy92YWxpZGF0b3JzLyIsInNvdXJjZXNDb250ZW50IjpbIi8vIGltcG9ydCB2YWxpZGF0b3IgZnJvbSBcInZhbGlkYXRvcnNcIjtcblxuY29uc3QgdXNlclZhbGlkYXRvciA9IHtcbiAgICBjaGFuZ2VQYXNzd29yZDogYXN5bmMgKHJlc29sdmUsIHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbykgPT4ge1xuICAgICAgICBjb25zdCB7bmV3UGFzc3dvcmR9ID0gYXJncztcblxuICAgICAgICAvLyBpZiAoIXZhbGlkYXRvci5pc0xlbmd0aChuZXdQYXNzd29yZCwge21pbjogNn0pKSB7XG4gICAgICAgIC8vICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKFwiRXJyb3I6IG5ld1Bhc3N3b3JkXCIpKTtcbiAgICAgICAgLy8gfVxuXG4gICAgICAgIHJldHVybiByZXNvbHZlKHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbyk7XG4gICAgfSxcbiAgICBuZXdQYXNzd29yZDogYXN5bmMgKHJlc29sdmUsIHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbykgPT4ge1xuICAgICAgICBjb25zdCB7bmV3UGFzc3dvcmR9ID0gYXJncztcblxuICAgICAgICAvLyBpZiAoIXZhbGlkYXRvci5pc0xlbmd0aChuZXdQYXNzd29yZCwge21pbjogNn0pKSB7XG4gICAgICAgIC8vICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKFwiRXJyb3I6IG5ld1Bhc3N3b3JkXCIpKTtcbiAgICAgICAgLy8gfVxuXG4gICAgICAgIHJldHVybiByZXNvbHZlKHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbyk7XG4gICAgfSxcbiAgICByZXNldFBhc3N3b3JkOiBhc3luYyAocmVzb2x2ZSwgc291cmNlLCBhcmdzLCBjb250ZXh0LCBpbmZvKSA9PiB7XG4gICAgICAgIGxldCB7ZW1haWx9ID0gYXJncztcblxuICAgICAgICAvLyBlbWFpbCA9IHZhbGlkYXRvci5ub3JtYWxpemVFbWFpbChlbWFpbCk7XG4gICAgICAgIC8vIGVtYWlsID0gdmFsaWRhdG9yLnRyaW0oZW1haWwpO1xuICAgICAgICAvL1xuICAgICAgICAvLyBPYmplY3QuYXNzaWduKGFyZ3MsIHtlbWFpbH0pO1xuXG4gICAgICAgIHJldHVybiByZXNvbHZlKHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbyk7XG4gICAgfSxcbiAgICBzaWduSW46IGFzeW5jIChyZXNvbHZlLCBzb3VyY2UsIGFyZ3MsIGNvbnRleHQsIGluZm8pID0+IHtcbiAgICAgICAgbGV0IHtlbWFpbH0gPSBhcmdzO1xuXG4gICAgICAgIC8vIGVtYWlsID0gZW1haWwudG9TdHJpbmcoKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAvLyBlbWFpbCA9IHZhbGlkYXRvci50cmltKGVtYWlsKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy8gT2JqZWN0LmFzc2lnbihhcmdzLCB7ZW1haWx9KTtcblxuICAgICAgICByZXR1cm4gcmVzb2x2ZShzb3VyY2UsIGFyZ3MsIGNvbnRleHQsIGluZm8pO1xuICAgIH0sXG4gICAgc2lnblVwOiBhc3luYyAocmVzb2x2ZSwgc291cmNlLCBhcmdzLCBjb250ZXh0LCBpbmZvKSA9PiB7XG4gICAgICAgIGxldCB7ZW1haWx9ID0gYXJncztcblxuICAgICAgICAvLyBlbWFpbCA9IGVtYWlsLnRvU3RyaW5nKCkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgLy8gZW1haWwgPSB2YWxpZGF0b3IudHJpbShlbWFpbCk7XG4gICAgICAgIC8vXG4gICAgICAgIC8vIE9iamVjdC5hc3NpZ24oYXJncywge2VtYWlsfSk7XG5cbiAgICAgICAgY29uc3Qge3Bhc3N3b3JkfSA9IGFyZ3M7XG5cbiAgICAgICAgLy8gaWYgKCF2YWxpZGF0b3IuaXNFbWFpbChlbWFpbCwge2FsbG93X3V0ZjhfbG9jYWxfcGFydDogZmFsc2V9KSkge1xuICAgICAgICAvLyAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcIkVycm9yOiBlbWFpbFwiKSk7XG4gICAgICAgIC8vIH1cbiAgICAgICAgLy9cbiAgICAgICAgLy8gaWYgKCF2YWxpZGF0b3IuaXNMZW5ndGgocGFzc3dvcmQsIHttaW46IDZ9KSkge1xuICAgICAgICAvLyAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcIkVycm9yOiBwYXNzd29yZFwiKSk7XG4gICAgICAgIC8vIH1cblxuICAgICAgICByZXR1cm4gcmVzb2x2ZShzb3VyY2UsIGFyZ3MsIGNvbnRleHQsIGluZm8pO1xuICAgIH0sXG4gICAgdXBkYXRlVXNlcjogYXN5bmMgKHJlc29sdmUsIHNvdXJjZSwgYXJncywgY29udGV4dCwgaW5mbykgPT4ge1xuICAgICAgICBsZXQge2VtYWlsfSA9IGFyZ3M7XG5cbiAgICAgICAgLy8gZW1haWwgPSB2YWxpZGF0b3Iubm9ybWFsaXplRW1haWwoZW1haWwpO1xuICAgICAgICAvLyBlbWFpbCA9IHZhbGlkYXRvci50cmltKGVtYWlsKTtcbiAgICAgICAgLy9cbiAgICAgICAgLy8gT2JqZWN0LmFzc2lnbihhcmdzLCB7ZW1haWx9KTtcblxuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgICBmaXJzdE5hbWUsXG4gICAgICAgICAgICBsYXN0TmFtZSxcbiAgICAgICAgfSA9IGFyZ3M7XG5cbiAgICAgICAgLy8gaWYgKCF2YWxpZGF0b3IuaXNFbWFpbChlbWFpbCwge2FsbG93X3V0ZjhfbG9jYWxfcGFydDogZmFsc2V9KSkge1xuICAgICAgICAvLyAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcIkVycm9yOiBlbWFpbFwiKSk7XG4gICAgICAgIC8vIH1cbiAgICAgICAgLy8gaWYgKCF2YWxpZGF0b3IuaXNMZW5ndGgoZmlyc3ROYW1lLCB7bWluOiAyfSkpIHtcbiAgICAgICAgLy8gICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoXCJFcnJvcjogZmlyc3ROYW1lXCIpKTtcbiAgICAgICAgLy8gfVxuICAgICAgICAvLyBpZiAoIXZhbGlkYXRvci5pc0xlbmd0aChsYXN0TmFtZSwge21pbjogMn0pKSB7XG4gICAgICAgIC8vICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKFwiRXJyb3I6IGxhc3ROYW1lXCIpKTtcbiAgICAgICAgLy8gfVxuICAgICAgICByZXR1cm4gcmVzb2x2ZShzb3VyY2UsIGFyZ3MsIGNvbnRleHQsIGluZm8pO1xuICAgIH0sXG59O1xuXG5leHBvcnQgZGVmYXVsdCB1c2VyVmFsaWRhdG9yO1xuIl19","map":{"version":3,"sources":["user-validator.js"],"names":["userValidator","changePassword","resolve","source","args","context","info","newPassword","resetPassword","email","signIn","signUp","password","updateUser","firstName","lastName"],"mappings":";;;;;;AAAA;AAEA,MAAMA,aAAa,GAAG;AAClBC,EAAAA,cAAc,EAAE,OAAOC,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AAC5D,UAAM;AAACC,MAAAA;AAAD,QAAgBH,IAAtB,CAD4D,CAG5D;AACA;AACA;;AAEA,WAAOF,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,GATiB;AAUlBC,EAAAA,WAAW,EAAE,OAAOL,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AACzD,UAAM;AAACC,MAAAA;AAAD,QAAgBH,IAAtB,CADyD,CAGzD;AACA;AACA;;AAEA,WAAOF,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,GAlBiB;AAmBlBE,EAAAA,aAAa,EAAE,OAAON,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AAC3D,QAAI;AAACG,MAAAA;AAAD,QAAUL,IAAd,CAD2D,CAG3D;AACA;AACA;AACA;;AAEA,WAAOF,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,GA5BiB;AA6BlBI,EAAAA,MAAM,EAAE,OAAOR,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AACpD,QAAI;AAACG,MAAAA;AAAD,QAAUL,IAAd,CADoD,CAGpD;AACA;AACA;AACA;;AAEA,WAAOF,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,GAtCiB;AAuClBK,EAAAA,MAAM,EAAE,OAAOT,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AACpD,QAAI;AAACG,MAAAA;AAAD,QAAUL,IAAd,CADoD,CAGpD;AACA;AACA;AACA;;AAEA,UAAM;AAACQ,MAAAA;AAAD,QAAaR,IAAnB,CARoD,CAUpD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,WAAOF,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH,GA1DiB;AA2DlBO,EAAAA,UAAU,EAAE,OAAOX,OAAP,EAAgBC,MAAhB,EAAwBC,IAAxB,EAA8BC,OAA9B,EAAuCC,IAAvC,KAAgD;AACxD,QAAI;AAACG,MAAAA;AAAD,QAAUL,IAAd,CADwD,CAGxD;AACA;AACA;AACA;;AAEA,UAAM;AACFU,MAAAA,SADE;AAEFC,MAAAA;AAFE,QAGFX,IAHJ,CARwD,CAaxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,WAAOF,OAAO,CAACC,MAAD,EAASC,IAAT,EAAeC,OAAf,EAAwBC,IAAxB,CAAd;AACH;AAlFiB,CAAtB;eAqFeN,a","sourceRoot":"/home/nathnael/projects/haleta/haleta-new-api/src/middlewares/validators/","sourcesContent":["// import validator from \"validators\";\n\nconst userValidator = {\n    changePassword: async (resolve, source, args, context, info) => {\n        const {newPassword} = args;\n\n        // if (!validator.isLength(newPassword, {min: 6})) {\n        //     return Promise.reject(new Error(\"Error: newPassword\"));\n        // }\n\n        return resolve(source, args, context, info);\n    },\n    newPassword: async (resolve, source, args, context, info) => {\n        const {newPassword} = args;\n\n        // if (!validator.isLength(newPassword, {min: 6})) {\n        //     return Promise.reject(new Error(\"Error: newPassword\"));\n        // }\n\n        return resolve(source, args, context, info);\n    },\n    resetPassword: async (resolve, source, args, context, info) => {\n        let {email} = args;\n\n        // email = validator.normalizeEmail(email);\n        // email = validator.trim(email);\n        //\n        // Object.assign(args, {email});\n\n        return resolve(source, args, context, info);\n    },\n    signIn: async (resolve, source, args, context, info) => {\n        let {email} = args;\n\n        // email = email.toString().toLowerCase();\n        // email = validator.trim(email);\n        //\n        // Object.assign(args, {email});\n\n        return resolve(source, args, context, info);\n    },\n    signUp: async (resolve, source, args, context, info) => {\n        let {email} = args;\n\n        // email = email.toString().toLowerCase();\n        // email = validator.trim(email);\n        //\n        // Object.assign(args, {email});\n\n        const {password} = args;\n\n        // if (!validator.isEmail(email, {allow_utf8_local_part: false})) {\n        //     return Promise.reject(new Error(\"Error: email\"));\n        // }\n        //\n        // if (!validator.isLength(password, {min: 6})) {\n        //     return Promise.reject(new Error(\"Error: password\"));\n        // }\n\n        return resolve(source, args, context, info);\n    },\n    updateUser: async (resolve, source, args, context, info) => {\n        let {email} = args;\n\n        // email = validator.normalizeEmail(email);\n        // email = validator.trim(email);\n        //\n        // Object.assign(args, {email});\n\n        const {\n            firstName,\n            lastName,\n        } = args;\n\n        // if (!validator.isEmail(email, {allow_utf8_local_part: false})) {\n        //     return Promise.reject(new Error(\"Error: email\"));\n        // }\n        // if (!validator.isLength(firstName, {min: 2})) {\n        //     return Promise.reject(new Error(\"Error: firstName\"));\n        // }\n        // if (!validator.isLength(lastName, {min: 2})) {\n        //     return Promise.reject(new Error(\"Error: lastName\"));\n        // }\n        return resolve(source, args, context, info);\n    },\n};\n\nexport default userValidator;\n"]}},"mtime":1648317478224},"{\"assumptions\":{},\"sourceRoot\":\"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/auth/resolvers/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"filename\":\"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/auth/resolvers/auth-resolvers.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\n\nvar _user = require(\"../../../models/user\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// import crypto from \"crypto\";\nconst signIn = {\n  name: \"signIn\",\n  type: \"AccessToken!\",\n  args: {\n    phoneNumber: \"String!\",\n    password: \"String!\"\n  },\n  resolve: async ({\n    args: {\n      phoneNumber,\n      password\n    }\n  }) => {\n    try {\n      // const user = await UserModel.phoneNumberExist(phoneNumber);\n      // if (!user) {\n      //     return Promise.reject(new Error(\"User not found.\"));\n      // }\n      const user = await _user.UserModel.find({\n        phoneNumber\n      }); // const comparePassword = await user.comparePassword(password.toString());\n      // if (!comparePassword) {\n      //     return Promise.reject(new Error(\"Password is incorrect.\"));\n      // }\n\n      console.log(user);\n      const accessToken = await _jsonwebtoken.default.sign(user, process.env.JWT_SECRET, {\n        expiresIn: process.env.JWT_EXPIRATION\n      });\n      return {\n        accessToken,\n        // roles: user.roles,\n        user\n      };\n    } catch (error) {\n      return Promise.reject(error);\n    }\n  }\n};\nconst signUp = {\n  name: \"signUp\",\n  type: \"AccessToken!\",\n  args: {\n    firstName: \"String!\",\n    middleName: \"String!\",\n    lastName: \"String!\",\n    password: \"String!\",\n    phoneNumber: \"String!\"\n  },\n  resolve: async ({\n    args: {\n      firstName,\n      middleName,\n      lastName,\n      password,\n      phoneNumber\n    },\n    context: {\n      phoneVerification\n    }\n  }) => {\n    try {\n      console.log(\"here 1\"); // let user = await UserModel.phoneNumberExist(phoneNumber);\n      // if (user) {\n      //     console.log(\"here 2\")\n      //     return Promise.reject(new Error(\"Phone Number has already been taken.\"));\n      // }\n      // user = await UserModel.emailExist(email);\n      // if (user) {\n      //   return Promise.reject(new Error(\"Email has already been taken.\"));\n      // }\n      // const salt = bcrypt.genSalt(10);\n      // const hash = bcrypt.hashSync(password, salt);\n\n      let user = await new _user.UserModel({\n        firstName,\n        middleName,\n        lastName,\n        phoneNumber,\n        password // password: hash,\n        // roles: [roles.OWNER],\n        // account: {\n        //     phoneVerification: {\n        //         verified: true,\n        //         token: phoneVerification,\n        //     },\n        // },\n\n      }).save();\n      console.log(\"here 3\");\n      const accessToken = await _jsonwebtoken.default.sign({\n        _id: user._id,\n        firstName: user.firstName,\n        middleName: user.middleName,\n        lastName: user.lastName,\n        phoneNumber: user.phoneNumber // roles: user.roles,\n\n      }, process.env.JWT_SECRET, {\n        expiresIn: process.env.JWT_EXPIRATION\n      }); // await userService.verifyRequest(user);\n      // userMail.verifyRequest(user, token);\n\n      return {\n        accessToken,\n        // roles: user.roles,\n        user\n      };\n    } catch (error) {\n      return Promise.reject(error);\n    }\n  }\n};\nconst logout = {\n  name: 'logout',\n  type: 'Succeed!',\n  resolve: async ({\n    context: {\n      user,\n      accessToken\n    }\n  }) => {\n    try {\n      // await redis.set(`expiredToken:${accessToken}`, user._id, 'EX', process.env.REDIS_TOKEN_EXPIRY);\n      return {\n        succeed: true\n      };\n    } catch (error) {\n      return Promise.reject(error);\n    }\n  }\n};\nconst resetPassword = {\n  name: \"resetPassword\",\n  type: \"Succeed!\",\n  args: {\n    email: \"String!\"\n  },\n  resolve: async ({\n    args: {\n      email\n    }\n  }) => {\n    try {\n      const user = await _user.UserModel.findOne({\n        email\n      });\n\n      if (!user) {\n        return Promise.reject(new Error(\"User not found.\"));\n      } // const token = crypto.randomBytes(48, (err, buffer) => buffer.toString(\"hex\"));\n      // const expiresIn = moment().add(7, \"days\");\n      // user.set({\n      //     account: {\n      //         resetPassword: {\n      //             token,\n      //             expiresIn,\n      //         },\n      //     },\n      // });\n\n\n      await user.save(); // userMail.resetPassword(user, token);\n\n      return {\n        succeed: true\n      };\n    } catch (error) {\n      return Promise.reject(error);\n    }\n  }\n};\nconst newPassword = {\n  name: \"newPassword\",\n  type: \"AccessToken!\",\n  args: {\n    token: \"String!\",\n    newPassword: \"String!\"\n  },\n  resolve: async ({\n    args: {\n      token,\n      newPassword\n    }\n  }) => {\n    try {\n      const user = await _user.UserModel.findOne({\n        \"account.resetPassword.token\": token\n      });\n\n      if (!user) {\n        return Promise.reject(new Error(\"Access Token is not valid or has expired.\"));\n      }\n\n      const hash = bcrypt.hashSync(newPassword, 10);\n      user.set({\n        password: hash,\n        account: {\n          resetPassword: {\n            token: null,\n            expiresIn: null\n          }\n        }\n      });\n      await user.save();\n      const accessToken = await _jsonwebtoken.default.sign({\n        userId: user._id\n      }, process.env.JWT_SECRET, {\n        expiresIn: process.env.JWT_EXPIRATION\n      });\n      return {\n        accessToken\n      };\n    } catch (error) {\n      return Promise.reject(error);\n    }\n  }\n};\nconst changePassword = {\n  name: \"changePassword\",\n  type: \"Succeed!\",\n  args: {\n    currentPassword: \"String!\",\n    newPassword: \"String!\"\n  },\n  resolve: async ({\n    args: {\n      currentPassword,\n      newPassword\n    },\n    context: {\n      user\n    }\n  }) => {\n    try {\n      const comparePassword = await user.comparePassword(currentPassword);\n\n      if (!comparePassword) {\n        return Promise.reject(new Error(\"Current password is incorrect.\"));\n      }\n\n      const hash = bcrypt.hashSync(newPassword, 10);\n      user.set({\n        password: hash\n      });\n      await user.save();\n      return {\n        succeed: true\n      };\n    } catch (error) {\n      return Promise.reject(error);\n    }\n  }\n};\nconst verifyRequest = {\n  name: \"verifyRequest\",\n  type: \"Succeed!\",\n  resolve: async ({\n    context: {\n      user\n    }\n  }) => {\n    try {\n      // await userService.verifyRequest(user);\n      // userMail.verifyRequest(user, token);\n      return {\n        succeed: true\n      };\n    } catch (error) {\n      return Promise.reject(error);\n    }\n  }\n};\nconst verify = {\n  name: \"verify\",\n  type: \"AccessToken!\",\n  args: {\n    token: \"String!\"\n  },\n  resolve: async ({\n    args: {\n      token\n    }\n  }) => {\n    try {// const user = await UserModel.findOne({\n      //   \"account.verification.token\": token,\n      // });\n      // if (!user) {\n      //   return Promise.reject(new Error(\"Access Token is not valid or has expired.\"));\n      // }\n      //\n      // user.set({\n      //   account: {\n      //     verification: {\n      //       verified: true,\n      //       token: null,\n      //       expiresIn: null,\n      //     },\n      //   },\n      // });\n      //\n      // await user.save();\n      //\n      // const accessToken = jwt.sign({ userId: user._id }, process.env.JWT_SECRET, {\n      //   expiresIn: process.env.JWT_EXPIRATION,\n      // });\n      // userMail.verify(user);\n      // return { accessToken };\n    } catch (error) {\n      return Promise.reject(error);\n    }\n  }\n};\nvar _default = {\n  signIn,\n  signUp,\n  logout,\n  newPassword,\n  changePassword,\n  verify,\n  verifyRequest\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImF1dGgtcmVzb2x2ZXJzLmpzIl0sIm5hbWVzIjpbInNpZ25JbiIsIm5hbWUiLCJ0eXBlIiwiYXJncyIsInBob25lTnVtYmVyIiwicGFzc3dvcmQiLCJyZXNvbHZlIiwidXNlciIsIlVzZXJNb2RlbCIsImZpbmQiLCJjb25zb2xlIiwibG9nIiwiYWNjZXNzVG9rZW4iLCJqd3QiLCJzaWduIiwicHJvY2VzcyIsImVudiIsIkpXVF9TRUNSRVQiLCJleHBpcmVzSW4iLCJKV1RfRVhQSVJBVElPTiIsImVycm9yIiwiUHJvbWlzZSIsInJlamVjdCIsInNpZ25VcCIsImZpcnN0TmFtZSIsIm1pZGRsZU5hbWUiLCJsYXN0TmFtZSIsImNvbnRleHQiLCJwaG9uZVZlcmlmaWNhdGlvbiIsInNhdmUiLCJfaWQiLCJsb2dvdXQiLCJzdWNjZWVkIiwicmVzZXRQYXNzd29yZCIsImVtYWlsIiwiZmluZE9uZSIsIkVycm9yIiwibmV3UGFzc3dvcmQiLCJ0b2tlbiIsImhhc2giLCJiY3J5cHQiLCJoYXNoU3luYyIsInNldCIsImFjY291bnQiLCJ1c2VySWQiLCJjaGFuZ2VQYXNzd29yZCIsImN1cnJlbnRQYXNzd29yZCIsImNvbXBhcmVQYXNzd29yZCIsInZlcmlmeVJlcXVlc3QiLCJ2ZXJpZnkiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTs7QUFDQTs7OztBQUNBO0FBRUEsTUFBTUEsTUFBTSxHQUFHO0FBQ1hDLEVBQUFBLElBQUksRUFBRSxRQURLO0FBRVhDLEVBQUFBLElBQUksRUFBRSxjQUZLO0FBR1hDLEVBQUFBLElBQUksRUFBRTtBQUNGQyxJQUFBQSxXQUFXLEVBQUUsU0FEWDtBQUVGQyxJQUFBQSxRQUFRLEVBQUU7QUFGUixHQUhLO0FBT1hDLEVBQUFBLE9BQU8sRUFBRSxPQUFPO0FBQ0lILElBQUFBLElBQUksRUFBRTtBQUNGQyxNQUFBQSxXQURFO0FBRUZDLE1BQUFBO0FBRkU7QUFEVixHQUFQLEtBS2E7QUFDbEIsUUFBSTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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QUFBQSxNQURXO0FBRVh1QixFQUFBQSxNQUZXO0FBR1hRLEVBQUFBLE1BSFc7QUFJWE0sRUFBQUEsV0FKVztBQUtYUSxFQUFBQSxjQUxXO0FBTVhJLEVBQUFBLE1BTlc7QUFPWEQsRUFBQUE7QUFQVyxDIiwic291cmNlUm9vdCI6Ii9ob21lL25hdGhuYWVsL3Byb2plY3RzL2hhbGV0YS9oYWxldGEtbmV3LWFwaS9zcmMvZ3JhcGhxbC9hdXRoL3Jlc29sdmVycy8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgand0IGZyb20gXCJqc29ud2VidG9rZW5cIjtcbmltcG9ydCB7VXNlck1vZGVsfSBmcm9tIFwiLi4vLi4vLi4vbW9kZWxzL3VzZXJcIjtcbi8vIGltcG9ydCBjcnlwdG8gZnJvbSBcImNyeXB0b1wiO1xuXG5jb25zdCBzaWduSW4gPSB7XG4gICAgbmFtZTogXCJzaWduSW5cIixcbiAgICB0eXBlOiBcIkFjY2Vzc1Rva2VuIVwiLFxuICAgIGFyZ3M6IHtcbiAgICAgICAgcGhvbmVOdW1iZXI6IFwiU3RyaW5nIVwiLFxuICAgICAgICBwYXNzd29yZDogXCJTdHJpbmchXCIsXG4gICAgfSxcbiAgICByZXNvbHZlOiBhc3luYyAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJnczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBob25lTnVtYmVyLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSkgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gY29uc3QgdXNlciA9IGF3YWl0IFVzZXJNb2RlbC5waG9uZU51bWJlckV4aXN0KHBob25lTnVtYmVyKTtcbiAgICAgICAgICAgIC8vIGlmICghdXNlcikge1xuICAgICAgICAgICAgLy8gICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoXCJVc2VyIG5vdCBmb3VuZC5cIikpO1xuICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXJNb2RlbC5maW5kKHtwaG9uZU51bWJlcn0pO1xuXG4gICAgICAgICAgICAvLyBjb25zdCBjb21wYXJlUGFzc3dvcmQgPSBhd2FpdCB1c2VyLmNvbXBhcmVQYXNzd29yZChwYXNzd29yZC50b1N0cmluZygpKTtcbiAgICAgICAgICAgIC8vIGlmICghY29tcGFyZVBhc3N3b3JkKSB7XG4gICAgICAgICAgICAvLyAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcIlBhc3N3b3JkIGlzIGluY29ycmVjdC5cIikpO1xuICAgICAgICAgICAgLy8gfVxuXG4gICAgICAgICAgICBjb25zb2xlLmxvZyh1c2VyKVxuICAgICAgICAgICAgY29uc3QgYWNjZXNzVG9rZW4gPSBhd2FpdCBqd3Quc2lnbih1c2VyLCBwcm9jZXNzLmVudi5KV1RfU0VDUkVULCB7XG4gICAgICAgICAgICAgICAgZXhwaXJlc0luOiBwcm9jZXNzLmVudi5KV1RfRVhQSVJBVElPTixcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuLFxuICAgICAgICAgICAgICAgIC8vIHJvbGVzOiB1c2VyLnJvbGVzLFxuICAgICAgICAgICAgICAgIHVzZXIsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTtcbiAgICAgICAgfVxuICAgIH0sXG59O1xuXG5cbmNvbnN0IHNpZ25VcCA9IHtcbiAgICBuYW1lOiBcInNpZ25VcFwiLFxuICAgIHR5cGU6IFwiQWNjZXNzVG9rZW4hXCIsXG4gICAgYXJnczoge1xuICAgICAgICBmaXJzdE5hbWU6IFwiU3RyaW5nIVwiLFxuICAgICAgICBtaWRkbGVOYW1lOiBcIlN0cmluZyFcIixcbiAgICAgICAgbGFzdE5hbWU6IFwiU3RyaW5nIVwiLFxuICAgICAgICBwYXNzd29yZDogXCJTdHJpbmchXCIsXG4gICAgICAgIHBob25lTnVtYmVyOiBcIlN0cmluZyFcIixcbiAgICB9LFxuICAgIHJlc29sdmU6IGFzeW5jICh7XG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlyc3ROYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1pZGRsZU5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFzdE5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGhvbmVOdW1iZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGhvbmVWZXJpZmljYXRpb24sXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9KSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImhlcmUgMVwiKVxuICAgICAgICAgICAgLy8gbGV0IHVzZXIgPSBhd2FpdCBVc2VyTW9kZWwucGhvbmVOdW1iZXJFeGlzdChwaG9uZU51bWJlcik7XG4gICAgICAgICAgICAvLyBpZiAodXNlcikge1xuICAgICAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKFwiaGVyZSAyXCIpXG4gICAgICAgICAgICAvLyAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcIlBob25lIE51bWJlciBoYXMgYWxyZWFkeSBiZWVuIHRha2VuLlwiKSk7XG4gICAgICAgICAgICAvLyB9XG5cbiAgICAgICAgICAgIC8vIHVzZXIgPSBhd2FpdCBVc2VyTW9kZWwuZW1haWxFeGlzdChlbWFpbCk7XG4gICAgICAgICAgICAvLyBpZiAodXNlcikge1xuICAgICAgICAgICAgLy8gICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKFwiRW1haWwgaGFzIGFscmVhZHkgYmVlbiB0YWtlbi5cIikpO1xuICAgICAgICAgICAgLy8gfVxuICAgICAgICAgICAgLy8gY29uc3Qgc2FsdCA9IGJjcnlwdC5nZW5TYWx0KDEwKTtcbiAgICAgICAgICAgIC8vIGNvbnN0IGhhc2ggPSBiY3J5cHQuaGFzaFN5bmMocGFzc3dvcmQsIHNhbHQpO1xuXG4gICAgICAgICAgICBsZXQgdXNlciA9IGF3YWl0IG5ldyBVc2VyTW9kZWwoe1xuICAgICAgICAgICAgICAgIGZpcnN0TmFtZSxcbiAgICAgICAgICAgICAgICBtaWRkbGVOYW1lLFxuICAgICAgICAgICAgICAgIGxhc3ROYW1lLFxuICAgICAgICAgICAgICAgIHBob25lTnVtYmVyLFxuICAgICAgICAgICAgICAgIHBhc3N3b3JkLFxuICAgICAgICAgICAgICAgIC8vIHBhc3N3b3JkOiBoYXNoLFxuICAgICAgICAgICAgICAgIC8vIHJvbGVzOiBbcm9sZXMuT1dORVJdLFxuICAgICAgICAgICAgICAgIC8vIGFjY291bnQ6IHtcbiAgICAgICAgICAgICAgICAvLyAgICAgcGhvbmVWZXJpZmljYXRpb246IHtcbiAgICAgICAgICAgICAgICAvLyAgICAgICAgIHZlcmlmaWVkOiB0cnVlLFxuICAgICAgICAgICAgICAgIC8vICAgICAgICAgdG9rZW46IHBob25lVmVyaWZpY2F0aW9uLFxuICAgICAgICAgICAgICAgIC8vICAgICB9LFxuICAgICAgICAgICAgICAgIC8vIH0sXG4gICAgICAgICAgICB9KS5zYXZlKCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcImhlcmUgM1wiKVxuICAgICAgICAgICAgY29uc3QgYWNjZXNzVG9rZW4gPSBhd2FpdCBqd3Quc2lnbih7XG4gICAgICAgICAgICAgICAgX2lkOiB1c2VyLl9pZCxcbiAgICAgICAgICAgICAgICBmaXJzdE5hbWU6IHVzZXIuZmlyc3ROYW1lLFxuICAgICAgICAgICAgICAgIG1pZGRsZU5hbWU6IHVzZXIubWlkZGxlTmFtZSxcbiAgICAgICAgICAgICAgICBsYXN0TmFtZTogdXNlci5sYXN0TmFtZSxcbiAgICAgICAgICAgICAgICBwaG9uZU51bWJlcjogdXNlci5waG9uZU51bWJlcixcbiAgICAgICAgICAgICAgICAvLyByb2xlczogdXNlci5yb2xlcyxcbiAgICAgICAgICAgIH0sIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQsIHtcbiAgICAgICAgICAgICAgICBleHBpcmVzSW46IHByb2Nlc3MuZW52LkpXVF9FWFBJUkFUSU9OLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIGF3YWl0IHVzZXJTZXJ2aWNlLnZlcmlmeVJlcXVlc3QodXNlcik7XG5cbiAgICAgICAgICAgIC8vIHVzZXJNYWlsLnZlcmlmeVJlcXVlc3QodXNlciwgdG9rZW4pO1xuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuLFxuICAgICAgICAgICAgICAgIC8vIHJvbGVzOiB1c2VyLnJvbGVzLFxuICAgICAgICAgICAgICAgIHVzZXIsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTtcbiAgICAgICAgfVxuICAgIH0sXG59O1xuXG5jb25zdCBsb2dvdXQgPSB7XG4gICAgbmFtZTogJ2xvZ291dCcsXG4gICAgdHlwZTogJ1N1Y2NlZWQhJyxcbiAgICByZXNvbHZlOiBhc3luYyAoe2NvbnRleHQ6IHt1c2VyLCBhY2Nlc3NUb2tlbn19KSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBhd2FpdCByZWRpcy5zZXQoYGV4cGlyZWRUb2tlbjoke2FjY2Vzc1Rva2VufWAsIHVzZXIuX2lkLCAnRVgnLCBwcm9jZXNzLmVudi5SRURJU19UT0tFTl9FWFBJUlkpO1xuXG4gICAgICAgICAgICByZXR1cm4ge3N1Y2NlZWQ6IHRydWV9O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbmNvbnN0IHJlc2V0UGFzc3dvcmQgPSB7XG4gICAgbmFtZTogXCJyZXNldFBhc3N3b3JkXCIsXG4gICAgdHlwZTogXCJTdWNjZWVkIVwiLFxuICAgIGFyZ3M6IHtlbWFpbDogXCJTdHJpbmchXCJ9LFxuICAgIHJlc29sdmU6IGFzeW5jICh7YXJnczoge2VtYWlsfX0pID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2VyTW9kZWwuZmluZE9uZSh7ZW1haWx9KTtcbiAgICAgICAgICAgIGlmICghdXNlcikge1xuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoXCJVc2VyIG5vdCBmb3VuZC5cIikpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBjb25zdCB0b2tlbiA9IGNyeXB0by5yYW5kb21CeXRlcyg0OCwgKGVyciwgYnVmZmVyKSA9PiBidWZmZXIudG9TdHJpbmcoXCJoZXhcIikpO1xuICAgICAgICAgICAgLy8gY29uc3QgZXhwaXJlc0luID0gbW9tZW50KCkuYWRkKDcsIFwiZGF5c1wiKTtcblxuICAgICAgICAgICAgLy8gdXNlci5zZXQoe1xuICAgICAgICAgICAgLy8gICAgIGFjY291bnQ6IHtcbiAgICAgICAgICAgIC8vICAgICAgICAgcmVzZXRQYXNzd29yZDoge1xuICAgICAgICAgICAgLy8gICAgICAgICAgICAgdG9rZW4sXG4gICAgICAgICAgICAvLyAgICAgICAgICAgICBleHBpcmVzSW4sXG4gICAgICAgICAgICAvLyAgICAgICAgIH0sXG4gICAgICAgICAgICAvLyAgICAgfSxcbiAgICAgICAgICAgIC8vIH0pO1xuXG4gICAgICAgICAgICBhd2FpdCB1c2VyLnNhdmUoKTtcblxuICAgICAgICAgICAgLy8gdXNlck1haWwucmVzZXRQYXNzd29yZCh1c2VyLCB0b2tlbik7XG5cbiAgICAgICAgICAgIHJldHVybiB7c3VjY2VlZDogdHJ1ZX07XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xuICAgICAgICB9XG4gICAgfSxcbn07XG5cbmNvbnN0IG5ld1Bhc3N3b3JkID0ge1xuICAgIG5hbWU6IFwibmV3UGFzc3dvcmRcIixcbiAgICB0eXBlOiBcIkFjY2Vzc1Rva2VuIVwiLFxuICAgIGFyZ3M6IHtcbiAgICAgICAgdG9rZW46IFwiU3RyaW5nIVwiLFxuICAgICAgICBuZXdQYXNzd29yZDogXCJTdHJpbmchXCIsXG4gICAgfSxcbiAgICByZXNvbHZlOiBhc3luYyAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJnczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRva2VuLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1Bhc3N3b3JkLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSkgPT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXJNb2RlbC5maW5kT25lKHtcbiAgICAgICAgICAgICAgICBcImFjY291bnQucmVzZXRQYXNzd29yZC50b2tlblwiOiB0b2tlbixcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcIkFjY2VzcyBUb2tlbiBpcyBub3QgdmFsaWQgb3IgaGFzIGV4cGlyZWQuXCIpKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgaGFzaCA9IGJjcnlwdC5oYXNoU3luYyhuZXdQYXNzd29yZCwgMTApO1xuXG4gICAgICAgICAgICB1c2VyLnNldCh7XG4gICAgICAgICAgICAgICAgcGFzc3dvcmQ6IGhhc2gsXG4gICAgICAgICAgICAgICAgYWNjb3VudDoge1xuICAgICAgICAgICAgICAgICAgICByZXNldFBhc3N3b3JkOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0b2tlbjogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cGlyZXNJbjogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGF3YWl0IHVzZXIuc2F2ZSgpO1xuXG4gICAgICAgICAgICBjb25zdCBhY2Nlc3NUb2tlbiA9IGF3YWl0IGp3dC5zaWduKHt1c2VySWQ6IHVzZXIuX2lkfSwgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCwge1xuICAgICAgICAgICAgICAgIGV4cGlyZXNJbjogcHJvY2Vzcy5lbnYuSldUX0VYUElSQVRJT04sXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIHthY2Nlc3NUb2tlbn07XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xuICAgICAgICB9XG4gICAgfSxcbn07XG5cbmNvbnN0IGNoYW5nZVBhc3N3b3JkID0ge1xuICAgIG5hbWU6IFwiY2hhbmdlUGFzc3dvcmRcIixcbiAgICB0eXBlOiBcIlN1Y2NlZWQhXCIsXG4gICAgYXJnczoge1xuICAgICAgICBjdXJyZW50UGFzc3dvcmQ6IFwiU3RyaW5nIVwiLFxuICAgICAgICBuZXdQYXNzd29yZDogXCJTdHJpbmchXCIsXG4gICAgfSxcbiAgICByZXNvbHZlOiBhc3luYyAoe1xuICAgICAgICAgICAgICAgICAgICAgICAgYXJnczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQYXNzd29yZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdQYXNzd29yZCxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0OiB7dXNlcn0sXG4gICAgICAgICAgICAgICAgICAgIH0pID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGNvbXBhcmVQYXNzd29yZCA9IGF3YWl0IHVzZXIuY29tcGFyZVBhc3N3b3JkKGN1cnJlbnRQYXNzd29yZCk7XG4gICAgICAgICAgICBpZiAoIWNvbXBhcmVQYXNzd29yZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoXCJDdXJyZW50IHBhc3N3b3JkIGlzIGluY29ycmVjdC5cIikpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBoYXNoID0gYmNyeXB0Lmhhc2hTeW5jKG5ld1Bhc3N3b3JkLCAxMCk7XG5cbiAgICAgICAgICAgIHVzZXIuc2V0KHtwYXNzd29yZDogaGFzaH0pO1xuXG4gICAgICAgICAgICBhd2FpdCB1c2VyLnNhdmUoKTtcblxuICAgICAgICAgICAgcmV0dXJuIHtzdWNjZWVkOiB0cnVlfTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XG4gICAgICAgIH1cbiAgICB9LFxufTtcblxuY29uc3QgdmVyaWZ5UmVxdWVzdCA9IHtcbiAgICBuYW1lOiBcInZlcmlmeVJlcXVlc3RcIixcbiAgICB0eXBlOiBcIlN1Y2NlZWQhXCIsXG4gICAgcmVzb2x2ZTogYXN5bmMgKHtjb250ZXh0OiB7dXNlcn19KSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBhd2FpdCB1c2VyU2VydmljZS52ZXJpZnlSZXF1ZXN0KHVzZXIpO1xuXG4gICAgICAgICAgICAvLyB1c2VyTWFpbC52ZXJpZnlSZXF1ZXN0KHVzZXIsIHRva2VuKTtcblxuICAgICAgICAgICAgcmV0dXJuIHtzdWNjZWVkOiB0cnVlfTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChlcnJvcik7XG4gICAgICAgIH1cbiAgICB9LFxufTtcblxuY29uc3QgdmVyaWZ5ID0ge1xuICAgIG5hbWU6IFwidmVyaWZ5XCIsXG4gICAgdHlwZTogXCJBY2Nlc3NUb2tlbiFcIixcbiAgICBhcmdzOiB7dG9rZW46IFwiU3RyaW5nIVwifSxcbiAgICByZXNvbHZlOiBhc3luYyAoe2FyZ3M6IHt0b2tlbn19KSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBjb25zdCB1c2VyID0gYXdhaXQgVXNlck1vZGVsLmZpbmRPbmUoe1xuICAgICAgICAgICAgLy8gICBcImFjY291bnQudmVyaWZpY2F0aW9uLnRva2VuXCI6IHRva2VuLFxuICAgICAgICAgICAgLy8gfSk7XG4gICAgICAgICAgICAvLyBpZiAoIXVzZXIpIHtcbiAgICAgICAgICAgIC8vICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcIkFjY2VzcyBUb2tlbiBpcyBub3QgdmFsaWQgb3IgaGFzIGV4cGlyZWQuXCIpKTtcbiAgICAgICAgICAgIC8vIH1cbiAgICAgICAgICAgIC8vXG4gICAgICAgICAgICAvLyB1c2VyLnNldCh7XG4gICAgICAgICAgICAvLyAgIGFjY291bnQ6IHtcbiAgICAgICAgICAgIC8vICAgICB2ZXJpZmljYXRpb246IHtcbiAgICAgICAgICAgIC8vICAgICAgIHZlcmlmaWVkOiB0cnVlLFxuICAgICAgICAgICAgLy8gICAgICAgdG9rZW46IG51bGwsXG4gICAgICAgICAgICAvLyAgICAgICBleHBpcmVzSW46IG51bGwsXG4gICAgICAgICAgICAvLyAgICAgfSxcbiAgICAgICAgICAgIC8vICAgfSxcbiAgICAgICAgICAgIC8vIH0pO1xuICAgICAgICAgICAgLy9cbiAgICAgICAgICAgIC8vIGF3YWl0IHVzZXIuc2F2ZSgpO1xuICAgICAgICAgICAgLy9cbiAgICAgICAgICAgIC8vIGNvbnN0IGFjY2Vzc1Rva2VuID0gand0LnNpZ24oeyB1c2VySWQ6IHVzZXIuX2lkIH0sIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQsIHtcbiAgICAgICAgICAgIC8vICAgZXhwaXJlc0luOiBwcm9jZXNzLmVudi5KV1RfRVhQSVJBVElPTixcbiAgICAgICAgICAgIC8vIH0pO1xuXG4gICAgICAgICAgICAvLyB1c2VyTWFpbC52ZXJpZnkodXNlcik7XG5cbiAgICAgICAgICAgIC8vIHJldHVybiB7IGFjY2Vzc1Rva2VuIH07XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXJyb3IpO1xuICAgICAgICB9XG4gICAgfSxcbn07XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgICBzaWduSW4sXG4gICAgc2lnblVwLFxuICAgIGxvZ291dCxcbiAgICBuZXdQYXNzd29yZCxcbiAgICBjaGFuZ2VQYXNzd29yZCxcbiAgICB2ZXJpZnksXG4gICAgdmVyaWZ5UmVxdWVzdFxufSJdfQ==","map":{"version":3,"sources":["auth-resolvers.js"],"names":["signIn","name","type","args","phoneNumber","password","resolve","user","UserModel","find","console","log","accessToken","jwt","sign","process","env","JWT_SECRET","expiresIn","JWT_EXPIRATION","error","Promise","reject","signUp","firstName","middleName","lastName","context","phoneVerification","save","_id","logout","succeed","resetPassword","email","findOne","Error","newPassword","token","hash","bcrypt","hashSync","set","account","userId","changePassword","currentPassword","comparePassword","verifyRequest","verify"],"mappings":"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","sourceRoot":"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/auth/resolvers/","sourcesContent":["import jwt from \"jsonwebtoken\";\nimport {UserModel} from \"../../../models/user\";\n// import crypto from \"crypto\";\n\nconst signIn = {\n    name: \"signIn\",\n    type: \"AccessToken!\",\n    args: {\n        phoneNumber: \"String!\",\n        password: \"String!\",\n    },\n    resolve: async ({\n                        args: {\n                            phoneNumber,\n                            password,\n                        },\n                    }) => {\n        try {\n            // const user = await UserModel.phoneNumberExist(phoneNumber);\n            // if (!user) {\n            //     return Promise.reject(new Error(\"User not found.\"));\n            // }\n            const user = await UserModel.find({phoneNumber});\n\n            // const comparePassword = await user.comparePassword(password.toString());\n            // if (!comparePassword) {\n            //     return Promise.reject(new Error(\"Password is incorrect.\"));\n            // }\n\n            console.log(user)\n            const accessToken = await jwt.sign(user, process.env.JWT_SECRET, {\n                expiresIn: process.env.JWT_EXPIRATION,\n            });\n\n            return {\n                accessToken,\n                // roles: user.roles,\n                user,\n            };\n        } catch (error) {\n            return Promise.reject(error);\n        }\n    },\n};\n\n\nconst signUp = {\n    name: \"signUp\",\n    type: \"AccessToken!\",\n    args: {\n        firstName: \"String!\",\n        middleName: \"String!\",\n        lastName: \"String!\",\n        password: \"String!\",\n        phoneNumber: \"String!\",\n    },\n    resolve: async ({\n                        args: {\n                            firstName,\n                            middleName,\n                            lastName,\n                            password,\n                            phoneNumber\n                        },\n                        context: {\n                            phoneVerification,\n                        },\n                    }) => {\n        try {\n            console.log(\"here 1\")\n            // let user = await UserModel.phoneNumberExist(phoneNumber);\n            // if (user) {\n            //     console.log(\"here 2\")\n            //     return Promise.reject(new Error(\"Phone Number has already been taken.\"));\n            // }\n\n            // user = await UserModel.emailExist(email);\n            // if (user) {\n            //   return Promise.reject(new Error(\"Email has already been taken.\"));\n            // }\n            // const salt = bcrypt.genSalt(10);\n            // const hash = bcrypt.hashSync(password, salt);\n\n            let user = await new UserModel({\n                firstName,\n                middleName,\n                lastName,\n                phoneNumber,\n                password,\n                // password: hash,\n                // roles: [roles.OWNER],\n                // account: {\n                //     phoneVerification: {\n                //         verified: true,\n                //         token: phoneVerification,\n                //     },\n                // },\n            }).save();\n            console.log(\"here 3\")\n            const accessToken = await jwt.sign({\n                _id: user._id,\n                firstName: user.firstName,\n                middleName: user.middleName,\n                lastName: user.lastName,\n                phoneNumber: user.phoneNumber,\n                // roles: user.roles,\n            }, process.env.JWT_SECRET, {\n                expiresIn: process.env.JWT_EXPIRATION,\n            });\n\n            // await userService.verifyRequest(user);\n\n            // userMail.verifyRequest(user, token);\n\n            return {\n                accessToken,\n                // roles: user.roles,\n                user,\n            };\n        } catch (error) {\n            return Promise.reject(error);\n        }\n    },\n};\n\nconst logout = {\n    name: 'logout',\n    type: 'Succeed!',\n    resolve: async ({context: {user, accessToken}}) => {\n        try {\n            // await redis.set(`expiredToken:${accessToken}`, user._id, 'EX', process.env.REDIS_TOKEN_EXPIRY);\n\n            return {succeed: true};\n        } catch (error) {\n            return Promise.reject(error);\n        }\n    }\n};\n\nconst resetPassword = {\n    name: \"resetPassword\",\n    type: \"Succeed!\",\n    args: {email: \"String!\"},\n    resolve: async ({args: {email}}) => {\n        try {\n            const user = await UserModel.findOne({email});\n            if (!user) {\n                return Promise.reject(new Error(\"User not found.\"));\n            }\n\n            // const token = crypto.randomBytes(48, (err, buffer) => buffer.toString(\"hex\"));\n            // const expiresIn = moment().add(7, \"days\");\n\n            // user.set({\n            //     account: {\n            //         resetPassword: {\n            //             token,\n            //             expiresIn,\n            //         },\n            //     },\n            // });\n\n            await user.save();\n\n            // userMail.resetPassword(user, token);\n\n            return {succeed: true};\n        } catch (error) {\n            return Promise.reject(error);\n        }\n    },\n};\n\nconst newPassword = {\n    name: \"newPassword\",\n    type: \"AccessToken!\",\n    args: {\n        token: \"String!\",\n        newPassword: \"String!\",\n    },\n    resolve: async ({\n                        args: {\n                            token,\n                            newPassword,\n                        },\n                    }) => {\n        try {\n            const user = await UserModel.findOne({\n                \"account.resetPassword.token\": token,\n            });\n            if (!user) {\n                return Promise.reject(new Error(\"Access Token is not valid or has expired.\"));\n            }\n\n            const hash = bcrypt.hashSync(newPassword, 10);\n\n            user.set({\n                password: hash,\n                account: {\n                    resetPassword: {\n                        token: null,\n                        expiresIn: null,\n                    },\n                },\n            });\n\n            await user.save();\n\n            const accessToken = await jwt.sign({userId: user._id}, process.env.JWT_SECRET, {\n                expiresIn: process.env.JWT_EXPIRATION,\n            });\n\n            return {accessToken};\n        } catch (error) {\n            return Promise.reject(error);\n        }\n    },\n};\n\nconst changePassword = {\n    name: \"changePassword\",\n    type: \"Succeed!\",\n    args: {\n        currentPassword: \"String!\",\n        newPassword: \"String!\",\n    },\n    resolve: async ({\n                        args: {\n                            currentPassword,\n                            newPassword,\n                        },\n                        context: {user},\n                    }) => {\n        try {\n            const comparePassword = await user.comparePassword(currentPassword);\n            if (!comparePassword) {\n                return Promise.reject(new Error(\"Current password is incorrect.\"));\n            }\n\n            const hash = bcrypt.hashSync(newPassword, 10);\n\n            user.set({password: hash});\n\n            await user.save();\n\n            return {succeed: true};\n        } catch (error) {\n            return Promise.reject(error);\n        }\n    },\n};\n\nconst verifyRequest = {\n    name: \"verifyRequest\",\n    type: \"Succeed!\",\n    resolve: async ({context: {user}}) => {\n        try {\n            // await userService.verifyRequest(user);\n\n            // userMail.verifyRequest(user, token);\n\n            return {succeed: true};\n        } catch (error) {\n            return Promise.reject(error);\n        }\n    },\n};\n\nconst verify = {\n    name: \"verify\",\n    type: \"AccessToken!\",\n    args: {token: \"String!\"},\n    resolve: async ({args: {token}}) => {\n        try {\n            // const user = await UserModel.findOne({\n            //   \"account.verification.token\": token,\n            // });\n            // if (!user) {\n            //   return Promise.reject(new Error(\"Access Token is not valid or has expired.\"));\n            // }\n            //\n            // user.set({\n            //   account: {\n            //     verification: {\n            //       verified: true,\n            //       token: null,\n            //       expiresIn: null,\n            //     },\n            //   },\n            // });\n            //\n            // await user.save();\n            //\n            // const accessToken = jwt.sign({ userId: user._id }, process.env.JWT_SECRET, {\n            //   expiresIn: process.env.JWT_EXPIRATION,\n            // });\n\n            // userMail.verify(user);\n\n            // return { accessToken };\n        } catch (error) {\n            return Promise.reject(error);\n        }\n    },\n};\n\nexport default {\n    signIn,\n    signUp,\n    logout,\n    newPassword,\n    changePassword,\n    verify,\n    verifyRequest\n}"]}},"mtime":1648317650632},"{\"assumptions\":{},\"sourceRoot\":\"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/auth/typedefs/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"filename\":\"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/auth/typedefs/types.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nvar _graphqlCompose = require(\"graphql-compose\");\n\nvar _user = require(\"../../../models/user\");\n\n_graphqlCompose.schemaComposer.createObjectTC({\n  name: \"AccessToken\",\n  fields: {\n    accessToken: \"String!\",\n    roles: \"[String]\",\n    user: _user.UserTC\n  }\n});\n\n_graphqlCompose.schemaComposer.createObjectTC({\n  name: \"Succeed\",\n  fields: {\n    succeed: \"Boolean!\"\n  }\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInR5cGVzLmpzIl0sIm5hbWVzIjpbInNjaGVtYUNvbXBvc2VyIiwiY3JlYXRlT2JqZWN0VEMiLCJuYW1lIiwiZmllbGRzIiwiYWNjZXNzVG9rZW4iLCJyb2xlcyIsInVzZXIiLCJVc2VyVEMiLCJzdWNjZWVkIl0sIm1hcHBpbmdzIjoiOztBQUFBOztBQUNBOztBQUVBQSwrQkFBZUMsY0FBZixDQUE4QjtBQUMxQkMsRUFBQUEsSUFBSSxFQUFFLGFBRG9CO0FBRTFCQyxFQUFBQSxNQUFNLEVBQUU7QUFDSkMsSUFBQUEsV0FBVyxFQUFFLFNBRFQ7QUFFSkMsSUFBQUEsS0FBSyxFQUFFLFVBRkg7QUFHSkMsSUFBQUEsSUFBSSxFQUFFQztBQUhGO0FBRmtCLENBQTlCOztBQVNBUCwrQkFBZUMsY0FBZixDQUE4QjtBQUMxQkMsRUFBQUEsSUFBSSxFQUFFLFNBRG9CO0FBRTFCQyxFQUFBQSxNQUFNLEVBQUU7QUFBQ0ssSUFBQUEsT0FBTyxFQUFFO0FBQVY7QUFGa0IsQ0FBOUIiLCJzb3VyY2VSb290IjoiL2hvbWUvbmF0aG5hZWwvcHJvamVjdHMvaGFsZXRhL2hhbGV0YS1uZXctYXBpL3NyYy9ncmFwaHFsL2F1dGgvdHlwZWRlZnMvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtzY2hlbWFDb21wb3Nlcn0gZnJvbSBcImdyYXBocWwtY29tcG9zZVwiO1xuaW1wb3J0IHtVc2VyVEN9IGZyb20gXCIuLi8uLi8uLi9tb2RlbHMvdXNlclwiO1xuXG5zY2hlbWFDb21wb3Nlci5jcmVhdGVPYmplY3RUQyh7XG4gICAgbmFtZTogXCJBY2Nlc3NUb2tlblwiLFxuICAgIGZpZWxkczoge1xuICAgICAgICBhY2Nlc3NUb2tlbjogXCJTdHJpbmchXCIsXG4gICAgICAgIHJvbGVzOiBcIltTdHJpbmddXCIsXG4gICAgICAgIHVzZXI6IFVzZXJUQyxcbiAgICB9LFxufSk7XG5cbnNjaGVtYUNvbXBvc2VyLmNyZWF0ZU9iamVjdFRDKHtcbiAgICBuYW1lOiBcIlN1Y2NlZWRcIixcbiAgICBmaWVsZHM6IHtzdWNjZWVkOiBcIkJvb2xlYW4hXCJ9LFxufSk7Il19","map":{"version":3,"sources":["types.js"],"names":["schemaComposer","createObjectTC","name","fields","accessToken","roles","user","UserTC","succeed"],"mappings":";;AAAA;;AACA;;AAEAA,+BAAeC,cAAf,CAA8B;AAC1BC,EAAAA,IAAI,EAAE,aADoB;AAE1BC,EAAAA,MAAM,EAAE;AACJC,IAAAA,WAAW,EAAE,SADT;AAEJC,IAAAA,KAAK,EAAE,UAFH;AAGJC,IAAAA,IAAI,EAAEC;AAHF;AAFkB,CAA9B;;AASAP,+BAAeC,cAAf,CAA8B;AAC1BC,EAAAA,IAAI,EAAE,SADoB;AAE1BC,EAAAA,MAAM,EAAE;AAACK,IAAAA,OAAO,EAAE;AAAV;AAFkB,CAA9B","sourceRoot":"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/auth/typedefs/","sourcesContent":["import {schemaComposer} from \"graphql-compose\";\nimport {UserTC} from \"../../../models/user\";\n\nschemaComposer.createObjectTC({\n    name: \"AccessToken\",\n    fields: {\n        accessToken: \"String!\",\n        roles: \"[String]\",\n        user: UserTC,\n    },\n});\n\nschemaComposer.createObjectTC({\n    name: \"Succeed\",\n    fields: {succeed: \"Boolean!\"},\n});"]}},"mtime":1648313712828},"{\"assumptions\":{},\"sourceRoot\":\"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/user/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"filename\":\"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/user/index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.UserQuery = exports.UserMutation = void 0;\n\nvar _user = require(\"../../models/user\");\n\nvar _middlewares = require(\"../../middlewares\");\n\n// import Resolvers from \"./services\";\n//\n// for (const resolver in Resolvers) {\n//     UserTC.addResolver(Resolvers[resolver]);\n// }\nconst UserQuery = {\n  userById: _user.UserTC.getResolver(\"findById\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userByIds: _user.UserTC.getResolver(\"findByIds\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userOne: _user.UserTC.getResolver(\"findOne\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userMany: _user.UserTC.getResolver(\"findMany\", [_middlewares.authentication.isAuth, _middlewares.authorization])\n};\nexports.UserQuery = UserQuery;\nconst UserMutation = {\n  userCreateOne: _user.UserTC.getResolver(\"createOne\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userCreateMany: _user.UserTC.getResolver(\"createMany\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userUpdateById: _user.UserTC.getResolver(\"updateById\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userUpdateOne: _user.UserTC.getResolver(\"updateOne\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userUpdateMany: _user.UserTC.getResolver(\"updateMany\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userRemoveById: _user.UserTC.getResolver(\"removeById\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userRemoveOne: _user.UserTC.getResolver(\"removeOne\", [_middlewares.authentication.isAuth, _middlewares.authorization]),\n  userRemoveMany: _user.UserTC.getResolver(\"removeMany\", [_middlewares.authentication.isAuth, _middlewares.authorization])\n};\nexports.UserMutation = UserMutation;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sIm5hbWVzIjpbIlVzZXJRdWVyeSIsInVzZXJCeUlkIiwiVXNlclRDIiwiZ2V0UmVzb2x2ZXIiLCJhdXRoZW50aWNhdGlvbiIsImlzQXV0aCIsImF1dGhvcml6YXRpb24iLCJ1c2VyQnlJZHMiLCJ1c2VyT25lIiwidXNlck1hbnkiLCJVc2VyTXV0YXRpb24iLCJ1c2VyQ3JlYXRlT25lIiwidXNlckNyZWF0ZU1hbnkiLCJ1c2VyVXBkYXRlQnlJZCIsInVzZXJVcGRhdGVPbmUiLCJ1c2VyVXBkYXRlTWFueSIsInVzZXJSZW1vdmVCeUlkIiwidXNlclJlbW92ZU9uZSIsInVzZXJSZW1vdmVNYW55Il0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBRUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBLE1BQU1BLFNBQVMsR0FBRztBQUNkQyxFQUFBQSxRQUFRLEVBQUVDLGFBQU9DLFdBQVAsQ0FBbUIsVUFBbkIsRUFBK0IsQ0FBQ0MsNEJBQWVDLE1BQWhCLEVBQXdCQywwQkFBeEIsQ0FBL0IsQ0FESTtBQUVkQyxFQUFBQSxTQUFTLEVBQUVMLGFBQU9DLFdBQVAsQ0FBbUIsV0FBbkIsRUFBZ0MsQ0FBQ0MsNEJBQWVDLE1BQWhCLEVBQXdCQywwQkFBeEIsQ0FBaEMsQ0FGRztBQUdkRSxFQUFBQSxPQUFPLEVBQUVOLGFBQU9DLFdBQVAsQ0FBbUIsU0FBbkIsRUFBOEIsQ0FBQ0MsNEJBQWVDLE1BQWhCLEVBQXdCQywwQkFBeEIsQ0FBOUIsQ0FISztBQUlkRyxFQUFBQSxRQUFRLEVBQUVQLGFBQU9DLFdBQVAsQ0FBbUIsVUFBbkIsRUFBK0IsQ0FBQ0MsNEJBQWVDLE1BQWhCLEVBQXdCQywwQkFBeEIsQ0FBL0I7QUFKSSxDQUFsQjs7QUFPQSxNQUFNSSxZQUFZLEdBQUc7QUFDakJDLEVBQUFBLGFBQWEsRUFBRVQsYUFBT0MsV0FBUCxDQUFtQixXQUFuQixFQUFnQyxDQUFDQyw0QkFBZUMsTUFBaEIsRUFBd0JDLDBCQUF4QixDQUFoQyxDQURFO0FBRWpCTSxFQUFBQSxjQUFjLEVBQUVWLGFBQU9DLFdBQVAsQ0FBbUIsWUFBbkIsRUFBaUMsQ0FBQ0MsNEJBQWVDLE1BQWhCLEVBQXdCQywwQkFBeEIsQ0FBakMsQ0FGQztBQUdqQk8sRUFBQUEsY0FBYyxFQUFFWCxhQUFPQyxXQUFQLENBQW1CLFlBQW5CLEVBQWlDLENBQUNDLDRCQUFlQyxNQUFoQixFQUF3QkMsMEJBQXhCLENBQWpDLENBSEM7QUFJakJRLEVBQUFBLGFBQWEsRUFBRVosYUFBT0MsV0FBUCxDQUFtQixXQUFuQixFQUFnQyxDQUFDQyw0QkFBZUMsTUFBaEIsRUFBd0JDLDBCQUF4QixDQUFoQyxDQUpFO0FBS2pCUyxFQUFBQSxjQUFjLEVBQUViLGFBQU9DLFdBQVAsQ0FBbUIsWUFBbkIsRUFBaUMsQ0FBQ0MsNEJBQWVDLE1BQWhCLEVBQXdCQywwQkFBeEIsQ0FBakMsQ0FMQztBQU1qQlUsRUFBQUEsY0FBYyxFQUFFZCxhQUFPQyxXQUFQLENBQW1CLFlBQW5CLEVBQWlDLENBQUNDLDRCQUFlQyxNQUFoQixFQUF3QkMsMEJBQXhCLENBQWpDLENBTkM7QUFPakJXLEVBQUFBLGFBQWEsRUFBRWYsYUFBT0MsV0FBUCxDQUFtQixXQUFuQixFQUFnQyxDQUFDQyw0QkFBZUMsTUFBaEIsRUFBd0JDLDBCQUF4QixDQUFoQyxDQVBFO0FBUWpCWSxFQUFBQSxjQUFjLEVBQUVoQixhQUFPQyxXQUFQLENBQW1CLFlBQW5CLEVBQWlDLENBQUNDLDRCQUFlQyxNQUFoQixFQUF3QkMsMEJBQXhCLENBQWpDO0FBUkMsQ0FBckIiLCJzb3VyY2VSb290IjoiL2hvbWUvbmF0aG5hZWwvcHJvamVjdHMvaGFsZXRhL2hhbGV0YS1uZXctYXBpL3NyYy9ncmFwaHFsL3VzZXIvIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtVc2VyVEN9IGZyb20gXCIuLi8uLi9tb2RlbHMvdXNlclwiO1xuXG5pbXBvcnQge2F1dGhlbnRpY2F0aW9uLCBhdXRob3JpemF0aW9ufSBmcm9tIFwiLi4vLi4vbWlkZGxld2FyZXNcIjtcbi8vIGltcG9ydCBSZXNvbHZlcnMgZnJvbSBcIi4vc2VydmljZXNcIjtcbi8vXG4vLyBmb3IgKGNvbnN0IHJlc29sdmVyIGluIFJlc29sdmVycykge1xuLy8gICAgIFVzZXJUQy5hZGRSZXNvbHZlcihSZXNvbHZlcnNbcmVzb2x2ZXJdKTtcbi8vIH1cblxuY29uc3QgVXNlclF1ZXJ5ID0ge1xuICAgIHVzZXJCeUlkOiBVc2VyVEMuZ2V0UmVzb2x2ZXIoXCJmaW5kQnlJZFwiLCBbYXV0aGVudGljYXRpb24uaXNBdXRoLCBhdXRob3JpemF0aW9uXSksXG4gICAgdXNlckJ5SWRzOiBVc2VyVEMuZ2V0UmVzb2x2ZXIoXCJmaW5kQnlJZHNcIiwgW2F1dGhlbnRpY2F0aW9uLmlzQXV0aCwgYXV0aG9yaXphdGlvbl0pLFxuICAgIHVzZXJPbmU6IFVzZXJUQy5nZXRSZXNvbHZlcihcImZpbmRPbmVcIiwgW2F1dGhlbnRpY2F0aW9uLmlzQXV0aCwgYXV0aG9yaXphdGlvbl0pLFxuICAgIHVzZXJNYW55OiBVc2VyVEMuZ2V0UmVzb2x2ZXIoXCJmaW5kTWFueVwiLCBbYXV0aGVudGljYXRpb24uaXNBdXRoLCBhdXRob3JpemF0aW9uXSksXG59O1xuXG5jb25zdCBVc2VyTXV0YXRpb24gPSB7XG4gICAgdXNlckNyZWF0ZU9uZTogVXNlclRDLmdldFJlc29sdmVyKFwiY3JlYXRlT25lXCIsIFthdXRoZW50aWNhdGlvbi5pc0F1dGgsIGF1dGhvcml6YXRpb25dKSxcbiAgICB1c2VyQ3JlYXRlTWFueTogVXNlclRDLmdldFJlc29sdmVyKFwiY3JlYXRlTWFueVwiLCBbYXV0aGVudGljYXRpb24uaXNBdXRoLCBhdXRob3JpemF0aW9uXSksXG4gICAgdXNlclVwZGF0ZUJ5SWQ6IFVzZXJUQy5nZXRSZXNvbHZlcihcInVwZGF0ZUJ5SWRcIiwgW2F1dGhlbnRpY2F0aW9uLmlzQXV0aCwgYXV0aG9yaXphdGlvbl0pLFxuICAgIHVzZXJVcGRhdGVPbmU6IFVzZXJUQy5nZXRSZXNvbHZlcihcInVwZGF0ZU9uZVwiLCBbYXV0aGVudGljYXRpb24uaXNBdXRoLCBhdXRob3JpemF0aW9uXSksXG4gICAgdXNlclVwZGF0ZU1hbnk6IFVzZXJUQy5nZXRSZXNvbHZlcihcInVwZGF0ZU1hbnlcIiwgW2F1dGhlbnRpY2F0aW9uLmlzQXV0aCwgYXV0aG9yaXphdGlvbl0pLFxuICAgIHVzZXJSZW1vdmVCeUlkOiBVc2VyVEMuZ2V0UmVzb2x2ZXIoXCJyZW1vdmVCeUlkXCIsIFthdXRoZW50aWNhdGlvbi5pc0F1dGgsIGF1dGhvcml6YXRpb25dKSxcbiAgICB1c2VyUmVtb3ZlT25lOiBVc2VyVEMuZ2V0UmVzb2x2ZXIoXCJyZW1vdmVPbmVcIiwgW2F1dGhlbnRpY2F0aW9uLmlzQXV0aCwgYXV0aG9yaXphdGlvbl0pLFxuICAgIHVzZXJSZW1vdmVNYW55OiBVc2VyVEMuZ2V0UmVzb2x2ZXIoXCJyZW1vdmVNYW55XCIsIFthdXRoZW50aWNhdGlvbi5pc0F1dGgsIGF1dGhvcml6YXRpb25dKSxcbn07XG5cbmV4cG9ydCB7VXNlclF1ZXJ5LCBVc2VyTXV0YXRpb259O1xuIl19","map":{"version":3,"sources":["index.js"],"names":["UserQuery","userById","UserTC","getResolver","authentication","isAuth","authorization","userByIds","userOne","userMany","UserMutation","userCreateOne","userCreateMany","userUpdateById","userUpdateOne","userUpdateMany","userRemoveById","userRemoveOne","userRemoveMany"],"mappings":";;;;;;;AAAA;;AAEA;;AACA;AACA;AACA;AACA;AACA;AAEA,MAAMA,SAAS,GAAG;AACdC,EAAAA,QAAQ,EAAEC,aAAOC,WAAP,CAAmB,UAAnB,EAA+B,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAA/B,CADI;AAEdC,EAAAA,SAAS,EAAEL,aAAOC,WAAP,CAAmB,WAAnB,EAAgC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAhC,CAFG;AAGdE,EAAAA,OAAO,EAAEN,aAAOC,WAAP,CAAmB,SAAnB,EAA8B,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAA9B,CAHK;AAIdG,EAAAA,QAAQ,EAAEP,aAAOC,WAAP,CAAmB,UAAnB,EAA+B,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAA/B;AAJI,CAAlB;;AAOA,MAAMI,YAAY,GAAG;AACjBC,EAAAA,aAAa,EAAET,aAAOC,WAAP,CAAmB,WAAnB,EAAgC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAhC,CADE;AAEjBM,EAAAA,cAAc,EAAEV,aAAOC,WAAP,CAAmB,YAAnB,EAAiC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAjC,CAFC;AAGjBO,EAAAA,cAAc,EAAEX,aAAOC,WAAP,CAAmB,YAAnB,EAAiC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAjC,CAHC;AAIjBQ,EAAAA,aAAa,EAAEZ,aAAOC,WAAP,CAAmB,WAAnB,EAAgC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAhC,CAJE;AAKjBS,EAAAA,cAAc,EAAEb,aAAOC,WAAP,CAAmB,YAAnB,EAAiC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAjC,CALC;AAMjBU,EAAAA,cAAc,EAAEd,aAAOC,WAAP,CAAmB,YAAnB,EAAiC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAjC,CANC;AAOjBW,EAAAA,aAAa,EAAEf,aAAOC,WAAP,CAAmB,WAAnB,EAAgC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAhC,CAPE;AAQjBY,EAAAA,cAAc,EAAEhB,aAAOC,WAAP,CAAmB,YAAnB,EAAiC,CAACC,4BAAeC,MAAhB,EAAwBC,0BAAxB,CAAjC;AARC,CAArB","sourceRoot":"/home/nathnael/projects/haleta/haleta-new-api/src/graphql/user/","sourcesContent":["import {UserTC} from \"../../models/user\";\n\nimport {authentication, authorization} from \"../../middlewares\";\n// import Resolvers from \"./services\";\n//\n// for (const resolver in Resolvers) {\n//     UserTC.addResolver(Resolvers[resolver]);\n// }\n\nconst UserQuery = {\n    userById: UserTC.getResolver(\"findById\", [authentication.isAuth, authorization]),\n    userByIds: UserTC.getResolver(\"findByIds\", [authentication.isAuth, authorization]),\n    userOne: UserTC.getResolver(\"findOne\", [authentication.isAuth, authorization]),\n    userMany: UserTC.getResolver(\"findMany\", [authentication.isAuth, authorization]),\n};\n\nconst UserMutation = {\n    userCreateOne: UserTC.getResolver(\"createOne\", [authentication.isAuth, authorization]),\n    userCreateMany: UserTC.getResolver(\"createMany\", [authentication.isAuth, authorization]),\n    userUpdateById: UserTC.getResolver(\"updateById\", [authentication.isAuth, authorization]),\n    userUpdateOne: UserTC.getResolver(\"updateOne\", [authentication.isAuth, authorization]),\n    userUpdateMany: UserTC.getResolver(\"updateMany\", [authentication.isAuth, authorization]),\n    userRemoveById: UserTC.getResolver(\"removeById\", [authentication.isAuth, authorization]),\n    userRemoveOne: UserTC.getResolver(\"removeOne\", [authentication.isAuth, authorization]),\n    userRemoveMany: UserTC.getResolver(\"removeMany\", [authentication.isAuth, authorization]),\n};\n\nexport {UserQuery, UserMutation};\n"]}},"mtime":1648317682657},"{\"assumptions\":{},\"sourceRoot\":\"/home/nathnael/projects/haleta/haleta-new-api/src/config/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"filename\":\"/home/nathnael/projects/haleta/haleta-new-api/src/config/mongodb-config.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/home/nathnael/projects/haleta/haleta-new-api\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{},\"externalDependencies\":[]},{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.17.8:development":{"value":{"code":"\"use strict\";\n\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\n\nvar _dotenv = _interopRequireDefault(require(\"dotenv\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n_dotenv.default.config();\n\nmain().then(() => console.log(\"Mongoose connected\")).catch(err => console.log(err));\n\nasync function main() {\n  await _mongoose.default.connect(process.env.MONGODB_URI);\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vbmdvZGItY29uZmlnLmpzIl0sIm5hbWVzIjpbImRvdGVudiIsImNvbmZpZyIsIm1haW4iLCJ0aGVuIiwiY29uc29sZSIsImxvZyIsImNhdGNoIiwiZXJyIiwibW9uZ29vc2UiLCJjb25uZWN0IiwicHJvY2VzcyIsImVudiIsIk1PTkdPREJfVVJJIl0sIm1hcHBpbmdzIjoiOztBQUFBOztBQUNBOzs7O0FBRUFBLGdCQUFPQyxNQUFQOztBQUVBQyxJQUFJLEdBQ0NDLElBREwsQ0FDVSxNQUFNQyxPQUFPLENBQUNDLEdBQVIsQ0FBWSxvQkFBWixDQURoQixFQUVLQyxLQUZMLENBRVdDLEdBQUcsSUFBSUgsT0FBTyxDQUFDQyxHQUFSLENBQVlFLEdBQVosQ0FGbEI7O0FBSUEsZUFBZUwsSUFBZixHQUFzQjtBQUNsQixRQUFNTSxrQkFBU0MsT0FBVCxDQUFpQkMsT0FBTyxDQUFDQyxHQUFSLENBQVlDLFdBQTdCLENBQU47QUFDSCIsInNvdXJjZVJvb3QiOiIvaG9tZS9uYXRobmFlbC9wcm9qZWN0cy9oYWxldGEvaGFsZXRhLW5ldy1hcGkvc3JjL2NvbmZpZy8iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9uZ29vc2UgZnJvbSBcIm1vbmdvb3NlXCI7XG5pbXBvcnQgZG90ZW52IGZyb20gXCJkb3RlbnZcIjtcblxuZG90ZW52LmNvbmZpZygpO1xuXG5tYWluKClcbiAgICAudGhlbigoKSA9PiBjb25zb2xlLmxvZyhcIk1vbmdvb3NlIGNvbm5lY3RlZFwiKSlcbiAgICAuY2F0Y2goZXJyID0+IGNvbnNvbGUubG9nKGVycikpO1xuXG5hc3luYyBmdW5jdGlvbiBtYWluKCkge1xuICAgIGF3YWl0IG1vbmdvb3NlLmNvbm5lY3QocHJvY2Vzcy5lbnYuTU9OR09EQl9VUkkpO1xufSJdfQ==","map":{"version":3,"sources":["mongodb-config.js"],"names":["dotenv","config","main","then","console","log","catch","err","mongoose","connect","process","env","MONGODB_URI"],"mappings":";;AAAA;;AACA;;;;AAEAA,gBAAOC,MAAP;;AAEAC,IAAI,GACCC,IADL,CACU,MAAMC,OAAO,CAACC,GAAR,CAAY,oBAAZ,CADhB,EAEKC,KAFL,CAEWC,GAAG,IAAIH,OAAO,CAACC,GAAR,CAAYE,GAAZ,CAFlB;;AAIA,eAAeL,IAAf,GAAsB;AAClB,QAAMM,kBAASC,OAAT,CAAiBC,OAAO,CAACC,GAAR,CAAYC,WAA7B,CAAN;AACH","sourceRoot":"/home/nathnael/projects/haleta/haleta-new-api/src/config/","sourcesContent":["import mongoose from \"mongoose\";\nimport dotenv from \"dotenv\";\n\ndotenv.config();\n\nmain()\n    .then(() => console.log(\"Mongoose connected\"))\n    .catch(err => console.log(err));\n\nasync function main() {\n    await mongoose.connect(process.env.MONGODB_URI);\n}"]}},"mtime":1648318431053}}